# Cascade Card ‚Äî ¬´–í–∞—à –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∫–∞—Å–∫–∞–¥¬ª

> –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–æ–¥—É–ª—è `heys_cascade_card_v1.js` v2.2.0  
> –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: 2026-02-19

---

## –°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ –∫–∞—Å–∫–∞–¥–∞ (v2.2.0)

–ö–∞—Å–∫–∞–¥ ‚Äî –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π —Å–∫–æ—Ä–∏–Ω–≥ –¥–Ω—è. 10 —Ñ–∞–∫—Ç–æ—Ä–æ–≤, –∫–∞–∂–¥—ã–π
–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è **–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π** (–≤–º–µ—Å—Ç–æ —Å—Ç—É–ø–µ–Ω–µ–π) –∏ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫
**–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–º—É baseline** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã v2.1.0

| –ü—Ä–∏–Ω—Ü–∏–ø                       | –ù–∞—É—á–Ω–∞—è –æ—Å–Ω–æ–≤–∞                           | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è                                 |
| :---------------------------- | :--------------------------------------- | :----------------------------------------- |
| **–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ —Å–∫–æ—Ä–∏–Ω–≥**       | –ü—Ä–∏—Ä–æ–¥–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç—É–ø–µ–Ω—è–º–∏            | –°–∏–≥–º–æ–∏–¥/–ª–∏–Ω–µ–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –≤–º–µ—Å—Ç–æ `if`  |
| **–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π baseline**     | –ú–µ–∂–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å ¬±30%     | 14-–¥–Ω–µ–≤–Ω–∞—è —Å–∫–æ–ª—å–∑—è—â–∞—è –º–µ–¥–∏–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| **–¶–∏—Ä–∫–∞–¥–Ω–∞—è –æ—Å–≤–µ–¥–æ–º–ª—ë–Ω–Ω–æ—Å—Ç—å** | –ì–æ—Ä–º–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–∏—Ç–º—ã –∫–æ—Ä—Ç–∏–∑–æ–ª/–º–µ–ª–∞—Ç–æ–Ω–∏–Ω/GH | –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–∫—Ç–æ—Ä–∞ |
| **–ê–ª–ª–æ—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞**  | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–π —Å—Ç—Ä–µ—Å—Å vs –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ    | –ö—Ä–æ—Å—Å-—Ñ–∞–∫—Ç–æ—Ä–Ω—ã–µ —Å–∏–Ω–µ—Ä–≥–∏–∏ –∏ –±–∞–ª–∞–Ω—Å          |
| **–ì–æ—Ä–º–µ–∑–∏—Å**                  | –£–º–µ—Ä–µ–Ω–Ω—ã–π —Å—Ç—Ä–µ—Å—Å –ø–æ–ª–µ–∑–µ–Ω, –∏–∑–±—ã—Ç–æ–∫ ‚Äî –Ω–µ—Ç  | Diminishing returns –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏          |
| **Confidence-–≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ**    | –ú–∞–ª–æ –¥–∞–Ω–Ω—ã—Ö ‚Üí –≤–µ—Å –±–ª–∏–∂–µ –∫ –Ω—É–ª—é           | `confidence: 0‚Ä¶1` –Ω–∞ –∫–∞–∂–¥—ã–π —Ñ–∞–∫—Ç–æ—Ä         |

```
–û–±—â–∞—è —Ñ–æ—Ä–º–∞—Ü–∏—è:

getPersonalBaseline(factorKey, defaultValue):
  ‚Üí median(last 14 days for factor)
  ‚Üí fallback: populationDefault

scoreFactor(raw, baseline, curveFn):
  ‚Üí weight = curveFn(raw, baseline)
  ‚Üí confidence = min(1.0, daysWithData / 7)
  ‚Üí adjustedWeight = weight √ó confidence
```

---

### –°–≤–æ–¥–∫–∞ —Ñ–∞–∫—Ç–æ—Ä–æ–≤

```
#   –§–∞–∫—Ç–æ—Ä            v2.0 –¥–∏–∞–ø–∞–∑–æ–Ω  v2.1 –¥–∏–∞–ø–∞–∑–æ–Ω   –ß—Ç–æ –º–µ–Ω—è–µ—Ç—Å—è
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1   –ë—ã—Ç–æ–≤–∞—è –∞–∫—Ç–∏–≤.     -0.3‚Ä¶+1.0      -0.5‚Ä¶+1.2      Adaptive baseline + log2
2   –ö–∞—á–µ—Å—Ç–≤–æ –ø—Ä–∏—ë–º–∞    -1.0‚Ä¶+1.5      -1.5‚Ä¶+2.0      –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è —Ñ-—è + circadian timing
3   –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞         -0.5‚Ä¶+2.5      -0.5‚Ä¶+3.0      Load√óintensity + recovery-aware
4   –í—Ä–µ–º—è –∑–∞—Å—ã–ø–∞–Ω–∏—è    -2.0‚Ä¶+1.0      -2.5‚Ä¶+1.5      Chronotype-adaptive + consistency
5   –î–ª–∏—Ç. —Å–Ω–∞          -1.5‚Ä¶+1.0      -2.0‚Ä¶+1.5      Personalized optimal + bell-curve
6   –®–∞–≥–∏               -0.3‚Ä¶+1.0      -0.5‚Ä¶+1.3      Rolling adaptive goal + tanh
7   –ß–µ–∫-–∏–Ω             0‚Ä¶+0.5         -0.1‚Ä¶+0.8      Streak bonus + trend awareness
8   –ó–∞–º–µ—Ä—ã —Ç–µ–ª–∞        -0.3‚Ä¶+1.0      -0.3‚Ä¶+1.2      Smart cadence + completeness
9   –í–∏—Ç–∞–º–∏–Ω—ã           -0.2‚Ä¶+0.5      -0.3‚Ä¶+0.7      Streak bonus + timing
10  –ò–Ω—Å—É–ª–∏–Ω–æ–≤—ã–µ –≤–æ–ª–Ω—ã  -1.5‚Ä¶+1.5      -2.0‚Ä¶+2.0      Sigmoid overlap + post-training + night fasting
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    –ú–µ—Ç–∞-—à–∞–≥–∏         ‚Äî              ‚Äî               Confidence + Day-Type + Synergies (+1.3 max)
    TOTAL               ~-8‚Ä¶~+11.5     ~-10‚Ä¶~+16.3
    MOMENTUM_TARGET     10.0           12.0
```

---

### –§–∞–∫—Ç–æ—Ä 1: –ë—ã—Ç–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (NEAT) ‚Äî –®–ê–ì 1

**–ò—Å—Ç–æ—á–Ω–∏–∫:**
`HEYS.mealScoring.getMealQualityScore(meal, null, normKcal, pIndex)` ‚Üí
`score: 0‚Äì100`

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** —Å—Ç—É–ø–µ–Ω—á–∞—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è (80/60/40/20 ‚Üí +1.5/+1.0/+0.5/0/-0.5)

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è + —Ü–∏—Ä–∫–∞–¥–Ω—ã–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä:**

```
–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –≤–µ—Å (–ª–∏–Ω–µ–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è):
  weight = clamp((qualityScore - 40) / 40, -1.0, +1.5)
  //  0 ‚Üí -1.0,  20 ‚Üí -0.5,  40 ‚Üí 0.0,  60 ‚Üí +0.5,  80 ‚Üí +1.0, 100 ‚Üí +1.5

–¶–∏—Ä–∫–∞–¥–Ω—ã–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä (–∑–∞–≤—Ç—Ä–∞–∫ –≤–∞–∂–Ω–µ–µ —É–∂–∏–Ω–∞):
  06:00‚Äì10:00 (–∑–∞–≤—Ç—Ä–∞–∫) ‚Üí weight √ó 1.3   ‚Äî cortisol peak, GH sensitivity
  10:00‚Äì14:00 (–æ–±–µ–¥)    ‚Üí weight √ó 1.0   ‚Äî baseline
  14:00‚Äì18:00 (–ø–µ—Ä–µ–∫—É—Å) ‚Üí weight √ó 0.9   ‚Äî slight discount
  18:00‚Äì21:00 (—É–∂–∏–Ω)    ‚Üí weight √ó 0.85  ‚Äî insulin resistance rises
  21:00‚Äì23:00 (–ø–æ–∑–¥–Ω–∏–π) ‚Üí weight √ó 0.7   ‚Äî melatonin onset impairs glucose
  > 23:00               ‚Üí always -1.0    ‚Äî hard violation (circadian disruption)

–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –∫—É–º—É–ª—è—Ç–∏–≤ (sigmoid –≤–º–µ—Å—Ç–æ binary 120%):
  ratio = cumulativeKcal / normKcal
  if ratio > 1.0:
    penalty = -sigmoid((ratio - 1.0) / 0.3) √ó 1.5
    // 105% ‚Üí -0.3,  115% ‚Üí -0.9,  130% ‚Üí -1.4
  // –ú—è–≥—á–µ —á–µ–º binary cutoff, –Ω–æ –Ω–∞—Ä–∞—Å—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–æ
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- Cortisol —É—Ç—Ä–æ–º –ø–æ–≤—ã—à–∞–µ—Ç —Ç–µ—Ä–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç –ø–∏—â–∏ (TEF) –Ω–∞ ~15% (Bo et
  al., 2015)
- –í–µ—á–µ—Ä–Ω—è—è –∏–Ω—Å—É–ª–∏–Ω–æ–≤–∞—è —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å: –æ–¥–∏–Ω–∞–∫–æ–≤–∞—è –µ–¥–∞ –≤–µ—á–µ—Ä–æ–º –¥–∞—ë—Ç –Ω–∞ 17% –≤—ã—à–µ
  –ø–æ—Å—Ç–ø—Ä–∞–Ω–¥–∏–∞–ª—å–Ω—É—é –≥–ª—é–∫–æ–∑—É (Morris et al., 2015)
- –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —É—Å—Ç—Ä–∞–Ω—è–µ—Ç ¬´cliff effect¬ª: –ø—Ä–∏—ë–º —Å–æ score 79 –Ω–µ –¥–æ–ª–∂–µ–Ω
  –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç score 80

**–§–æ–ª–±—ç–∫:** –µ—Å–ª–∏ `getMealQualityScore` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí –±–∏–Ω–∞—Ä–Ω–∞—è –ª–æ–≥–∏–∫–∞ (+1.0 /
‚àí1.0).

---

### –§–∞–∫—Ç–æ—Ä 2: –ö–∞—á–µ—Å—Ç–≤–æ –ø—Ä–∏—ë–º–∞ –ø–∏—â–∏ ‚Äî –®–ê–ì 2

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `day.householdMin` (–º–∏–Ω—É—Ç—ã –±—ã—Ç–æ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏)

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ 60/30/10 –º–∏–Ω

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî adaptive baseline + relative scoring:**

```
Personal baseline:
  baselineNEAT = median(last14days.householdMin) || 30  // population default

Relative scoring (–∫ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–º—É —É—Ä–æ–≤–Ω—é):
  ratio = householdMin / baselineNEAT
  weight = clamp(log2(ratio + 0.5) √ó 0.8, -0.5, +1.2)
  //  ratio=0.0 ‚Üí -0.5 (—Ä–µ–∑–∫–æ –Ω–∏–∂–µ —Å–≤–æ–µ–π –Ω–æ—Ä–º—ã)
  //  ratio=0.3 ‚Üí -0.15
  //  ratio=1.0 ‚Üí +0.35 (–Ω–∞ —É—Ä–æ–≤–Ω–µ)
  //  ratio=1.5 ‚Üí +0.70
  //  ratio=2.0 ‚Üí +1.0 (–≤–¥–≤–æ–µ –≤—ã—à–µ –ø—Ä–∏–≤—ã—á–Ω–æ–≥–æ)
  //  ratio=3.0 ‚Üí +1.2 (cap)

Streak penalty (multi-day, smoothed):
  inactiveDays = countConsecutive(prevDays, d => d.householdMin < 10)
  if inactiveDays > 2:
    penalty = -0.08 √ó (inactiveDays - 2)^0.7, max -0.5
    // –°—É–±–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è –∫—Ä–∏–≤–∞—è: –ø–ª–∞–≤–Ω–æ –Ω–∞—Ä–∞—Å—Ç–∞–µ—Ç
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- NEAT —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 15‚Äì50% —Å—É—Ç–æ—á–Ω–æ–≥–æ —Ä–∞—Å—Ö–æ–¥–∞ (Levine, 2004) ‚Äî –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å
  –æ–≥—Ä–æ–º–Ω–∞
- –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ —Å–∫–æ—Ä–∏–Ω–≥ –≤–∞–∂–Ω–µ–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ: —á–µ–ª–æ–≤–µ–∫ —Å NEAT 120 –º–∏–Ω/–¥–µ–Ω—å –∏ 60
  –º–∏–Ω/–¥–µ–Ω—å ‚Äî —Ä–∞–∑–Ω—ã–µ –±–∞–∑–æ–≤—ã–µ —É—Ä–æ–≤–Ω–∏
- Log-–∫—Ä–∏–≤–∞—è: diminishing returns (60‚Üí120 –º–∏–Ω –º–µ–Ω–µ–µ –∑–Ω–∞—á–∏–º—ã —á–µ–º 0‚Üí60)

---

### –§–∞–∫—Ç–æ—Ä 3: –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ ‚Äî –®–ê–ì 3

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `day.trainings[]`, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å + —Ç–∏–ø

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** duration-only buckets (60/45/30/15 –º–∏–Ω)

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî training load + recovery-aware + diminishing returns:**

```
Training load (per session):
  baseDuration = sum(training.z) || training.duration || typeDefault
  intensityMultiplier = {
    hiit: 1.8,  strength: 1.5,  cardio: 1.2,
    yoga: 0.8,  stretching: 0.6, walk: 0.5
  }[training.type] || 1.0

  load = baseDuration √ó intensityMultiplier

  // –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –≤–µ—Å (sqrt-–∫—Ä–∏–≤–∞—è: diminishing returns):
  sessionWeight = clamp(sqrt(load / 30) √ó 1.2, 0.3, 3.0)
  //  load=15 (15 –º–∏–Ω —Ö–æ–¥—å–±–∞)   ‚Üí +0.85
  //  load=40 (40 –º–∏–Ω –∫–∞—Ä–¥–∏–æ)   ‚Üí +1.38
  //  load=60 (40 –º–∏–Ω —Å–∏–ª–æ–≤–∞—è)  ‚Üí +1.70
  //  load=90 (60 –º–∏–Ω —Å–∏–ª–æ–≤–∞—è)  ‚Üí +2.08
  //  load=108 (60 –º–∏–Ω HIIT)    ‚Üí +2.28

Multiple sessions/day ‚Äî diminishing returns:
  totalWeight = session1 + session2 √ó 0.5 + session3 √ó 0.25
  // –í—Ç–æ—Ä–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –≤ –¥–µ–Ω—å ‚Äî –±–æ–Ω—É—Å, –Ω–æ –Ω–µ –ø–æ–ª–Ω—ã–π

Recovery-aware (–æ—Ç–º–µ–Ω–∞ streak-—à—Ç—Ä–∞—Ñ–∞):
  yesterdayLoad = sum(yesterday.trainings.load)
  if yesterdayLoad > 60:
    // –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –≤—á–µ—Ä–∞ = —Å–µ–≥–æ–¥–Ω—è rest day planned
    skipStreakPenalty = true
    // –î–∞–∂–µ –±–æ–Ω—É—Å +0.2 –∑–∞ planned recovery

Weekly volume tracking:
  weeklyLoad = sum(last7days.totalLoad)
  weeklyTarget = baselineWeeklyLoad || 200  // population default
  weeklyRatio = weeklyLoad / weeklyTarget
  // –ù–µ —à—Ç—Ä–∞—Ñ–æ–≤–∞—Ç—å –µ—Å–ª–∏ weeklyRatio ‚â• 0.8 (–Ω–∞ –Ω–µ–¥–µ–ª–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- Training load = Volume √ó Intensity ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç —Å–ø–æ—Ä—Ç–∏–≤–Ω–æ–π –Ω–∞—É–∫–∏ (Foster, 1998)
- –ü—Ä–∏–Ω—Ü–∏–ø —Å—É–ø–µ—Ä–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏: –¥–µ–Ω—å –æ—Ç–¥—ã—Ö–∞ –ø–æ—Å–ª–µ —Ç—è–∂—ë–ª–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ = —á–∞—Å—Ç—å
  —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–≥–æ —Ü–∏–∫–ª–∞, –Ω–µ –ª–µ–Ω—å
- Diminishing returns: –≤—Ç–æ—Ä–æ–π —á–∞—Å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –º–µ–Ω–µ–µ –ø–æ–ª–µ–∑–µ–Ω —á–µ–º –ø–µ—Ä–≤—ã–π (cortisol
  elevation, glycogen depletion)

---

### –§–∞–∫—Ç–æ—Ä 4: –í—Ä–µ–º—è –∑–∞—Å—ã–ø–∞–Ω–∏—è ‚Äî –®–ê–ì 4

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `day.sleepStart` (—Å—Ç—Ä–æ–∫–∞ `"HH:MM"`)

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ (22:00/23:00/00:00/01:00/02:00)

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî chronotype-adaptive + consistency bonus:**

```
Chronotype baseline:
  personalOnset = median(last14days.sleepStart) || 23:00  // default
  optimalOnset = max(21:30, min(personalOnset, 00:30))
  // Clamp: –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ–º baseline —É–π—Ç–∏ –¥–∞–ª—å—à–µ 00:30

Continuous scoring (sigmoid):
  deviation = sleepStartMins - optimalOnsetMins  // –º–∏–Ω—É—Ç—ã –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
  weight = -tanh(deviation / 45) √ó 2.0 + 0.5
  // deviation = -60 (–Ω–∞ —á–∞—Å —Ä–∞–Ω—å—à–µ –æ–ø—Ç–∏–º—É–º–∞) ‚Üí +1.5
  // deviation = 0   (–≤ —Å–≤–æ—ë –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è) ‚Üí +0.5
  // deviation = +30  (–Ω–∞ 30 –º–∏–Ω –ø–æ–∑–∂–µ) ‚Üí -0.2
  // deviation = +60  (–Ω–∞ —á–∞—Å –ø–æ–∑–∂–µ) ‚Üí -1.0
  // deviation = +120 (–Ω–∞ 2 —á–∞—Å–∞ –ø–æ–∑–∂–µ) ‚Üí -2.0
  // deviation = +180 (–Ω–∞ 3 —á–∞—Å–∞ –ø–æ–∑–∂–µ) ‚Üí -2.5 (cap)

Consistency bonus (low variance = circadian alignment):
  onsetVariance = stdev(last7days.sleepStartMins)
  if onsetVariance < 30:   consistencyBonus = +0.3
  elif onsetVariance < 45: consistencyBonus = +0.15
  else:                    consistencyBonus = 0.0

Hard floor:
  sleepStart > 03:00 ‚Üí always -2.5 (circadian catastrophe)
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- Social jet lag (Wittmann et al., 2006): –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ö—Ä–æ–Ω–æ—Ç–∏–ø–∞ –∏ –≤—Ä–µ–º–µ–Ω–∏ —Å–Ω–∞ ‚Üí
  –º–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è
- Consistency > earliness: —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —Å–Ω–∞ 00:00 –ª—É—á—à–µ —á–µ–º —Ö–∞–æ—Ç–∏—á–Ω–æ–µ
  22:00/02:00 (Phillips et al., 2017)
- Melatonin dim light onset (DLMO) ‚Äî –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–∞—Ä–∫–µ—Ä:
  –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∑–∞—Å—ã–ø–∞–Ω–∏–µ = DLMO + 2—á

---

### –§–∞–∫—Ç–æ—Ä 5: –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–Ω–∞ ‚Äî –®–ê–ì 5

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `day.sleepHours`

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–ø—Ç–∏–º—É–º 7.0‚Äì8.5—á

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî personalized bell-curve + training recovery:**

```
Personal optimal:
  personalOptimal = median(last14days.sleepHours) || 7.5
  // Clamp: 6.0 ‚â§ personalOptimal ‚â§ 9.0

Bell-curve scoring:
  deviation = abs(sleepHours - personalOptimal)
  weight = 1.5 √ó exp(-deviation¬≤ / (2 √ó 0.8¬≤)) - 0.5
  // –í —Å–≤–æ—ë–º –æ–ø—Ç–∏–º—É–º–µ: +1.0
  // ¬±1—á –æ—Ç –æ–ø—Ç–∏–º—É–º–∞: +0.3
  // ¬±2—á –æ—Ç –æ–ø—Ç–∏–º—É–º–∞: -0.4
  // ¬±3—á –æ—Ç –æ–ø—Ç–∏–º—É–º–∞: -0.5 (floor, cap)

Asymmetry (–Ω–µ–¥–æ—Å—ã–ø —Ö—É–∂–µ –ø–µ—Ä–µ—Å—ã–ø–∞):
  if sleepHours < personalOptimal:
    weight *= 1.3  // –£—Å–∏–ª–µ–Ω–∏–µ —à—Ç—Ä–∞—Ñ–∞ –∑–∞ –Ω–µ–¥–æ—Å—ã–ø
  // 5—á –ø—Ä–∏ –æ–ø—Ç–∏–º—É–º–µ 7.5 ‚Üí -0.65 (–≤–º–µ—Å—Ç–æ -0.5)

Training recovery modifier:
  if yesterdayHadIntenseTraining:
    personalOptimal += 0.5  // –ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ —Å–Ω–µ –≤—ã—à–µ –Ω–∞ 30 –º–∏–Ω
    // 8—á –ø–æ—Å–ª–µ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ = –±–ª–∏–∂–µ –∫ –æ–ø—Ç–∏–º—É–º—É

Hard limits (—Ñ–∏–∑–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–æ–ª/–ø–æ—Ç–æ–ª–æ–∫):
  sleepHours < 4.0 ‚Üí floor -2.0 (critical health risk)
  sleepHours > 12.0 ‚Üí cap -0.5 (–º–∞—Ä–∫–µ—Ä –ø—Ä–æ–±–ª–µ–º—ã, –Ω–æ –Ω–µ –∞–∫—Ç–∏–≤–Ω—ã–π –≤—Ä–µ–¥)
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ —Å–Ω–µ: –≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–ª–∏–º–æ—Ä—Ñ–∏–∑–º DEC2 ‚Äî 5—á vs 9—á (He
  et al., 2009)
- Bell-curve –æ–ø—Ç–∏–º–∞–ª—å–Ω–µ–µ –ª–∏–Ω–µ–π–Ω—ã—Ö –ø–æ—Ä–æ–≥–æ–≤: nature is Gaussian
- Post-exercise sleep need: +20‚Äì40 –º–∏–Ω –ø–æ—Å–ª–µ —Ç—è–∂—ë–ª–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (Dattilo et
  al., 2011)

---

### –§–∞–∫—Ç–æ—Ä 6: –ß–µ–∫-–∏–Ω (–≤–µ—Å —É—Ç—Ä–æ–º) ‚Äî –®–ê–ì 7

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `day.weightMorning > 0`

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** binary +0.5

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî streak bonus + trend awareness:**

```
Base reward:
  weightMorning > 0 ‚Üí +0.3

Streak bonus (consecutive check-ins):
  checkinStreak = countConsecutive(prevDays, d => d.weightMorning > 0)
  streakBonus = min(0.5, checkinStreak √ó 0.05)
  // 1 –¥–µ–Ω—å ‚Üí +0.05, 3 –¥–Ω—è ‚Üí +0.15, 7 –¥–Ω–µ–π ‚Üí +0.35, 10+ ‚Üí +0.50

Trend awareness:
  if weight trending toward goal (7-day slope √ó goal direction > 0):
    trendBonus = +0.1
  elif weight stable (|7-day slope| < 0.05 kg/day):
    trendBonus = +0.05

No check-in penalty (mild, only if streak existed):
  if checkinStreak >= 3 && today no checkin:
    penalty = -0.1  // break a good habit

Total: base + streakBonus + trendBonus = max +0.8
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- Self-monitoring = —Å–∞–º—ã–π —Å–∏–ª—å–Ω—ã–π –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (Burke et
  al., 2011)
- Daily weighing: -3.1 –∫–≥ –∑–∞ 12 –º–µ—Å vs -1.2 –∫–≥ –±–µ–∑ (Steinberg et al., 2015)
- Reinforcement schedule: variable ratio > fixed ratio (Skinner, 1938) ‚Äî streak
  bonus —Å–æ–∑–¥–∞—ë—Ç momentum

---

### –§–∞–∫—Ç–æ—Ä 7: –ó–∞–º–µ—Ä—ã —Ç–µ–ª–∞ ‚Äî –®–ê–ì 8

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `day.measurements` ‚Äî `{ waist, hips, thigh, biceps, ... }`

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** binary +1.0 today / penalty if old

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî smart cadence + completeness score:**

```
Optimal cadence:
  daysSinceLast = daysUntil(lastMeasurementDate) || Infinity
  optimalCadence = 7  // 1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é

Today has measurements:
  completeness = count(measurements[k] > 0) / totalPossibleMeasurements
  // waist + hips + thigh + biceps = 4 possible
  // 2 –∏–∑ 4 ‚Üí completeness = 0.5

  baseWeight = 0.5 + completeness √ó 0.7
  // 1 –∑–∞–º–µ—Ä ‚Üí +0.67,  all 4 ‚Üí +1.2

  // –ï—Å–ª–∏ —Å–Ω–∏–º–∞–ª–∏ –≤—á–µ—Ä–∞ —Ç–æ–∂–µ ‚Äî diminishing returns:
  if daysSinceLast <= 2: baseWeight *= 0.5
  // ¬´–ö–∞–∂–¥—ã–π –¥–µ–Ω—å –º–µ—Ä–∏—Ç—å¬ª –Ω–µ –ª—É—á—à–µ —á–µ–º —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é

No measurements today:
  if daysSinceLast > optimalCadence √ó 2:
    penalty = clamp(-0.05 √ó (daysSinceLast - optimalCadence), -0.3, 0)
  // 14 –¥–Ω–µ–π –Ω–∞–∑–∞–¥ ‚Üí -0.05 √ó 7 = -0.35 ‚Üí capped -0.3
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- –û–±—Ö–≤–∞—Ç —Ç–∞–ª–∏–∏ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å –≤–∏—Å—Ü–µ—Ä–∞–ª—å–Ω—ã–º –∂–∏—Ä–æ–º: r = 0.84 (Janssen et al., 2002)
- –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –ø–æ—Ö—É–¥–µ–Ω–∏—è
- Completeness: –±–æ–ª—å—à–µ —Ç–æ—á–µ–∫ = —Ç–æ—á–Ω–µ–µ tracking body recomposition

---

### –§–∞–∫—Ç–æ—Ä 8: –®–∞–≥–∏ ‚Äî –®–ê–ì 6

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `day.steps` / `prof.stepsGoal || 7000`

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** ratio-based —Å—Ç—É–ø–µ–Ω–∏ (120/100/70/50%)

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî rolling adaptive goal + time-of-day curve:**

```
Adaptive goal:
  rollingAvg = mean(last14days.steps) || prof.stepsGoal || 7000
  adaptiveGoal = max(5000, rollingAvg √ó 1.05)
  // –¶–µ–ª—å —Å–ª–µ–≥–∫–∞ –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ ‚Äî –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞

Continuous scoring:
  ratio = steps / adaptiveGoal
  weight = clamp(tanh((ratio - 0.6) √ó 2.5) √ó 1.0 + 0.15, -0.5, +1.3)
  //  ratio=0.3 ‚Üí -0.45
  //  ratio=0.5 ‚Üí -0.10
  //  ratio=0.7 ‚Üí +0.30
  //  ratio=1.0 ‚Üí +0.85
  //  ratio=1.3 ‚Üí +1.15
  //  ratio=1.5 ‚Üí +1.25 (diminishing returns)

Time-of-day expectation (intraday credit):
  hourFraction = currentHour / 24
  expectedSteps = adaptiveGoal √ó hourFraction^0.7
  // –ö 14:00 –æ–∂–∏–¥. ~55% —à–∞–≥–æ–≤, –∫ 20:00 ~82%
  // –ù–µ —à—Ç—Ä–∞—Ñ—É–µ–º —É—Ç—Ä–æ–º –∑–∞ ¬´–º–∞–ª–æ —à–∞–≥–æ–≤¬ª ‚Äî –¥–µ–Ω—å –µ—â—ë –∏–¥—ë—Ç

  if steps < expectedSteps √ó 0.5 && currentHour > 16:
    // –ö –≤–µ—á–µ—Ä—É –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∏–∂–µ –æ–∂–∏–¥. ‚Üí  hint ¬´–ø—Ä–æ–≥—É–ª—è–π—Å—è¬ª
    earlyWarning = true
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- 7000‚Äì10000 —à–∞–≥–æ–≤/–¥–µ–Ω—å = –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç–∏ (Paluch
  et al., 2022)
- –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞: +5% –∫ —Å—Ä–µ–¥–Ω–µ–º—É ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç —Å–ø–æ—Ä—Ç–∏–≤–Ω–æ–π –ø–µ—Ä–∏–æ–¥–∏–∑–∞—Ü–∏–∏
- Intraday curve: —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ, –ø–∏–∫ 10‚Äì18—á

---

### –§–∞–∫—Ç–æ—Ä 9: –í–∏—Ç–∞–º–∏–Ω—ã / –¥–æ–±–∞–≤–∫–∏ ‚Äî –®–ê–ì 9

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `day.supplementsTaken` vs –ø–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** ratio-based 3 —Å—Ç—É–ø–µ–Ω–∏ (100/50/0%)

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî streak bonus + smooth function:**

```
Base scoring (continuous):
  ratio = suppTaken / suppPlanned
  weight = clamp(ratio √ó 0.7 - 0.1, -0.3, +0.5)
  //  ratio=0.0 ‚Üí -0.1
  //  ratio=0.3 ‚Üí +0.11
  //  ratio=0.7 ‚Üí +0.39
  //  ratio=1.0 ‚Üí +0.5 (–≤—Å—ë –ø—Ä–∏–Ω—è—Ç–æ, –µ—â—ë –Ω–µ max)

Streak bonus (consistency):
  suppStreak = countConsecutive(prevDays, d => suppRatio(d) >= 0.8)
  if suppStreak >= 7:  streakBonus = +0.2  // –Ω–µ–¥–µ–ª—è –ø–æ–¥—Ä—è–¥
  elif suppStreak >= 3: streakBonus = +0.1

Missed penalty (only if plan exists && streak was active):
  if suppPlanned > 0 && suppTaken == 0 && suppStreak >= 3:
    penalty = -0.3  // breaking established habit

Total: base + streak = max +0.7
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- Adherence > dosage: 80% compliance = 95% —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, <50% = –ø–æ—Ç–µ—Ä—è —ç—Ñ—Ñ–µ–∫—Ç–∞
  (Osterberg & Blaschke, 2005)
- Habit formation: streak-–±–æ–Ω—É—Å —Å–æ–∑–¥–∞—ë—Ç positive reinforcement loop (Lally et
  al., 2010: average 66 –¥–Ω–µ–π –¥–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–º, –ø–µ—Ä–≤—ã–µ 7 ‚Äî –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –æ–∫–Ω–æ)

---

### –§–∞–∫—Ç–æ—Ä 10: –ò–Ω—Å—É–ª–∏–Ω–æ–≤—ã–µ –≤–æ–ª–Ω—ã ‚Äî –®–ê–ì 10

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `HEYS.InsulinWave.calculate()`

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** overlap count + avgGap + nightFasting

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî GI-awareness + post-training window + composition:**

```
Overlap scoring (severity-weighted, continuous):
  overlapPenalty = Œ£ -sigmoid(overlapMinutes / 30) √ó 0.6
  // 10 –º–∏–Ω –Ω–∞–ª–æ–∂–µ–Ω–∏—è ‚Üí -0.18
  // 30 –º–∏–Ω ‚Üí -0.36
  // 60 –º–∏–Ω ‚Üí -0.51
  // Total cap: -2.0

Gap scoring (continuous log-curve):
  gapBonus = Œ£ clamp(log2(gapMinutes / 120), 0, 1.0) √ó 0.4
  // 120 –º–∏–Ω gap ‚Üí +0.0
  // 180 –º–∏–Ω ‚Üí +0.23
  // 240 –º–∏–Ω ‚Üí +0.40
  // 360 –º–∏–Ω ‚Üí +0.63

Post-training meal timing (anabolic window):
  if meal within 30‚Äì120 –º–∏–Ω after training:
    mealTimingBonus = +0.3  // protein synthesis window
  if meal within 0‚Äì30 –º–∏–Ω after training:
    mealTimingBonus = +0.15  // too fast, but okay

Night fasting (continuous):
  nightGapHours = longestGap / 60
  nightBonus = clamp((nightGapHours - 10) √ó 0.15, 0.0, +0.5)
  // 10—á ‚Üí 0.0, 12—á ‚Üí +0.3, 14—á ‚Üí +0.5 (cap)

Meal composition modifier (–µ—Å–ª–∏ getMealQualityScore –¥–æ—Å—Ç—É–ø–µ–Ω):
  if lastMealBeforeSleep has highGI items:
    nightFastingPenalty -= 0.2
    // –í—ã—Å–æ–∫–∏–π –ì–ò –ø–µ—Ä–µ–¥ —Å–Ω–æ–º = poor sleep quality ‚Üí hit fasting benefit

Total: overlapPenalty + gapBonus + nightBonus + mealTimingBonus
  range: -2.0 ‚Ä¶ +2.0
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- Insulin Overlap: –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ –∏–Ω—Å—É–ª–∏–Ω–∞ –¥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ baseline ‚Üí de novo
  lipogenesis (Frayn, 2003)
- Anabolic window: MPS –ø–æ–≤—ã—à–∞–µ—Ç—Å—è –Ω–∞ 50% –≤ –ø–µ—Ä–≤—ã–µ 2—á –ø–æ—Å–ª–µ resistance training
  (Schoenfeld et al., 2013)
- Time-restricted eating (16/8): meta-analysis –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç -1.6 –∫–≥ / 12 –Ω–µ–¥–µ–ª—å
  (Regmi & Heilbronn, 2020) ‚Äî –Ω–æ—á–Ω–æ–π —Ñ–∞—Å—Ç–∏–Ω–≥ ‚â• 14—á

---

### –ö—Ä–æ—Å—Å-—Ñ–∞–∫—Ç–æ—Ä–Ω—ã–µ —Å–∏–Ω–µ—Ä–≥–∏–∏ ‚Äî –®–ê–ì 13 (NEW in v2.1.0)

–§–∞–∫—Ç–æ—Ä—ã –Ω–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã. –û–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç **—Å–∏–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π
—ç—Ñ—Ñ–µ–∫—Ç**:

```
SYNERGIES = {
  // –°–æ–Ω + –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞: —Ö–æ—Ä–æ—à–∏–π —Å–æ–Ω —É—Å–∏–ª–∏–≤–∞–µ—Ç recovery
  sleep_training: {
    condition: sleepDurWeight > 0 && yesterdayTrainingLoad > 50
    bonus: +0.3
    reason: 'Quality sleep after training ‚Üí supercompensation'
  },

  // NEAT + –®–∞–≥–∏: combined movement score
  neat_steps: {
    condition: householdWeight > 0 && stepsWeight > 0
    bonus: +0.2
    reason: 'Multi-modal movement ‚Üí higher TDEE, better insulin sensitivity'
  },

  // Meal timing + Insulin gaps: aligned eating = metabolic harmony
  meals_insulin: {
    condition: avgMealQuality > 60 && avgGap > 180
    bonus: +0.2
    reason: 'Quality food + proper spacing ‚Üí optimal nutrient partitioning'
  },

  // Morning routine: checkin + early meal + NEAT
  morning_ritual: {
    condition: hasCheckin && firstMealBefore10 && householdMin > 0
    bonus: +0.3
    reason: 'Morning structure ‚Üí cortisol alignment, habit stacking'
  },

  // Full recovery day: good sleep + rest + low stress
  recovery_day: {
    condition: sleepOnsetWeight > 0 && sleepDurWeight > 0.5
              && !hasTraining && householdMin > 20
    bonus: +0.3
    reason: 'Planned recovery ‚Üí parasympathetic dominance'
  }
}

Max total synergy bonus: +1.3
```

---

### Day-Type Awareness ‚Äî –®–ê–ì 12 (NEW in v2.1.0)

–ö–∞—Å–∫–∞–¥ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç **—Ç–∏–ø –¥–Ω—è** –∏ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç –æ–∂–∏–¥–∞–Ω–∏—è:

```
DAY_TYPES = {
  training_day: {
    detect: trainings.length > 0 && totalLoad > 40
    adjustments: {
      mealCalorieTolerance: 1.3   // +30% kcal allowance
      sleepImportance: 1.2         // sleep weight √ó 1.2 tomorrow
      stepsGoalModifier: 0.8       // lower steps expected
    }
  },
  rest_day: {
    detect: trainings.length == 0 && yesterday.trainingLoad > 60
    adjustments: {
      trainingPenalty: 0            // no penalty for missing training
      neatImportance: 1.3           // NEAT more important on rest days
      recoveryBonus: +0.2           // explicit rest = good
    }
  },
  active_rest: {
    detect: trainings has yoga/stretching/walk only
    adjustments: {
      trainingWeight: √ó 1.2        // boost low-intensity activities
      stepsBonus: +0.1              // walking encouraged
    }
  }
}
```

---

### Confidence Layer ‚Äî –®–ê–ì 11 (NEW in v2.1.0)

–ö–∞–∂–¥—ã–π —Ñ–∞–∫—Ç–æ—Ä –ø–æ–ª—É—á–∞–µ—Ç `confidence: 0.0‚Äì1.0` –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–±—ä—ë–º–∞ –¥–∞–Ω–Ω—ã—Ö:

```
getFactorConfidence(factorKey):
  daysWithData = count(last14days where factor has data)

  if daysWithData >= 10:  return 1.0
  elif daysWithData >= 7: return 0.8
  elif daysWithData >= 3: return 0.5
  elif daysWithData >= 1: return 0.3
  else:                   return 0.1  // population default only

–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
  adjustedWeight = rawWeight √ó confidence
  // –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (day 1): –≤—Å–µ –≤–µ—Å–∞ √ó 0.1 ‚Üí score ‚âà 0
  // –ß–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é: √ó 0.5‚Äì0.8 ‚Üí score –Ω–∞—á–∏–Ω–∞–µ—Ç –æ—Ç—Ä–∞–∂–∞—Ç—å —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å
  // –ß–µ—Ä–µ–∑ 2 –Ω–µ–¥–µ–ª–∏: √ó 1.0 ‚Üí –ø–æ–ª–Ω—ã–µ –≤–µ—Å–∞

–≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç:
  - –õ–æ–∂–Ω—ã–π STRONG —É –Ω–æ–≤–∏—á–∫–∞  —Å –æ–¥–Ω–æ–π —Ö–æ—Ä–æ—à–µ–π –µ–¥–æ–π
  - –õ–æ–∂–Ω—ã–π BROKEN –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã—Ö
  - –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏ –ø—Ä–∏ –º–∞–ª–æ–º N
```

---

### –ü–æ—Ä–æ–≥–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π (v2.2.0)

```
STRONG:   score ‚â• 8.0   ‚Äî –º–æ—â–Ω—ã–π –¥–µ–Ω—å
GROWING:  score ‚â• 4.5   ‚Äî –∫–∞—Å–∫–∞–¥ —Ä–∞—Å—Ç—ë—Ç
BUILDING: score ‚â• 1.5   ‚Äî –Ω–∞—á–∞–ª–æ
RECOVERY: 0 < score < 1.5  ‚Äî —Å–ª–∞–±—ã–π –∏–º–ø—É–ª—å—Å (–≤ v2.1 –±—ã–ª–æ: hasBreak + score > 0)
BROKEN:   score ‚â§ 0     ‚Äî –Ω–µ–≥–∞—Ç–∏–≤—ã –ø–µ—Ä–µ–≤–µ—Å–∏–ª–∏ (–≤ v2.1: hasBreak + score ‚â§ 0)
EMPTY:    –Ω–µ—Ç —Å–æ–±—ã—Ç–∏–π   ‚Äî –Ω–∞—á–∞–ª–æ –¥–Ω—è
```

> **v2.2.0**: `hasBreak` –±–æ–ª—å—à–µ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –°–æ—Å—Ç–æ—è–Ω–∏–µ = f(score).
> RECOVERY —Ç–µ–ø–µ—Ä—å –æ–∑–Ω–∞—á–∞–µ—Ç ¬´—Å–ª–∞–±—ã–π –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∏–º–ø—É–ª—å—Å¬ª, –∞ –Ω–µ ¬´–±—ã–ª —Ä–∞–∑—Ä—ã–≤¬ª.
> BROKEN —Ç–µ–ø–µ—Ä—å –æ–∑–Ω–∞—á–∞–µ—Ç ¬´–Ω–µ–≥–∞—Ç–∏–≤—ã –ø–µ—Ä–µ–≤–µ—Å–∏–ª–∏ –ø–æ–∑–∏—Ç–∏–≤¬ª.

### –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä (v2.2.0)

```
Momentum = min(1, max(0, score) / MOMENTUM_TARGET)
MOMENTUM_TARGET = 12.0  (raised from 10.0 to accommodate higher range)

–•–æ—Ä–æ—à–∏–π –¥–µ–Ω—å (—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π):
  3 —Ö–æ—Ä. –µ–¥—ã (√ócircadian +3.5) + —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ 45–º (+2.0) + —Å–æ–Ω (onset+dur +2.0)
  + consistency +0.3 + —á–µ–∫-–∏–Ω streak (+0.5) + —à–∞–≥–∏ adaptive (+0.9)
  + –≤–∏—Ç–∞–º–∏–Ω—ã streak (+0.6) + gaps 3—á (+0.5) + morning_ritual synergy (+0.3)
  = 10.6 ‚Üí –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä 88%

–û—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å:
  3 –æ—Ç–ª. –µ–¥—ã (√ócircadian +5.0) + —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ 60–º (+2.5) + —Å–æ–Ω –∏–¥–µ–∞–ª—å–Ω—ã–π (+2.5)
  + consistency +0.3 + —á–µ–∫-–∏–Ω streak (+0.8) + –∑–∞–º–µ—Ä—ã complete (+1.2)
  + —à–∞–≥–∏ 120% adaptive (+1.15) + –≤–∏—Ç–∞–º–∏–Ω—ã streak (+0.7)
  + gaps 4—á (+1.0) + –Ω–æ—á–Ω–æ–π 14—á (+0.5) + NEAT 60–º relative (+1.0)
  + synergies (+1.0)
  = 17.6 ‚Üí –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä 100% (capped)
```

### –ü–æ—Å—Ç-—Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–µ –æ–∫–Ω–æ

| –£—Å–ª–æ–≤–∏–µ               | –≠—Ñ—Ñ–µ–∫—Ç                        |
| :-------------------- | :---------------------------- |
| < 2—á –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ | –ü—É–ª —Å–æ–æ–±—â–µ–Ω–∏–π: ANTI_LICENSING |

### –í–∏–∑—É–∞–ª—å–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ (`chain`) ‚Äî v2.2.0 Soft Chain

`chain` ‚Äî –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –ù–µ–≥–∞—Ç–∏–≤–Ω–æ–µ
—Å–æ–±—ã—Ç–∏–µ **—É–º–µ–Ω—å—à–∞–µ—Ç** —Ü–µ–ø–æ—á–∫—É –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —Ç—è–∂–µ—Å—Ç–∏, –∞ –Ω–µ –æ–±–Ω—É–ª—è–µ—Ç. –ù–µ –≤–ª–∏—è–µ—Ç
–Ω–∞ state/progress.

```
Soft Chain Penalty Tiers:
  MINOR  (weight ‚â• -0.5):  chain -= 1  ‚Äî —Å–ª–∞–±—ã–π –ø—Ä–∏—ë–º, –º–∞–ª–æ —à–∞–≥–æ–≤
  MEDIUM (-1.5 ‚â§ w < -0.5): chain -= 2  ‚Äî –ø–æ–∑–¥–Ω–∏–π —Å–æ–Ω, –≤—Ä–µ–¥–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç
  SEVERE (weight < -1.5):  chain -= 3  ‚Äî –∑–∞—Å—ã–ø–∞–Ω–∏–µ –ø–æ—Å–ª–µ 03:00, –∫—Ä–∏—Ç. –Ω–µ–¥–æ—Å—ã–ø

  chain = max(0, chain - penalty)  ‚Äî –Ω–∏–∫–æ–≥–¥–∞ –Ω–∏–∂–µ 0

–ü—Ä–∏–º–µ—Ä: chain=5, –æ–¥–∏–Ω –ø—Ä–æ–º–∞—Ö (MINOR) ‚Üí chain=4 (–∞ –Ω–µ 0)
```

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ö–æ–Ω—Ü–µ–ø—Ü–∏—è](#1-–∫–æ–Ω—Ü–µ–ø—Ü–∏—è)
2. [–§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞](#2-—Ñ–∞–π–ª–æ–≤–∞—è-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
3. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è](#3-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–º–æ–¥—É–ª—è)
4. [–î–≤–∏–∂–æ–∫: computeCascadeState](#4-–¥–≤–∏–∂–æ–∫-computecascadestate)
5. [–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö](#5-–º–æ–¥–µ–ª—å-–¥–∞–Ω–Ω—ã—Ö)
6. [–°–æ—Å—Ç–æ—è–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏](#6-—Å–æ—Å—Ç–æ—è–Ω–∏—è-–∫–∞—Ä—Ç–æ—á–∫–∏)
7. [–ê–ª–≥–æ—Ä–∏—Ç–º —Ü–µ–ø–æ—á–∫–∏](#7-–∞–ª–≥–æ—Ä–∏—Ç–º-—Ü–µ–ø–æ—á–∫–∏)
8. [–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã React](#8-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã-react)
9. [–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è](#9-–∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ-—Å–æ–æ–±—â–µ–Ω–∏—è)
10. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ](#10-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-–≤-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
11. [CSS –∏ —Å—Ç–∏–ª–∏](#11-css-–∏-—Å—Ç–∏–ª–∏)
12. [–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞](#12-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ-–∏-–æ—Ç–ª–∞–¥–∫–∞)
13. [API –º–æ–¥—É–ª—è](#13-api-–º–æ–¥—É–ª—è)
14. [–†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å](#14-—Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)
15. [–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è](#15-–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è)

---

## 1. –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

**¬´–í–∞—à –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∫–∞—Å–∫–∞–¥¬ª** ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ –≤ Day View, –∫–æ—Ç–æ—Ä–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ü–µ–ø–æ—á–∫—É
–∑–¥–æ—Ä–æ–≤—ã—Ö —Ä–µ—à–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –∑–∞ —Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å.

**–ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞** (–±–µ–∑ –Ω–∞—É—á–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤):

- –ö–∞–∂–¥–æ–µ –ø–æ–∑–∏—Ç–∏–≤–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–≤–µ–Ω–æ –≤ —Ü–µ–ø–æ—á–∫—É
- –ù–∞—Ä—É—à–µ–Ω–∏–µ **—É–º–µ–Ω—å—à–∞–µ—Ç** —Ü–µ–ø–æ—á–∫—É (–Ω–µ –æ–±–Ω—É–ª—è–µ—Ç), –∫–∞—Ä—Ç–æ—á–∫–∞ —Å—Ä–∞–∑—É –≥–æ–≤–æ—Ä–∏—Ç ¬´–Ω–µ –≤—Å—ë
  –ø–æ—Ç–µ—Ä—è–Ω–æ¬ª
- 2 —á–∞—Å–∞ –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –∞–Ω—Ç–∏–ª–∏—Ü–µ–Ω–∑–∏—Ä—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
  (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç ¬´–∑–∞—Å–ª—É–∂–µ–Ω–Ω—É—é¬ª –ø–µ—Ä–µ–µ–¥–∫—É)
- RECOVERY-—Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–æ—â—Ä—è–µ—Ç –≤–æ–∑–≤—Ä–∞—Ç –ø–æ—Å–ª–µ —Å—Ä—ã–≤–∞

**–ú–µ—Å—Ç–æ –≤ UI:** –º–µ–∂–¥—É Goal Progress Bar –∏ Refeed Card –≤ `renderDiarySection`.

---

## 2. –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

| –§–∞–π–ª                                           | –¢–∏–ø              | –û–ø–∏—Å–∞–Ω–∏–µ                                   |
| ---------------------------------------------- | ---------------- | ------------------------------------------ |
| `apps/web/heys_cascade_card_v1.js`             | JS (~1760 —Å—Ç—Ä–æ–∫) | –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å: –¥–≤–∏–∂–æ–∫ + React-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã |
| `apps/web/styles/modules/740-cascade-card.css` | CSS              | –°—Ç–∏–ª–∏ standalone-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞                |

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

| –§–∞–π–ª                                 | –ò–∑–º–µ–Ω–µ–Ω–∏–µ                                                        |
| ------------------------------------ | ---------------------------------------------------------------- |
| `apps/web/heys_day_diary_section.js` | –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∏ –≤—Å—Ç–∞–≤–∫–∞ `cascadeCard` –≤–Ω—É—Ç—Ä–∏ `renderDiarySection()` |
| `apps/web/index.html`                | `<script defer src="heys_cascade_card_v1.js?v=1">`               |
| `apps/web/styles/main.css`           | `@import url("./modules/740-cascade-card.css")`                  |

---

## 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è

```
heys_cascade_card_v1.js
‚îÇ
‚îú‚îÄ‚îÄ CONSTANTS
‚îÇ   ‚îú‚îÄ‚îÄ STATES            ‚Äî 6 —Å–æ—Å—Ç–æ—è–Ω–∏–π –∫–∞—Ä—Ç–æ—á–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ STATE_CONFIG      ‚Äî –∏–∫–æ–Ω–∫–∞, —Ü–≤–µ—Ç, –ª–µ–π–±–ª –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ MESSAGES          ‚Äî –ø—É–ª—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (6 –ø—É–ª–æ–≤)
‚îÇ   ‚îî‚îÄ‚îÄ EVENT_ICONS       ‚Äî —ç–º–æ–¥–∑–∏ –∏–∫–æ–Ω–∫–∏ —Ç–∏–ø–æ–≤ —Å–æ–±—ã—Ç–∏–π
‚îÇ
‚îú‚îÄ‚îÄ UTILITIES
‚îÇ   ‚îú‚îÄ‚îÄ parseTime(str)           ‚Äî "HH:MM" ‚Üí –º–∏–Ω—É—Ç—ã –æ—Ç –ø–æ–ª—É–Ω–æ—á–∏
‚îÇ   ‚îú‚îÄ‚îÄ formatTimeShort(str)     ‚Äî –º–∏–Ω—É—Ç—ã ‚Üí "HH:MM"
‚îÇ   ‚îú‚îÄ‚îÄ pickMessage(pool, key)   ‚Äî –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–±–æ—Ä –ø–æ —á–∞—Å—É
‚îÇ   ‚îú‚îÄ‚îÄ isWithinHours(str, h)    ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –æ–∫–Ω–∞
‚îÇ   ‚îú‚îÄ‚îÄ getMealLabel(meal, i)    ‚Äî –º–µ—Ç–∫–∞ –ø—Ä–∏—ë–º–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
‚îÇ   ‚îú‚îÄ‚îÄ checkMealHarm(meal, pi) ‚Äî –Ω–∞–ª–∏—á–∏–µ product.harm ‚â• 7
‚îÇ   ‚îú‚îÄ‚îÄ getPreviousDays(n)       ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–µ N –¥–Ω–µ–π –∏–∑ localStorage
‚îÇ   ‚îú‚îÄ‚îÄ clamp(v, min, max)       ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ (v2.1.0)
‚îÇ   ‚îú‚îÄ‚îÄ median(arr)              ‚Äî –º–µ–¥–∏–∞–Ω–∞ –º–∞—Å—Å–∏–≤–∞ (v2.1.0)
‚îÇ   ‚îú‚îÄ‚îÄ stdev(arr)               ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (v2.1.0)
‚îÇ   ‚îú‚îÄ‚îÄ getPersonalBaseline()    ‚Äî 14-–¥–Ω–µ–≤–Ω–∞—è –º–µ–¥–∏–∞–Ω–∞ —Ñ–∞–∫—Ç–æ—Ä–∞ (v2.1.0)
‚îÇ   ‚îú‚îÄ‚îÄ getFactorConfidence()    ‚Äî 0..1 –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Å –ø–æ –æ–±—ä—ë–º—É –¥–∞–Ω–Ω—ã—Ö (v2.1.0)
‚îÇ   ‚îú‚îÄ‚îÄ countConsecutive()       ‚Äî —Å—Ç—Ä–∏–∫-–ø–æ–¥—Å—á—ë—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –¥–Ω–µ–π (v2.1.0)
‚îÇ   ‚îú‚îÄ‚îÄ getCircadianMultiplier() ‚Äî —Ü–∏—Ä–∫–∞–¥–Ω—ã–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (v2.1.0)
‚îÇ   ‚îú‚îÄ‚îÄ getTrainingDuration()    ‚Äî –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (v2.1.0)
‚îÇ   ‚îî‚îÄ‚îÄ getTrainingLoad()        ‚Äî dur √ó intensity multiplier (v2.1.0)
‚îÇ
‚îú‚îÄ‚îÄ ENGINE
‚îÇ   ‚îî‚îÄ‚îÄ computeCascadeState(day, dayTot, normAbs, prof, pIndex)
‚îÇ       ‚Äî 20-—à–∞–≥–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º, —á–∏—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç cascadeState
‚îÇ
‚îú‚îÄ‚îÄ REACT COMPONENTS (standalone, –Ω–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç HEYS.ExpandableCard)
‚îÇ   ‚îú‚îÄ‚îÄ ChainDots(props)         ‚Äî –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ —Ç–æ—á–µ–∫
‚îÇ   ‚îú‚îÄ‚îÄ CascadeTimeline(props)   ‚Äî —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–π —Ç–∞–π–º–ª–∞–π–Ω —Å–æ–±—ã—Ç–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ CascadeCard(props)       ‚Äî –≥–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (useState –¥–ª—è toggle)
‚îÇ
‚îî‚îÄ‚îÄ ENTRY POINT
    ‚îî‚îÄ‚îÄ renderCard(params)       ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –∏–∑ diary section
```

**–ü–∞—Ç—Ç–µ—Ä–Ω –º–æ–¥—É–ª—è:** IIFE `(function(global) { ... })(window)` ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç
–≤—Å–µ–º legacy-–º–æ–¥—É–ª—è–º (`heys_refeed_v1.js`, `heys_supplements_v1.js` –∏ –¥—Ä.)

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

- `global.React` ‚Äî –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω –¥–æ –º–æ–¥—É–ª—è
- `HEYS.dayUtils.getProductFromItem` –∏–ª–∏ `HEYS.models.getProductFromItem` ‚Äî –¥–ª—è
  —Ä–∞—Å—á—ë—Ç–∞ –∫–∫–∞–ª –∏ harm –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, graceful degradation –±–µ–∑ –Ω–∏—Ö)

---

## 4. –î–≤–∏–∂–æ–∫: computeCascadeState

```js
computeCascadeState(day, dayTot, normAbs, prof, pIndex) ‚Üí cascadeState
```

**–í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä  | –¢–∏–ø    | –û–ø–∏—Å–∞–Ω–∏–µ                                                          |
| --------- | ------ | ----------------------------------------------------------------- |
| `day`     | Object | –û–±—ä–µ–∫—Ç –¥–Ω—è: `meals[]`, `trainings[]`, `water`, `steps`            |
| `dayTot`  | Object | –î–Ω–µ–≤–Ω—ã–µ —Å—É–º–º–∞—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é, –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è) |
| `normAbs` | Object | –ê–±—Å–æ–ª—é—Ç–Ω—ã–µ –Ω–æ—Ä–º—ã: `normAbs.kcal` ‚Äî –∫–∞–ª–æ—Ä–∏–π–Ω–∞—è –Ω–æ—Ä–º–∞ –Ω–∞ –¥–µ–Ω—å       |
| `prof`    | Object | –ü—Ä–æ—Ñ–∏–ª—å: `water_norm` (–º–ª), `stepsGoal` / `steps_goal`            |
| `pIndex`  | Object | –ò–Ω–¥–µ–∫—Å –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –¥–ª—è `getProductFromItem`                         |

**–ê–ª–≥–æ—Ä–∏—Ç–º (20 —à–∞–≥–æ–≤, v2.1.0):**

```
–®–ê–ì 1  ‚Äî –ë—ã—Ç–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: adaptive baseline, log2-relative scoring, sub-quad streak
–®–ê–ì 2  ‚Äî –ü—Ä–∏—ë–º—ã –ø–∏—â–∏: continuous scoring + circadian modifier + sigmoid cumulative penalty
–®–ê–ì 3  ‚Äî –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏: training load (dur √ó intensity), sqrt-diminishing returns, recovery-aware
–®–ê–ì 4  ‚Äî –í—Ä–µ–º—è –∑–∞—Å—ã–ø–∞–Ω–∏—è: chronotype-adaptive sigmoid + consistency bonus + hard floor
–®–ê–ì 5  ‚Äî –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–Ω–∞: personalized bell-curve + asymmetric penalty + training recovery
–®–ê–ì 6  ‚Äî –®–∞–≥–∏: rolling adaptive goal, tanh continuous scoring
–®–ê–ì 7  ‚Äî –ß–µ–∫-–∏–Ω: streak bonus (consecutive +0.05/day) + trend awareness + habit break penalty
–®–ê–ì 8  ‚Äî –ó–∞–º–µ—Ä—ã —Ç–µ–ª–∞: smart cadence (weekly optimal) + completeness score + diminishing daily
–®–ê–ì 9  ‚Äî –í–∏—Ç–∞–º–∏–Ω—ã: continuous ratio scoring + streak bonus + habit break penalty
–®–ê–ì 10 ‚Äî –ò–Ω—Å—É–ª–∏–Ω–æ–≤—ã–µ –≤–æ–ª–Ω—ã: sigmoid overlap + log2 gap + post-training timing + night fasting
–®–ê–ì 11 ‚Äî Scoring summary + Confidence layer: daysWithData / 14 ‚Üí adjustedWeight = rawWeight √ó confidence
–®–ê–ì 12 ‚Äî Day-Type detection: training_day / rest_day / active_rest ‚Üí modifier adjustments
–®–ê–ì 13 ‚Äî Cross-factor synergies: sleep+training, NEAT+steps, meals+insulin, morning ritual, recovery
–®–ê–ì 14 ‚Äî –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ events –ø–æ sortKey (–≤—Ä–µ–º—è –≤ –º–∏–Ω—É—Ç–∞—Ö)
–®–ê–ì 15 ‚Äî –ê–ª–≥–æ—Ä–∏—Ç–º —Ü–µ–ø–æ—á–∫–∏ (v2.2.0 soft): –ø–æ–¥—Å—á—ë—Ç chain c –º—è–≥–∫–æ–π –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–µ–π, maxChain, warnings
–®–ê–ì 16 ‚Äî –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (v2.2.0 score-driven, –±–µ–∑ hasBreak)
–®–ê–ì 17 ‚Äî Post-training window: lastTraining.time –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 2 —á–∞—Å–æ–≤?
–®–ê–ì 18 ‚Äî –í—ã–±–æ—Ä –ø—É–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏–π (—Å —É—á—ë—Ç–æ–º post-training)
–®–ê–ì 19 ‚Äî Momentum score: min(1, max(0, score) / MOMENTUM_TARGET=12.0)
–®–ê–ì 20 ‚Äî Next step hint: —Å–ª–µ–¥—É—é—â–∏–π —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —à–∞–≥
```

---

## 5. –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

### –°–æ–±—ã—Ç–∏–µ (Event object)

```js
{
  type:        'meal' | 'training' | 'household' | 'sleep' | 'checkin' | 'measurements' | 'steps' | 'supplements' | 'insulin',
  time:        '08:30' | null,   // —Å—Ç—Ä–æ–∫–∞ HH:MM
  positive:    true | false,     // —Å–æ–∑–¥–∞—ë—Ç –∏–ª–∏ –ª–æ–º–∞–µ—Ç —Ü–µ–ø–æ—á–∫—É
  icon:        'ü•ó' | 'üí™' | ... // —ç–º–æ–¥–∑–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
  label:       '–ó–∞–≤—Ç—Ä–∞–∫',        // —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
  sortKey:     480,              // –º–∏–Ω—É—Ç—ã –æ—Ç –ø–æ–ª—É–Ω–æ—á–∏ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
  weight:      number            // —á–∏—Å–ª–æ–≤–æ–π –≤–∫–ª–∞–¥ –≤ score
}
```

### –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (—Å–æ–∑–¥–∞—é—Ç –∑–≤–µ–Ω–æ —Ü–µ–ø–æ—á–∫–∏)

| –¢–∏–ø            | –ò—Å—Ç–æ—á–Ω–∏–∫               | –£—Å–ª–æ–≤–∏–µ                                                    |
| -------------- | ---------------------- | ---------------------------------------------------------- |
| `household`    | `day.householdMin`     | householdMin ‚â• 10 (–≤–µ—Å 0.2‚Äì1.0)                            |
| `meal`         | `meals[i]`             | –ù–µ—Ç –ø–µ—Ä–µ–±–æ—Ä–∞ –∫–∞–ª–æ—Ä–∏–π –ò –Ω–µ—Ç harm-–ø—Ä–æ–¥—É–∫—Ç–æ–≤ –ò –Ω–µ –ø–æ—Å–ª–µ 23:00 |
| `training`     | `trainings[i]`         | –ö–∞–∂–¥–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ (–≤–µ—Å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)            |
| `sleep`        | `day.sleepStart`       | sleepOnsetWeight ‚â• 0 (–∑–∞—Å—ã–ø–∞–Ω–∏–µ –¥–æ 00:00)                  |
| `steps`        | `day.steps`            | stepsWeight > 0 (steps / goal ‚â• 0.7)                       |
| `checkin`      | `day.weightMorning`    | weightMorning > 0                                          |
| `measurements` | `day.measurements`     | –•–æ—Ç—è –±—ã –æ–¥–Ω–æ –∏–∑–º–µ—Ä–µ–Ω–∏–µ > 0                                 |
| `supplements`  | `day.supplementsTaken` | suppRatio ‚â• 0.5                                            |

### –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (—Å–Ω–∏–∂–∞—é—Ç —Ü–µ–ø–æ—á–∫—É)

| –£—Å–ª–æ–≤–∏–µ                             | –¢—è–∂–µ—Å—Ç—å | `breakReason`       | Penalty (v2.2.0) |
| ----------------------------------- | ------- | ------------------- | ---------------- |
| –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –∫–∫–∞–ª > 120% –Ω–æ—Ä–º—ã      | hard    | `'–ü–µ—Ä–µ–±–æ—Ä –∫–∫–∞–ª'`    | SEVERE (3)       |
| –õ—é–±–æ–π –ø—Ä–æ–¥—É–∫—Ç –≤ –ø—Ä–∏—ë–º–µ —Å `harm ‚â• 7` | soft    | `'–í—Ä–µ–¥–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç'` | MINOR (1)        |
| –í—Ä–µ–º—è –ø—Ä–∏—ë–º–∞ ‚â• 23:00 (1380 –º–∏–Ω)     | soft    | `'–ü–æ–∑–¥–Ω–∏–π –ø—Ä–∏—ë–º'`   | MINOR (1)        |

### cascadeState (—Ä–µ–∑—É–ª—å—Ç–∞—Ç computeCascadeState)

```js
{
  events:             CascadeEvent[],  // –≤—Å–µ —Å–æ–±—ã—Ç–∏—è, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
  chainLength:        number,          // —Ç–µ–∫—É—â–∞—è –¥–ª–∏–Ω–∞ —Ü–µ–ø–æ—á–∫–∏ (v2.2.0: –º—è–≥–∫–∞—è –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è)
  maxChainToday:      number,          // –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ –∑–∞ –¥–µ–Ω—å
  score:              number,          // –≤–∑–≤–µ—à–µ–Ω–Ω—ã–π —Å–∫–æ—Ä (—Å—É–º–º–∞ –≤—Å–µ—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤)
  warnings:           WarningInfo[],   // —Å–ø–∏—Å–æ–∫ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π (v2.2.0: —Å penalty, chainAfter)
  state:              CascadeState,    // —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (v2.2.0: score-driven)
  momentumScore:      number,          // 0..1 (score / MOMENTUM_TARGET)
  postTrainingWindow: boolean,         // true = 2—á –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
  message:            { short: string }, // –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
  nextStepHint:       string | null,   // –ø–æ–¥—Å–∫–∞–∑–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞
  // NEW in v2.1.0:
  dayType:            'training_day' | 'rest_day' | 'active_rest' | 'normal',
  synergies:          SynergyBonus[],  // applied cross-factor synergies
  confidence:         { [factorKey]: number },  // 0..1 per factor
  avgConfidence:      number           // mean confidence across all factors
}
```

---

## 6. –°–æ—Å—Ç–æ—è–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏

| –°–æ—Å—Ç–æ—è–Ω–∏–µ  | –ò–∫–æ–Ω–∫–∞ | –¶–≤–µ—Ç      | –£—Å–ª–æ–≤–∏–µ         | –õ–µ–π–±–ª          |
| ---------- | ------ | --------- | --------------- | -------------- |
| `EMPTY`    | üåÖ     | `#94a3b8` | –ù–µ—Ç —Å–æ–±—ã—Ç–∏–π     | –ù–∞—á–Ω–∏ –¥–µ–Ω—å     |
| `BUILDING` | üîó     | `#3b82f6` | score ‚â• 1.5     | –ù–∞—á–∞–ª–æ         |
| `GROWING`  | ‚ö°     | `#22c55e` | score ‚â• 4.5     | –ö–∞—Å–∫–∞–¥ —Ä–∞—Å—Ç—ë—Ç  |
| `STRONG`   | üî•     | `#eab308` | score ‚â• 8.0     | –ú–æ—â–Ω—ã–π –¥–µ–Ω—å    |
| `BROKEN`   | üí™     | `#f59e0b` | score ‚â§ 0       | –ü–∞—É–∑–∞          |
| `RECOVERY` | üå±     | `#0ea5e9` | 0 < score < 1.5 | –°–ª–∞–±—ã–π –∏–º–ø—É–ª—å—Å |

**–ú–∞—Ç—Ä–∏—Ü–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ (v2.2.0 score-driven):**

```
(–Ω–µ—Ç —Å–æ–±—ã—Ç–∏–π)           ‚Üí EMPTY
EMPTY + –ø–æ–∑–∏—Ç–∏–≤         ‚Üí RECOVERY (score 0‚Äì1.5) –∏–ª–∏ BUILDING (‚â• 1.5)
–ª—é–±–æ–µ —Å–æ–±—ã—Ç–∏–µ          ‚Üí —Å–æ—Å—Ç–æ—è–Ω–∏–µ = f(score)
score —Ä–∞—Å—Ç—ë—Ç              ‚Üí BUILDING ‚Üí GROWING ‚Üí STRONG
–Ω–µ–≥–∞—Ç–∏–≤ —Å–Ω–∏–∂–∞–µ—Ç score   ‚Üí —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å, –Ω–æ score ‚â• 4.5 ‚Üí GROWING
score ‚â§ 0                 ‚Üí BROKEN
```

> **v2.2.0**: –Ω–µ—Ç –ø—Ä—è–º–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ BROKEN/RECOVERY –ø–æ –Ω–∞–ª–∏—á–∏—é –Ω–µ–≥–∞—Ç–∏–≤–∞. Score
> –≤–∫–ª—é—á–∞–µ—Ç –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –≤–µ—Å–∞, –ø–æ—ç—Ç–æ–º—É –æ–¥–∏–Ω –ø—Ä–æ–º–∞—Ö —Å–Ω–∏–∂–∞–µ—Ç score, –Ω–æ –Ω–µ
> –ø–µ—Ä–µ—á—ë—Ä–∫–∏–≤–∞–µ—Ç 5 –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π.

---

## 7. –ê–ª–≥–æ—Ä–∏—Ç–º —Ü–µ–ø–æ—á–∫–∏ (v2.2.0 Soft Chain)

```js
// –õ–∏–Ω–µ–π–Ω—ã–π –ø—Ä–æ—Ö–æ–¥ –ø–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º events
chain = 0; maxChain = 0; warnings = []; totalPenalty = 0;

for event in sortedEvents:
    if event.positive:
        chain++
        maxChain = max(maxChain, chain)
    else:
        penalty = getChainPenalty(event.weight)
        //  weight ‚â• -0.5      ‚Üí MINOR  (penalty=1)
        // -1.5 ‚â§ weight < -0.5 ‚Üí MEDIUM (penalty=2)
        //  weight < -1.5       ‚Üí SEVERE (penalty=3)
        chain = max(0, chain - penalty)
        totalPenalty += penalty
        warnings.push({ time, reason, penalty, chainBefore, chainAfter })

// –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–®–ê–ì 16) ‚Äî —Ç–æ–ª—å–∫–æ –ø–æ score:
if events.length == 0         ‚Üí EMPTY
elif score >= 8.0             ‚Üí STRONG
elif score >= 4.5             ‚Üí GROWING
elif score >= 1.5             ‚Üí BUILDING
elif score > 0                ‚Üí RECOVERY
else                          ‚Üí BROKEN
```

> **v2.2.0**: `hasBreak` —É–¥–∞–ª—ë–Ω –∏–∑ –ª–æ–≥–∏–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è. –¶–µ–ø–æ—á–∫–∞ –Ω–µ
> –æ–±–Ω—É–ª—è–µ—Ç—Å—è, –∞ –¥–µ–≥—Ä–∞–¥–∏—Ä—É–µ—Ç –º—è–≥–∫–æ: chain=5 + 1 MINOR ‚Üí chain=4.

**Momentum score (–®–ê–ì 19):**

```
momentumScore = min(1.0, max(0, score) / MOMENTUM_TARGET)  // MOMENTUM_TARGET = 12.0
```

> –ó–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å 12 ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω v2.1.0 —Å —Å–∏–Ω–µ—Ä–≥–∏—è–º–∏ –∏ confidence

---

## 8. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã React

### ChainDots

```
props: { events: CascadeEvent[] }
```

–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ —Ü–≤–µ—Ç–Ω—ã—Ö –∫—Ä—É–∂–∫–æ–≤ —Å —è–≤–Ω—ã–º–∏ connector-—ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –≤ DOM:

- `.cascade-dot--{type}` ‚Äî —Ü–≤–µ—Ç –ø–æ —Ç–∏–ø—É —Å–æ–±—ã—Ç–∏—è
- `.cascade-dot--warning` ‚Äî —è–Ω—Ç–∞—Ä–Ω—ã–π (amber #f59e0b) –¥–ª—è –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
  (v2.2.0)
- `.cascade-dot--latest` ‚Äî –ø—É–ª—å—Å-–∞–Ω–∏–º–∞—Ü–∏—è –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º –ø–æ–∑–∏—Ç–∏–≤–Ω–æ–º –∑–≤–µ–Ω–µ
- `.cascade-dot-connector` ‚Äî –ª–∏–Ω–∏—è –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏
- `.cascade-dot-connector--warning` ‚Äî –ø—É–Ω–∫—Ç–∏—Ä–Ω–∞—è —è–Ω—Ç–∞—Ä–Ω–∞—è –ª–∏–Ω–∏—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
  (v2.2.0)

**–¶–≤–µ—Ç–∞ —Ç–æ—á–µ–∫:** | –¢–∏–ø | –¶–≤–µ—Ç | |-----|------| | `meal` | `#22c55e` –∑–µ–ª—ë–Ω—ã–π | |
`training` | `#f59e0b` —è–Ω—Ç–∞—Ä—å | | `household` | `#f97316` –æ—Ä–∞–Ω–∂–µ–≤—ã–π | | `sleep`
| `#6366f1` –∏–Ω–¥–∏–≥–æ | | `checkin` | `#14b8a6` —Ç–∏–ª–æ–≤—ã–π | | `measurements` |
`#ec4899` —Ä–æ–∑–æ–≤—ã–π | | `steps` | `#8b5cf6` —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π | | `supplements` |
`#0ea5e9` –≥–æ–ª—É–±–æ–π | | _(warning)_ | `#f59e0b` —è–Ω—Ç–∞—Ä—å |

### CascadeTimeline

```
props: { events: CascadeEvent[], nextStepHint: string | null }
```

–†–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–π —Ç–∞–π–º–ª–∞–π–Ω —Å –∏–∫–æ–Ω–∫–æ–π, –≤—Ä–µ–º–µ–Ω–µ–º, –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∏ –±–µ–π–¥–∂–µ–º `‚úì` / `‚ö†`
(v2.2.0) / `breakReason`.  
–í –∫–æ–Ω—Ü–µ ‚Äî hint `üí° ...`.

### CascadeCard (–≥–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)

```
props: cascadeState (–≤—Å–µ –ø–æ–ª—è –∏–∑ computeCascadeState)
```

**Standalone** ‚Äî –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `HEYS.ExpandableCard`. –£–ø—Ä–∞–≤–ª—è–µ—Ç expanded —á–µ—Ä–µ–∑
`React.useState(false)`.

**–°–≤—ë—Ä–Ω—É—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**

```
[üîó icon] [–í–∞—à –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∫–∞—Å–∫–∞–¥] [3 ‚ö° badge]
 –¢—Ä–∏ —Ä–µ—à–µ–Ω–∏—è –ø–æ–¥—Ä—è–¥ ‚Äî —Ç—ã –Ω–∞–±–∏—Ä–∞–µ—à—å —Ö–æ–¥.
 ‚óè ‚Äî ‚óè ‚Äî ‚óè (ChainDots)
 [======-------] (progress bar)                 [‚Ä∫]
```

**–†–∞–∑–≤—ë—Ä–Ω—É—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**

```
[üîó icon] [–í–∞—à –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∫–∞—Å–∫–∞–¥] [3 ‚ö° badge]
 –¢—Ä–∏ —Ä–µ—à–µ–Ω–∏—è –ø–æ–¥—Ä—è–¥ ‚Äî —Ç—ã –Ω–∞–±–∏—Ä–∞–µ—à—å —Ö–æ–¥.
 ‚óè ‚Äî ‚óè ‚Äî ‚óè (ChainDots)
 [======-------] (progress bar)                 [‚Äπ]
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 ‚óè ‚Äî ‚óè ‚Äî ‚óè (ChainDots full)
 üåÖ  08:15  –†–∞–Ω–Ω–∏–π –∑–∞–≤—Ç—Ä–∞–∫                      ‚úì
 ü•ó  09:00  –ó–∞–≤—Ç—Ä–∞–∫                             ‚úì
 üí™  10:30  –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ 45 –º–∏–Ω                   ‚úì
 üí° –í—ã–ø–µ–π –≤–æ–¥—ã ‚Äî —Ç—ã –µ—â—ë –Ω–µ –Ω–∞ 50% –Ω–æ—Ä–º—ã
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 ‚ö†Ô∏è –†–∞–∑—Ä—ã–≤–æ–≤ —Ü–µ–ø–æ—á–∫–∏ —Å–µ–≥–æ–¥–Ω—è: 0
 üèÜ –ú–∞–∫—Å. —Ü–µ–ø–æ—á–∫–∞: 3    ‚ö° –ò–º–ø—É–ª—å—Å: 43%
```

---

## 9. –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

–í—ã–±–æ—Ä –ø—É–ª–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ post-training window.  
–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Äî –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ –ø–æ —á–∞—Å—É –¥–Ω—è (`hour % poolSize`), –Ω–µ
–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ-—Ä–µ–Ω–¥–µ—Ä–∞—Ö.

### BUILDING (chain 1‚Äì2)

- ¬´–•–æ—Ä–æ—à–µ–µ –Ω–∞—á–∞–ª–æ. –ü–µ—Ä–≤—ã–π —à–∞–≥ —É–∂–µ —Å–¥–µ–ª–∞–Ω.¬ª
- ¬´–ù–∞—á–∞–ª–æ –ø–æ–ª–æ–∂–µ–Ω–æ ‚Äî –ø—Ä–æ—â–µ –≤—Å–µ–≥–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å, –∫–æ–≥–¥–∞ —É–∂–µ –Ω–∞—á–∞–ª.¬ª

### GROWING (chain 3‚Äì4)

- ¬´–¢—Ä–∏ —Ä–µ—à–µ–Ω–∏—è –ø–æ–¥—Ä—è–¥ ‚Äî —Ç—ã –Ω–∞–±–∏—Ä–∞–µ—à—å —Ö–æ–¥.¬ª
- ¬´–•–æ—Ä–æ—à–∏–π —Ä–∏—Ç–º. –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ –¥–∞—ë—Ç—Å—è –ª–µ–≥—á–µ.¬ª
- ¬´–ö–æ–≥–¥–∞ –≤—Å—ë —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–æ—â–µ.¬ª

### STRONG (chain 5+)

- ¬´–ú–æ—â–Ω—ã–π –¥–µ–Ω—å. –ö–æ–≥–¥–∞ —Å—Ç–æ–ª—å–∫–æ —Å–¥–µ–ª–∞–Ω–æ ‚Äî –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è —Å–ª–æ–∂–Ω–æ.¬ª
- ¬´–°–µ–≥–æ–¥–Ω—è –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç. –¢–∞–∫–∏–µ –¥–Ω–∏ —Å—Ç—Ä–æ—è—Ç –ø—Ä–∏–≤—ã—á–∫–∏.¬ª
- ¬´–ü—è—Ç—å+ —Ä–µ—à–µ–Ω–∏–π ‚Äî —ç—Ç–æ —É–∂–µ —Å–∏—Å—Ç–µ–º–∞. –¢–µ–±–µ –ø—Ä–æ—â–µ –¥–µ–ª–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä.¬ª

### BROKEN (—Ü–µ–ø–æ—á–∫–∞ –ø—Ä–µ—Ä–≤–∞–ª–∞—Å—å)

- ¬´–û–¥–∏–Ω —à–∞–≥ –≤ —Å—Ç–æ—Ä–æ–Ω—É ‚Äî –Ω–µ –∫–æ–Ω–µ—Ü –ø—É—Ç–∏. –°–ª–µ–¥—É—é—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ —É–∂–µ –º–æ–∂–µ—Ç –±—ã—Ç—å
  —Ö–æ—Ä–æ—à–∏–º.¬ª
- ¬´–ù–µ –≤—Å—ë –∏–ª–∏ –Ω–∏—á–µ–≥–æ. –î–∞–∂–µ 70% —Ö–æ—Ä–æ—à–∏—Ö —Ä–µ—à–µ–Ω–∏–π ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å.¬ª
- ¬´–¶–µ–ø–æ—á–∫–∞ –ø—Ä–µ—Ä–≤–∞–ª–∞—Å—å? –ù–∞—á–Ω–∏ –Ω–æ–≤—É—é. –ö–∞–∂–¥–∞—è —Ü–µ–ø–æ—á–∫–∞ –∏–∑ 2+ –∑–≤–µ–Ω—å–µ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç.¬ª

### RECOVERY (–≤–æ–∑–≤—Ä–∞—Ç –ø–æ—Å–ª–µ —Å—Ä—ã–≤–∞)

- ¬´–ù–æ–≤–∞—è —Ü–µ–ø–æ—á–∫–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è. –≠—Ç–æ –≤–∞–∂–Ω–µ–µ, —á–µ–º –±—ã—Ç—å –∏–¥–µ–∞–ª—å–Ω—ã–º.¬ª
- ¬´–¢—ã –≤–µ—Ä–Ω—É–ª—Å—è –≤ —Ä–∏—Ç–º. –ü–µ—Ä–≤—ã–π —à–∞–≥ –ø–æ—Å–ª–µ –ø–∞—É–∑—ã ‚Äî —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π.¬ª
- ¬´–ü–æ—Å–ª–µ –ø–µ—Ä–µ—Ä—ã–≤–∞ –∫–∞–∂–¥–æ–µ —Ä–µ—à–µ–Ω–∏–µ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ. –¢—ã —É–∂–µ –Ω–∞ –ø—É—Ç–∏.¬ª

### ANTI_LICENSING (2—á –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ –ª—é–±—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º)

- ¬´–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ ‚Äî —Å–∞–º–∞ –ø–æ —Å–µ–±–µ –ø–æ–±–µ–¥–∞. –ù–µ ¬´–Ω–∞–≥—Ä–∞–∂–¥–∞–π¬ª —Å–µ–±—è –µ–¥–æ–π.¬ª
- ¬´–ü–æ—Å–ª–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –æ—Ä–≥–∞–Ω–∏–∑–º –ª—É—á—à–µ –≤—Å–µ–≥–æ —É—Å–≤–æ–∏—Ç –±–µ–ª–æ–∫ –∏ –æ–≤–æ—â–∏.¬ª
- ¬´–ö–ª–∞—Å—Å–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞! –í—ã–±–µ—Ä–∏ –∫–∞—á–µ—Å—Ç–≤–æ, –∞ –Ω–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ.¬ª

> **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ:** ANTI_LICENSING –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ BROKEN –∏ EMPTY.

### Next step hint (–ø–æ–¥—Å–∫–∞–∑–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞)

–ü—Ä–∞–≤–∏–ª–æ –≤—ã–±–æ—Ä–∞ (–ø–µ—Ä–≤–æ–µ –ø–æ–¥—Ö–æ–¥—è—â–µ–µ):

| –£—Å–ª–æ–≤–∏–µ                   | Hint                                                |
| ------------------------- | --------------------------------------------------- |
| –ù–µ—Ç –ø—Ä–∏—ë–º–∞ –ø–∏—â–∏, —á–∞—Å < 20 | ¬´–î–æ–±–∞–≤—å –ø–µ—Ä–≤—ã–π –ø—Ä–∏—ë–º –ø–∏—â–∏¬ª                          |
| –ù–µ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, —á–∞—Å 6‚Äì20  | ¬´–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∏–ª–∏ –ø—Ä–æ–≥—É–ª–∫–∞ –¥–æ–±–∞–≤—è—Ç –∑–≤–µ–Ω–æ –≤ —Ü–µ–ø–æ—á–∫—É¬ª   |
| –ù–µ—Ç —á–µ–∫-–∏–Ω–∞, —á–∞—Å < 11     | ¬´–í–∑–≤–µ—Å—å—Å—è —É—Ç—Ä–æ–º ‚Äî —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å¬ª |
| –ù–µ—Ç –∑–∞–º–µ—Ä–æ–≤, —á–∞—Å < 11     | ¬´–°–Ω–∏–º–∏ –∑–∞–º–µ—Ä—ã ‚Äî —ç—Ç–æ –ø–æ–≤—ã—Å–∏—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞¬ª       |
| –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö —Å–Ω–∞            | ¬´–ó–∞—Ñ–∏–∫—Å–∏—Ä—É–π –≤—Ä–µ–º—è –∑–∞—Å—ã–ø–∞–Ω–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–Ω–∞¬ª        |
| chain > 0, —á–∞—Å < 21       | ¬´–ü—Ä–æ–¥–æ–ª–∂–∞–π ‚Äî —Å–ª–µ–¥—É—é—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ —É—Å–∏–ª–∏—Ç —Ü–µ–ø–æ—á–∫—É¬ª      |

---

## 10. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –¢–æ—á–∫–∞ –≤—ã–∑–æ–≤–∞ ‚Äî `apps/web/heys_day_diary_section.js`

```js
// –í–Ω—É—Ç—Ä–∏ renderDiarySection(), –ø–æ—Å–ª–µ mealRecCard:
const cascadeCard = app.CascadeCard?.renderCard?.({
    React, day, prof, pIndex, dayTot, normAbs
}) || null;

// –í return React.createElement(React.Fragment, ...):
goalProgressBar,
cascadeCard,      // ‚Üê –ó–î–ï–°–¨, –º–µ–∂–¥—É goalProgressBar –∏ refeedCard
refeedCard,
mealRecCard,
...
```

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ ‚Äî `apps/web/index.html`

```html
<script defer src="heys_cascade_card_v1.js?v=1"></script>
<!-- –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ heys_day_diary_section.js -->
```

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ CSS ‚Äî `apps/web/styles/main.css`

```css
@import url('./modules/740-cascade-card.css');
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ `renderCard`

```js
// –§—É–Ω–∫—Ü–∏—è renderCard –Ω–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç –∫–∞—Ä—Ç–æ—á–∫—É –µ—Å–ª–∏:
// 1. day = null
// 2. –ù–µ—Ç –Ω–∏–∫–∞–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (meals, trainings, water, steps ‚Äî –≤—Å–µ –ø—É—Å—Ç—ã–µ)
// 3. computeCascadeState –≤–µ—Ä–Ω—É–ª state = EMPTY
// –í –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç React.createElement(CascadeCard, cascadeState)
```

---

## 11. CSS –∏ —Å—Ç–∏–ª–∏

–§–∞–π–ª: `apps/web/styles/modules/740-cascade-card.css` (430 —Å—Ç—Ä–æ–∫)

### BEM-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
.cascade-card                     ‚Äî –∫–æ—Ä–Ω–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç
.cascade-card--{state}            ‚Äî –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è (--building, --strong, etc.)
‚îÇ
‚îú‚îÄ‚îÄ .cascade-card__header         ‚Äî –∫–Ω–æ–ø–∫–∞ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ .cascade-card__title-row  ‚Äî —Å—Ç—Ä–æ–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ .cascade-card__icon   ‚Äî —ç–º–æ–¥–∑–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ .cascade-card__title  ‚Äî ¬´–í–∞—à –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∫–∞—Å–∫–∞–¥¬ª
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ .cascade-card__badge  ‚Äî —Å—á—ë—Ç—á–∏–∫ ¬´3 ‚ö°¬ª
‚îÇ   ‚îú‚îÄ‚îÄ .cascade-card__subtitle   ‚Äî —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ .cascade-card__hint       ‚Äî anti-licensing —Ö–∏–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ .cascade-chain-dots       ‚Äî —Ü–µ–ø–æ—á–∫–∞ —Ç–æ—á–µ–∫ (—Å–≤—ë—Ä–Ω—É—Ç–æ–µ)
‚îÇ   ‚îú‚îÄ‚îÄ .cascade-card__progress-track
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ .cascade-card__progress-bar
‚îÇ   ‚îî‚îÄ‚îÄ .cascade-card__chevron    ‚Äî ¬´‚Ä∫¬ª / ¬´‚Äπ¬ª
‚îÇ       ‚îî‚îÄ‚îÄ --open
‚îÇ
‚îî‚îÄ‚îÄ .cascade-card__body           ‚Äî —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
    ‚îú‚îÄ‚îÄ .cascade-chain-dots       ‚Äî —Ü–µ–ø–æ—á–∫–∞ —Ç–æ—á–µ–∫ (–¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è)
    ‚îú‚îÄ‚îÄ .cascade-timeline         ‚Äî —Ç–∞–π–º–ª–∞–π–Ω
    ‚îÇ   ‚îú‚îÄ‚îÄ .cascade-timeline-row--positive
    ‚îÇ   ‚îú‚îÄ‚îÄ .cascade-timeline-row--warning     ‚Äî v2.2.0: —è–Ω—Ç–∞—Ä–Ω—ã–π –≤–º–µ—Å—Ç–æ --negative
    ‚îÇ   ‚îú‚îÄ‚îÄ .cascade-timeline-icon
    ‚îÇ   ‚îú‚îÄ‚îÄ .cascade-timeline-time
    ‚îÇ   ‚îú‚îÄ‚îÄ .cascade-timeline-label
    ‚îÇ   ‚îî‚îÄ‚îÄ .cascade-timeline-badge
    ‚îú‚îÄ‚îÄ .cascade-next-step        ‚Äî hint üí°
    ‚îú‚îÄ‚îÄ .cascade-card__breaks-info
    ‚îî‚îÄ‚îÄ .cascade-card__stats
        ‚îî‚îÄ‚îÄ .cascade-card__stat
```

### Chain dots

```
.cascade-chain-dots               ‚Äî flex-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, overflow-x: auto
‚îú‚îÄ‚îÄ .cascade-dot                  ‚Äî 12√ó12px –∫—Ä—É–∂–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ --meal / --training / --household / --sleep / --checkin / --measurements / --steps / --supplements / --insulin ‚Äî —Ü–≤–µ—Ç –ø–æ —Ç–∏–ø—É
‚îÇ   ‚îú‚îÄ‚îÄ --warning                 ‚Äî —è–Ω—Ç–∞—Ä—å #f59e0b, solid border (v2.2.0)
‚îÇ   ‚îî‚îÄ‚îÄ --latest                  ‚Äî –ø—É–ª—å—Å @keyframes cascadePulse
‚îî‚îÄ‚îÄ .cascade-dot-connector        ‚Äî 12px –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è
    ‚îî‚îÄ‚îÄ --warning                 ‚Äî dashed border-top —è–Ω—Ç–∞—Ä—å (v2.2.0, –±—ã–ª–æ --broken)
```

### –ê–Ω–∏–º–∞—Ü–∏—è

```css
@keyframes cascadePulse {
  0%,
  100% {
    box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.35);
  }
  50% {
    box-shadow: 0 0 0 5px rgba(34, 197, 94, 0);
  }
}
/* –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ .cascade-dot--latest:not(.cascade-dot--warning) */
```

### Dark mode

–í—Å–µ –∫–ª–∞—Å—Å—ã –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–æ–¥ `[data-theme="dark"]`.

---

## 12. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞

**–§–∏–ª—å—Ç—Ä –≤ –∫–æ–Ω—Å–æ–ª–∏:** `[HEYS.cascade]`

–í—Å–µ –ª–æ–≥–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `console.info` (–∏–ª–∏ `console.warn` –¥–ª—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π).

### –ü–æ–ª–Ω–∞—è –∫–∞—Ä—Ç–∞ –ª–æ–≥–æ–≤ (v2.1.0)

| –≠–º–æ–¥–∑–∏              | –õ–æ–≥                             | –ö–æ–≥–¥–∞                                         |
| ------------------- | ------------------------------- | --------------------------------------------- |
| `‚îÄ‚îÄ‚îÄ v2.1.0 START`  | computeCascadeState START       | –ù–∞—á–∞–ª–æ —Ä–∞—Å—á—ë—Ç–∞ + —Å–ø–∏—Å–æ–∫ —Ñ–∏—á v2.1.0            |
| `üß¨`                | v2.1.0 features                 | continuous/baselines/circadian/synergies      |
| `üì•`                | Input data                      | –í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ)               |
| `üè† [EVENT]`        | Household (v2.1.0 log2)         | log2 adaptive scoring + baseline              |
| `üçΩÔ∏è [MEAL N/M]`     | Meal (v2.1.0 continuous)        | continuous + circadian modifier + formula     |
| `üí™ [TRAINING N/M]` | Training (v2.1.0 load√ósqrt)     | load√óintensity, diminishing, formula          |
| `üí™`                | Recovery / no training          | recovery-aware + weekly load check            |
| `üò¥`                | Sleep onset (v2.1.0 sigmoid)    | chronotype-adaptive + consistency + variance  |
| `üò¥`                | Sleep duration (v2.1.0 bell)    | Gaussian bell-curve + asymmetry + recovery    |
| `üö∂`                | Steps (v2.1.0 tanh)             | adaptive goal + tanh formula                  |
| `‚öñÔ∏è`                | Checkin (v2.1.0 streak)         | base + streak + trend + formula               |
| `üìè`                | Measurements (v2.1.0 cadence)   | completeness + cadence + diminishing          |
| `üíä`                | Supplements (v2.1.0 continuous) | ratio + streak + formula                      |
| `‚ö°`                | InsulinWave (v2.1.0 sigmoid)    | sigmoid overlap + log2 gap + fasting          |
| `üìä`                | v2.1.0 Scoring summary          | rawWeights + active/skipped + method          |
| `üéØ`                | Confidence layer (v2.1.0)       | per-factor confidence + avg + quality         |
| `üìÖ`                | Day-type (v2.1.0)               | training/rest/active_rest + effect            |
| `üîó`                | Cross-factor synergies          | count + names + bonuses + capped              |
| `üìã`                | Events sorted (N total)         | —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π                      |
| `‚õìÔ∏è`                | Chain algorithm trace           | —Ç—Ä–µ–π—Å –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ —Ü–µ–ø–æ—á–∫–∏                    |
| `üîó`                | Chain result                    | –∏—Ç–æ–≥: chain, maxChain, warnings[]             |
| `üè∑Ô∏è`                | State determination             | score-driven (v2.2.0)                         |
| `‚è∞`                | Post-training window            | –∞–∫—Ç–∏–≤–Ω–æ/–Ω–µ –∞–∫—Ç–∏–≤–Ω–æ –∏ —ç—Ñ—Ñ–µ–∫—Ç                   |
| `üí¨`                | Message selected                | –ø—É–ª, –∏–Ω–¥–µ–∫—Å, —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è                  |
| `üìä`                | Momentum score                  | —Ñ–æ—Ä–º—É–ª–∞ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç                           |
| `üí°`                | Next step hint                  | –∫–∞–∫–æ–π hint –∏ –ø–æ—á–µ–º—É                           |
| `‚úÖ v2.2.0 DONE`    | computeCascadeState DONE        | –∏—Ç–æ–≥–æ–≤—ã–π –æ–±—ä–µ–∫—Ç + elapsed                     |
| `üß¨ v2.2.0 subsys`  | v2.2.0 subsystems               | dayType + synergies + confidence + chainModel |
| `‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ`     | —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å                     | –∫–æ–Ω–µ—Ü —Ä–∞—Å—á—ë—Ç–∞                                 |
| `üìå`                | renderCard called               | –≤—ã–∑–æ–≤ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞                             |
| `‚è≠Ô∏è`                | No activity / State=EMPTY       | –∫–∞—Ä—Ç–æ—á–∫–∞ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è                      |
| `üß† Cache MISS`     | recompute triggered             | –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å, –ø–µ—Ä–µ—Å—á—ë—Ç           |
| `‚ö° Cache HIT`      | compute skipped                 | –¥–∞–Ω–Ω—ã–µ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å, –∫—ç—à –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω         |
| `üöÄ`                | Rendering CascadeCard           | –∫–∞—Ä—Ç–æ—á–∫–∞ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è                           |
| `üé®`                | CascadeCard render              | –∫–∞–∂–¥—ã–π —Ä–µ–Ω–¥–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞                      |
| `üîÑ`                | Toggle expanded                 | —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ                            |
| `‚úÖ Module loaded`  | –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª—è v2.1.0          | –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∫—Ä–∏–ø—Ç–∞                          |

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –∫–æ–Ω—Å–æ–ª–∏

```js
// –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞–ø—Ä—è–º—É—é:
HEYS.CascadeCard.computeCascadeState(
  HEYS.day,
  HEYS.dayTot,
  HEYS.normAbs,
  HEYS.prof,
  HEYS.pIndex,
);

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é:
HEYS.CascadeCard.VERSION; // ‚Üí "2.1.0"

// –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è:
HEYS.CascadeCard.STATES;

// –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ–Ω—Ñ–∏–≥ —Å–æ—Å—Ç–æ—è–Ω–∏–π:
HEYS.CascadeCard.STATE_CONFIG;

// –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—É–ª—ã —Å–æ–æ–±—â–µ–Ω–∏–π:
HEYS.CascadeCard.MESSAGES;
```

---

## 13. API –º–æ–¥—É–ª—è

```js
HEYS.CascadeCard = {
  VERSION:             '2.1.0',
  STATES:              { EMPTY, BUILDING, GROWING, STRONG, BROKEN, RECOVERY },
  STATE_CONFIG:        { [state]: { icon, color, label } },
  MESSAGES:            { [poolKey]: [{ short }] },
  computeCascadeState: function(day, dayTot, normAbs, prof, pIndex) ‚Üí cascadeState,
  renderCard:          function({ day, dayTot, normAbs, prof, pIndex, React? }) ‚Üí ReactElement | null
}
```

### renderCard ‚Äî –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä  | –û–±—è–∑–∞—Ç–µ–ª–µ–Ω | –û—Ç–∫—É–¥–∞ –±–µ—Ä—ë—Ç—Å—è                |
| --------- | ---------- | ----------------------------- |
| `day`     | **–¥–∞**     | `params.day` –∏–∑ diary section |
| `dayTot`  | –Ω–µ—Ç        | `params.dayTot`               |
| `normAbs` | –Ω–µ—Ç        | `params.normAbs`              |
| `prof`    | –Ω–µ—Ç        | `params.prof`                 |
| `pIndex`  | –Ω–µ—Ç        | `params.pIndex`               |
| `React`   | –Ω–µ—Ç        | –±–µ—Ä—ë—Ç—Å—è –∏–∑ `global.React`     |

### –£—Å–ª–æ–≤–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö renderCard –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç null

1. `day` –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω / null
2. –ù–µ—Ç –Ω–∏–∫–∞–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:
   `meals.length === 0 && trainings.length === 0 && steps === 0 && householdMin === 0 && weightMorning === 0 && sleepStart === null && measurements === null && supplementsTaken === 0`
3. `computeCascadeState` –≤–µ—Ä–Ω—É–ª `state = 'EMPTY'`

---

## 14. –†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

–ö–∞—Ä—Ç–æ—á–∫–∞ **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–∫—Ç–∏–≤–Ω–∞** —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π React re-render:

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç –µ–¥—É / —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É / –≤–æ–¥—É
  ‚Üí React state (day) –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ DayTab
  ‚Üí DayTab re-render
  ‚Üí renderDiarySection() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ
  ‚Üí app.CascadeCard.renderCard({ day, ... }) –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è
  ‚Üí computeCascadeState() ‚Äî —á–∏—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è, 0 side effects
  ‚Üí CascadeCard —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è —Å –Ω–æ–≤—ã–º cascadeState
```

`computeCascadeState` ‚Äî **—á–∏—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è** (pure function):

- –ë–µ–∑ –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
- –ë–µ–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∞ –ø—Ä–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: ~0.5‚Äì2 –º—Å (3‚Äì5 meals + 0‚Äì2 trainings)

**–õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞** (`expanded`) ‚Äî —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `React.useState`
–≤–Ω—É—Ç—Ä–∏ `CascadeCard`. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ-—Ä–µ–Ω–¥–µ—Ä–∞—Ö –ø–æ–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω,
—Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏.

---

## 15. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Ä—É—á–Ω—É—é

| –®–∞–≥ | –î–µ–π—Å—Ç–≤–∏–µ                              | –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç                            |
| --- | ------------------------------------- | ---------------------------------------------- |
| 1   | –û—Ç–∫—Ä—ã—Ç—å Day tab –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö            | –ö–∞—Ä—Ç–æ—á–∫–∏ –Ω–µ—Ç                                   |
| 2   | –î–æ–±–∞–≤–∏—Ç—å 1 –ø—Ä–∏—ë–º –≤ –Ω–æ—Ä–º–µ              | BUILDING, ¬´–•–æ—Ä–æ—à–µ–µ –Ω–∞—á–∞–ª–æ¬ª, score~1.0, 1 —Ç–æ—á–∫–∞ |
| 3   | –î–æ–±–∞–≤–∏—Ç—å 2-–π –ø—Ä–∏—ë–º –≤ –Ω–æ—Ä–º–µ            | BUILDING, 2 —Ç–æ—á–∫–∏, hint –ø–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ/—á–µ–∫-–∏–Ω—É  |
| 4   | –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É 45 –º–∏–Ω            | score —Ä–∞—Å—Ç—ë—Ç, GROWING –µ—Å–ª–∏ score‚â•4.0           |
| 5   | –°—Ä–∞–∑—É –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (< 2—á)         | ANTI_LICENSING —Å–æ–æ–±—â–µ–Ω–∏–µ                       |
| 6   | –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏—ë–º —Å harm ‚â• 7             | BROKENüí™, —Ä–∞–∑—Ä—ã–≤ –ø—É–Ω–∫—Ç–∏—Ä–æ–º, anti-WTH —Å–æ–æ–±—â–µ–Ω–∏–µ |
| 7   | –î–æ–±–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π –ø—Ä–∏—ë–º   | RECOVERYüå±, –Ω–æ–≤–∞—è —Ç–æ—á–∫–∞, ¬´–ù–æ–≤–∞—è —Ü–µ–ø–æ—á–∫–∞¬ª       |
| 8   | –í–∑–≤–µ—Å–∏—Ç—å—Å—è —É—Ç—Ä–æ–º (weightMorning)      | checkin —Ç–æ—á–∫–∞ +0.5 –≤ score                     |
| 9   | –ó–∞–ø–∏—Å–∞—Ç—å –≤—Ä–µ–º—è —Å–Ω–∞ (sleepStart)       | sleep onset —Ç–æ—á–∫–∞, bonus/penalty –∑–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ |
| 10  | 5+ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π –∏–ª–∏ score ‚â• 7.0 | STRONGüî•, ¬´–ú–æ—â–Ω—ã–π –¥–µ–Ω—å¬ª, –∑–æ–ª–æ—Ç–æ                |
| 11  | –ù–∞–∂–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É                    | –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è —Ç–∞–π–º–ª–∞–π–Ω —Å —Å–æ–±—ã—Ç–∏—è–º–∏           |
| 12  | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ dark mode                 | –í—Å–µ —Ü–≤–µ—Ç–∞ —á–∏—Ç–∞—é—Ç—Å—è                             |
| 13  | –ö–æ–Ω—Å–æ–ª—å ‚Üí —Ñ–∏–ª—å—Ç—Ä `[HEYS.cascade]`     | –í—Å—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞; –∫–∞–∂–¥—ã–π –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π —à–∞–≥ –≤–∏–¥–µ–Ω    |

### –ö–æ–Ω—Å–æ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

```js
// –ü—Ä—è–º–æ–π —Ç–µ—Å—Ç –¥–≤–∏–∂–∫–∞ —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:
HEYS.CascadeCard.computeCascadeState(
  {
    meals: [
      { time: '08:00', items: [] },
      { time: '12:30', items: [] },
    ],
    trainings: [{ time: '10:00', duration: 45 }],
    steps: 5000,
    householdMin: 20,
    weightMorning: 75.3,
    sleep: { start: '23:00', hoursTotal: 7.5 },
    measurements: { waist: 80 },
    supplementsTaken: 2,
    supplementsPlanned: 3,
  },
  {},
  { kcal: 2000 },
  { stepsGoal: 10000 },
  null,
);
// –û–∂–∏–¥–∞–µ–º–æ: state=GROWING –∏–ª–∏ STRONG, score~5-8, –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏–π –≤ —Ü–µ–ø–æ—á–∫–µ
```

---

## –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –í–µ—Ä—Å–∏—è | –î–∞—Ç–∞       | –ò–∑–º–µ–Ω–µ–Ω–∏–µ                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ------ | ---------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| v1.0.0 | 2026-02-19 | –ü–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ `HEYS.ExpandableCard`. –ù–∞–∑–≤–∞–Ω–∏–µ ¬´–¢–≤–æ–π –∏–º–ø—É–ª—å—Å —Å–µ–≥–æ–¥–Ω—è¬ª                                                                                                                                                                                                                                                                                                                                                                                                |
| v1.1.0 | 2026-02-19 | Standalone –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–±–µ–∑ `ExpandableCard`). –î–µ—Ç–∞–ª—å–Ω–æ–µ 12-—à–∞–≥–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ ‚Üí ¬´–í–∞—à –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∫–∞—Å–∫–∞–¥¬ª. –Ø–≤–Ω—ã–µ DOM-–∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä—ã –≤–º–µ—Å—Ç–æ CSS `::before`                                                                                                                                                                                                                                                                                                             |
| v1.2.1 | 2026-02-19 | Decision chain visualization —É–ª—É—á—à–µ–Ω–∏—è. 816 LOC                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| v2.0.0 | 2026-02-19 | 10-—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞. 17-—à–∞–≥–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º. –ù–æ–≤—ã–µ —Ç–∏–ø—ã —Å–æ–±—ã—Ç–∏–π: household, sleep, checkin, measurements, supplements, insulin. EVENT_WEIGHTS —Å–∏—Å—Ç–µ–º–∞. Score-based —Å–æ—Å—Ç–æ—è–Ω–∏—è (BUILDING‚â•1.5, GROWING‚â•4.0, STRONG‚â•7.0). MOMENTUM_TARGET=10. –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤. ~1195 LOC                                                                                                                                                                         |
| v2.1.0 | 2026-02-20 | –ù–∞—É—á–Ω—ã–π –∞–ø–≥—Ä–µ–π–¥ –≤—Å–µ—Ö 10 —Ñ–∞–∫—Ç–æ—Ä–æ–≤: –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (sigmoid/bell-curve/log2) –≤–º–µ—Å—Ç–æ —Å—Ç—É–ø–µ–Ω–µ–π. –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π baseline (14-–¥–Ω–µ–≤–Ω–∞—è –º–µ–¥–∏–∞–Ω–∞). Chronotype-adaptive —Å–æ–Ω. Training load (dur√óintensity) + recovery-aware. Confidence layer (data volume ‚Üí weight modulation). Day-Type awareness (training/rest/active). 5 –∫—Ä–æ—Å—Å-—Ñ–∞–∫—Ç–æ—Ä–Ω—ã—Ö —Å–∏–Ω–µ—Ä–≥–∏–π. –ü–æ—Ä–æ–≥–∏: GROWING‚â•4.5, STRONG‚â•8.0, MOMENTUM_TARGET=12. 21-—à–∞–≥–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º                                                         |
| v2.2.0 | 2026-02-20 | **Soft Chain Degradation + Score-driven States.** –¶–µ–ø–æ—á–∫–∞ –±–æ–ª—å—à–µ –Ω–µ –æ–±–Ω—É–ª—è–µ—Ç—Å—è –ø—Ä–∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ–º —Å–æ–±—ã—Ç–∏–∏ ‚Äî –º—è–≥–∫–∞—è –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è —Å 3 —É—Ä–æ–≤–Ω—è–º–∏ –ø–µ–Ω–∞–ª—å—Ç–∏ (MINOR=1, MEDIUM=2, SEVERE=3) –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç—è–∂–µ—Å—Ç–∏. –°–æ—Å—Ç–æ—è–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ score (–±–µ–∑ hasBreak override): STRONG‚â•8, GROWING‚â•4.5, BUILDING‚â•1.5, RECOVERY>0, BROKEN‚â§0. –í–∏–∑—É–∞–ª—å–Ω–æ: –∂—ë–ª—Ç–æ-—è–Ω—Ç–∞—Ä–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (‚ö†) –≤–º–µ—Å—Ç–æ —Å–µ—Ä—ã—Ö —Ä–∞–∑—Ä—ã–≤–æ–≤ (‚úó). API: `breaks[]` ‚Üí `warnings[]` (—Å –ø–æ–ª—è–º–∏ penalty, chainAfter, weight) |
