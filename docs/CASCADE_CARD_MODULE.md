# Cascade Card ‚Äî ¬´–í–∞—à –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∫–∞—Å–∫–∞–¥¬ª

> –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–æ–¥—É–ª—è `heys_cascade_card_v1.js` v3.6.0  
> –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: 2026-02-25

---

## –°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ –∫–∞—Å–∫–∞–¥–∞

–ö–∞—Å–∫–∞–¥ ‚Äî –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π —Å–∫–æ—Ä–∏–Ω–≥ –¥–Ω—è. 10 —Ñ–∞–∫—Ç–æ—Ä–æ–≤, –∫–∞–∂–¥—ã–π
–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è **–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π** (–≤–º–µ—Å—Ç–æ —Å—Ç—É–ø–µ–Ω–µ–π) –∏ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫
**–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–º—É baseline** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã v2.1.0

| –ü—Ä–∏–Ω—Ü–∏–ø                       | –ù–∞—É—á–Ω–∞—è –æ—Å–Ω–æ–≤–∞                           | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è                                 |
| :---------------------------- | :--------------------------------------- | :----------------------------------------- |
| **–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ —Å–∫–æ—Ä–∏–Ω–≥**       | –ü—Ä–∏—Ä–æ–¥–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç—É–ø–µ–Ω—è–º–∏            | –°–∏–≥–º–æ–∏–¥/–ª–∏–Ω–µ–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –≤–º–µ—Å—Ç–æ `if`  |
| **–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π baseline**     | –ú–µ–∂–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å ¬±30%     | 14-–¥–Ω–µ–≤–Ω–∞—è —Å–∫–æ–ª—å–∑—è—â–∞—è –º–µ–¥–∏–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| **–¶–∏—Ä–∫–∞–¥–Ω–∞—è –æ—Å–≤–µ–¥–æ–º–ª—ë–Ω–Ω–æ—Å—Ç—å** | –ì–æ—Ä–º–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–∏—Ç–º—ã –∫–æ—Ä—Ç–∏–∑–æ–ª/–º–µ–ª–∞—Ç–æ–Ω–∏–Ω/GH | –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–∫—Ç–æ—Ä–∞ |
| **–ê–ª–ª–æ—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞**  | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–π —Å—Ç—Ä–µ—Å—Å vs –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ    | –ö—Ä–æ—Å—Å-—Ñ–∞–∫—Ç–æ—Ä–Ω—ã–µ —Å–∏–Ω–µ—Ä–≥–∏–∏ –∏ –±–∞–ª–∞–Ω—Å          |
| **–ì–æ—Ä–º–µ–∑–∏—Å**                  | –£–º–µ—Ä–µ–Ω–Ω—ã–π —Å—Ç—Ä–µ—Å—Å –ø–æ–ª–µ–∑–µ–Ω, –∏–∑–±—ã—Ç–æ–∫ ‚Äî –Ω–µ—Ç  | Diminishing returns –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏          |
| **Confidence-–≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ**    | –ú–∞–ª–æ –¥–∞–Ω–Ω—ã—Ö ‚Üí –≤–µ—Å –±–ª–∏–∂–µ –∫ –Ω—É–ª—é           | `confidence: 0‚Ä¶1` –Ω–∞ –∫–∞–∂–¥—ã–π —Ñ–∞–∫—Ç–æ—Ä         |

```
–û–±—â–∞—è —Ñ–æ—Ä–º–∞—Ü–∏—è:

getPersonalBaseline(factorKey, defaultValue):
  ‚Üí median(last 14 days for factor)
  ‚Üí fallback: populationDefault

scoreFactor(raw, baseline, curveFn):
  ‚Üí weight = curveFn(raw, baseline)
  ‚Üí confidence = min(1.0, daysWithData / 7)
  ‚Üí adjustedWeight = weight √ó confidence
```

---

### –°–≤–æ–¥–∫–∞ —Ñ–∞–∫—Ç–æ—Ä–æ–≤

```
#   –§–∞–∫—Ç–æ—Ä            v2.0 –¥–∏–∞–ø–∞–∑–æ–Ω  v2.1 –¥–∏–∞–ø–∞–∑–æ–Ω   –ß—Ç–æ –º–µ–Ω—è–µ—Ç—Å—è
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1   –ë—ã—Ç–æ–≤–∞—è –∞–∫—Ç–∏–≤.     -0.3‚Ä¶+1.0      -0.5‚Ä¶+1.2      Adaptive baseline + log2
2   –ö–∞—á–µ—Å—Ç–≤–æ –ø—Ä–∏—ë–º–∞    -1.0‚Ä¶+1.5      -1.5‚Ä¶+2.0      –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è —Ñ-—è + circadian timing
3   –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞         -0.5‚Ä¶+2.5      -0.5‚Ä¶+3.0      Load√óintensity + recovery-aware
4   –í—Ä–µ–º—è –∑–∞—Å—ã–ø–∞–Ω–∏—è    -2.0‚Ä¶+1.0      -2.0‚Ä¶+1.2      Chronotype-adaptive + consistency (v3.2.0: sigmoid softened)
5   –î–ª–∏—Ç. —Å–Ω–∞          -1.5‚Ä¶+1.0      -2.0‚Ä¶+1.5      Personalized optimal + bell-curve
6   –®–∞–≥–∏               -0.3‚Ä¶+1.0      -0.5‚Ä¶+1.3      Rolling adaptive goal + tanh
7   –ß–µ–∫-–∏–Ω             0‚Ä¶+0.5         -0.1‚Ä¶+0.8      Streak bonus + trend awareness
8   –ó–∞–º–µ—Ä—ã —Ç–µ–ª–∞        -0.3‚Ä¶+1.0      -0.3‚Ä¶+1.2      Smart cadence + completeness
9   –í–∏—Ç–∞–º–∏–Ω—ã           -0.2‚Ä¶+0.5      -0.3‚Ä¶+0.7      Streak bonus + timing
10  –ò–Ω—Å—É–ª–∏–Ω–æ–≤—ã–µ –≤–æ–ª–Ω—ã  -1.5‚Ä¶+1.5      -2.0‚Ä¶+2.0      Sigmoid overlap + post-training + night fasting
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    –ú–µ—Ç–∞-—à–∞–≥–∏         ‚Äî              ‚Äî               Confidence + Day-Type + Synergies (+1.3 max)
    TOTAL               ~-8‚Ä¶~+11.5     ~-10‚Ä¶~+16.3
    MOMENTUM_TARGET     8.5            8.5 (v3.5.0: —Å–Ω–∏–∂–µ–Ω —Å 10.0 –¥–ª—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ DCS –ø—Ä–∏ 4-5 —Ñ–∞–∫—Ç–æ—Ä–∞—Ö)
```

---

### –§–∞–∫—Ç–æ—Ä 1: –ë—ã—Ç–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (NEAT) ‚Äî –®–ê–ì 1

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `day.householdMin` (–º–∏–Ω—É—Ç—ã –±—ã—Ç–æ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏)

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ 60/30/10 –º–∏–Ω

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî adaptive baseline + relative scoring:**

```
Personal baseline:
  baselineNEAT = median(last14days.householdMin) || 30  // population default

Relative scoring (–∫ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–º—É —É—Ä–æ–≤–Ω—é):
  ratio = householdMin / baselineNEAT
  weight = clamp(log2(ratio + 0.5) √ó 0.8, -0.5, +1.2)
  //  ratio=0.0 ‚Üí -0.5 (—Ä–µ–∑–∫–æ –Ω–∏–∂–µ —Å–≤–æ–µ–π –Ω–æ—Ä–º—ã)
  //  ratio=0.3 ‚Üí -0.15
  //  ratio=1.0 ‚Üí +0.35 (–Ω–∞ —É—Ä–æ–≤–Ω–µ)
  //  ratio=1.5 ‚Üí +0.70
  //  ratio=2.0 ‚Üí +1.0 (–≤–¥–≤–æ–µ –≤—ã—à–µ –ø—Ä–∏–≤—ã—á–Ω–æ–≥–æ)
  //  ratio=3.0 ‚Üí +1.2 (cap)

Streak penalty (multi-day, smoothed):
  inactiveDays = countConsecutive(prevDays, d => d.householdMin < 10)
  if inactiveDays > 2:
    penalty = -0.08 √ó (inactiveDays - 2)^0.7, max -0.5
    // –°—É–±–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è –∫—Ä–∏–≤–∞—è: –ø–ª–∞–≤–Ω–æ –Ω–∞—Ä–∞—Å—Ç–∞–µ—Ç
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- NEAT —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 15‚Äì50% —Å—É—Ç–æ—á–Ω–æ–≥–æ —Ä–∞—Å—Ö–æ–¥–∞ (Levine, 2004) ‚Äî –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å
  –æ–≥—Ä–æ–º–Ω–∞
- –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ —Å–∫–æ—Ä–∏–Ω–≥ –≤–∞–∂–Ω–µ–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ: —á–µ–ª–æ–≤–µ–∫ —Å NEAT 120 –º–∏–Ω/–¥–µ–Ω—å –∏ 60
  –º–∏–Ω/–¥–µ–Ω—å ‚Äî —Ä–∞–∑–Ω—ã–µ –±–∞–∑–æ–≤—ã–µ —É—Ä–æ–≤–Ω–∏
- Log-–∫—Ä–∏–≤–∞—è: diminishing returns (60‚Üí120 –º–∏–Ω –º–µ–Ω–µ–µ –∑–Ω–∞—á–∏–º—ã —á–µ–º 0‚Üí60)

---

### –§–∞–∫—Ç–æ—Ä 2: –ö–∞—á–µ—Å—Ç–≤–æ –ø—Ä–∏—ë–º–∞ –ø–∏—â–∏ ‚Äî –®–ê–ì 2

**–ò—Å—Ç–æ—á–Ω–∏–∫:**
`HEYS.mealScoring.getMealQualityScore(meal, null, normKcal, pIndex)` ‚Üí
`score: 0‚Äì100`

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** —Å—Ç—É–ø–µ–Ω—á–∞—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è (80/60/40/20 ‚Üí +1.5/+1.0/+0.5/0/-0.5)

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è + —Ü–∏—Ä–∫–∞–¥–Ω—ã–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä:**

```
–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –≤–µ—Å (–ª–∏–Ω–µ–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è):
  weight = clamp((qualityScore - 40) / 40, -1.0, +1.5)
  //  0 ‚Üí -1.0,  20 ‚Üí -0.5,  40 ‚Üí 0.0,  60 ‚Üí +0.5,  80 ‚Üí +1.0, 100 ‚Üí +1.5

–¶–∏—Ä–∫–∞–¥–Ω—ã–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä (–∑–∞–≤—Ç—Ä–∞–∫ –≤–∞–∂–Ω–µ–µ —É–∂–∏–Ω–∞):
  v3.5.0: –ü–æ–ª–æ—Å—ã —Å–¥–≤–∏–≥–∞—é—Ç—Å—è –Ω–∞ `mealBandShift = optimalOnset - 23:00` (–∞–¥–∞–ø—Ç–∞—Ü–∏—è –∫ —Ö—Ä–æ–Ω–æ—Ç–∏–ø—É)
  06:00‚Äì10:00 (–∑–∞–≤—Ç—Ä–∞–∫) ‚Üí weight √ó 1.3   ‚Äî cortisol peak, GH sensitivity
  10:00‚Äì14:00 (–æ–±–µ–¥)    ‚Üí weight √ó 1.0   ‚Äî baseline
  14:00‚Äì18:00 (–ø–µ—Ä–µ–∫—É—Å) ‚Üí weight √ó 0.9   ‚Äî slight discount
  18:00‚Äì21:00 (—É–∂–∏–Ω)    ‚Üí weight √ó 0.85  ‚Äî insulin resistance rises
  21:00‚Äì23:00 (–ø–æ–∑–¥–Ω–∏–π) ‚Üí weight √ó 0.7   ‚Äî melatonin onset impairs glucose
  > 23:00 (—Å–¥–≤–∏–Ω—É—Ç–æ)    ‚Üí always -1.0    ‚Äî hard violation (circadian disruption)

–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –∫—É–º—É–ª—è—Ç–∏–≤ (sigmoid –≤–º–µ—Å—Ç–æ binary 120%):
  ratio = cumulativeKcal / normKcal
  if ratio > 1.0:
    penalty = -sigmoid((ratio - 1.0) / 0.3) √ó 1.5
    // 105% ‚Üí -0.3,  115% ‚Üí -0.9,  130% ‚Üí -1.4
  // –ú—è–≥—á–µ —á–µ–º binary cutoff, –Ω–æ –Ω–∞—Ä–∞—Å—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–æ
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- Cortisol —É—Ç—Ä–æ–º –ø–æ–≤—ã—à–∞–µ—Ç —Ç–µ—Ä–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç –ø–∏—â–∏ (TEF) –Ω–∞ ~15% (Bo et
  al., 2015)
- –í–µ—á–µ—Ä–Ω—è—è –∏–Ω—Å—É–ª–∏–Ω–æ–≤–∞—è —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å: –æ–¥–∏–Ω–∞–∫–æ–≤–∞—è –µ–¥–∞ –≤–µ—á–µ—Ä–æ–º –¥–∞—ë—Ç –Ω–∞ 17% –≤—ã—à–µ
  –ø–æ—Å—Ç–ø—Ä–∞–Ω–¥–∏–∞–ª—å–Ω—É—é –≥–ª—é–∫–æ–∑—É (Morris et al., 2015)
- –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —É—Å—Ç—Ä–∞–Ω—è–µ—Ç ¬´cliff effect¬ª: –ø—Ä–∏—ë–º —Å–æ score 79 –Ω–µ –¥–æ–ª–∂–µ–Ω
  –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç score 80

**–§–æ–ª–±—ç–∫:** –µ—Å–ª–∏ `getMealQualityScore` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí –±–∏–Ω–∞—Ä–Ω–∞—è –ª–æ–≥–∏–∫–∞ (+1.0 /
‚àí1.0).

---

### –§–∞–∫—Ç–æ—Ä 3: –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ ‚Äî –®–ê–ì 3

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `day.trainings[]`, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å + —Ç–∏–ø

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** duration-only buckets (60/45/30/15 –º–∏–Ω)

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî training load + recovery-aware + diminishing returns:**

```
Training load (per session):
  baseDuration = sum(training.z) || training.duration || typeDefault
  intensityMultiplier = {
    hiit: 1.8,  strength: 1.5,  cardio: 1.2,
    yoga: 0.8,  stretching: 0.6, walk: 0.5
  }[training.type] || 1.0

  load = baseDuration √ó intensityMultiplier

  // –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –≤–µ—Å (sqrt-–∫—Ä–∏–≤–∞—è: diminishing returns):
  sessionWeight = clamp(sqrt(load / 30) √ó 1.2, 0.3, 3.0)
  //  load=15 (15 –º–∏–Ω —Ö–æ–¥—å–±–∞)   ‚Üí +0.85
  //  load=40 (40 –º–∏–Ω –∫–∞—Ä–¥–∏–æ)   ‚Üí +1.38
  //  load=60 (40 –º–∏–Ω —Å–∏–ª–æ–≤–∞—è)  ‚Üí +1.70
  //  load=90 (60 –º–∏–Ω —Å–∏–ª–æ–≤–∞—è)  ‚Üí +2.08
  //  load=108 (60 –º–∏–Ω HIIT)    ‚Üí +2.28

Multiple sessions/day ‚Äî diminishing returns:
  totalWeight = session1 + session2 √ó 0.5 + session3 √ó 0.25
  // –í—Ç–æ—Ä–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –≤ –¥–µ–Ω—å ‚Äî –±–æ–Ω—É—Å, –Ω–æ –Ω–µ –ø–æ–ª–Ω—ã–π

Recovery-aware (–æ—Ç–º–µ–Ω–∞ streak-—à—Ç—Ä–∞—Ñ–∞):
  yesterdayLoad = sum(yesterday.trainings.load)
  if yesterdayLoad > 60:
    // –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –≤—á–µ—Ä–∞ = —Å–µ–≥–æ–¥–Ω—è rest day planned
    skipStreakPenalty = true
    // –î–∞–∂–µ –±–æ–Ω—É—Å +0.2 –∑–∞ planned recovery

Weekly volume tracking:
  weeklyLoad = sum(last7days.totalLoad)
  weeklyTarget = baselineWeeklyLoad || 200  // population default
  weeklyRatio = weeklyLoad / weeklyTarget
  // –ù–µ —à—Ç—Ä–∞—Ñ–æ–≤–∞—Ç—å –µ—Å–ª–∏ weeklyRatio ‚â• 0.8 (–Ω–∞ –Ω–µ–¥–µ–ª–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- Training load = Volume √ó Intensity ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç —Å–ø–æ—Ä—Ç–∏–≤–Ω–æ–π –Ω–∞—É–∫–∏ (Foster, 1998)
- –ü—Ä–∏–Ω—Ü–∏–ø —Å—É–ø–µ—Ä–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏: –¥–µ–Ω—å –æ—Ç–¥—ã—Ö–∞ –ø–æ—Å–ª–µ —Ç—è–∂—ë–ª–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ = —á–∞—Å—Ç—å
  —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–≥–æ —Ü–∏–∫–ª–∞, –Ω–µ –ª–µ–Ω—å
- Diminishing returns: –≤—Ç–æ—Ä–æ–π —á–∞—Å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –º–µ–Ω–µ–µ –ø–æ–ª–µ–∑–µ–Ω —á–µ–º –ø–µ—Ä–≤—ã–π (cortisol
  elevation, glycogen depletion)

---

### –§–∞–∫—Ç–æ—Ä 4: –í—Ä–µ–º—è –∑–∞—Å—ã–ø–∞–Ω–∏—è ‚Äî –®–ê–ì 4

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `day.sleepStart` (—Å—Ç—Ä–æ–∫–∞ `"HH:MM"`)

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ (22:00/23:00/00:00/01:00/02:00)

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî chronotype-adaptive + consistency bonus:**

```
Chronotype baseline:
  personalOnset = median(last14days.sleepStart) || 23:00  // default
  optimalOnset = max(21:30, min(personalOnset, 01:30))  // v3.2.0: —Ä–∞—Å—à–∏—Ä–µ–Ω —Å 00:30
  // Clamp: –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ–º baseline —É–π—Ç–∏ –¥–∞–ª—å—à–µ 01:30

Continuous scoring (sigmoid) ‚Äî v3.2.0:
  deviation = sleepStartMins - optimalOnsetMins  // –º–∏–Ω—É—Ç—ã –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
  weight = -tanh(deviation / 60) √ó 1.5 + 0.5     // v3.2.0: /60 √ó 1.5 (–±—ã–ª–æ /45 √ó 2.0)
  // deviation = -60 (–Ω–∞ —á–∞—Å —Ä–∞–Ω—å—à–µ –æ–ø—Ç–∏–º—É–º–∞) ‚Üí +1.2
  // deviation = 0   (–≤ —Å–≤–æ—ë –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è) ‚Üí +0.5
  // deviation = +30  (–Ω–∞ 30 –º–∏–Ω –ø–æ–∑–∂–µ) ‚Üí +0.0
  // deviation = +60  (–Ω–∞ —á–∞—Å –ø–æ–∑–∂–µ) ‚Üí -0.6
  // deviation = +120 (–Ω–∞ 2 —á–∞—Å–∞ –ø–æ–∑–∂–µ) ‚Üí -1.4
  // deviation = +180 (–Ω–∞ 3 —á–∞—Å–∞ –ø–æ–∑–∂–µ) ‚Üí -1.9 (cap at -2.0)

Consistency bonus (low variance = circadian alignment):
  onsetVariance = stdev(last7days.sleepStartMins)
  if onsetVariance < 30:   consistencyBonus = +0.3
  elif onsetVariance < 45: consistencyBonus = +0.15
  else:                    consistencyBonus = 0.0

Hard floor:
  sleepStart > 04:00 ‚Üí always -2.0 (circadian catastrophe)  // v3.2.0: —Å–¥–≤–∏–Ω—É—Ç —Å 03:00, cap -2.0 –≤–º–µ—Å—Ç–æ -2.5
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- Social jet lag (Wittmann et al., 2006): –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ö—Ä–æ–Ω–æ—Ç–∏–ø–∞ –∏ –≤—Ä–µ–º–µ–Ω–∏ —Å–Ω–∞ ‚Üí
  –º–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è
- Consistency > earliness: —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —Å–Ω–∞ 00:00 –ª—É—á—à–µ —á–µ–º —Ö–∞–æ—Ç–∏—á–Ω–æ–µ
  22:00/02:00 (Phillips et al., 2017)
- Melatonin dim light onset (DLMO) ‚Äî –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–∞—Ä–∫–µ—Ä:
  –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∑–∞—Å—ã–ø–∞–Ω–∏–µ = DLMO + 2—á

---

### –§–∞–∫—Ç–æ—Ä 5: –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–Ω–∞ ‚Äî –®–ê–ì 5

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `day.sleepHours`

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–ø—Ç–∏–º—É–º 7.0‚Äì8.5—á

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî personalized bell-curve + training recovery:**

```
Personal optimal:
  personalOptimal = median(last14days.sleepHours) || 7.5
  // Clamp: 6.0 ‚â§ personalOptimal ‚â§ 9.0

Bell-curve scoring:
  deviation = abs(sleepHours - personalOptimal)
  weight = 1.5 √ó exp(-deviation¬≤ / (2 √ó 0.8¬≤)) - 0.5
  // –í —Å–≤–æ—ë–º –æ–ø—Ç–∏–º—É–º–µ: +1.0
  // ¬±1—á –æ—Ç –æ–ø—Ç–∏–º—É–º–∞: +0.3
  // ¬±2—á –æ—Ç –æ–ø—Ç–∏–º—É–º–∞: -0.4
  // ¬±3—á –æ—Ç –æ–ø—Ç–∏–º—É–º–∞: -0.5 (floor, cap)

Asymmetry (–Ω–µ–¥–æ—Å—ã–ø —Ö—É–∂–µ –ø–µ—Ä–µ—Å—ã–ø–∞):
  if sleepHours < personalOptimal:
    weight *= 1.3  // –£—Å–∏–ª–µ–Ω–∏–µ —à—Ç—Ä–∞—Ñ–∞ –∑–∞ –Ω–µ–¥–æ—Å—ã–ø
  // 5—á –ø—Ä–∏ –æ–ø—Ç–∏–º—É–º–µ 7.5 ‚Üí -0.65 (–≤–º–µ—Å—Ç–æ -0.5)

Training recovery modifier:
  if yesterdayHadIntenseTraining:
    personalOptimal += 0.5  // –ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ —Å–Ω–µ –≤—ã—à–µ –Ω–∞ 30 –º–∏–Ω
    // 8—á –ø–æ—Å–ª–µ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ = –±–ª–∏–∂–µ –∫ –æ–ø—Ç–∏–º—É–º—É

Hard limits (—Ñ–∏–∑–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–æ–ª/–ø–æ—Ç–æ–ª–æ–∫):
  sleepHours < 4.0 ‚Üí floor -2.0 (critical health risk)
  sleepHours > 12.0 ‚Üí cap -0.5 (–º–∞—Ä–∫–µ—Ä –ø—Ä–æ–±–ª–µ–º—ã, –Ω–æ –Ω–µ –∞–∫—Ç–∏–≤–Ω—ã–π –≤—Ä–µ–¥)
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ —Å–Ω–µ: –≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–ª–∏–º–æ—Ä—Ñ–∏–∑–º DEC2 ‚Äî 5—á vs 9—á (He
  et al., 2009)
- Bell-curve –æ–ø—Ç–∏–º–∞–ª—å–Ω–µ–µ –ª–∏–Ω–µ–π–Ω—ã—Ö –ø–æ—Ä–æ–≥–æ–≤: nature is Gaussian
- Post-exercise sleep need: +20‚Äì40 –º–∏–Ω –ø–æ—Å–ª–µ —Ç—è–∂—ë–ª–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (Dattilo et
  al., 2011)

---

### –§–∞–∫—Ç–æ—Ä 7: –ß–µ–∫-–∏–Ω (–≤–µ—Å —É—Ç—Ä–æ–º) ‚Äî –®–ê–ì 7

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `day.weightMorning > 0`

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** binary +0.5

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî streak bonus + trend awareness:**

```
Base reward:
  weightMorning > 0 ‚Üí +0.3

Streak bonus (consecutive check-ins):
  checkinStreak = countConsecutive(prevDays, d => d.weightMorning > 0)
  streakBonus = min(0.5, checkinStreak √ó 0.05)
  // 1 –¥–µ–Ω—å ‚Üí +0.05, 3 –¥–Ω—è ‚Üí +0.15, 7 –¥–Ω–µ–π ‚Üí +0.35, 10+ ‚Üí +0.50

Trend awareness:
  if weight trending toward goal (7-day slope √ó goal direction > 0):
    trendBonus = +0.1
  elif weight stable (|7-day slope| < 0.05 kg/day):
    trendBonus = +0.05

No check-in penalty (mild, only if streak existed):
  if checkinStreak >= 3 && today no checkin:
    penalty = -0.1  // break a good habit

Total: base + streakBonus + trendBonus = max +0.8
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- Self-monitoring = —Å–∞–º—ã–π —Å–∏–ª—å–Ω—ã–π –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (Burke et
  al., 2011)
- Daily weighing: -3.1 –∫–≥ –∑–∞ 12 –º–µ—Å vs -1.2 –∫–≥ –±–µ–∑ (Steinberg et al., 2015)
- Reinforcement schedule: variable ratio > fixed ratio (Skinner, 1938) ‚Äî streak
  bonus —Å–æ–∑–¥–∞—ë—Ç momentum

---

### –§–∞–∫—Ç–æ—Ä 8: –ó–∞–º–µ—Ä—ã —Ç–µ–ª–∞ ‚Äî –®–ê–ì 8

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `day.measurements` ‚Äî `{ waist, hips, thigh, biceps, ... }`

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** binary +1.0 today / penalty if old

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî smart cadence + completeness score:**

```
Optimal cadence:
  daysSinceLast = daysUntil(lastMeasurementDate) || Infinity
  optimalCadence = 7  // 1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é

Today has measurements:
  completeness = count(measurements[k] > 0) / totalPossibleMeasurements
  // waist + hips + thigh + biceps = 4 possible
  // 2 –∏–∑ 4 ‚Üí completeness = 0.5

  baseWeight = 0.5 + completeness √ó 0.7
  // 1 –∑–∞–º–µ—Ä ‚Üí +0.67,  all 4 ‚Üí +1.2

  // –ï—Å–ª–∏ —Å–Ω–∏–º–∞–ª–∏ –≤—á–µ—Ä–∞ —Ç–æ–∂–µ ‚Äî diminishing returns:
  if daysSinceLast <= 2: baseWeight *= 0.5
  // ¬´–ö–∞–∂–¥—ã–π –¥–µ–Ω—å –º–µ—Ä–∏—Ç—å¬ª –Ω–µ –ª—É—á—à–µ —á–µ–º —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é

No measurements today:
  if daysSinceLast > optimalCadence √ó 2:
    penalty = clamp(-0.05 √ó (daysSinceLast - optimalCadence), -0.3, 0)
  // 14 –¥–Ω–µ–π –Ω–∞–∑–∞–¥ ‚Üí -0.05 √ó 7 = -0.35 ‚Üí capped -0.3
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- –û–±—Ö–≤–∞—Ç —Ç–∞–ª–∏–∏ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å –≤–∏—Å—Ü–µ—Ä–∞–ª—å–Ω—ã–º –∂–∏—Ä–æ–º: r = 0.84 (Janssen et al., 2002)
- –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –ø–æ—Ö—É–¥–µ–Ω–∏—è
- Completeness: –±–æ–ª—å—à–µ —Ç–æ—á–µ–∫ = —Ç–æ—á–Ω–µ–µ tracking body recomposition

---

### –§–∞–∫—Ç–æ—Ä 6: –®–∞–≥–∏ ‚Äî –®–ê–ì 6

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `day.steps` / `prof.stepsGoal || 7000`

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** ratio-based —Å—Ç—É–ø–µ–Ω–∏ (120/100/70/50%)

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî rolling adaptive goal + time-of-day curve:**

```
Adaptive goal:
  rollingAvg = mean(last14days.steps) || prof.stepsGoal || 7000
  adaptiveGoal = max(5000, rollingAvg √ó 1.05)
  // –¶–µ–ª—å —Å–ª–µ–≥–∫–∞ –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ ‚Äî –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞

Continuous scoring:
  ratio = steps / adaptiveGoal
  weight = clamp(tanh((ratio - 0.6) √ó 2.5) √ó 1.0 + 0.15, -0.5, +1.3)
  //  ratio=0.3 ‚Üí -0.45
  //  ratio=0.5 ‚Üí -0.10
  //  ratio=0.7 ‚Üí +0.30
  //  ratio=1.0 ‚Üí +0.85
  //  ratio=1.3 ‚Üí +1.15
  //  ratio=1.5 ‚Üí +1.25 (diminishing returns)

Time-of-day expectation (intraday credit):
  hourFraction = currentHour / 24
  expectedSteps = adaptiveGoal √ó hourFraction^0.7
  // –ö 14:00 –æ–∂–∏–¥. ~55% —à–∞–≥–æ–≤, –∫ 20:00 ~82%
  // –ù–µ —à—Ç—Ä–∞—Ñ—É–µ–º —É—Ç—Ä–æ–º –∑–∞ ¬´–º–∞–ª–æ —à–∞–≥–æ–≤¬ª ‚Äî –¥–µ–Ω—å –µ—â—ë –∏–¥—ë—Ç

  if steps < expectedSteps √ó 0.5 && currentHour > 16:
    // –ö –≤–µ—á–µ—Ä—É –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∏–∂–µ –æ–∂–∏–¥. ‚Üí  hint ¬´–ø—Ä–æ–≥—É–ª—è–π—Å—è¬ª
    earlyWarning = true
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- 7000‚Äì10000 —à–∞–≥–æ–≤/–¥–µ–Ω—å = –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç–∏ (Paluch
  et al., 2022)
- –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞: +5% –∫ —Å—Ä–µ–¥–Ω–µ–º—É ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç —Å–ø–æ—Ä—Ç–∏–≤–Ω–æ–π –ø–µ—Ä–∏–æ–¥–∏–∑–∞—Ü–∏–∏
- Intraday curve: —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ, –ø–∏–∫ 10‚Äì18—á

---

### –§–∞–∫—Ç–æ—Ä 9: –í–∏—Ç–∞–º–∏–Ω—ã / –¥–æ–±–∞–≤–∫–∏ ‚Äî –®–ê–ì 9

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `day.supplementsTaken` vs –ø–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** ratio-based 3 —Å—Ç—É–ø–µ–Ω–∏ (100/50/0%)

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî streak bonus + smooth function + zero-plan fallback:**

```
Base scoring (continuous):
  // –ï—Å–ª–∏ –ø–ª–∞–Ω –Ω–µ –∑–∞–¥–∞–Ω, –Ω–æ –≤–∏—Ç–∞–º–∏–Ω—ã –≤—ã–ø–∏—Ç—ã ‚Äî —Å—á–∏—Ç–∞–µ–º –ø–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º –Ω–∞ 100%
  if suppPlanned == 0 && suppTaken > 0: suppPlanned = suppTaken

  ratio = suppTaken / suppPlanned
  weight = clamp(ratio √ó 0.7 - 0.1, -0.3, +0.5)
  //  ratio=0.0 ‚Üí -0.1
  //  ratio=0.3 ‚Üí +0.11
  //  ratio=0.7 ‚Üí +0.39
  //  ratio=1.0 ‚Üí +0.5 (–≤—Å—ë –ø—Ä–∏–Ω—è—Ç–æ, –µ—â—ë –Ω–µ max)

Streak bonus (consistency):
  suppStreak = countConsecutive(prevDays, d => suppRatio(d) >= 0.8)
  if suppStreak >= 7:  streakBonus = +0.2  // –Ω–µ–¥–µ–ª—è –ø–æ–¥—Ä—è–¥
  elif suppStreak >= 3: streakBonus = +0.1

Missed penalty (only if plan exists && streak was active):
  if suppPlanned > 0 && suppTaken == 0 && suppStreak >= 3:
    penalty = -0.3  // breaking established habit

Total: base + streak = max +0.7
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- Adherence > dosage: 80% compliance = 95% —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, <50% = –ø–æ—Ç–µ—Ä—è —ç—Ñ—Ñ–µ–∫—Ç–∞
  (Osterberg & Blaschke, 2005)
- Habit formation: streak-–±–æ–Ω—É—Å —Å–æ–∑–¥–∞—ë—Ç positive reinforcement loop (Lally et
  al., 2010: average 66 –¥–Ω–µ–π –¥–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–º, –ø–µ—Ä–≤—ã–µ 7 ‚Äî –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –æ–∫–Ω–æ)

---

### –§–∞–∫—Ç–æ—Ä 10: –ò–Ω—Å—É–ª–∏–Ω–æ–≤—ã–µ –≤–æ–ª–Ω—ã ‚Äî –®–ê–ì 10

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `HEYS.InsulinWave.calculate()`

**v2.0 (—Ç–µ–∫—É—â–µ–µ):** overlap count + avgGap + nightFasting

**v2.1 (–∞–ø–≥—Ä–µ–π–¥) ‚Äî GI-awareness + post-training window + composition:**

```
Overlap scoring (severity-weighted, continuous):
  overlapPenalty = Œ£ -sigmoid(overlapMinutes / 30) √ó 0.6
  // 10 –º–∏–Ω –Ω–∞–ª–æ–∂–µ–Ω–∏—è ‚Üí -0.18
  // 30 –º–∏–Ω ‚Üí -0.36
  // 60 –º–∏–Ω ‚Üí -0.51
  // Total cap: -2.0

Gap scoring (continuous log-curve):
  gapBonus = Œ£ clamp(log2(gapMinutes / 120), 0, 1.0) √ó 0.4
  // 120 –º–∏–Ω gap ‚Üí +0.0
  // 180 –º–∏–Ω ‚Üí +0.23
  // 240 –º–∏–Ω ‚Üí +0.40
  // 360 –º–∏–Ω ‚Üí +0.63

Post-training meal timing (anabolic window):
  if meal within 30‚Äì120 –º–∏–Ω after training:
    mealTimingBonus = +0.3  // protein synthesis window
  if meal within 0‚Äì30 –º–∏–Ω after training:
    mealTimingBonus = +0.15  // too fast, but okay

Night fasting (continuous):
  nightGapHours = longestGap / 60
  nightBonus = clamp((nightGapHours - 10) √ó 0.15, 0.0, +0.5)
  // 10—á ‚Üí 0.0, 12—á ‚Üí +0.3, 14—á ‚Üí +0.5 (cap)

Meal composition modifier (–µ—Å–ª–∏ getMealQualityScore –¥–æ—Å—Ç—É–ø–µ–Ω):
  if lastMealBeforeSleep has highGI items:
    nightFastingPenalty -= 0.2
    // –í—ã—Å–æ–∫–∏–π –ì–ò –ø–µ—Ä–µ–¥ —Å–Ω–æ–º = poor sleep quality ‚Üí hit fasting benefit

Total: overlapPenalty + gapBonus + nightBonus + mealTimingBonus
  range: -2.0 ‚Ä¶ +2.0
```

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

- Insulin Overlap: –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ –∏–Ω—Å—É–ª–∏–Ω–∞ –¥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ baseline ‚Üí de novo
  lipogenesis (Frayn, 2003)
- Anabolic window: MPS –ø–æ–≤—ã—à–∞–µ—Ç—Å—è –Ω–∞ 50% –≤ –ø–µ—Ä–≤—ã–µ 2—á –ø–æ—Å–ª–µ resistance training
  (Schoenfeld et al., 2013)
- Time-restricted eating (16/8): meta-analysis –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç -1.6 –∫–≥ / 12 –Ω–µ–¥–µ–ª—å
  (Regmi & Heilbronn, 2020) ‚Äî –Ω–æ—á–Ω–æ–π —Ñ–∞—Å—Ç–∏–Ω–≥ ‚â• 14—á

---

### –ö—Ä–æ—Å—Å-—Ñ–∞–∫—Ç–æ—Ä–Ω—ã–µ —Å–∏–Ω–µ—Ä–≥–∏–∏ ‚Äî –®–ê–ì 13 (NEW in v2.1.0)

–§–∞–∫—Ç–æ—Ä—ã –Ω–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã. –û–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç **—Å–∏–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π
—ç—Ñ—Ñ–µ–∫—Ç**:

```
SYNERGIES = {
  // –°–æ–Ω + –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞: —Ö–æ—Ä–æ—à–∏–π —Å–æ–Ω —É—Å–∏–ª–∏–≤–∞–µ—Ç recovery
  sleep_training: {
    condition: sleepDurWeight > 0 && yesterdayTrainingLoad > 50
    bonus: +0.3
    reason: 'Quality sleep after training ‚Üí supercompensation'
  },

  // NEAT + –®–∞–≥–∏: combined movement score
  neat_steps: {
    condition: householdWeight > 0 && stepsWeight > 0
    bonus: +0.2
    reason: 'Multi-modal movement ‚Üí higher TDEE, better insulin sensitivity'
  },

  // Meal timing + Insulin gaps: aligned eating = metabolic harmony
  meals_insulin: {
    condition: avgMealQuality > 60 && avgGap > 180
    bonus: +0.2
    reason: 'Quality food + proper spacing ‚Üí optimal nutrient partitioning'
  },

  // Morning routine: checkin + early meal + NEAT
  morning_ritual: {
    condition: hasCheckin && firstMealBefore10 && householdMin > 0
    bonus: +0.3
    reason: 'Morning structure ‚Üí cortisol alignment, habit stacking'
  },

  // Full recovery day: good sleep + rest + low stress
  recovery_day: {
    condition: sleepOnsetWeight > 0 && sleepDurWeight > 0.5
              && !hasTraining && householdMin > 20
    bonus: +0.3
    reason: 'Planned recovery ‚Üí parasympathetic dominance'
  }
}

Max total synergy bonus: +1.3
```

---

### Day-Type Awareness ‚Äî –®–ê–ì 12 (NEW in v2.1.0)

–ö–∞—Å–∫–∞–¥ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç **—Ç–∏–ø –¥–Ω—è** –∏ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç –æ–∂–∏–¥–∞–Ω–∏—è:

```
DAY_TYPES = {
  training_day: {
    detect: trainings.length > 0 && totalLoad > 40
    adjustments: {
      mealCalorieTolerance: 1.3   // +30% kcal allowance
      sleepImportance: 1.2         // sleep weight √ó 1.2 tomorrow
      stepsGoalModifier: 0.8       // lower steps expected
    }
  },
  rest_day: {
    detect: trainings.length == 0 && yesterday.trainingLoad > 60
    adjustments: {
      trainingPenalty: 0            // no penalty for missing training
      neatImportance: 1.3           // NEAT more important on rest days
      recoveryBonus: +0.2           // explicit rest = good
    }
  },
  active_rest: {
    detect: trainings has yoga/stretching/walk only
    adjustments: {
      trainingWeight: √ó 1.2        // boost low-intensity activities
      stepsBonus: +0.1              // walking encouraged
    }
  }
}
```

---

### Confidence Layer ‚Äî –®–ê–ì 11 (NEW in v2.1.0)

–ö–∞–∂–¥—ã–π —Ñ–∞–∫—Ç–æ—Ä –ø–æ–ª—É—á–∞–µ—Ç `confidence: 0.0‚Äì1.0` –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–±—ä—ë–º–∞ –¥–∞–Ω–Ω—ã—Ö:

```
getFactorConfidence(factorKey):
  daysWithData = count(last14days where factor has data)

  if daysWithData >= 10:  return 1.0
  elif daysWithData >= 7: return 0.8
  elif daysWithData >= 3: return 0.5
  elif daysWithData >= 1: return 0.3
  else:                   return 0.1  // population default only

–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
  adjustedWeight = rawWeight √ó confidence
  // –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (day 1): –≤—Å–µ –≤–µ—Å–∞ √ó 0.1 ‚Üí score ‚âà 0
  // –ß–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é: √ó 0.5‚Äì0.8 ‚Üí score –Ω–∞—á–∏–Ω–∞–µ—Ç –æ—Ç—Ä–∞–∂–∞—Ç—å —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å
  // –ß–µ—Ä–µ–∑ 2 –Ω–µ–¥–µ–ª–∏: √ó 1.0 ‚Üí –ø–æ–ª–Ω—ã–µ –≤–µ—Å–∞

–≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç:
  - –õ–æ–∂–Ω—ã–π STRONG —É –Ω–æ–≤–∏—á–∫–∞  —Å –æ–¥–Ω–æ–π —Ö–æ—Ä–æ—à–µ–π –µ–¥–æ–π
  - –õ–æ–∂–Ω—ã–π BROKEN –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã—Ö
  - –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏ –ø—Ä–∏ –º–∞–ª–æ–º N
```

---

### –ü–æ—Ä–æ–≥–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π (v3.1.0+ CRS-driven)

```
STRONG:   CRS ‚â• 0.75   ‚Äî —É—Å—Ç–æ–π—á–∏–≤—ã–π –∏–º–ø—É–ª—å—Å
GROWING:  CRS ‚â• 0.45   ‚Äî –∫–∞—Å–∫–∞–¥ –Ω–∞–±–∏—Ä–∞–µ—Ç —Å–∏–ª—É
BUILDING: CRS ‚â• 0.20   ‚Äî –∏–º–ø—É–ª—å—Å —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è
RECOVERY: CRS > 0.05   ‚Äî –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ
BROKEN:   CRS ‚â§ 0.05   ‚Äî –Ω–∞—á–Ω–∏ —Å –º–∞–ª–æ–≥–æ
EMPTY:    –Ω–µ—Ç —Å–æ–±—ã—Ç–∏–π   ‚Äî –Ω–∞—á–∞–ª–æ –¥–Ω—è
```

> **v3.1.0+**: —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ CRS (–∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–π –∏–º–ø—É–ª—å—Å), –∞ –Ω–µ –ø–æ
> –¥–Ω–µ–≤–Ω–æ–º—É score. –ü–æ—Ä–æ–≥–∏ score (v2.2.0) –≤—Å—ë –µ—â—ë –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è
> –≤–Ω—É—Ç—Ä–∏–¥–Ω–µ–≤–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ DCS-–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏.

### –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä (v3.0.0+ CRS-driven)

```
Momentum = crs  // v3.0.0+: –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä = CRS (–∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–π –∏–º–ø—É–ª—å—Å)
// dailyMomentum = min(1, max(0, score) / MOMENTUM_TARGET) ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
MOMENTUM_TARGET = 8.5  (v3.5.0: —Å–Ω–∏–∂–µ–Ω —Å 10.0 –¥–ª—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ DCS –ø—Ä–∏ 4-5 –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–∞—Ö)

–•–æ—Ä–æ—à–∏–π –¥–µ–Ω—å (—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π, 4-5 –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤):
  3 —Ö–æ—Ä. –µ–¥—ã (√ócircadian +3.0) + —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ 45–º (+2.0) + —Å–æ–Ω (onset+dur +1.5)
  + consistency +0.3 + —á–µ–∫-–∏–Ω streak (+0.5) + —à–∞–≥–∏ adaptive (+0.6)
  + morning_ritual synergy (+0.3)
  = 8.2 ‚Üí –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä 96%  (score / MT=8.5)
  // –ü—Ä–∏ MT=8.5 —Ö–æ—Ä–æ—à–∏–π 4-—Ñ–∞–∫—Ç–æ—Ä–Ω—ã–π –¥–µ–Ω—å –≤–ø–ª–æ—Ç–Ω—É—é –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç—Å—è –∫ 100%

–û—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å (–≤—Å–µ 10 —Ñ–∞–∫—Ç–æ—Ä–æ–≤):
  3 –æ—Ç–ª. –µ–¥—ã (√ócircadian +4.5) + —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ 60–º (+2.5) + —Å–æ–Ω –∏–¥–µ–∞–ª—å–Ω—ã–π (+2.5)
  + consistency +0.3 + —á–µ–∫-–∏–Ω streak (+0.8) + –∑–∞–º–µ—Ä—ã complete (+1.2)
  + —à–∞–≥–∏ 120% adaptive (+1.15) + –≤–∏—Ç–∞–º–∏–Ω—ã streak (+0.7)
  + gaps 4—á (+1.0) + –Ω–æ—á–Ω–æ–π 14—á (+0.5) + NEAT 60–º relative (+1.0)
  + synergies (+1.0)
  = 17.1 ‚Üí –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä 100% (capped)
```

### –ü–æ—Å—Ç-—Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–µ –æ–∫–Ω–æ

| –£—Å–ª–æ–≤–∏–µ               | –≠—Ñ—Ñ–µ–∫—Ç                        |
| :-------------------- | :---------------------------- |
| < 2—á –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ | –ü—É–ª —Å–æ–æ–±—â–µ–Ω–∏–π: ANTI_LICENSING |

### –í–∏–∑—É–∞–ª—å–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ (`chain`) ‚Äî v2.2.0 Soft Chain

`chain` ‚Äî –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –ù–µ–≥–∞—Ç–∏–≤–Ω–æ–µ
—Å–æ–±—ã—Ç–∏–µ **—É–º–µ–Ω—å—à–∞–µ—Ç** —Ü–µ–ø–æ—á–∫—É –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —Ç—è–∂–µ—Å—Ç–∏, –∞ –Ω–µ –æ–±–Ω—É–ª—è–µ—Ç. –ù–µ –≤–ª–∏—è–µ—Ç
–Ω–∞ state/progress.

```
Soft Chain Penalty Tiers:
  MINOR  (weight ‚â• -0.5):  chain -= 1  ‚Äî —Å–ª–∞–±—ã–π –ø—Ä–∏—ë–º, –º–∞–ª–æ —à–∞–≥–æ–≤
  MEDIUM (-1.5 ‚â§ w < -0.5): chain -= 2  ‚Äî –ø–æ–∑–¥–Ω–∏–π —Å–æ–Ω, –≤—Ä–µ–¥–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç
  SEVERE (weight < -1.5):  chain -= 3  ‚Äî –∑–∞—Å—ã–ø–∞–Ω–∏–µ –ø–æ—Å–ª–µ 03:00, –∫—Ä–∏—Ç. –Ω–µ–¥–æ—Å—ã–ø

  chain = max(0, chain - penalty)  ‚Äî –Ω–∏–∫–æ–≥–¥–∞ –Ω–∏–∂–µ 0

–ü—Ä–∏–º–µ—Ä: chain=5, –æ–¥–∏–Ω –ø—Ä–æ–º–∞—Ö (MINOR) ‚Üí chain=4 (–∞ –Ω–µ 0)
```

---

## Cascade Rate Score (CRS) v1.0 ‚Äî –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–π –∏–º–ø—É–ª—å—Å

> –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞: v3.0.0‚Äìv3.5.0 | –°—Ç–∞—Ç—É—Å: implemented

### –ü—Ä–æ–±–ª–µ–º–∞

–¢–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞ (v2.2.0) –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç score **–∑–∞–Ω–æ–≤–æ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å**. 14-–¥–Ω–µ–≤–Ω–∞—è
—Å–µ—Ä–∏—è —á–µ–∫–∏–Ω–æ–≤, —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∏ —Ö–æ—Ä–æ—à–∏–µ –ø—Ä–∏—ë–º—ã –ø–∏—â–∏ –æ–±–Ω—É–ª—è—é—Ç—Å—è –≤–∏–∑—É–∞–ª—å–Ω–æ
–∏–∑-–∑–∞ –æ–¥–Ω–æ–≥–æ –ø–ª–æ—Ö–æ–≥–æ —Å–Ω–∞ (03:10, 5.9—á ‚Üí score ‚àí1.84 ‚Üí BROKEN). –≠—Ç–æ:

- **–ù–∞—É—á–Ω–æ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ** ‚Äî –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–º–µ—é—Ç –∏–Ω–µ—Ä—Ü–∏—é
- **–î–µ–º–æ—Ç–∏–≤–∏—Ä—É–µ—Ç** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç ¬´–ü–∞—É–∑–∞ üí™¬ª –ø–æ—Å–ª–µ 2 –Ω–µ–¥–µ–ª—å —Ö–æ—Ä–æ—à–µ–π —Ä–∞–±–æ—Ç—ã
- **–ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—Ç Behavioral Momentum Theory** (Nevin, 1992): —Å–∫–æ—Ä–æ—Å—Ç—å
  —É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ –æ—Ç–∫–ª–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–π

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

**Cascade Rate Score (CRS)** ‚Äî ¬´—Ä–µ–∑–µ—Ä–≤—É–∞—Ä –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ –∏–º–ø—É–ª—å—Å–∞¬ª. –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ
–ø–∞—Ç—Ç–µ—Ä–Ω—ã –∑–∞ **30 –¥–Ω–µ–π** –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è, —Ñ–æ—Ä–º–∏—Ä—É—è –∏–Ω–µ—Ä—Ü–∏—é. –û–¥–∏–Ω –ø–ª–æ—Ö–æ–π –¥–µ–Ω—å –Ω–µ
–º–æ–∂–µ—Ç —Ä–∞–∑—Ä—É—à–∏—Ç—å 2 –Ω–µ–¥–µ–ª–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.

–ú–æ–¥–µ–ª—å –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞:

| –¢–µ–æ—Ä–∏—è                                    | –ê–≤—Ç–æ—Ä              | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ CRS                             |
| :---------------------------------------- | :----------------- | :------------------------------------------- |
| **Behavioral Momentum Theory**            | Nevin, 1992        | –ò–Ω–µ—Ä—Ü–∏—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–π |
| **Habit Formation** (66 –¥–Ω–µ–π, –º–µ–¥–∏–∞–Ω–∞)    | Lally et al., 2010 | 30-–¥–Ω–µ–≤–Ω–æ–µ –æ–∫–Ω–æ ‚Äî –≤–∞–ª–∏–¥–Ω—ã–π —Ü–∏–∫–ª —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è |
| **Allostatic Load Model**                 | McEwen, 1998       | –ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ vs –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ      |
| **Self-Determination Theory** (–∞–≤—Ç–æ–Ω–æ–º–∏—è) | Deci & Ryan, 2000  | –í–∏–¥–∏–º—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å = –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –º–æ—Ç–∏–≤–∞—Ü–∏—è      |

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ CRS

```
–¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å (v2.2.0):
  day ‚Üí computeCascadeState() ‚Üí dailyScore ‚Üí state/progress
  ‚Üë –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å, –±–µ–∑ –ø–∞–º—è—Ç–∏

–ù–æ–≤–∞—è –º–æ–¥–µ–ª—å (v3.6.0 CRS):
  day ‚Üí computeCascadeState() ‚Üí dailyScore ‚Üí DCS (Daily Contribution Score)
                                               ‚Üì
  CRS_base = EMA(completed days, Œ±=0.95)     // i‚â•1, today excluded
  todayBoost = max(0, DCS) √ó 0.03            // instant feedback (+0..3%)
  CRS = clamp(CRS_base + todayBoost, 0, ceiling) ‚Üí state/progress
                                  ‚Üì
                          ceiling (–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–ª–æ–∫)
```

### 1. Daily Contribution Score (DCS)

–ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –¥–Ω–µ–≤–Ω–æ–π score –≤ –µ–¥–∏–Ω—ã–π –º–∞—Å—à—Ç–∞–± ‚àí1.0‚Ä¶+1.0:

```
dcs = clamp(dailyScore / MOMENTUM_TARGET, -0.3, 1.0)
```

**–ó–∞—â–∏—Ç–∞ –∏–Ω–µ—Ä—Ü–∏–∏**: –æ–±—ã—á–Ω—ã–µ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –¥–Ω–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã **‚àí0.3** (–æ–¥–Ω–∏–º –ø–ª–æ—Ö–∏–º
—Å–Ω–æ–º –Ω–µ —Ä–∞–∑—Ä—É—à–∏—à—å –Ω–µ–¥–µ–ª—é –ø—Ä–æ–≥—Ä–µ—Å—Å–∞).

**Critical Violation Override** ‚Äî –æ–±—Ö–æ–¥–∏—Ç –∏–Ω–µ—Ä—Ü–∏—é:

| –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ                        | DCS override | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ                            |
| :----------------------------------------- | :----------- | :------------------------------------- |
| –ï–¥–∞ –ø–æ—Å–ª–µ 00:00 —Å `harm ‚â• 7`               | ‚àí0.8         | –ù–æ—á–Ω–æ–π —Å—Ä—ã–≤ = —Ü–∏—Ä–∫–∞–¥–Ω–∞—è –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞     |
| –ü–µ—Ä–µ–±–æ—Ä –∫–∫–∞–ª > 150% –Ω–æ—Ä–º—ã                  | ‚àí0.6         | –ú–∞—Å—Å–∏–≤–Ω–æ–µ –ø–µ—Ä–µ–µ–¥–∞–Ω–∏–µ                   |
| –ö–æ–º–±–∏–Ω–∞—Ü–∏—è (–Ω–æ—á–Ω–æ–µ + –≤—Ä–µ–¥–Ω–æ–µ + –ø–µ—Ä–µ–µ–¥–∞–Ω–∏–µ) | ‚àí1.0         | –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –¥–Ω–µ–≤–Ω–æ–≥–æ –≤–∫–ª–∞–¥–∞           |
| **–î–µ—Ñ–∏—Ü–∏—Ç: >150% –Ω–æ—Ä–º—ã** (v3.1.0)          | **‚àí0.7**     | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–±–æ—Ä –ø—Ä–∏ —Ü–µ–ª–∏ –ø–æ—Ö—É–¥–µ–Ω–∏—è |
| **–î–µ—Ñ–∏—Ü–∏—Ç: >criticalOver (–Ω–∞–ø—Ä. >115%)**   | **‚àí0.5**     | –ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∏ –¥–µ—Ñ–∏—Ü–∏—Ç–µ (level 2)       |
| **–î–µ—Ñ–∏—Ü–∏—Ç: >targetMax (–Ω–∞–ø—Ä. >105%)**      | clamp ‚àí0.4   | –ú—è–≥–∫–∏–π –ø–µ—Ä–µ–±–æ—Ä –ø—Ä–∏ –¥–µ—Ñ–∏—Ü–∏—Ç–µ (level 1)  |
| **–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –¥–µ–Ω—å + –¥–µ—Ñ–∏—Ü–∏—Ç** (v3.3.0)  | –ø–æ—Ä–æ–≥–∏ √ó1.2  | +20% –¥–æ–ø—É—Å–∫ –Ω–∞ –∫–∫–∞–ª –ø—Ä–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ     |

```javascript
// computeDailyContribution(dailyScore, day, normAbs, pIndex, prof)
function computeDailyContribution(dailyScore, day, normAbs, pIndex, prof) {
  var dcs = clamp(dailyScore / MOMENTUM_TARGET, -0.3, 1.0);
  var hasCriticalViolation = false;
  var violationType = null;

  // Critical Violation Detection
  var meals = (day && day.meals) || [];
  // v3.5.1: fallback 0 (was 2000) ‚Äî skip kcal overrides when normAbs unavailable
  var normKcal = (normAbs && normAbs.kcal) || 0;
  var hasNightHarm = false;
  var hasExcessKcal = false;

  // –ù–æ—á–Ω–∞—è –µ–¥–∞ —Å harm ‚â• 7
  for (var i = 0; i < meals.length; i++) {
    var mealTime = parseTime(meals[i] && meals[i].time);
    if (mealTime !== null && mealTime >= 0 && mealTime < 360) {
      // 00:00‚Äì06:00
      if (checkMealHarm(meals[i], pIndex)) {
        hasNightHarm = true;
      }
    }
  }

  // –ü–µ—Ä–µ–±–æ—Ä –∫–∫–∞–ª > 150%
  var totalKcal = /* sum from dayTot */ 0;
  if (totalKcal > normKcal * 1.5) hasExcessKcal = true;

  if (hasNightHarm && hasExcessKcal) {
    dcs = -1.0;
    violationType = 'night_harm_excess';
  } else if (hasNightHarm) {
    dcs = -0.8;
    violationType = 'night_harm';
  } else if (hasExcessKcal) {
    dcs = -0.6;
    violationType = 'excess_kcal';
  }

  hasCriticalViolation = violationType !== null;
  return {
    dcs: dcs,
    hasCriticalViolation: hasCriticalViolation,
    violationType: violationType,
  };
}
```

### 2. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ CRS (v3.6.0 ‚Äî Base + Today's Boost)

**–§–æ—Ä–º—É–ª–∞ v3.6.0:**

```
CRS = CRS_base + todayBoost

CRS_base   = EMA(–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –¥–Ω–∏, i‚â•1, Œ±=0.95, 30-day window)
todayBoost = max(0, DCS_today) √ó CRS_TODAY_BOOST   // CRS_TODAY_BOOST = 0.03
CRS        = clamp(CRS_base + todayBoost, 0, ceiling)
```

**–ü–æ—á–µ–º—É v3.6.0 –≤–º–µ—Å—Ç–æ partial-day weighting (v3.3.0):**

- **–ü—Ä–æ–±–ª–µ–º–∞ v3.3.0:** DCS –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ–≥–æ –¥–Ω—è (—É—Ç—Ä–æ–º 0.3) –≤–∫–ª—é—á–∞–ª—Å—è –≤ EMA —Å
  —á–∞—Å—Ç–∏—á–Ω—ã–º –≤–µ—Å–æ–º. –ü—Ä–∏ DCS < CRS —ç—Ç–æ _—Ç—è–Ω—É–ª–æ CRS –≤–Ω–∏–∑_ ‚Äî –ø–∞—Ä–∞–¥–æ–∫—Å "—Å–¥–µ–ª–∞–ª
  —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É ‚Üí CRS –Ω–µ –≤—ã—Ä–æ—Å" (–∏–∑–º–µ–Ω–µ–Ω–∏–µ ~0.002, –Ω–µ–≤–∏–¥–∏–º–æ).
- **–†–µ—à–µ–Ω–∏–µ v3.6.0:** CRS_base = —Ç–æ–ª—å–∫–æ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –¥–Ω–∏ (—Å—Ç–∞–±–∏–ª–µ–Ω –≤–µ—Å—å –¥–µ–Ω—å).
  –ö–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ —Å–µ–≥–æ–¥–Ω—è —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç todayBoost (0 ‚Üí +3%), –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –≤–∏–¥–∏–º–æ.
  –£—Ç—Ä–æ–º CRS_base –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å –≤—á–µ—Ä–∞—à–Ω–∏–º DCS ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–Ω—è –∑–∞–∫—Ä–µ–ø–ª—è–µ—Ç—Å—è.

**EMA base (completed days only, i‚â•1):**

```
weights: –≤—á–µ—Ä–∞=1.0 (Œ±‚Å∞), 2 –¥–Ω—è –Ω–∞–∑–∞–¥=0.95 (Œ±¬π), ..., 29 –¥–Ω–µ–π=0.95¬≤‚Å∏ ‚âà 0.24
crs_base = Œ£(weights[i] √ó dcs[i]) / Œ£(weights[i] –¥–ª—è –¥–Ω–µ–π —Å –¥–∞–Ω–Ω—ã–º–∏)
```

**–°–≤–æ–π—Å—Ç–≤–∞ Œ± = 0.95:**

| –î–∞–≤–Ω–æ—Å—Ç—å      | –í–µ—Å   | –í–ª–∏—è–Ω–∏–µ                    |
| :------------ | :---- | :------------------------- |
| –í—á–µ—Ä–∞         | 1.000 | 100% ‚Äî –ø–æ–ª–Ω—ã–π –≤–∫–ª–∞–¥        |
| 2 –¥–Ω—è –Ω–∞–∑–∞–¥   | 0.950 | 95% ‚Äî –ø–æ—á—Ç–∏ –ø–æ–ª–Ω—ã–π         |
| 7 –¥–Ω–µ–π –Ω–∞–∑–∞–¥  | 0.735 | 74% ‚Äî –∑–∞–º–µ—Ç–Ω—ã–π             |
| 14 –¥–Ω–µ–π –Ω–∞–∑–∞–¥ | 0.513 | 51% ‚Äî –∑–Ω–∞—á–∏–º—ã–π —Ñ–æ–Ω         |
| 21 –¥–µ–Ω—å –Ω–∞–∑–∞–¥ | 0.358 | 36% ‚Äî –æ—â—É—Ç–∏–º—ã–π             |
| 30 –¥–Ω–µ–π –Ω–∞–∑–∞–¥ | 0.228 | 23% ‚Äî –≤—Å—ë –µ—â—ë –≤–Ω–æ—Å–∏—Ç –≤–∫–ª–∞–¥ |

> **–ü–µ—Ä–∏–æ–¥ –ø–æ–ª—É—Ä–∞—Å–ø–∞–¥–∞:** ~14 –¥–Ω–µ–π. –û–¥–∏–Ω –ø–ª–æ—Ö–æ–π –¥–µ–Ω—å —Å—Ä–µ–¥–∏ 14 —Ö–æ—Ä–æ—à–∏—Ö –Ω–µ –æ–±—Ä—É—à–∏—Ç
> CRS.

**Today's Boost ‚Äî –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å:**

```
todayBoost = max(0, DCS_today) √ó 0.03

–ü—Ä–∏–º–µ—Ä—ã (–ø—Ä–∏ CRS_base = 80%):
  –£—Ç—Ä–æ, –ø—É—Å—Ç–æ:              DCS=0.000 ‚Üí boost=0.0%  ‚Üí CRS=80.0%
  + –ß–µ–∫–∏–Ω –≤–µ—Å–∞:             DCS=0.094 ‚Üí boost=+0.3% ‚Üí CRS=80.3%
  + –ó–∞–≤—Ç—Ä–∞–∫:                DCS=0.289 ‚Üí boost=+0.9% ‚Üí CRS=80.9%
  + –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞:             DCS=0.466 ‚Üí boost=+1.4% ‚Üí CRS=81.4%  ‚Üê –≤–∏–¥–∏–º–æ!
  + 3 –ø—Ä–∏—ë–º–∞ –ø–∏—â–∏:          DCS=0.607 ‚Üí boost=+1.8% ‚Üí CRS=81.8%
  –ò–¥–µ–∞–ª—å–Ω—ã–π –¥–µ–Ω—å (DCS=1.0): boost=+3.0%              ‚Üí CRS=83.0%
```

**–î–Ω–∏ –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è** (–Ω–µ —Å—á–∏—Ç–∞—é—Ç—Å—è –∫–∞–∫ 0, —á—Ç–æ–±—ã –Ω–µ —à—Ç—Ä–∞—Ñ–æ–≤–∞—Ç—å –∑–∞
–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ).

**–ü—Ä–∏–º–µ—Ä: 14 —Ö–æ—Ä–æ—à–∏—Ö –¥–Ω–µ–π + 1 –ø–ª–æ—Ö–æ–π —Å–æ–Ω (score ‚àí1.84)**

```
DCS –∑–∞ 14 –¥–Ω–µ–π: [0.7, 0.8, 0.6, 0.9, 0.7, 0.8, 0.65, 0.75, 0.8, 0.7, 0.85, 0.6, 0.9, 0.7]
–°–µ–≥–æ–¥–Ω—è DCS: clamp(-1.84/8.5, -0.3, 1.0) = -0.22 (–∑–∞—â–∏—Ç–∞ –∏–Ω–µ—Ä—Ü–∏–∏ ‚àí0.3)

CRS_base ‚âà 0.68  (EMA –±–µ–∑ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–≥–æ –¥–Ω—è)
todayBoost = max(0, -0.22) √ó 0.03 = 0  (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π DCS –Ω–µ —Å–Ω–∏–∂–∞–µ—Ç CRS —á–µ—Ä–µ–∑ boost)
CRS = 0.68 + 0 = 0.68
‚Üí –°–æ—Å—Ç–æ—è–Ω–∏–µ: GROWING ‚ö° ¬´–ö–∞—Å–∫–∞–¥ –Ω–∞–±–∏—Ä–∞–µ—Ç —Å–∏–ª—É¬ª
‚Üí –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä: 68%
```

–ë–µ–∑ CRS: score ‚àí1.84 ‚Üí BROKEN, –ø—Ä–æ–≥—Ä–µ—Å—Å 0%. –° CRS: 14 –¥–Ω–µ–π –∏–Ω–µ—Ä—Ü–∏–∏ ‚Üí GROWING.

### 3. –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–ª–æ–∫ (Ceiling)

–ü–æ—Ç–æ–ª–æ–∫ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç **–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π CRS** –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –†–∞—Å—Ç—ë—Ç –ø–æ –º–µ—Ä–µ
–Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

```
ceiling = min(1.0, base √ó consistency √ó diversity + dataDepth)
```

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç       | –§–æ—Ä–º—É–ª–∞                                          | –î–∏–∞–ø–∞–∑–æ–Ω   | –°–º—ã—Å–ª                        |
| :-------------- | :----------------------------------------------- | :--------- | :--------------------------- |
| **base**        | `0.65`                                           | 0.65       | –í—Å–µ –Ω–∞—á–∏–Ω–∞—é—Ç –∑–¥–µ—Å—å           |
| **consistency** | `1 + clamp((1 - CV(dailyScores)) √ó 0.3, 0, 0.3)` | 1.0 ‚Äì 1.3  | –ù–∏–∑–∫–∞—è –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Üí –≤—ã—à–µ  |
| **diversity**   | `1 + activatedFactorTypes / 10 √ó 0.15`           | 1.0 ‚Äì 1.15 | –ë–æ–ª—å—à–µ —Ç–∏–ø–æ–≤ —Ñ–∞–∫—Ç–æ—Ä–æ–≤ ‚Üí –≤—ã—à–µ |
| **dataDepth**   | `+0.03 √ó –ø–æ–ª–Ω—ã—Ö_–Ω–µ–¥–µ–ª—å` (–¥–æ 4 –Ω–µ–¥–µ–ª—å)            | 0 ‚Äì 0.12   | –ö–∞–∂–¥–∞—è –Ω–µ–¥–µ–ª—è +3%            |

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ UI (CRS Progress Bar)

–î–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ CRS –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä, –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤
–Ω–∏–∂–Ω–µ–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–µ –º–µ–Ω—é (`AppTabsNav`).

**–î–∏–∑–∞–π–Ω –∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:**

- **–ü–æ–∑–∏—Ü–∏—è:** –í —Å–∞–º–æ–º –Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞, –ø–æ–¥ –∫–Ω–æ–ø–∫–∞–º–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ (–ø—Ä–∏–≤—è–∑–∞–Ω –∫ –Ω–∏–∑—É
  –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ `.tabs`).
- **–í—ã—Å–æ—Ç–∞:** 4px (—Ç–æ–Ω–∫–∞—è, —ç–ª–µ–≥–∞–Ω—Ç–Ω–∞—è –ª–∏–Ω–∏—è —Å –ª–µ–≥–∫–∏–º —Ñ–æ–Ω–æ–º-—Ç—Ä–µ–∫–æ–º).
- **–¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞ (Neon):**
  - –õ–µ–≤–∞—è —á–∞—Å—Ç—å (–æ—Ç 0 –¥–æ —Ç–µ–∫—É—â–µ–≥–æ CRS): **–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–µ–ª—ë–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç**
    (`#10b981` ‚Üí `#34d399`).
  - –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å (–æ—Ç —Ç–µ–∫—É—â–µ–≥–æ CRS –¥–æ 100%): **–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç** (–∫—Ä–∞—Å–Ω—ã–π
    —É —Ü–µ–Ω—Ç—Ä–∞ `#dc2626` ‚Üí –æ—Ä–∞–Ω–∂–µ–≤—ã–π `#f97316` ‚Üí –∂—ë–ª—Ç—ã–π —É –ø—Ä–∞–≤–æ–≥–æ –∫—Ä–∞—è `#fde047`).
    –¶–≤–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ–∑–∏—Ü–∏–µ–π –Ω–∞ —à–∫–∞–ª–µ, –∞ –Ω–µ –∑–Ω–∞—á–µ–Ω–∏–µ–º CRS, —á—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç
    –º–µ—Ä—Ü–∞–Ω–∏–µ –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ —Ç–æ—á–∫–∏.
  - –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å: –°–≤–µ—Ç—è—â–∞—è—Å—è –±–µ–ª–∞—è —Ç–æ—á–∫–∞ (8x8px) —Å —Å–∏–ª—å–Ω—ã–º –Ω–µ–æ–Ω–æ–≤—ã–º –æ—Ä–µ–æ–ª–æ–º –∏
    –ø—É–ª—å—Å–∏—Ä—É—é—â–µ–π –∞–Ω–∏–º–∞—Ü–∏–µ–π.
- **–ê–Ω–∏–º–∞—Ü–∏—è:**
  - **–ü–æ—è–≤–ª–µ–Ω–∏–µ:** –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ª–∏–Ω–∏–∏ –ø–ª–∞–≤–Ω–æ —Ä–∞–∑—ä–µ–∑–∂–∞—é—Ç—Å—è –∏–∑ —Ü–µ–Ω—Ç—Ä–∞ (50%) –≤
    —Ä–∞–∑–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã (–∑–µ–ª–µ–Ω–∞—è –≤–ª–µ–≤–æ, –æ—Ä–∞–Ω–∂–µ–≤–∞—è –≤–ø—Ä–∞–≤–æ), –∞ —Ç–æ—á–∫–∞-—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
    –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Å —ç—Ñ—Ñ–µ–∫—Ç–æ–º `scale`.
  - **–û–∂–∏–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (–ú–∞—è—Ç–Ω–∏–∫):** –ü–æ–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∂–¥–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –æ–±–ª–∞–∫–∞ (–¥–æ
    —Å–æ–±—ã—Ç–∏—è `heysSyncCompleted`), —Ç–æ—á–∫–∞-—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –ø–ª–∞–≤–Ω–æ –ø–æ–∫–∞—á–∏–≤–∞–µ—Ç—Å—è
    –≤–ª–µ–≤–æ-–≤–ø—Ä–∞–≤–æ (¬±5% –æ—Ç —Ü–µ–Ω—Ç—Ä–∞) –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã, —Å–æ–∑–¥–∞–≤–∞—è —ç—Ñ—Ñ–µ–∫—Ç "–ø–æ–∏—Å–∫–∞" –∏–ª–∏
    "–≤–∑–≤–µ—à–∏–≤–∞–Ω–∏—è" –¥–∞–Ω–Ω—ã—Ö.
  - **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è:** –ö–∞–∫ —Ç–æ–ª—å–∫–æ –æ–±–ª–∞—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –∏
    –ø–æ–ª—É—á–µ–Ω —Ñ–∏–Ω–∞–ª—å–Ω—ã–π CRS, –º–∞—è—Ç–Ω–∏–∫ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, –∏ —Ç–æ—á–∫–∞ –ø–ª–∞–≤–Ω–æ –ø–µ—Ä–µ–µ–∑–∂–∞–µ—Ç –∫
    —Ä–µ–∞–ª—å–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é CRS.
  - **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ CRS —Ç–æ—á–∫–∞ –ø–ª–∞–≤–Ω–æ –ø–µ—Ä–µ–µ–∑–∂–∞–µ—Ç –Ω–∞ –Ω–æ–≤—É—é –ø–æ–∑–∏—Ü–∏—é,
    –∞ –ª–∏–Ω–∏–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –º–µ–Ω—è—é—Ç —à–∏—Ä–∏–Ω—É, —Å–æ–∑–¥–∞–≤–∞—è —ç—Ñ—Ñ–µ–∫—Ç –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
    (`transition: width 1.8s ease-in-out, left 1.8s...`).
  - **–ü—É–ª—å—Å–∞—Ü–∏—è:** –ë–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è –ø—É–ª—å—Å–∞—Ü–∏—è —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è (`@keyframes crs-pulse`).

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

1. **–ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** `computeCascadeState` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤
   `window.HEYS._lastCrs` –∏ –≤—ã–∑—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ `heys:crs-updated`.
2. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –æ–±–ª–∞–∫–æ–º:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `CrsProgressBar` –∂–µ—Å—Ç–∫–æ –ø—Ä–∏–≤—è–∑–∞–Ω –∫
   –∂–∏–∑–Ω–µ–Ω–Ω–æ–º—É —Ü–∏–∫–ª—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –û–Ω –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–ª–∞–≥ `window.HEYS.syncCompletedAt`
   –∏ —Å–ª—É—à–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ `heysSyncCompleted`, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –¥–æ–∂–¥–∞—Ç—å—Å—è
   —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –æ–±–ª–∞–∫–∞ –∏ –∏–∑–±–µ–∂–∞—Ç—å "–¥–≤–æ–π–Ω—ã—Ö –ø—Ä—ã–∂–∫–æ–≤" (—Å–Ω–∞—á–∞–ª–∞ –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É
   –∫—ç—à—É, –∑–∞—Ç–µ–º –∫ –æ–±–ª–∞—á–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é).
3. **React –ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** `HEYS.CascadeCard.CrsProgressBar` –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞
   —Å–æ–±—ã—Ç–∏—è `heys:crs-updated` –∏ `heysSyncCompleted`, –ª–æ–∫–∞–ª—å–Ω–æ —Ö—Ä–∞–Ω–∏—Ç `crsData` –∏
   —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–∞–∑–∞–º–∏ –∞–Ω–∏–º–∞—Ü–∏–∏ (`isLoaded`, `isSettled`, `loadingOffset`).
4. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:** –ü—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ `AppTabsNav` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ
   `HEYS._lastCrs`. –ï—Å–ª–∏ –ø—É—Å—Ç–æ ‚Äî –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç `computeCascadeState`
   –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –¥–Ω—è, —á—Ç–æ–±—ã –±–∞—Ä –æ—Ç–æ–±—Ä–∞–∑–∏–ª—Å—è —Å—Ä–∞–∑—É, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ
   –∑–∞—Ö–æ–¥–∏–ª –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–î–Ω–µ–≤–Ω–∏–∫".
5. **CSS:** –ö–ª–∞—Å—Å—ã `.crs-bar-container`, `.crs-bar-green`, `.crs-bar-orange`,
   `.crs-bar-divider` –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `000-base-and-gamification.css` —Å —É—á–µ—Ç–æ–º
   `safe-area-inset-bottom`.

**–ü—Ä–∏–º–µ—Ä—ã:**

| –ü—Ä–æ—Ñ–∏–ª—å                              | ceiling | –ü–æ—è—Å–Ω–µ–Ω–∏–µ                        |
| :----------------------------------- | :------ | :------------------------------- |
| –ù–æ–≤–∏—á–æ–∫, 3 –¥–Ω—è –¥–∞–Ω–Ω—ã—Ö                | ~0.65   | –¢–æ–ª—å–∫–æ base, –Ω–µ—Ç depth           |
| 1 –Ω–µ–¥–µ–ª—è, –µ–¥–∞ + —Å–æ–Ω                  | ~0.72   | base + 1 week + 2 factors        |
| 2 –Ω–µ–¥–µ–ª–∏, —Å—Ç–∞–±–∏–ª—å–Ω—ã–π, 5 —Ñ–∞–∫—Ç–æ—Ä–æ–≤     | ~0.82   | consistency 1.2 + diversity 1.08 |
| 4 –Ω–µ–¥–µ–ª–∏, —Ä–∞–∑–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π, —Å—Ç–∞–±–∏–ª—å–Ω—ã–π | ~1.0    | –ú–∞–∫—Å–∏–º—É–º ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞—Å–∫—Ä—ã—Ç—ã–π   |

**CV (Coefficient of Variation)** = stdev(dailyScores) / mean(dailyScores).
–ù–∏–∑–∫–∏–π CV = —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ ‚Üí –º–Ω–æ–∂–∏—Ç–µ–ª—å –¥–æ 1.3.

**Activated Factor Types** = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ñ–∞–∫—Ç–æ—Ä–æ–≤, –ø–æ –∫–æ—Ç–æ—Ä—ã–º
–µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ —Ö–æ—Ç—è –±—ã –∑–∞ 3 –∏–∑ 30 –¥–Ω–µ–π (–µ–¥–∞, —Å–æ–Ω, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, —à–∞–≥–∏, —á–µ–∫–∏–Ω, –∑–∞–º–µ—Ä—ã,
–≤–∏—Ç–∞–º–∏–Ω—ã, –∏–Ω—Å—É–ª–∏–Ω, NEAT).

### 5. –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ü–∏—è DCS –≤ localStorage

```
–ö–ª—é—á: heys_{clientId}_cascade_dcs_v7   (v3.5.0: chronotype-adaptive meals, MT=8.5)
–§–æ—Ä–º–∞—Ç: JSON { "2026-02-20": 0.72, "2026-02-19": 0.85, ... }
```

- –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ `computeCascadeState` –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –¥–Ω—è
- –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞: –∑–∞–ø–∏—Å–∏ —Å—Ç–∞—Ä—à–µ 35 –¥–Ω–µ–π —É–¥–∞–ª—è—é—Ç—Å—è
- **–ù–µ —à–∏—Ñ—Ä—É–µ—Ç—Å—è** ‚Äî –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç PII (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `heys_products`)
- –î–ª—è –¥–Ω–µ–π –±–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ DCS ‚Äî —Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω–æ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∏–∑ `dayv2` –¥–∞–Ω–Ω—ã—Ö
  (**v3.5.0: —Ö—Ä–æ–Ω–æ—Ç–∏–ø-–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–æ–ª–æ—Å—ã –ø—Ä–∏—ë–º–æ–≤** ‚Äî –ø–æ—Ä–æ–≥–∏ —Å–¥–≤–∏–≥–∞—é—Ç—Å—è –Ω–∞
  `mealBandShift = max(-30, optimalOnset - 1380)` –º–∏–Ω; breakfast 1.25, daytime
  1.10, –ø–æ–∑–¥–Ω–∏–π (21:00+shift ‚Üí 23:00+shift) 0.70, hard violation (‚â•23:00+shift)
  ‚àí1.0; –¥–µ—Ñ–æ–ª—Ç +0.3 –¥–ª—è –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–≥–æ —Å–Ω–∞; —Å–∏–Ω–µ—Ä–≥–∏–∏ 0.25/0.45/0.65/0.80;
  streak-aware checkin, adaptive household, sigmoid —Å–Ω–∞, bell-curve
  –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, tanh —à–∞–≥–∏, insulin gap proxy, —Ö—Ä–æ–Ω–æ—Ç–∏–ø –∏–∑ –æ–∫—Ä–µ—Å—Ç–Ω—ã—Ö –¥–Ω–µ–π)

**–ò—Å—Ç–æ—Ä–∏—è –º–∏–≥—Ä–∞—Ü–∏–π –∫—ç—à–∞:**

| –í–µ—Ä—Å–∏—è | –ú–∏–≥—Ä–∞—Ü–∏—è                              | –ü—Ä–∏—á–∏–Ω–∞                                                                                                            |
| :----- | :------------------------------------ | :----------------------------------------------------------------------------------------------------------------- |
| v1‚Üív2  | positive DCS √ó1.2, negative kept      | MOMENTUM_TARGET 12‚Üí10                                                                                              |
| v2‚Üív3  | –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è DCS –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ (-0.6, 0) | Deficit penalties –±–µ–∑ training tolerance (v3.3.0)                                                                  |
| v3‚Üív4  | –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ + –ø–µ—Ä–µ—Å—á—ë—Ç             | –†–µ—Ç—Ä–æ–∞–∫—Ç–∏–≤–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ v1-v3 –∑–∞–≤—ã—à–∞–ª–∞ DCS –Ω–∞ 50-100% (v3.4.0)                                                       |
| v4‚Üív5  | –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ + –ø–µ—Ä–µ—Å—á—ë—Ç             | v4 —Ä–µ—Ç—Ä–æ —Ñ–æ—Ä–º—É–ª–∞ –∑–∞–Ω–∏–∂–∞–ª–∞ DCS –Ω–∞ ~30% (flat 0.65/meal, –Ω–µ—Ç streak/synergy, v3.4.1)                                 |
| v5‚Üív6  | –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ + –ø–µ—Ä–µ—Å—á—ë—Ç             | v5 meal weights –∑–∞–Ω–∏–∂–µ–Ω—ã –Ω–∞ ~10-15% (0.95 vs full algo 1.05-1.15), –Ω–µ—Ç missing-sleep default (v3.4.2)              |
| v6‚Üív7  | –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ + –ø–µ—Ä–µ—Å—á—ë—Ç             | v6 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä–æ–≥ 23:00 –¥–ª—è –µ–¥—ã –∏ MT=10.0. v7 –≤–≤–æ–¥–∏—Ç —Ö—Ä–æ–Ω–æ—Ç–∏–ø-–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–æ–ª–æ—Å—ã –∏ MT=8.5 (v3.5.0) |

### 6. CRS-driven —Å–æ—Å—Ç–æ—è–Ω–∏—è (–∑–∞–º–µ–Ω–∞ score-driven)

| –°–æ—Å—Ç–æ—è–Ω–∏–µ  | –ò–∫–æ–Ω–∫–∞ | –£—Å–ª–æ–≤–∏–µ    | –õ–µ–π–±–ª                | v2.2.0 (–±—ã–ª–æ) |
| :--------- | :----- | :--------- | :------------------- | :------------ |
| `STRONG`   | üî•     | CRS ‚â• 0.75 | –£—Å—Ç–æ–π—á–∏–≤—ã–π –∏–º–ø—É–ª—å—Å   | score ‚â• 8.0   |
| `GROWING`  | ‚ö°     | CRS ‚â• 0.45 | –ö–∞—Å–∫–∞–¥ –Ω–∞–±–∏—Ä–∞–µ—Ç —Å–∏–ª—É | score ‚â• 4.5   |
| `BUILDING` | üîó     | CRS ‚â• 0.20 | –ò–º–ø—É–ª—å—Å —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è  | score ‚â• 1.5   |
| `RECOVERY` | üå±     | CRS > 0.05 | –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ          | score > 0     |
| `BROKEN`   | üí™     | CRS ‚â§ 0.05 | –ù–∞—á–Ω–∏ —Å –º–∞–ª–æ–≥–æ       | score ‚â§ 0     |
| `EMPTY`    | üåÖ     | –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö | –ù–∞—á–Ω–∏ –¥–µ–Ω—å           | –Ω–µ—Ç —Å–æ–±—ã—Ç–∏–π   |

**–ö–ª—é—á–µ–≤–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ**: –ø—Ä–∏ CRS ‚â• 0.45 (GROWING) –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å—Ç–∞—Ç—å BROKEN –∏–∑-–∑–∞
–æ–¥–Ω–æ–≥–æ –ø–ª–æ—Ö–æ–≥–æ –¥–Ω—è. –ë—ã–≤–∞–ª—ã–π —é–∑–µ—Ä —Å CRS 0.78 –ø–æ—Å–ª–µ –æ–¥–Ω–æ–≥–æ –ø–ª–æ—Ö–æ–≥–æ —Å–Ω–∞:
`Œîcrs ‚âà ‚àí0.02 ‚Üí CRS ‚âà 0.76 ‚Üí –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É STRONG üî•`.

### 7. –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä: CRS –≤–º–µ—Å—Ç–æ dailyScore

```
v2.2.0:  momentumScore = min(1, max(0, score) / 12.0)     ‚Äî –æ–¥–Ω–æ–¥–Ω–µ–≤–Ω—ã–π
v3.0.0:  momentumScore = crs                                ‚Äî –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–π
```

–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Ç–µ–ø–µ—Ä—å –æ—Ç—Ä–∞–∂–∞–µ—Ç **–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å**, –∞ –Ω–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–¥–Ω–æ–≥–æ
–¥–Ω—è.

### 8. –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

| –°–æ—Å—Ç–æ—è–Ω–∏–µ  | –°–æ–æ–±—â–µ–Ω–∏—è (CRS-–∫–æ–Ω—Ç–µ–∫—Å—Ç)                                                |
| :--------- | :---------------------------------------------------------------------- |
| `STRONG`   | ¬´–£—Å—Ç–æ–π—á–∏–≤—ã–π –∏–º–ø—É–ª—å—Å. –¢—ã –Ω–∞ –ø–∏–∫–µ ‚Äî –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä–∏–≤—ã—á–∫—É.¬ª   |
|            | ¬´–ú–æ—â–Ω–∞—è –∏–Ω–µ—Ä—Ü–∏—è. –î–∞–∂–µ –Ω–µ–±–æ–ª—å—à–æ–π —Å–±–æ–π –Ω–µ –ø–µ—Ä–µ—á–µ—Ä–∫–Ω—ë—Ç —Ç–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å.¬ª     |
|            | ¬´–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç. –î–≤–µ+ –Ω–µ–¥–µ–ª–∏ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π ‚Äî —ç—Ç–æ —É–∂–µ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç.¬ª |
| `GROWING`  | ¬´–ö–∞—Å–∫–∞–¥ –Ω–∞–±–∏—Ä–∞–µ—Ç —Å–∏–ª—É. –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –¥–µ–Ω—å –∑–∞ –¥–Ω—ë–º.¬ª |
|            | ¬´–ù–∞ –≤–æ—Å—Ö–æ–¥—è—â–µ–π. –ö–∞–∂–¥—ã–π —Ö–æ—Ä–æ—à–∏–π –¥–µ–Ω—å –ø–æ–¥–Ω–∏–º–∞–µ—Ç —Ç–µ–±—è –≤—ã—à–µ.¬ª               |
|            | ¬´–ü—Ä–æ–≥—Ä–µ—Å—Å –≤–∏–¥–µ–Ω. –ï—â—ë –Ω–µ–º–Ω–æ–≥–æ ‚Äî –∏ –∏–º–ø—É–ª—å—Å —Å—Ç–∞–Ω–µ—Ç —É—Å—Ç–æ–π—á–∏–≤—ã–º.¬ª            |
| `BUILDING` | ¬´–ò–º–ø—É–ª—å—Å —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è. –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞—á–∏–Ω–∞—é—Ç —Å–∫–ª–∞–¥—ã–≤–∞—Ç—å—Å—è.¬ª       |
|            | ¬´–ü–µ—Ä–≤—ã–µ –¥–Ω–∏ ‚Äî —Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ. –ö–∞–∂–¥–æ–µ —Ä–µ—à–µ–Ω–∏–µ –∑–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç.¬ª      |
| `RECOVERY` | ¬´–û–¥–∏–Ω —à–∞–≥ –Ω–∞–∑–∞–¥ –Ω–µ –æ—Ç–º–µ–Ω—è–µ—Ç –Ω–µ–¥–µ–ª—é –ø—Ä–æ–≥—Ä–µ—Å—Å–∞. –¢—ã —É–∂–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—à—å—Å—è.¬ª    |
|            | ¬´–ò–º–ø—É–ª—å—Å —Å–Ω–∏–∑–∏–ª—Å—è, –Ω–æ –Ω–µ –æ–±–Ω—É–ª–∏–ª—Å—è. –û–¥–∏–Ω —Ö–æ—Ä–æ—à–∏–π –¥–µ–Ω—å ‚Äî –∏ —Ç—ã –Ω–∞ –ø—É—Ç–∏.¬ª  |
| `BROKEN`   | ¬´–ù–∞—á–Ω–∏ —Å –º–∞–ª–æ–≥–æ ‚Äî –∫–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç –Ω–æ–≤—ã–π –∫–∞—Å–∫–∞–¥.¬ª              |
|            | ¬´–ù—É–ª–µ–≤–æ–π –∏–º–ø—É–ª—å—Å ‚Äî —ç—Ç–æ —á–∏—Å—Ç—ã–π —Å—Ç–∞—Ä—Ç. –ü–µ—Ä–≤—ã–π –¥–µ–Ω—å —Å—Ç—Ä–æ–∏—Ç –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ.¬ª |

### 9. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ cascadeState

–ù–æ–≤—ã–µ –ø–æ–ª—è –≤ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–º –æ–±—ä–µ–∫—Ç–µ `computeCascadeState`:

```js
{
  // ...—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è (events, chainLength, score, warnings, state, ...)...

  // NEW in v3.0.0 ‚Äî Cascade Rate Score
  crs:                  number,        // 0‚Äì1, –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–π –∏–º–ø—É–ª—å—Å
  crsBase:              number,        // 0‚Äì1, EMA completed days only (v3.6.0)
  todayBoost:           number,        // 0‚Äì0.03, DCS √ó CRS_TODAY_BOOST (v3.6.0)
  ceiling:              number,        // 0‚Äì1, –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–ª–æ–∫
  dailyContribution:    number,        // ‚àí1..1, –≤–∫–ª–∞–¥ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–≥–æ –¥–Ω—è (DCS)
  dailyMomentum:        number,        // 0‚Äì1, dailyScore / MOMENTUM_TARGET
  hasCriticalViolation: boolean,       // critical violation –æ–±–æ—à–ª–∞ –∏–Ω–µ—Ä—Ü–∏—é?
  crsTrend:             'up' | 'down' | 'flat',  // –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ CRS –∑–∞ 7 –¥–Ω–µ–π
  daysAtPeak:           number,        // –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥ DCS ‚â• 0.5
  dcsHistory:           { [date]: number },  // –≤—Å—è –∏—Å—Ç–æ—Ä–∏—è DCS
  historicalDays:       HistoricalDay[],  // —Å–æ–±—ã—Ç–∏—è –ø—Ä–æ—à–ª—ã—Ö –¥–Ω–µ–π
  // NEW in v3.1.0 ‚Äî Goal-aware:
  hasDeficitOvershoot:  boolean,       // –¥–µ—Ñ–∏—Ü–∏—Ç-mode + –ø–µ—Ä–µ–±–æ—Ä –∫–∫–∞–ª?
  deficitOvershootRatio: number|null,  // –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–µ—Ä–µ–±–æ—Ä–∞
  goalMode:             string|null    // 'deficit' | 'bulk' | 'maintenance'
}
```

### 10. UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞: –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–ë–µ–π–¥–∂–∏–∫**: –≤–º–µ—Å—Ç–æ `chainLength ‚ö°` ‚Üí CRS –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö: `78% ‚ö°`

**–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä**: –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç CRS (0‚Äì100%) –≤–º–µ—Å—Ç–æ –¥–Ω–µ–≤–Ω–æ–≥–æ score.

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** (–≤ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–æ–º –≤–∏–¥–µ):

```
v2.2.0:  üèÜ –ú–∞–∫—Å. —Ü–µ–ø–æ—á–∫–∞: 3    ‚ö° –ò–º–ø—É–ª—å—Å: 43%
v3.0.0:  üìà –ò–º–ø—É–ª—å—Å: 78/85%     ‚Üë –¢—Ä–µ–Ω–¥: —Ä–∞—Å—Ç—ë—Ç
         üíé –ü–æ—Ç–æ–ª–æ–∫: 85%         üî• –ù–∞ –ø–∏–∫–µ: 3 –¥–Ω—è
```

**Daily events**: chain dots –∏ timeline –æ—Å—Ç–∞—é—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å (–ø–æ–∫–∞–∑—ã–≤–∞—é—Ç
—Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è ‚Äî –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –∏–Ω—Ç—Ä–∞–¥–Ω–µ–≤–Ω–æ–≥–æ —Ñ–∏–¥–±–µ–∫–∞).

### 11. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ CRS

```javascript
console.info('[HEYS.cascade.crs] üìà CRS (Cascade Rate Score) v3.6.0:', {
  crsBase: 0.78,
  todayBoost: 0.014,
  crs: 0.794,
  formula: 'CRS_base(0.780) + DCS(0.466) √ó 0.03 = 0.794',
  ceiling: 0.85,
  dcsToday: 0.466,
  dcsHistoryDays: 18,
  emaDecay: 0.95,
  window: '30 days (completed only)',
});

console.info('[HEYS.cascade.crs] üìä DCS history (last 7d):', {
  scores: [0.72, 0.85, 0.68, 0.91, 0.73, 0.8, -0.15],
  avgDCS: 0.65,
  trend: 'stable',
});

console.info('[HEYS.cascade.crs] üèîÔ∏è Ceiling computation:', {
  base: 0.65,
  consistency: 1.22,
  diversity: 1.08,
  dataDepth: 0.06,
  ceiling: 0.85,
  activatedFactors: ['meal', 'sleep', 'training', 'checkin', 'steps'],
});

// v3.1.0: goal-aware DCS override (deficit mode)
console.info('[HEYS.cascade.deficit] üìä Goal-aware DCS override:', {
  level: 2,
  ratio: 1.18,
  criticalOver: 1.15,
  targetMax: 1.05,
  appliedPenalty: -0.5,
  violationType: 'deficit_overshoot',
});
```

### 12. –§–æ—Ä–º—É–ª—ã ‚Äî —Å–≤–æ–¥–∫–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  DAILY CONTRIBUTION SCORE (DCS)                                 ‚îÇ
‚îÇ  dcs = clamp(dailyScore / 8.5, -0.3, 1.0)   // v3.5.0          ‚îÇ
‚îÇ  Critical override: night_harm ‚Üí -0.8, excess ‚Üí -0.6, both ‚Üí -1‚îÇ
‚îÇ  Training-day deficit: –ø–æ—Ä–æ–≥–∏ √ó 1.2 (v3.3.0)                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  CASCADE RATE SCORE (CRS) ‚Äî v3.6.0                              ‚îÇ
‚îÇ  CRS = CRS_base + todayBoost                                    ‚îÇ
‚îÇ  CRS_base: EMA of completed days (i‚â•1), Œ±=0.95, 30-day window  ‚îÇ
‚îÇ    weights[i-1] = 0.95^(i-1)  (yesterday=1.0, 2d ago=0.95...)  ‚îÇ
‚îÇ    crs_base = Œ£(w√ódcs) / Œ£(w for days with data)                ‚îÇ
‚îÇ  todayBoost = max(0, DCS_today) √ó 0.03  (0..+3%)               ‚îÇ
‚îÇ  CRS = clamp(CRS_base + todayBoost, 0, ceiling)                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  CEILING (–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–ª–æ–∫)                               ‚îÇ
‚îÇ  ceiling = min(1.0, 0.65 √ó consistency √ó diversity + dataDepth) ‚îÇ
‚îÇ  consistency = 1 + clamp((1 - CV) √ó 0.3, 0, 0.3)               ‚îÇ
‚îÇ  diversity = 1 + activatedTypes/10 √ó 0.15                       ‚îÇ
‚îÇ  dataDepth = 0.03 √ó fullWeeks (max 4)                           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  STATE THRESHOLDS (CRS-driven)                                  ‚îÇ
‚îÇ  STRONG ‚â• 0.75 | GROWING ‚â• 0.45 | BUILDING ‚â• 0.20              ‚îÇ
‚îÇ  RECOVERY > 0.05 | BROKEN ‚â§ 0.05                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 13. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è CRS

| –°—Ü–µ–Ω–∞—Ä–∏–π                         | –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç                          |
| :------------------------------- | :------------------------------------------- |
| 14 —Ö–æ—Ä–æ—à–∏—Ö –¥–Ω–µ–π + 1 –ø–ª–æ—Ö–æ–π —Å–æ–Ω   | CRS ‚âà 0.68, GROWING (–Ω–µ BROKEN)              |
| 7 —Ö–æ—Ä–æ—à–∏—Ö –¥–Ω–µ–π + 1 –ø–ª–æ—Ö–æ–π        | CRS ‚âà 0.50, GROWING (–∏–Ω–µ—Ä—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç)       |
| 3 —Ö–æ—Ä–æ—à–∏—Ö –¥–Ω—è + 2 –ø–ª–æ—Ö–∏—Ö         | CRS ‚âà 0.15, RECOVERY (–º–∞–ª–æ –∏–Ω–µ—Ä—Ü–∏–∏)          |
| 0 –¥–Ω–µ–π –∏—Å—Ç–æ—Ä–∏–∏                   | CRS = 0, BROKEN ‚Üí –ø–æ—Å–ª–µ 3 —Ö–æ—Ä–æ—à–∏—Ö ‚Üí BUILDING |
| –ù–æ—á–Ω–æ–π —Å—Ä—ã–≤ (harm ‚â• 7 –ø–æ—Å–ª–µ 00)  | DCS = ‚àí0.8, CRS –ø–∞–¥–∞–µ—Ç –∑–∞–º–µ—Ç–Ω–æ (‚àí30..50%)    |
| 4 –Ω–µ–¥–µ–ª–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è   | CRS ‚Üí ceiling (–¥–æ 1.0), STRONG               |
| 2 –Ω–µ–¥–µ–ª–∏ —Ö–æ—Ä–æ—à–æ + 1 –Ω–µ–¥–µ–ª—è –ø–ª–æ—Ö–æ | CRS –ø–ª–∞–≤–Ω–æ —Å–Ω–∏–∂–∞–µ—Ç—Å—è, –Ω–µ –æ–±–≤–∞–ª–∏–≤–∞–µ—Ç—Å—è        |
| **–î–µ—Ñ–∏—Ü–∏—Ç + 110% –∫–∫–∞–ª** (v3.1.0) | DCS clamp –æ—Å–ª–∞–±–ª–µ–Ω –¥–æ ‚àí0.4 (level 1)         |
| **–î–µ—Ñ–∏—Ü–∏—Ç + 120% –∫–∫–∞–ª** (v3.1.0) | DCS override ‚àí0.5, DEFICIT_OVERSHOOT (l2)    |
| **–î–µ—Ñ–∏—Ü–∏—Ç + 160% –∫–∫–∞–ª** (v3.1.0) | DCS override ‚àí0.7, —Å–∏–ª—å–Ω–µ–µ generic (l3)      |
| **–ù–∞–±–æ—Ä + 140% –∫–∫–∞–ª** (v3.1.0)   | Penalty —Å–Ω—è—Ç (bulk exempt ‚â§ 180%)            |

```javascript
// –ö–æ–Ω—Å–æ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:
HEYS.CascadeCard.computeCascadeState(
  HEYS.day,
  HEYS.dayTot,
  HEYS.normAbs,
  HEYS.prof,
  HEYS.pIndex,
);
// ‚Üí { crs: 0.78, ceiling: 0.85, crsTrend: 'up', state: 'STRONG', ... }
```

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ö–æ–Ω—Ü–µ–ø—Ü–∏—è](#1-–∫–æ–Ω—Ü–µ–ø—Ü–∏—è)
2. [–§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞](#2-—Ñ–∞–π–ª–æ–≤–∞—è-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
3. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è](#3-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–º–æ–¥—É–ª—è)
4. [–î–≤–∏–∂–æ–∫: computeCascadeState](#4-–¥–≤–∏–∂–æ–∫-computecascadestate)
5. [–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö](#5-–º–æ–¥–µ–ª—å-–¥–∞–Ω–Ω—ã—Ö)
6. [–°–æ—Å—Ç–æ—è–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏](#6-—Å–æ—Å—Ç–æ—è–Ω–∏—è-–∫–∞—Ä—Ç–æ—á–∫–∏)
7. [–ê–ª–≥–æ—Ä–∏—Ç–º —Ü–µ–ø–æ—á–∫–∏](#7-–∞–ª–≥–æ—Ä–∏—Ç–º-—Ü–µ–ø–æ—á–∫–∏)
8. [–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã React](#8-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã-react)
9. [–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è](#9-–∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ-—Å–æ–æ–±—â–µ–Ω–∏—è)
10. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ](#10-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-–≤-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
11. [CSS –∏ —Å—Ç–∏–ª–∏](#11-css-–∏-—Å—Ç–∏–ª–∏)
12. [–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞](#12-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ-–∏-–æ—Ç–ª–∞–¥–∫–∞)
13. [API –º–æ–¥—É–ª—è](#13-api-–º–æ–¥—É–ª—è)
14. [–†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å](#14-—Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)
15. [–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è](#15-–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è)
16. [Cascade Rate Score (CRS) v1.0](#cascade-rate-score-crs-v10--–∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–π-–∏–º–ø—É–ª—å—Å)

---

## 1. –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

**¬´–í–∞—à –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∫–∞—Å–∫–∞–¥¬ª** ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ –≤ Day View, –∫–æ—Ç–æ—Ä–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ü–µ–ø–æ—á–∫—É
–∑–¥–æ—Ä–æ–≤—ã—Ö —Ä–µ—à–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –∑–∞ —Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å.

**–ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞** (–±–µ–∑ –Ω–∞—É—á–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤):

- –ö–∞–∂–¥–æ–µ –ø–æ–∑–∏—Ç–∏–≤–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–≤–µ–Ω–æ –≤ —Ü–µ–ø–æ—á–∫—É
- –ù–∞—Ä—É—à–µ–Ω–∏–µ **—É–º–µ–Ω—å—à–∞–µ—Ç** —Ü–µ–ø–æ—á–∫—É (–Ω–µ –æ–±–Ω—É–ª—è–µ—Ç), –∫–∞—Ä—Ç–æ—á–∫–∞ —Å—Ä–∞–∑—É –≥–æ–≤–æ—Ä–∏—Ç ¬´–Ω–µ –≤—Å—ë
  –ø–æ—Ç–µ—Ä—è–Ω–æ¬ª
- 2 —á–∞—Å–∞ –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –∞–Ω—Ç–∏–ª–∏—Ü–µ–Ω–∑–∏—Ä—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
  (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç ¬´–∑–∞—Å–ª—É–∂–µ–Ω–Ω—É—é¬ª –ø–µ—Ä–µ–µ–¥–∫—É)
- RECOVERY-—Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–æ—â—Ä—è–µ—Ç –≤–æ–∑–≤—Ä–∞—Ç –ø–æ—Å–ª–µ —Å—Ä—ã–≤–∞

**–ú–µ—Å—Ç–æ –≤ UI:** –º–µ–∂–¥—É Goal Progress Bar –∏ Refeed Card –≤ `renderDiarySection`.

---

## 2. –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

| –§–∞–π–ª                                           | –¢–∏–ø              | –û–ø–∏—Å–∞–Ω–∏–µ                                   |
| ---------------------------------------------- | ---------------- | ------------------------------------------ |
| `apps/web/heys_cascade_card_v1.js`             | JS (~3790 —Å—Ç—Ä–æ–∫) | –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å: –¥–≤–∏–∂–æ–∫ + React-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã |
| `apps/web/styles/modules/740-cascade-card.css` | CSS              | –°—Ç–∏–ª–∏ standalone-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞                |

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

| –§–∞–π–ª                                 | –ò–∑–º–µ–Ω–µ–Ω–∏–µ                                                        |
| ------------------------------------ | ---------------------------------------------------------------- |
| `apps/web/heys_day_diary_section.js` | –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∏ –≤—Å—Ç–∞–≤–∫–∞ `cascadeCard` –≤–Ω—É—Ç—Ä–∏ `renderDiarySection()` |
| `apps/web/index.html`                | `<script defer src="heys_cascade_card_v1.js?v=1">`               |
| `apps/web/styles/main.css`           | `@import url("./modules/740-cascade-card.css")`                  |

---

## 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è

```
heys_cascade_card_v1.js
‚îÇ
‚îú‚îÄ‚îÄ CONSTANTS
‚îÇ   ‚îú‚îÄ‚îÄ STATES            ‚Äî 6 —Å–æ—Å—Ç–æ—è–Ω–∏–π –∫–∞—Ä—Ç–æ—á–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ STATE_CONFIG      ‚Äî –∏–∫–æ–Ω–∫–∞, —Ü–≤–µ—Ç, –ª–µ–π–±–ª –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ MESSAGES          ‚Äî –ø—É–ª—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (7 –ø—É–ª–æ–≤: BUILDING, GROWING, STRONG, BROKEN, RECOVERY, ANTI_LICENSING, DEFICIT_OVERSHOOT)
‚îÇ   ‚îî‚îÄ‚îÄ EVENT_ICONS       ‚Äî —ç–º–æ–¥–∑–∏ –∏–∫–æ–Ω–∫–∏ —Ç–∏–ø–æ–≤ —Å–æ–±—ã—Ç–∏–π
‚îÇ
‚îú‚îÄ‚îÄ UTILITIES
‚îÇ   ‚îú‚îÄ‚îÄ parseTime(str)           ‚Äî "HH:MM" ‚Üí –º–∏–Ω—É—Ç—ã –æ—Ç –ø–æ–ª—É–Ω–æ—á–∏
‚îÇ   ‚îú‚îÄ‚îÄ formatTimeShort(str)     ‚Äî –º–∏–Ω—É—Ç—ã ‚Üí "HH:MM"
‚îÇ   ‚îú‚îÄ‚îÄ pickMessage(pool, key)   ‚Äî –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–±–æ—Ä –ø–æ —á–∞—Å—É
‚îÇ   ‚îú‚îÄ‚îÄ isWithinHours(str, h)    ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –æ–∫–Ω–∞
‚îÇ   ‚îú‚îÄ‚îÄ getMealLabel(meal, i)    ‚Äî –º–µ—Ç–∫–∞ –ø—Ä–∏—ë–º–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
‚îÇ   ‚îú‚îÄ‚îÄ checkMealHarm(meal, pi) ‚Äî –Ω–∞–ª–∏—á–∏–µ product.harm ‚â• 7
‚îÇ   ‚îú‚îÄ‚îÄ getPreviousDays(n)       ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–µ N –¥–Ω–µ–π –∏–∑ localStorage
‚îÇ   ‚îú‚îÄ‚îÄ clamp(v, min, max)       ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ (v2.1.0)
‚îÇ   ‚îú‚îÄ‚îÄ median(arr)              ‚Äî –º–µ–¥–∏–∞–Ω–∞ –º–∞—Å—Å–∏–≤–∞ (v2.1.0)
‚îÇ   ‚îú‚îÄ‚îÄ stdev(arr)               ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (v2.1.0)
‚îÇ   ‚îú‚îÄ‚îÄ getPersonalBaseline()    ‚Äî 14-–¥–Ω–µ–≤–Ω–∞—è –º–µ–¥–∏–∞–Ω–∞ —Ñ–∞–∫—Ç–æ—Ä–∞ (v2.1.0)
‚îÇ   ‚îú‚îÄ‚îÄ getFactorConfidence()    ‚Äî 0..1 –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Å –ø–æ –æ–±—ä—ë–º—É –¥–∞–Ω–Ω—ã—Ö (v2.1.0)
‚îÇ   ‚îú‚îÄ‚îÄ countConsecutive()       ‚Äî —Å—Ç—Ä–∏–∫-–ø–æ–¥—Å—á—ë—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –¥–Ω–µ–π (v2.1.0)
‚îÇ   ‚îú‚îÄ‚îÄ getCircadianMultiplier() ‚Äî —Ü–∏—Ä–∫–∞–¥–Ω—ã–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (v2.1.0)
‚îÇ   ‚îú‚îÄ‚îÄ getTrainingDuration()    ‚Äî –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (v2.1.0)
‚îÇ   ‚îî‚îÄ‚îÄ getTrainingLoad()        ‚Äî dur √ó intensity multiplier (v2.1.0)
‚îÇ
‚îú‚îÄ‚îÄ ENGINE
‚îÇ   ‚îî‚îÄ‚îÄ computeCascadeState(day, dayTot, normAbs, prof, pIndex)
‚îÇ       ‚Äî 20-—à–∞–≥–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º, —á–∏—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç cascadeState
‚îÇ
‚îú‚îÄ‚îÄ REACT COMPONENTS (standalone, –Ω–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç HEYS.ExpandableCard)
‚îÇ   ‚îú‚îÄ‚îÄ ChainDots(props)         ‚Äî –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ —Ç–æ—á–µ–∫
‚îÇ   ‚îú‚îÄ‚îÄ CascadeTimeline(props)   ‚Äî —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–π —Ç–∞–π–º–ª–∞–π–Ω —Å–æ–±—ã—Ç–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ CascadeCard(props)       ‚Äî –≥–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (useState –¥–ª—è toggle)
‚îÇ
‚îî‚îÄ‚îÄ ENTRY POINT
    ‚îî‚îÄ‚îÄ renderCard(params)       ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –∏–∑ diary section
```

**–ü–∞—Ç—Ç–µ—Ä–Ω –º–æ–¥—É–ª—è:** IIFE `(function(global) { ... })(window)` ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç
–≤—Å–µ–º legacy-–º–æ–¥—É–ª—è–º (`heys_refeed_v1.js`, `heys_supplements_v1.js` –∏ –¥—Ä.)

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

- `global.React` ‚Äî –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω –¥–æ –º–æ–¥—É–ª—è
- `HEYS.dayUtils.getProductFromItem` –∏–ª–∏ `HEYS.models.getProductFromItem` ‚Äî –¥–ª—è
  —Ä–∞—Å—á—ë—Ç–∞ –∫–∫–∞–ª –∏ harm –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, graceful degradation –±–µ–∑ –Ω–∏—Ö)

---

## 4. –î–≤–∏–∂–æ–∫: computeCascadeState

```js
computeCascadeState(day, dayTot, normAbs, prof, pIndex) ‚Üí cascadeState
```

**–í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä  | –¢–∏–ø    | –û–ø–∏—Å–∞–Ω–∏–µ                                                          |
| --------- | ------ | ----------------------------------------------------------------- |
| `day`     | Object | –û–±—ä–µ–∫—Ç –¥–Ω—è: `meals[]`, `trainings[]`, `water`, `steps`            |
| `dayTot`  | Object | –î–Ω–µ–≤–Ω—ã–µ —Å—É–º–º–∞—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é, –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è) |
| `normAbs` | Object | –ê–±—Å–æ–ª—é—Ç–Ω—ã–µ –Ω–æ—Ä–º—ã: `normAbs.kcal` ‚Äî –∫–∞–ª–æ—Ä–∏–π–Ω–∞—è –Ω–æ—Ä–º–∞ –Ω–∞ –¥–µ–Ω—å       |
| `prof`    | Object | –ü—Ä–æ—Ñ–∏–ª—å: `water_norm` (–º–ª), `stepsGoal` / `steps_goal`            |
| `pIndex`  | Object | –ò–Ω–¥–µ–∫—Å –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –¥–ª—è `getProductFromItem`                         |

**–ê–ª–≥–æ—Ä–∏—Ç–º (20 —à–∞–≥–æ–≤, v2.1.0):**

```
–®–ê–ì 1  ‚Äî –ë—ã—Ç–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: adaptive baseline, log2-relative scoring, sub-quad streak
–®–ê–ì 2  ‚Äî –ü—Ä–∏—ë–º—ã –ø–∏—â–∏: continuous scoring + circadian modifier + sigmoid cumulative penalty
–®–ê–ì 3  ‚Äî –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏: training load (dur √ó intensity), sqrt-diminishing returns, recovery-aware
–®–ê–ì 4  ‚Äî –í—Ä–µ–º—è –∑–∞—Å—ã–ø–∞–Ω–∏—è: chronotype-adaptive sigmoid + consistency bonus + hard floor
–®–ê–ì 5  ‚Äî –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–Ω–∞: personalized bell-curve + asymmetric penalty + training recovery
–®–ê–ì 6  ‚Äî –®–∞–≥–∏: rolling adaptive goal, tanh continuous scoring
–®–ê–ì 7  ‚Äî –ß–µ–∫-–∏–Ω: streak bonus (consecutive +0.05/day) + trend awareness + habit break penalty
–®–ê–ì 8  ‚Äî –ó–∞–º–µ—Ä—ã —Ç–µ–ª–∞: smart cadence (weekly optimal) + completeness score + diminishing daily
–®–ê–ì 9  ‚Äî –í–∏—Ç–∞–º–∏–Ω—ã: continuous ratio scoring + streak bonus + habit break penalty
–®–ê–ì 10 ‚Äî –ò–Ω—Å—É–ª–∏–Ω–æ–≤—ã–µ –≤–æ–ª–Ω—ã: sigmoid overlap + log2 gap + post-training timing + night fasting
–®–ê–ì 11 ‚Äî Scoring summary + Confidence layer: daysWithData / 14 ‚Üí adjustedWeight = rawWeight √ó confidence
–®–ê–ì 12 ‚Äî Day-Type detection: training_day / rest_day / active_rest ‚Üí modifier adjustments
–®–ê–ì 13 ‚Äî Cross-factor synergies: sleep+training, NEAT+steps, meals+insulin, morning ritual, recovery
–®–ê–ì 14 ‚Äî –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ events –ø–æ sortKey (–≤—Ä–µ–º—è –≤ –º–∏–Ω—É—Ç–∞—Ö)
–®–ê–ì 15 ‚Äî –ê–ª–≥–æ—Ä–∏—Ç–º —Ü–µ–ø–æ—á–∫–∏ (v2.2.0 soft): –ø–æ–¥—Å—á—ë—Ç chain c –º—è–≥–∫–æ–π –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–µ–π, maxChain, warnings
–®–ê–ì 16 ‚Äî –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (v3.1.0+ CRS-driven: crs ‚â• 0.75 ‚Üí STRONG, crs ‚â• 0.45 ‚Üí GROWING, etc.)
–®–ê–ì 17 ‚Äî Post-training window: lastTraining.time –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 2 —á–∞—Å–æ–≤?
–®–ê–ì 18 ‚Äî –í—ã–±–æ—Ä –ø—É–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏–π (—Å —É—á—ë—Ç–æ–º post-training –∏ DEFICIT_OVERSHOOT)
–®–ê–ì 19 ‚Äî Momentum score: momentumScore = crs (CRS-driven progress-bar)
–®–ê–ì 20 ‚Äî Next step hint: —Å–ª–µ–¥—É—é—â–∏–π —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —à–∞–≥
```

---

## 5. –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

### –°–æ–±—ã—Ç–∏–µ (Event object)

```js
{
  type:        'meal' | 'training' | 'household' | 'sleep' | 'checkin' | 'measurements' | 'steps' | 'supplements' | 'insulin',
  time:        '08:30' | null,   // —Å—Ç—Ä–æ–∫–∞ HH:MM
  positive:    true | false,     // —Å–æ–∑–¥–∞—ë—Ç –∏–ª–∏ –ª–æ–º–∞–µ—Ç —Ü–µ–ø–æ—á–∫—É
  icon:        'ü•ó' | 'üí™' | ... // —ç–º–æ–¥–∑–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
  label:       '–ó–∞–≤—Ç—Ä–∞–∫',        // —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
  sortKey:     480,              // –º–∏–Ω—É—Ç—ã –æ—Ç –ø–æ–ª—É–Ω–æ—á–∏ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
  weight:      number            // —á–∏—Å–ª–æ–≤–æ–π –≤–∫–ª–∞–¥ –≤ score
}
```

### –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (—Å–æ–∑–¥–∞—é—Ç –∑–≤–µ–Ω–æ —Ü–µ–ø–æ—á–∫–∏)

| –¢–∏–ø            | –ò—Å—Ç–æ—á–Ω–∏–∫               | –£—Å–ª–æ–≤–∏–µ                                                    |
| -------------- | ---------------------- | ---------------------------------------------------------- |
| `household`    | `day.householdMin`     | householdMin ‚â• 10 (–≤–µ—Å 0.2‚Äì1.0)                            |
| `meal`         | `meals[i]`             | –ù–µ—Ç –ø–µ—Ä–µ–±–æ—Ä–∞ –∫–∞–ª–æ—Ä–∏–π –ò –Ω–µ—Ç harm-–ø—Ä–æ–¥—É–∫—Ç–æ–≤ –ò –Ω–µ –ø–æ—Å–ª–µ 23:00 |
| `training`     | `trainings[i]`         | –ö–∞–∂–¥–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ (–≤–µ—Å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)            |
| `sleep`        | `day.sleepStart`       | sleepOnsetWeight ‚â• 0 (–∑–∞—Å—ã–ø–∞–Ω–∏–µ –¥–æ 00:00)                  |
| `steps`        | `day.steps`            | stepsWeight > 0 (steps / goal ‚â• 0.7)                       |
| `checkin`      | `day.weightMorning`    | weightMorning > 0                                          |
| `measurements` | `day.measurements`     | –•–æ—Ç—è –±—ã –æ–¥–Ω–æ –∏–∑–º–µ—Ä–µ–Ω–∏–µ > 0                                 |
| `supplements`  | `day.supplementsTaken` | suppRatio ‚â• 0.5                                            |

### –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (—Å–Ω–∏–∂–∞—é—Ç —Ü–µ–ø–æ—á–∫—É)

| –£—Å–ª–æ–≤–∏–µ                             | –¢—è–∂–µ—Å—Ç—å | `breakReason`       | Penalty (v2.2.0) |
| ----------------------------------- | ------- | ------------------- | ---------------- |
| –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –∫–∫–∞–ª > 120% –Ω–æ—Ä–º—ã      | hard    | `'–ü–µ—Ä–µ–±–æ—Ä –∫–∫–∞–ª'`    | SEVERE (3)       |
| –õ—é–±–æ–π –ø—Ä–æ–¥—É–∫—Ç –≤ –ø—Ä–∏—ë–º–µ —Å `harm ‚â• 7` | soft    | `'–í—Ä–µ–¥–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç'` | MINOR (1)        |
| –í—Ä–µ–º—è –ø—Ä–∏—ë–º–∞ ‚â• 23:00 (1380 –º–∏–Ω)     | soft    | `'–ü–æ–∑–¥–Ω–∏–π –ø—Ä–∏—ë–º'`   | MINOR (1)        |

### cascadeState (—Ä–µ–∑—É–ª—å—Ç–∞—Ç computeCascadeState)

```js
{
  events:             CascadeEvent[],  // –≤—Å–µ —Å–æ–±—ã—Ç–∏—è, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
  chainLength:        number,          // —Ç–µ–∫—É—â–∞—è –¥–ª–∏–Ω–∞ —Ü–µ–ø–æ—á–∫–∏ (v2.2.0: –º—è–≥–∫–∞—è –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è)
  maxChainToday:      number,          // –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ –∑–∞ –¥–µ–Ω—å
  score:              number,          // –≤–∑–≤–µ—à–µ–Ω–Ω—ã–π —Å–∫–æ—Ä (—Å—É–º–º–∞ –≤—Å–µ—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤)
  warnings:           WarningInfo[],   // —Å–ø–∏—Å–æ–∫ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π (v2.2.0: —Å penalty, chainAfter)
  state:              CascadeState,    // —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (v3.1.0+: CRS-driven)
  momentumScore:      number,          // 0..1 (= crs, CRS-driven progress-bar)
  postTrainingWindow: boolean,         // true = 2—á –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
  message:            { short: string }, // –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
  nextStepHint:       string | null,   // –ø–æ–¥—Å–∫–∞–∑–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞
  // NEW in v2.1.0:
  dayType:            'training_day' | 'rest_day' | 'active_rest' | 'normal',
  synergies:          SynergyBonus[],  // applied cross-factor synergies
  confidence:         { [factorKey]: number },  // 0..1 per factor
  avgConfidence:      number,          // mean confidence across all factors
  rawWeights:         { [factorKey]: number },  // raw weights per factor
  // NEW in v3.0.0 ‚Äî Cascade Rate Score:
  crs:                number,          // 0‚Äì1, –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–π –∏–º–ø—É–ª—å—Å
  crsBase:            number,          // 0‚Äì1, EMA completed days only (v3.6.0)
  todayBoost:         number,          // 0‚Äì0.03, DCS √ó CRS_TODAY_BOOST (v3.6.0)
  ceiling:            number,          // 0‚Äì1, –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–ª–æ–∫
  dailyContribution:  number,          // ‚àí1..1, –≤–∫–ª–∞–¥ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–≥–æ –¥–Ω—è (DCS)
  dailyMomentum:      number,          // 0‚Äì1, dailyScore / MOMENTUM_TARGET
  hasCriticalViolation: boolean,       // critical violation –æ–±–æ—à–ª–∞ –∏–Ω–µ—Ä—Ü–∏—é?
  crsTrend:           'up' | 'down' | 'flat',  // –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ CRS –∑–∞ 7 –¥–Ω–µ–π
  daysAtPeak:         number,          // –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥ DCS ‚â• 0.5
  dcsHistory:         { [date]: number },  // –≤—Å—è –∏—Å—Ç–æ—Ä–∏—è DCS
  historicalDays:     HistoricalDay[], // —Å–æ–±—ã—Ç–∏—è –ø—Ä–æ—à–ª—ã—Ö –¥–Ω–µ–π –¥–ª—è timeline
  // NEW in v3.1.0 ‚Äî Goal-aware:
  hasDeficitOvershoot: boolean,        // –¥–µ—Ñ–∏—Ü–∏—Ç-mode + –ø–µ—Ä–µ–±–æ—Ä –∫–∫–∞–ª?
  deficitOvershootRatio: number|null,  // –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–µ—Ä–µ–±–æ—Ä–∞ (–Ω–∞–ø—Ä. 1.18)
  goalMode:           string|null      // 'deficit' | 'bulk' | 'maintenance' | null
}
```

---

## 6. –°–æ—Å—Ç–æ—è–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏

| –°–æ—Å—Ç–æ—è–Ω–∏–µ  | –ò–∫–æ–Ω–∫–∞ | –¶–≤–µ—Ç      | –£—Å–ª–æ–≤–∏–µ     | –õ–µ–π–±–ª                |
| ---------- | ------ | --------- | ----------- | -------------------- |
| `EMPTY`    | üåÖ     | `#94a3b8` | –ù–µ—Ç —Å–æ–±—ã—Ç–∏–π | –ù–∞—á–Ω–∏ –¥–µ–Ω—å           |
| `BUILDING` | üîó     | `#3b82f6` | CRS ‚â• 0.20  | –ò–º–ø—É–ª—å—Å —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è  |
| `GROWING`  | ‚ö°     | `#22c55e` | CRS ‚â• 0.45  | –ö–∞—Å–∫–∞–¥ –Ω–∞–±–∏—Ä–∞–µ—Ç —Å–∏–ª—É |
| `STRONG`   | üî•     | `#eab308` | CRS ‚â• 0.75  | –£—Å—Ç–æ–π—á–∏–≤—ã–π –∏–º–ø—É–ª—å—Å   |
| `BROKEN`   | üí™     | `#f59e0b` | CRS ‚â§ 0.05  | –ù–∞—á–Ω–∏ —Å –º–∞–ª–æ–≥–æ       |
| `RECOVERY` | üå±     | `#0ea5e9` | CRS > 0.05  | –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ          |

**–ú–∞—Ç—Ä–∏—Ü–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ (v3.1.0+ CRS-driven):**

```
(–Ω–µ—Ç —Å–æ–±—ã—Ç–∏–π)              ‚Üí EMPTY
EMPTY + –ø–æ–∑–∏—Ç–∏–≤            ‚Üí BUILDING (CRS —Ä–∞—Å—Ç—ë—Ç —á–µ—Ä–µ–∑ todayBoost)
CRS —Ä–∞—Å—Ç—ë—Ç                  ‚Üí BUILDING ‚Üí GROWING ‚Üí STRONG
–Ω–µ–≥–∞—Ç–∏–≤ —Å–Ω–∏–∂–∞–µ—Ç DCS         ‚Üí CRS_base –ø–ª–∞–≤–Ω–æ —Å–Ω–∏–∂–∞–µ—Ç—Å—è, –Ω–æ –∏–Ω–µ—Ä—Ü–∏—è –∑–∞—â–∏—â–∞–µ—Ç
CRS ‚â§ 0.05                  ‚Üí BROKEN
```

> **v3.1.0+**: —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ CRS (–∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–π –∏–º–ø—É–ª—å—Å), –∞ –Ω–µ –ø–æ
> –¥–Ω–µ–≤–Ω–æ–º—É score. 14 –¥–Ω–µ–π —Ö–æ—Ä–æ—à–∏—Ö —Ä–µ—à–µ–Ω–∏–π —Å–æ–∑–¥–∞—é—Ç –∏–Ω–µ—Ä—Ü–∏—é, –∫–æ—Ç–æ—Ä—É—é –æ–¥–∏–Ω –ø–ª–æ—Ö–æ–π
> –¥–µ–Ω—å –Ω–µ –º–æ–∂–µ—Ç —Ä–∞–∑—Ä—É—à–∏—Ç—å.

---

## 7. –ê–ª–≥–æ—Ä–∏—Ç–º —Ü–µ–ø–æ—á–∫–∏ (v2.2.0 Soft Chain)

```js
// –õ–∏–Ω–µ–π–Ω—ã–π –ø—Ä–æ—Ö–æ–¥ –ø–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º events
chain = 0; maxChain = 0; warnings = []; totalPenalty = 0;

for event in sortedEvents:
    if event.positive:
        chain++
        maxChain = max(maxChain, chain)
    else:
        penalty = getChainPenalty(event.weight)
        //  weight ‚â• -0.5      ‚Üí MINOR  (penalty=1)
        // -1.5 ‚â§ weight < -0.5 ‚Üí MEDIUM (penalty=2)
        //  weight < -1.5       ‚Üí SEVERE (penalty=3)
        chain = max(0, chain - penalty)
        totalPenalty += penalty
        warnings.push({ time, reason, penalty, chainBefore, chainAfter })

// –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–®–ê–ì 16) ‚Äî CRS-driven (v3.1.0+):
if events.length == 0         ‚Üí EMPTY
elif crs >= 0.75              ‚Üí STRONG
elif crs >= 0.45              ‚Üí GROWING
elif crs >= 0.20              ‚Üí BUILDING
elif crs > 0.05               ‚Üí RECOVERY
else                          ‚Üí BROKEN
```

> **v3.1.0+**: `hasBreak` —É–¥–∞–ª—ë–Ω –∏–∑ –ª–æ–≥–∏–∫–∏. –°–æ—Å—Ç–æ—è–Ω–∏–µ = f(CRS). –¶–µ–ø–æ—á–∫–∞ –Ω–µ
> –æ–±–Ω—É–ª—è–µ—Ç—Å—è, –∞ –¥–µ–≥—Ä–∞–¥–∏—Ä—É–µ—Ç –º—è–≥–∫–æ: chain=5 + 1 MINOR ‚Üí chain=4.

**Momentum score (–®–ê–ì 19):**

```
momentumScore = crs  // v3.0.0+: CRS-driven progress-bar
```

> –ó–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å 8.5 (v3.5.0, –±—ã–ª–æ 10.0) ‚Äî —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –ø–æ—Ç–æ–ª–æ–∫ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å
> 4-5 –∞–∫—Ç–∏–≤–Ω—ã–º–∏ —Ñ–∞–∫—Ç–æ—Ä–∞–º–∏

---

## 8. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã React

### ChainDots

```
props: { events: CascadeEvent[] }
```

–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ —Ü–≤–µ—Ç–Ω—ã—Ö –∫—Ä—É–∂–∫–æ–≤ —Å —è–≤–Ω—ã–º–∏ connector-—ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –≤ DOM:

- –¶–≤–µ—Ç —Ç–æ—á–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è **–≤–µ—Å–æ–º (–≤–ª–∏—è–Ω–∏–µ–º) —Å–æ–±—ã—Ç–∏—è** –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å (–∞ –Ω–µ —Ç–∏–ø–æ–º
  —Å–æ–±—ã—Ç–∏—è):
  - `w <= -0.5` ‚Äî `#dc2626` (–∫—Ä–∞—Å–Ω—ã–π, —Å–∏–ª—å–Ω—ã–π –Ω–µ–≥–∞—Ç–∏–≤)
  - `w < 0` ‚Äî `#f97316` (–æ—Ä–∞–Ω–∂–µ–≤—ã–π, —Å–ª–∞–±—ã–π –Ω–µ–≥–∞—Ç–∏–≤)
  - `w == 0` ‚Äî `#facc15` (–∂–µ–ª—Ç—ã–π, –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ)
  - `w <= 0.5` ‚Äî `#84cc16` (—Å–≤–µ—Ç–ª–æ-–∑–µ–ª–µ–Ω—ã–π, —Å–ª–∞–±—ã–π –ø–æ–∑–∏—Ç–∏–≤)
  - `w <= 1.5` ‚Äî `#22c55e` (–∑–µ–ª–µ–Ω—ã–π, —Ö–æ—Ä–æ—à–∏–π –ø–æ–∑–∏—Ç–∏–≤)
  - `w > 1.5` ‚Äî `#10b981` (–∏–∑—É–º—Ä—É–¥–Ω—ã–π, –æ—Ç–ª–∏—á–Ω—ã–π –ø–æ–∑–∏—Ç–∏–≤)
- `.cascade-dot--latest` ‚Äî –ø—É–ª—å—Å-–∞–Ω–∏–º–∞—Ü–∏—è –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º –ø–æ–∑–∏—Ç–∏–≤–Ω–æ–º –∑–≤–µ–Ω–µ
- `.cascade-dot-connector` ‚Äî –ª–∏–Ω–∏—è –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏
- `.cascade-dot-connector--warning` ‚Äî –ø—É–Ω–∫—Ç–∏—Ä–Ω–∞—è —è–Ω—Ç–∞—Ä–Ω–∞—è –ª–∏–Ω–∏—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
  (v2.2.0)

**Tooltip (title):** –ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ —Ç–æ—á–∫—É –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤—Ä–µ–º—è, –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
–∏ –µ–≥–æ –≤–µ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, `–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ 45 –º–∏–Ω (+1.2)`).

### CascadeTimeline

```
props: { events: CascadeEvent[], nextStepHint: string | null }
```

–†–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–π —Ç–∞–π–º–ª–∞–π–Ω —Å –∏–∫–æ–Ω–∫–æ–π, –≤—Ä–µ–º–µ–Ω–µ–º, –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∏ –±–µ–π–¥–∂–µ–º `‚úì` / `‚ö†`
(v2.2.0) / `breakReason`.  
–í –∫–æ–Ω—Ü–µ ‚Äî hint `üí° ...`.

### CascadeCard (–≥–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)

```
props: cascadeState (–≤—Å–µ –ø–æ–ª—è –∏–∑ computeCascadeState)
```

**Standalone** ‚Äî –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `HEYS.ExpandableCard`. –£–ø—Ä–∞–≤–ª—è–µ—Ç expanded —á–µ—Ä–µ–∑
`React.useState(false)`.

**–°–≤—ë—Ä–Ω—É—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**

```
[üîó icon] [–í–∞—à –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∫–∞—Å–∫–∞–¥] [3 ‚ö° badge]
 –¢—Ä–∏ —Ä–µ—à–µ–Ω–∏—è –ø–æ–¥—Ä—è–¥ ‚Äî —Ç—ã –Ω–∞–±–∏—Ä–∞–µ—à—å —Ö–æ–¥.
 ‚óè ‚Äî ‚óè ‚Äî ‚óè (ChainDots)
 [======-------] (progress bar)                 [‚Ä∫]
```

**–†–∞–∑–≤—ë—Ä–Ω—É—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**

```
[üîó icon] [–í–∞—à –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∫–∞—Å–∫–∞–¥] [3 ‚ö° badge]
 –¢—Ä–∏ —Ä–µ—à–µ–Ω–∏—è –ø–æ–¥—Ä—è–¥ ‚Äî —Ç—ã –Ω–∞–±–∏—Ä–∞–µ—à—å —Ö–æ–¥.
 ‚óè ‚Äî ‚óè ‚Äî ‚óè (ChainDots)
 [======-------] (progress bar)                 [‚Äπ]
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 ‚óè ‚Äî ‚óè ‚Äî ‚óè (ChainDots full)
 üåÖ  08:15  –†–∞–Ω–Ω–∏–π –∑–∞–≤—Ç—Ä–∞–∫                      ‚úì
 ü•ó  09:00  –ó–∞–≤—Ç—Ä–∞–∫                             ‚úì
 üí™  10:30  –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ 45 –º–∏–Ω                   ‚úì
 üí° –í—ã–ø–µ–π –≤–æ–¥—ã ‚Äî —Ç—ã –µ—â—ë –Ω–µ –Ω–∞ 50% –Ω–æ—Ä–º—ã
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 ‚ö†Ô∏è –†–∞–∑—Ä—ã–≤–æ–≤ —Ü–µ–ø–æ—á–∫–∏ —Å–µ–≥–æ–¥–Ω—è: 0
 üèÜ –ú–∞–∫—Å. —Ü–µ–ø–æ—á–∫–∞: 3    ‚ö° –ò–º–ø—É–ª—å—Å: 43%
```

---

## 9. –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

–í—ã–±–æ—Ä –ø—É–ª–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ post-training window.  
–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Äî –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ –ø–æ —á–∞—Å—É –¥–Ω—è (`hour % poolSize`), –Ω–µ
–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ-—Ä–µ–Ω–¥–µ—Ä–∞—Ö.

### BUILDING (chain 1‚Äì2)

- ¬´–•–æ—Ä–æ—à–µ–µ –Ω–∞—á–∞–ª–æ. –ü–µ—Ä–≤—ã–π —à–∞–≥ —É–∂–µ —Å–¥–µ–ª–∞–Ω.¬ª
- ¬´–ù–∞—á–∞–ª–æ –ø–æ–ª–æ–∂–µ–Ω–æ ‚Äî –ø—Ä–æ—â–µ –≤—Å–µ–≥–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å, –∫–æ–≥–¥–∞ —É–∂–µ –Ω–∞—á–∞–ª.¬ª

### GROWING (chain 3‚Äì4)

- ¬´–¢—Ä–∏ —Ä–µ—à–µ–Ω–∏—è –ø–æ–¥—Ä—è–¥ ‚Äî —Ç—ã –Ω–∞–±–∏—Ä–∞–µ—à—å —Ö–æ–¥.¬ª
- ¬´–•–æ—Ä–æ—à–∏–π —Ä–∏—Ç–º. –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ –¥–∞—ë—Ç—Å—è –ª–µ–≥—á–µ.¬ª
- ¬´–ö–æ–≥–¥–∞ –≤—Å—ë —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–æ—â–µ.¬ª

### STRONG (chain 5+)

- ¬´–ú–æ—â–Ω—ã–π –¥–µ–Ω—å. –ö–æ–≥–¥–∞ —Å—Ç–æ–ª—å–∫–æ —Å–¥–µ–ª–∞–Ω–æ ‚Äî –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è —Å–ª–æ–∂–Ω–æ.¬ª
- ¬´–°–µ–≥–æ–¥–Ω—è –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç. –¢–∞–∫–∏–µ –¥–Ω–∏ —Å—Ç—Ä–æ—è—Ç –ø—Ä–∏–≤—ã—á–∫–∏.¬ª
- ¬´–ü—è—Ç—å+ —Ä–µ—à–µ–Ω–∏–π ‚Äî —ç—Ç–æ —É–∂–µ —Å–∏—Å—Ç–µ–º–∞. –¢–µ–±–µ –ø—Ä–æ—â–µ –¥–µ–ª–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä.¬ª

### BROKEN (CRS ‚â§ 0.05)

- ¬´–ù–∞—á–Ω–∏ —Å –º–∞–ª–æ–≥–æ ‚Äî –∫–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç –Ω–æ–≤—ã–π –∫–∞—Å–∫–∞–¥.¬ª
- ¬´–ù—É–ª–µ–≤–æ–π –∏–º–ø—É–ª—å—Å ‚Äî —ç—Ç–æ —á–∏—Å—Ç—ã–π —Å—Ç–∞—Ä—Ç. –ü–µ—Ä–≤—ã–π –¥–µ–Ω—å —Å—Ç—Ä–æ–∏—Ç –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ.¬ª
- ¬´–ù–µ –≤—Å—ë –∏–ª–∏ –Ω–∏—á–µ–≥–æ. –î–∞–∂–µ 70% —Ö–æ—Ä–æ—à–∏—Ö —Ä–µ—à–µ–Ω–∏–π ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å.¬ª

### RECOVERY (0.05 < CRS < 0.20)

- ¬´–û–¥–∏–Ω —à–∞–≥ –Ω–∞–∑–∞–¥ –Ω–µ –æ—Ç–º–µ–Ω—è–µ—Ç –Ω–µ–¥–µ–ª—é –ø—Ä–æ–≥—Ä–µ—Å—Å–∞. –¢—ã —É–∂–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—à—å—Å—è.¬ª
- ¬´–ò–º–ø—É–ª—å—Å —Å–Ω–∏–∑–∏–ª—Å—è, –Ω–æ –Ω–µ –æ–±–Ω—É–ª–∏–ª—Å—è. –û–¥–∏–Ω —Ö–æ—Ä–æ—à–∏–π –¥–µ–Ω—å ‚Äî –∏ —Ç—ã –Ω–∞ –ø—É—Ç–∏.¬ª
- ¬´–ü–æ—Å–ª–µ –ø–µ—Ä–µ—Ä—ã–≤–∞ –∫–∞–∂–¥–æ–µ —Ä–µ—à–µ–Ω–∏–µ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ. –¢—ã —É–∂–µ –Ω–∞ –ø—É—Ç–∏.¬ª

### ANTI_LICENSING (2—á –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ –ª—é–±—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º)

- ¬´–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ ‚Äî —Å–∞–º–∞ –ø–æ —Å–µ–±–µ –ø–æ–±–µ–¥–∞. –ù–µ ¬´–Ω–∞–≥—Ä–∞–∂–¥–∞–π¬ª —Å–µ–±—è –µ–¥–æ–π.¬ª
- ¬´–ü–æ—Å–ª–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –æ—Ä–≥–∞–Ω–∏–∑–º –ª—É—á—à–µ –≤—Å–µ–≥–æ —É—Å–≤–æ–∏—Ç –±–µ–ª–æ–∫ –∏ –æ–≤–æ—â–∏.¬ª
- ¬´–ö–ª–∞—Å—Å–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞! –í—ã–±–µ—Ä–∏ –∫–∞—á–µ—Å—Ç–≤–æ, –∞ –Ω–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ.¬ª

> **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ:** ANTI_LICENSING –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ BROKEN –∏ EMPTY.

### DEFICIT_OVERSHOOT (–ø–µ—Ä–µ–±–æ—Ä –∫–∫–∞–ª –ø—Ä–∏ —Ü–µ–ª–∏ –ø–æ—Ö—É–¥–µ–Ω–∏—è, v3.1.0)

- ¬´–ü–µ—Ä–µ–±–æ—Ä, –Ω–æ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞—â–∏—â–∞–µ—Ç —Ç–µ–±—è. –ó–∞–≤—Ç—Ä–∞ ‚Äî –Ω–æ–≤—ã–π —à–∞–Ω—Å.¬ª
- ¬´–û–¥–∏–Ω –ø–µ—Ä–µ–±–æ—Ä –Ω–µ –ø–µ—Ä–µ—á—ë—Ä–∫–∏–≤–∞–µ—Ç –Ω–µ–¥–µ–ª—é –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã. –ò–º–ø—É–ª—å—Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω.¬ª
- ¬´–ü–µ—Ä–µ–±—Ä–∞–ª ‚Äî –±—ã–≤–∞–µ—Ç. –ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ —Å–≤–æ—é –Ω–µ–¥–µ–ª—é: —Ç—ã —Å–ø—Ä–∞–≤–ª—è–µ—à—å—Å—è.¬ª
- ¬´–ö–∞–ª–æ—Ä–∏–∏ –≤—ã—à–µ —Ü–µ–ª–∏, –Ω–æ –∫–∞—Å–∫–∞–¥ –∏–Ω–µ—Ä—Ü–∏–∏ –Ω–∞ —Ç–≤–æ–µ–π —Å—Ç–æ—Ä–æ–Ω–µ.¬ª

> **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—É–ª–æ–≤ (–®–ê–ì 18):** DEFICIT_OVERSHOOT > ANTI_LICENSING >
> state-based.

### Next step hint (–ø–æ–¥—Å–∫–∞–∑–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞)

–ü—Ä–∞–≤–∏–ª–æ –≤—ã–±–æ—Ä–∞ (–ø–µ—Ä–≤–æ–µ –ø–æ–¥—Ö–æ–¥—è—â–µ–µ):

| –£—Å–ª–æ–≤–∏–µ                   | Hint                                                |
| ------------------------- | --------------------------------------------------- |
| –ù–µ—Ç –ø—Ä–∏—ë–º–∞ –ø–∏—â–∏, —á–∞—Å < 20 | ¬´–î–æ–±–∞–≤—å –ø–µ—Ä–≤—ã–π –ø—Ä–∏—ë–º –ø–∏—â–∏¬ª                          |
| –ù–µ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, —á–∞—Å 6‚Äì20  | ¬´–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∏–ª–∏ –ø—Ä–æ–≥—É–ª–∫–∞ –¥–æ–±–∞–≤—è—Ç –∑–≤–µ–Ω–æ –≤ —Ü–µ–ø–æ—á–∫—É¬ª   |
| –ù–µ—Ç —á–µ–∫-–∏–Ω–∞, —á–∞—Å < 11     | ¬´–í–∑–≤–µ—Å—å—Å—è —É—Ç—Ä–æ–º ‚Äî —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å¬ª |
| –ù–µ—Ç –∑–∞–º–µ—Ä–æ–≤, —á–∞—Å < 11     | ¬´–°–Ω–∏–º–∏ –∑–∞–º–µ—Ä—ã ‚Äî —ç—Ç–æ –ø–æ–≤—ã—Å–∏—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞¬ª       |
| –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö —Å–Ω–∞            | ¬´–ó–∞—Ñ–∏–∫—Å–∏—Ä—É–π –≤—Ä–µ–º—è –∑–∞—Å—ã–ø–∞–Ω–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–Ω–∞¬ª        |
| chain > 0, —á–∞—Å < 21       | ¬´–ü—Ä–æ–¥–æ–ª–∂–∞–π ‚Äî —Å–ª–µ–¥—É—é—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ —É—Å–∏–ª–∏—Ç —Ü–µ–ø–æ—á–∫—É¬ª      |

---

## 10. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –¢–æ—á–∫–∞ –≤—ã–∑–æ–≤–∞ ‚Äî `apps/web/heys_day_diary_section.js`

```js
// –í–Ω—É—Ç—Ä–∏ renderDiarySection(), –ø–æ—Å–ª–µ mealRecCard:
const cascadeCard = app.CascadeCard?.renderCard?.({
    React, day, prof, pIndex, dayTot, normAbs
}) || null;

// –í return React.createElement(React.Fragment, ...):
goalProgressBar,
cascadeCard,      // ‚Üê –ó–î–ï–°–¨, –º–µ–∂–¥—É goalProgressBar –∏ refeedCard
refeedCard,
mealRecCard,
...
```

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ ‚Äî `apps/web/index.html`

```html
<script defer src="heys_cascade_card_v1.js?v=1"></script>
<!-- –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ heys_day_diary_section.js -->
```

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ CSS ‚Äî `apps/web/styles/main.css`

```css
@import url('./modules/740-cascade-card.css');
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ `renderCard`

```js
// –§—É–Ω–∫—Ü–∏—è renderCard –Ω–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç –∫–∞—Ä—Ç–æ—á–∫—É –µ—Å–ª–∏:
// 1. day = null
// 2. –ù–µ—Ç –Ω–∏–∫–∞–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (meals, trainings, water, steps ‚Äî –≤—Å–µ –ø—É—Å—Ç—ã–µ)
// 3. computeCascadeState –≤–µ—Ä–Ω—É–ª state = EMPTY
// –í –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç React.createElement(CascadeCard, cascadeState)
```

---

## 11. CSS –∏ —Å—Ç–∏–ª–∏

–§–∞–π–ª: `apps/web/styles/modules/740-cascade-card.css` (430 —Å—Ç—Ä–æ–∫)

### BEM-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
.cascade-card                     ‚Äî –∫–æ—Ä–Ω–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç
.cascade-card--{state}            ‚Äî –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è (--building, --strong, etc.)
‚îÇ
‚îú‚îÄ‚îÄ .cascade-card__header         ‚Äî –∫–Ω–æ–ø–∫–∞ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ .cascade-card__title-row  ‚Äî —Å—Ç—Ä–æ–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ .cascade-card__icon   ‚Äî —ç–º–æ–¥–∑–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ .cascade-card__title  ‚Äî ¬´–í–∞—à –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∫–∞—Å–∫–∞–¥¬ª
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ .cascade-card__badge  ‚Äî —Å—á—ë—Ç—á–∏–∫ ¬´3 ‚ö°¬ª
‚îÇ   ‚îú‚îÄ‚îÄ .cascade-card__subtitle   ‚Äî —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ .cascade-card__hint       ‚Äî anti-licensing —Ö–∏–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ .cascade-chain-dots       ‚Äî —Ü–µ–ø–æ—á–∫–∞ —Ç–æ—á–µ–∫ (—Å–≤—ë—Ä–Ω—É—Ç–æ–µ)
‚îÇ   ‚îú‚îÄ‚îÄ .cascade-card__progress-track
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ .cascade-card__progress-bar
‚îÇ   ‚îî‚îÄ‚îÄ .cascade-card__chevron    ‚Äî ¬´‚Ä∫¬ª / ¬´‚Äπ¬ª
‚îÇ       ‚îî‚îÄ‚îÄ --open
‚îÇ
‚îî‚îÄ‚îÄ .cascade-card__body           ‚Äî —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
    ‚îú‚îÄ‚îÄ .cascade-chain-dots       ‚Äî —Ü–µ–ø–æ—á–∫–∞ —Ç–æ—á–µ–∫ (–¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è)
    ‚îú‚îÄ‚îÄ .cascade-timeline         ‚Äî —Ç–∞–π–º–ª–∞–π–Ω
    ‚îÇ   ‚îú‚îÄ‚îÄ .cascade-timeline-row--positive
    ‚îÇ   ‚îú‚îÄ‚îÄ .cascade-timeline-row--warning     ‚Äî v2.2.0: —è–Ω—Ç–∞—Ä–Ω—ã–π –≤–º–µ—Å—Ç–æ --negative
    ‚îÇ   ‚îú‚îÄ‚îÄ .cascade-timeline-icon
    ‚îÇ   ‚îú‚îÄ‚îÄ .cascade-timeline-time
    ‚îÇ   ‚îú‚îÄ‚îÄ .cascade-timeline-label
    ‚îÇ   ‚îî‚îÄ‚îÄ .cascade-timeline-badge
    ‚îú‚îÄ‚îÄ .cascade-next-step        ‚Äî hint üí°
    ‚îú‚îÄ‚îÄ .cascade-card__breaks-info
    ‚îî‚îÄ‚îÄ .cascade-card__stats
        ‚îî‚îÄ‚îÄ .cascade-card__stat
```

### Chain dots

```
.cascade-chain-dots               ‚Äî flex-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, overflow-x: auto
‚îú‚îÄ‚îÄ .cascade-dot                  ‚Äî 12√ó12px –∫—Ä—É–∂–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ style="background: ..."   ‚Äî —Ü–≤–µ—Ç –∑–∞–¥–∞–µ—Ç—Å—è –∏–Ω–ª–∞–π–Ω –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–µ—Å–∞ —Å–æ–±—ã—Ç–∏—è (w)
‚îÇ   ‚îî‚îÄ‚îÄ --latest                  ‚Äî –ø—É–ª—å—Å @keyframes cascadePulse
‚îî‚îÄ‚îÄ .cascade-dot-connector        ‚Äî 12px –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è
    ‚îî‚îÄ‚îÄ --warning                 ‚Äî dashed border-top —è–Ω—Ç–∞—Ä—å (v2.2.0, –±—ã–ª–æ --broken)
```

### –ê–Ω–∏–º–∞—Ü–∏—è

```css
@keyframes cascadePulse {
  0%,
  100% {
    box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.35);
  }
  50% {
    box-shadow: 0 0 0 5px rgba(34, 197, 94, 0);
  }
}
/* –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ .cascade-dot--latest:not(.cascade-dot--warning) */
```

### Dark mode

–í—Å–µ –∫–ª–∞—Å—Å—ã –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–æ–¥ `[data-theme="dark"]`.

---

## 12. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞

**–§–∏–ª—å—Ç—Ä—ã –≤ –∫–æ–Ω—Å–æ–ª–∏:**

- `[HEYS.cascade]` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä, –≤—Å–µ —Å–æ–±—ã—Ç–∏—è
- `[HEYS.cascade.crs]` ‚Äî —Ç–æ–ª—å–∫–æ CRS-–ø–æ–¥—Å–∏—Å—Ç–µ–º–∞ (DCS, EMA, ceiling)
- `[HEYS.cascade.deficit]` ‚Äî —Ç–æ–ª—å–∫–æ goal-aware —à—Ç—Ä–∞—Ñ—ã v3.1.0 (–¥–µ—Ñ–∏—Ü–∏—Ç/–Ω–∞–±–æ—Ä)

–í—Å–µ –ª–æ–≥–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `console.info` (–∏–ª–∏ `console.warn` –¥–ª—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π).

### –ü–æ–ª–Ω–∞—è –∫–∞—Ä—Ç–∞ –ª–æ–≥–æ–≤ (v3.6.0)

| –≠–º–æ–¥–∑–∏ –∏ –ø—Ä–µ—Ñ–∏–∫—Å                      | –õ–æ–≥                                    | –ö–æ–≥–¥–∞                                         |
| ------------------------------------- | -------------------------------------- | --------------------------------------------- |
| `[cascade] ‚îÄ‚îÄ‚îÄ v3.6.0 START`          | computeCascadeState START              | –ù–∞—á–∞–ª–æ —Ä–∞—Å—á—ë—Ç–∞ + –ø–µ—Ä–µ—á–µ–Ω—å —Ñ–∏—á v3.6.0          |
| `[cascade] üß¨`                        | v3.6.0 features                        | CRS base+todayBoost/continuous/goal-penalty   |
| `[cascade] üì•`                        | Input data                             | –í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã                             |
| `[cascade] üè† [EVENT]`                | Household (log2 adaptive)              | log2 adaptive scoring + baseline              |
| `[cascade.deficit] üéØ`                | Goal mode for meal loop                | —Ä–µ–∂–∏–º —Ü–µ–ª–∏ (deficit/bulk/maintenance), –ø–æ—Ä–æ–≥–∏ |
| `[cascade] ü•ó Processing N meals`     | –Ω–∞—á–∞–ª–æ —Ü–∏–∫–ª–∞ –ø—Ä–∏—ë–º–æ–≤                   | –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏—ë–º–æ–≤                            |
| `[cascade] üéØ Meal quality`           | score + grade + weight + formula       | continuous scoring v2.1.0                     |
| `[cascade] üçΩÔ∏è [MEAL N/M]`             | Meal (continuous + circadian)          | kcal, norm, ratio, penalty, mealWeight        |
| `[cascade.deficit] üî¥`                | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–±–æ—Ä –ø—Ä–∏ –¥–µ—Ñ–∏—Ü–∏—Ç–µ       | finalRatio > criticalOver (–Ω–∞–ø—Ä. >115%)       |
| `[cascade.deficit] ‚ö†Ô∏è`                | –û—â—É—Ç–∏–º—ã–π –ø–µ—Ä–µ–±–æ—Ä –ø—Ä–∏ –¥–µ—Ñ–∏—Ü–∏—Ç–µ          | finalRatio > targetRange.max (–Ω–∞–ø—Ä. >105%)    |
| `[cascade.deficit] ‚úÖ Deficit check`  | –∏—Ç–æ–≥ —à–∞–≥–∞ 2.5                          | —Ñ–ª–∞–≥, —Ä–∞—Ü–∏–æ, goalLabel                        |
| `[cascade] üí™ Processing N trainings` | –Ω–∞—á–∞–ª–æ —Ü–∏–∫–ª–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫                | –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫                         |
| `[cascade] üí™ [TRAINING N/M]`         | Training (load√ósqrt)                   | load√óintensity, diminishing, formula          |
| `[cascade] üí™ Recovery / no training` | recovery-aware + weekly check          | streak, penalty if needed                     |
| `[cascade] üò¥`                        | Sleep onset (sigmoid)                  | chronotype-adaptive + consistency + variance  |
| `[cascade] üò¥`                        | Sleep duration (bell-curve)            | Gaussian + asymmetry + recovery               |
| `[cascade] üö∂`                        | Steps (tanh)                           | adaptive goal + tanh formula                  |
| `[cascade] ‚öñÔ∏è`                        | Checkin (streak)                       | base + streak + trend                         |
| `[cascade] üìè`                        | Measurements (cadence)                 | completeness + cadence + diminishing          |
| `[cascade] üíä`                        | Supplements (continuous)               | ratio + streak + formula                      |
| `[cascade] ‚ö°`                        | InsulinWave (sigmoid)                  | sigmoid overlap + log2 gap + fasting          |
| `[cascade] üìä Scoring summary`        | rawWeights + active/skipped            | scoringMethod v2.2.0                          |
| `[cascade] üéØ Confidence layer`       | per-factor confidence + avg            | quality: HIGH/MEDIUM/LOW                      |
| `[cascade] üìÖ Day-type`               | training/rest/active + effect          | context-aware day type                        |
| `[cascade] üîó Cross-factor synergies` | count + names + bonuses                | –¥–æ 5 —Å–∏–Ω–µ—Ä–≥–∏–π                                 |
| `[cascade] üìã Events sorted`          | —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π (N total)     | –ø–µ—Ä–µ–¥ —Ü–µ–ø–æ—á–∫–æ–π                                |
| `[cascade] ‚õìÔ∏è Chain algorithm`        | —Ç—Ä–µ–π—Å –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ —Ü–µ–ø–æ—á–∫–∏             | soft degradation v2.2.0                       |
| `[cascade] üîó Chain result`           | chain, maxChain, warnings[]            | –∏—Ç–æ–≥ —Ü–µ–ø–æ—á–∫–∏                                  |
| `[cascade.crs] ‚îÄ‚îÄ‚îÄ START`             | CRS computation START                  | –Ω–∞—á–∞–ª–æ EMA-—Ä–∞—Å—á—ë—Ç–∞                            |
| `[cascade.deficit] üìä Goal-aware DCS` | DCS override –ø–æ —É—Ä–æ–≤–Ω—é (1/2/3)         | level, ratio, appliedPenalty                  |
| `[cascade.deficit] üí™ Bulk exemption` | —à—Ç—Ä–∞—Ñ —Å–Ω—è—Ç (—Ä–µ–∂–∏–º –Ω–∞–±–æ—Ä–∞, –∫–∫–∞–ª ‚â§ 180%) | –∫–∫–∞–ª% ‚â§ 180% –≤ bulk-—Ä–µ–∂–∏–º–µ                    |
| `[cascade.crs] üìä DCS`                | DCS formula + result                   | baseDcs, hasCriticalViolation, violationType  |
| `[cascade.crs] üóÇÔ∏è`                    | Retroactive backfill                   | —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –∑–∞–ø–æ–ª–Ω–µ–Ω–æ                        |
| `[cascade.crs] üèîÔ∏è Ceiling`            | consistency √ó diversity √ó depth        | activatedFactors, daysWithData                |
| `[cascade.crs] üìà CRS`                | crs, ceiling, dcsToday, emaDecay       | —Ñ–∏–Ω–∞–ª—å–Ω—ã–π CRS                                 |
| `[cascade.crs] üìä CRS trend`          | up/down/flat                           | –¥–∏–Ω–∞–º–∏–∫–∞ –∑–∞ 7 –¥–Ω–µ–π                            |
| `[cascade.crs] üî• Days at peak`       | –∫–æ–Ω—Å–µ–∫—É—Ç–∏–≤–Ω—ã–µ –¥–Ω–∏ DCS ‚â• 0.5            | streak —Å–∏–ª—å–Ω—ã—Ö –¥–Ω–µ–π                           |
| `[cascade.crs] ‚îÄ‚îÄ‚îÄ DONE`              | CRS computation DONE                   | –∫–æ–Ω–µ—Ü EMA-—Ä–∞—Å—á—ë—Ç–∞                             |
| `[cascade] üè∑Ô∏è State`                  | CRS-driven state                       | crs, eventsLength, thresholds                 |
| `[cascade] ‚è∞ Post-training`          | –æ–∫–Ω–æ 2—á –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏               | –∞–∫—Ç–∏–≤–Ω–æ / –Ω–µ –∞–∫—Ç–∏–≤–Ω–æ                          |
| `[cascade] üí¨ Message pool`           | –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø—É–ª                          | DEFICIT_OVERSHOOT / ANTI_LICENSING / state    |
| `[cascade] üí¨ Message selected`       | –ø—É–ª, –∏–Ω–¥–µ–∫—Å, —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è           | —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ                           |
| `[cascade] üìä Momentum score`         | CRS –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö                        | CRS-driven progress-bar                       |
| `[cascade] üí° Next step hint`         | hint –∏ –ø–æ—á–µ–º—É                          | —Å–ø–µ—Ü. hint –ø—Ä–∏ deficitOvershoot               |
| `[cascade] ‚úÖ v3.6.0 DONE`            | computeCascadeState DONE               | state, crs, goalMode, hasDeficitOvershoot     |
| `[cascade] üß¨ v3.6.0 subsystems`      | –≤—Å–µ –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã –∫—Ä–∞—Ç–∫–æ                  | goalAwarePenalty + CRS + chainModel + ...     |
| `[cascade] ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ`                   | —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å                            | –∫–æ–Ω–µ—Ü —Ä–∞—Å—á—ë—Ç–∞                                 |
| `[cascade] üìå renderCard called`      | –≤—ã–∑–æ–≤ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞                      | –ø–µ—Ä–µ–¥ –≤—Å–µ–º                                    |
| `[cascade] üß† Cache MISS`             | recompute triggered                    | –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å, –ø–µ—Ä–µ—Å—á—ë—Ç           |
| `[cascade] ‚ö° Cache HIT`              | compute skipped                        | –¥–∞–Ω–Ω—ã–µ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å, –∫—ç—à –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω         |
| `[cascade] üöÄ`                        | Rendering CascadeCard                  | React-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è                    |
| `[cascade] üîÑ`                        | Toggle expanded                        | —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ / –∑–∞–∫—Ä—ã—Ç–∏–µ                          |
| `[cascade] ‚úÖ Module loaded v3.6.0`   | –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª—è                        | –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∫—Ä–∏–ø—Ç–∞, sub-–ø—Ä–µ—Ñ–∏–∫—Å—ã            |

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –∫–æ–Ω—Å–æ–ª–∏

```js
// –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞–ø—Ä—è–º—É—é:
HEYS.CascadeCard.computeCascadeState(
  HEYS.day,
  HEYS.dayTot,
  HEYS.normAbs,
  HEYS.prof,
  HEYS.pIndex,
);

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é:
HEYS.CascadeCard.VERSION; // ‚Üí "3.6.0"

// –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è:
HEYS.CascadeCard.STATES;

// –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ–Ω—Ñ–∏–≥ —Å–æ—Å—Ç–æ—è–Ω–∏–π:
HEYS.CascadeCard.STATE_CONFIG;

// –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—É–ª—ã —Å–æ–æ–±—â–µ–Ω–∏–π:
HEYS.CascadeCard.MESSAGES;
```

---

## 13. API –º–æ–¥—É–ª—è

```js
HEYS.CascadeCard = {
  VERSION:             '3.6.0',
  STATES:              { EMPTY, BUILDING, GROWING, STRONG, BROKEN, RECOVERY },
  STATE_CONFIG:        { [state]: { icon, color, label } },
  MESSAGES:            { [poolKey]: [{ short }] },  // + DEFICIT_OVERSHOOT (v3.1.0)
  computeCascadeState: function(day, dayTot, normAbs, prof, pIndex) ‚Üí cascadeState,
  renderCard:          function({ day, dayTot, normAbs, prof, pIndex, React? }) ‚Üí ReactElement | null
}
```

### renderCard ‚Äî –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä  | –û–±—è–∑–∞—Ç–µ–ª–µ–Ω | –û—Ç–∫—É–¥–∞ –±–µ—Ä—ë—Ç—Å—è                |
| --------- | ---------- | ----------------------------- |
| `day`     | **–¥–∞**     | `params.day` –∏–∑ diary section |
| `dayTot`  | –Ω–µ—Ç        | `params.dayTot`               |
| `normAbs` | –Ω–µ—Ç        | `params.normAbs`              |
| `prof`    | –Ω–µ—Ç        | `params.prof`                 |
| `pIndex`  | –Ω–µ—Ç        | `params.pIndex`               |
| `React`   | –Ω–µ—Ç        | –±–µ—Ä—ë—Ç—Å—è –∏–∑ `global.React`     |

### –£—Å–ª–æ–≤–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö renderCard –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç null

1. `day` –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω / null
2. –ù–µ—Ç –Ω–∏–∫–∞–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:
   `meals.length === 0 && trainings.length === 0 && steps === 0 && householdMin === 0 && weightMorning === 0 && sleepStart === null && measurements === null && supplementsTaken === 0`
3. `computeCascadeState` –≤–µ—Ä–Ω—É–ª `state = 'EMPTY'`

---

## 14. –†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

–ö–∞—Ä—Ç–æ—á–∫–∞ **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–∫—Ç–∏–≤–Ω–∞** —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π React re-render:

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç –µ–¥—É / —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É / –≤–æ–¥—É
  ‚Üí React state (day) –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ DayTab
  ‚Üí DayTab re-render
  ‚Üí renderDiarySection() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ
  ‚Üí app.CascadeCard.renderCard({ day, ... }) –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è
  ‚Üí computeCascadeState() ‚Äî —á–∏—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è, 0 side effects
  ‚Üí CascadeCard —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è —Å –Ω–æ–≤—ã–º cascadeState
```

`computeCascadeState` ‚Äî **—á–∏—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è** (pure function):

- –ë–µ–∑ –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
- –ë–µ–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∞ –ø—Ä–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: ~0.5‚Äì2 –º—Å (3‚Äì5 meals + 0‚Äì2 trainings)

**–õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞** (`expanded`) ‚Äî —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `React.useState`
–≤–Ω—É—Ç—Ä–∏ `CascadeCard`. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ-—Ä–µ–Ω–¥–µ—Ä–∞—Ö –ø–æ–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω,
—Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏.

---

## 15. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Ä—É—á–Ω—É—é

| –®–∞–≥ | –î–µ–π—Å—Ç–≤–∏–µ                              | –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç                            |
| --- | ------------------------------------- | ---------------------------------------------- |
| 1   | –û—Ç–∫—Ä—ã—Ç—å Day tab –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö            | –ö–∞—Ä—Ç–æ—á–∫–∏ –Ω–µ—Ç                                   |
| 2   | –î–æ–±–∞–≤–∏—Ç—å 1 –ø—Ä–∏—ë–º –≤ –Ω–æ—Ä–º–µ              | BUILDING, ¬´–•–æ—Ä–æ—à–µ–µ –Ω–∞—á–∞–ª–æ¬ª, score~1.0, 1 —Ç–æ—á–∫–∞ |
| 3   | –î–æ–±–∞–≤–∏—Ç—å 2-–π –ø—Ä–∏—ë–º –≤ –Ω–æ—Ä–º–µ            | BUILDING, 2 —Ç–æ—á–∫–∏, hint –ø–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ/—á–µ–∫-–∏–Ω—É  |
| 4   | –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É 45 –º–∏–Ω            | score —Ä–∞—Å—Ç—ë—Ç, GROWING –µ—Å–ª–∏ score‚â•4.0           |
| 5   | –°—Ä–∞–∑—É –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (< 2—á)         | ANTI_LICENSING —Å–æ–æ–±—â–µ–Ω–∏–µ                       |
| 6   | –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏—ë–º —Å harm ‚â• 7             | BROKENüí™, —Ä–∞–∑—Ä—ã–≤ –ø—É–Ω–∫—Ç–∏—Ä–æ–º, anti-WTH —Å–æ–æ–±—â–µ–Ω–∏–µ |
| 7   | –î–æ–±–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π –ø—Ä–∏—ë–º   | RECOVERYüå±, –Ω–æ–≤–∞—è —Ç–æ—á–∫–∞, ¬´–ù–æ–≤–∞—è —Ü–µ–ø–æ—á–∫–∞¬ª       |
| 8   | –í–∑–≤–µ—Å–∏—Ç—å—Å—è —É—Ç—Ä–æ–º (weightMorning)      | checkin —Ç–æ—á–∫–∞ +0.5 –≤ score                     |
| 9   | –ó–∞–ø–∏—Å–∞—Ç—å –≤—Ä–µ–º—è —Å–Ω–∞ (sleepStart)       | sleep onset —Ç–æ—á–∫–∞, bonus/penalty –∑–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ |
| 10  | 5+ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π –∏–ª–∏ score ‚â• 7.0 | STRONGüî•, ¬´–ú–æ—â–Ω—ã–π –¥–µ–Ω—å¬ª, –∑–æ–ª–æ—Ç–æ                |
| 11  | –ù–∞–∂–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É                    | –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è —Ç–∞–π–º–ª–∞–π–Ω —Å —Å–æ–±—ã—Ç–∏—è–º–∏           |
| 12  | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ dark mode                 | –í—Å–µ —Ü–≤–µ—Ç–∞ —á–∏—Ç–∞—é—Ç—Å—è                             |
| 13  | –ö–æ–Ω—Å–æ–ª—å ‚Üí —Ñ–∏–ª—å—Ç—Ä `[HEYS.cascade]`     | –í—Å—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞; –∫–∞–∂–¥—ã–π –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π —à–∞–≥ –≤–∏–¥–µ–Ω    |

### –ö–æ–Ω—Å–æ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

```js
// –ü—Ä—è–º–æ–π —Ç–µ—Å—Ç –¥–≤–∏–∂–∫–∞ —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:
HEYS.CascadeCard.computeCascadeState(
  {
    meals: [
      { time: '08:00', items: [] },
      { time: '12:30', items: [] },
    ],
    trainings: [{ time: '10:00', duration: 45 }],
    steps: 5000,
    householdMin: 20,
    weightMorning: 75.3,
    sleep: { start: '23:00', hoursTotal: 7.5 },
    measurements: { waist: 80 },
    supplementsTaken: 2,
    supplementsPlanned: 3,
  },
  {},
  { kcal: 2000 },
  { stepsGoal: 10000 },
  null,
);
// –û–∂–∏–¥–∞–µ–º–æ: state=GROWING –∏–ª–∏ STRONG, score~5-8, –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏–π –≤ —Ü–µ–ø–æ—á–∫–µ
```

---

## –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –í–µ—Ä—Å–∏—è | –î–∞—Ç–∞       | –ò–∑–º–µ–Ω–µ–Ω–∏–µ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| ------ | ---------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| v1.0.0 | 2026-02-19 | –ü–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ `HEYS.ExpandableCard`. –ù–∞–∑–≤–∞–Ω–∏–µ ¬´–¢–≤–æ–π –∏–º–ø—É–ª—å—Å —Å–µ–≥–æ–¥–Ω—è¬ª                                                                                                                                                                                                                                                                                                                                                                                                                             |
| v1.1.0 | 2026-02-19 | Standalone –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–±–µ–∑ `ExpandableCard`). –î–µ—Ç–∞–ª—å–Ω–æ–µ 12-—à–∞–≥–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ ‚Üí ¬´–í–∞—à –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∫–∞—Å–∫–∞–¥¬ª. –Ø–≤–Ω—ã–µ DOM-–∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä—ã –≤–º–µ—Å—Ç–æ CSS `::before`                                                                                                                                                                                                                                                                                                                                          |
| v1.2.1 | 2026-02-19 | Decision chain visualization —É–ª—É—á—à–µ–Ω–∏—è. 816 LOC                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| v2.0.0 | 2026-02-19 | 10-—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞. 17-—à–∞–≥–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º. –ù–æ–≤—ã–µ —Ç–∏–ø—ã —Å–æ–±—ã—Ç–∏–π: household, sleep, checkin, measurements, supplements, insulin. EVENT_WEIGHTS —Å–∏—Å—Ç–µ–º–∞. Score-based —Å–æ—Å—Ç–æ—è–Ω–∏—è (BUILDING‚â•1.5, GROWING‚â•4.0, STRONG‚â•7.0). MOMENTUM_TARGET=10. –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤. ~1195 LOC                                                                                                                                                                                                      |
| v2.1.0 | 2026-02-20 | –ù–∞—É—á–Ω—ã–π –∞–ø–≥—Ä–µ–π–¥ –≤—Å–µ—Ö 10 —Ñ–∞–∫—Ç–æ—Ä–æ–≤: –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (sigmoid/bell-curve/log2) –≤–º–µ—Å—Ç–æ —Å—Ç—É–ø–µ–Ω–µ–π. –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π baseline (14-–¥–Ω–µ–≤–Ω–∞—è –º–µ–¥–∏–∞–Ω–∞). Chronotype-adaptive —Å–æ–Ω. Training load (dur√óintensity) + recovery-aware. Confidence layer (data volume ‚Üí weight modulation). Day-Type awareness (training/rest/active). 5 –∫—Ä–æ—Å—Å-—Ñ–∞–∫—Ç–æ—Ä–Ω—ã—Ö —Å–∏–Ω–µ—Ä–≥–∏–π. –ü–æ—Ä–æ–≥–∏: GROWING‚â•4.5, STRONG‚â•8.0, MOMENTUM_TARGET=12. 21-—à–∞–≥–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º                                                                                      |
| v2.2.0 | 2026-02-20 | **Soft Chain Degradation + Score-driven States.** –¶–µ–ø–æ—á–∫–∞ –±–æ–ª—å—à–µ –Ω–µ –æ–±–Ω—É–ª—è–µ—Ç—Å—è –ø—Ä–∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ–º —Å–æ–±—ã—Ç–∏–∏ ‚Äî –º—è–≥–∫–∞—è –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è —Å 3 —É—Ä–æ–≤–Ω—è–º–∏ –ø–µ–Ω–∞–ª—å—Ç–∏ (MINOR=1, MEDIUM=2, SEVERE=3) –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç—è–∂–µ—Å—Ç–∏. –°–æ—Å—Ç–æ—è–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ score (–±–µ–∑ hasBreak override): STRONG‚â•8, GROWING‚â•4.5, BUILDING‚â•1.5, RECOVERY>0, BROKEN‚â§0. –í–∏–∑—É–∞–ª—å–Ω–æ: –∂—ë–ª—Ç–æ-—è–Ω—Ç–∞—Ä–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (‚ö†) –≤–º–µ—Å—Ç–æ —Å–µ—Ä—ã—Ö —Ä–∞–∑—Ä—ã–≤–æ–≤ (‚úó). API: `breaks[]` ‚Üí `warnings[]` (—Å –ø–æ–ª—è–º–∏ penalty, chainAfter, weight)                              |
| v3.0.0 | 2026-02-21 | **Cascade Rate Score (CRS) v1.0 ‚Äî –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–π –∏–º–ø—É–ª—å—Å.** 30-–¥–Ω–µ–≤–Ω–∞—è EMA (Œ±=0.92) –∑–∞–º–µ–Ω—è–µ—Ç –æ–¥–Ω–æ–¥–Ω–µ–≤–Ω—ã–π score –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞. –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–ª–æ–∫ (ceiling) = f(consistency, diversity, dataDepth). DCS (Daily Contribution Score) —Å –∑–∞—â–∏—Ç–æ–π –∏–Ω–µ—Ä—Ü–∏–∏ (clamp ‚àí0.3) –∏ Critical Violation Override (–Ω–æ—á–Ω–æ–µ –ø–µ—Ä–µ–µ–¥–∞–Ω–∏–µ/harm). CRS-driven –ø–æ—Ä–æ–≥–∏: STRONG‚â•0.75, GROWING‚â•0.45, BUILDING‚â•0.20. –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ü–∏—è DCS –≤ localStorage (`_dcs_v1`).                                               |
| v3.1.0 | 2026-02-22 | **Goal-aware DCS override (–¥–µ—Ñ–∏—Ü–∏—Ç).** –¢—Ä–∏ —É—Ä–æ–≤–Ω—è –ø–µ–Ω–∞–ª—å—Ç–∏ –ø—Ä–∏ —Ü–µ–ª–∏ –ø–æ—Ö—É–¥–µ–Ω–∏—è: Level 1 (>targetMax ‚Üí clamp ‚àí0.4), Level 2 (>criticalOver ‚Üí ‚àí0.5), Level 3 (>150% ‚Üí ‚àí0.7). DEFICIT_OVERSHOOT –ø—É–ª —Å–æ–æ–±—â–µ–Ω–∏–π.                                                                                                                                                                                                                                                                                                     |
| v3.2.0 | 2026-02-23 | **Chronotype-tolerant sigmoid + MOMENTUM_TARGET.** –°–∏–≥–º–æ–∏–¥ –∑–∞—Å—ã–ø–∞–Ω–∏—è: `/45)√ó2.0` ‚Üí `/60)√ó1.5` (–º—è–≥—á–µ –¥–ª—è –ø–æ–∑–¥–Ω–∏—Ö —Ö—Ä–æ–Ω–æ—Ç–∏–ø–æ–≤). optimalOnset clamp: 00:30 ‚Üí 01:30. Hard floor: 03:00 ‚Üí 04:00. –î–∏–∞–ø–∞–∑–æ–Ω: [‚àí2.5,+1.5] ‚Üí [‚àí2.0,+1.2]. MOMENTUM_TARGET: 12.0 ‚Üí 10.0. DCS cache migration v1‚Üív2 (positive DCS √ó1.2).                                                                                                                                                                                                  |
| v3.3.0 | 2026-02-24 | **EMA stabilization + training tolerance.** Œ±: 0.92 ‚Üí 0.95 (–ø–µ—Ä–∏–æ–¥ –ø–æ–ª—É—Ä–∞—Å–ø–∞–¥–∞ ~14–¥ –≤–º–µ—Å—Ç–æ ~8–¥). Partial-day weighting: –≤–µ—Å —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–≥–æ –¥–Ω—è √ó dayProgress. Deficit training tolerance: –ø–æ—Ä–æ–≥–∏ √ó1.2 –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–Ω–µ–π. `buildDayEventsSimple`: graduated sleep buckets (6 —É—Ä–æ–≤–Ω–µ–π) + –ª–µ–π–±–ª—ã –ø–æ–¥ chronotype clamp.                                                                                                                                                                                         |
| v3.4.0 | 2026-02-24 | **Accurate retroactive DCS.** –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ—Å—á—ë—Ç —Ä–µ—Ç—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ–π —Ñ–æ—Ä–º—É–ª—ã: —Ä–∞–Ω—å—à–µ `‚àëbonuses/1.2` (–∑–∞–≤—ã—à–∞–ª–∞ DCS –Ω–∞ 50-100%), —Ç–µ–ø–µ—Ä—å –º–∏—Ä—Ä–æ—Ä–∏—Ç –ø–æ–ª–Ω—ã–π 10-—Ñ–∞–∫—Ç–æ—Ä–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º: sigmoid —Å–Ω–∞ —Å chronotype baseline –∏–∑ –æ–∫—Ä–µ—Å—Ç–Ω—ã—Ö –¥–Ω–µ–π, bell-curve –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, tanh —à–∞–≥–∏ —Å adaptive goal, training load (sqrt-curve), —Ü–∏—Ä–∫–∞–¥–Ω—ã–µ —à—Ç—Ä–∞—Ñ—ã –ø—Ä–∏—ë–º–æ–≤, log2 household, insulin gap proxy. –ö—ç—à v3‚Üív4: –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ + backfill —Å –ø–µ—Ä–µ–¥–∞—á–µ–π `prevDays` –¥–ª—è —Ö—Ä–æ–Ω–æ—Ç–∏–ø–Ω–æ–≥–æ baseline.                                                   |
| v3.4.1 | 2026-02-24 | **Calibrated retroactive DCS.** v3.4.0 –∑–∞–Ω–∏–∂–∞–ª–∞ DCS –Ω–∞ ~30% (flat 0.65/meal vs 0.95‚Äì1.15 –≤ full algo, flat checkin 0.4 –≤–º–µ—Å—Ç–æ streak-aware 0.8, –Ω–µ—Ç synergies/measurements). –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: time-band meals (breakfast 1.15, daytime 0.95, 21‚Äì23:00 0.50, late/night ‚àí1.0), streak-aware checkin (0.3+streak√ó0.05), adaptive household baseline –∏–∑ prevDays, 3rd+ training √ó0.25, synergy approximation (+0.15/+0.30/+0.50 –ø–æ –∫–æ–ª-–≤—É –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤), measurements. –ö—ç—à v4‚Üív5: –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ + –ø–µ—Ä–µ—Å—á—ë—Ç. |
| v3.4.2 | 2026-02-24 | **Meal weight calibration.** v3.4.1 meal weights –Ω–∞ 10-15% –Ω–∏–∂–µ full algo output (–≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ: —Å–µ–≥–æ–¥–Ω—è full algo –¥–∞—ë—Ç 1.00-1.20/meal, retro –¥–∞–≤–∞–ª 0.95). –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞: daytime 0.95‚Üí1.10, breakfast 1.15‚Üí1.25, evening 0.50‚Üí0.70. Missing-sleep default +0.3 (–ø—Ä–æ–ø—É—Å–∫ –¥–∞–Ω–Ω—ã—Ö ‚â† –ø–ª–æ—Ö–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ). Synergy –±–æ–Ω—É—Å—ã: 0.25/0.45/0.65/0.80 (–±—ã–ª–æ 0.15/0.30/0.50). –ö—ç—à v5‚Üív6: –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ + –ø–µ—Ä–µ—Å—á—ë—Ç.                                                                                                            |
| v3.5.0 | 2026-02-24 | **Chronotype-adaptive meals & Target calibration.** –°–¥–≤–∏–≥ —Ü–∏—Ä–∫–∞–¥–Ω—ã—Ö –ø–æ–ª–æ—Å –µ–¥—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ `optimalOnset` (–∞–¥–∞–ø—Ç–∞—Ü–∏—è –∫ —Ö—Ä–æ–Ω–æ—Ç–∏–ø—É, –∑–∞—â–∏—Ç–∞ —Å–æ–≤ –æ—Ç —à—Ç—Ä–∞—Ñ–∞ -1.0 –∑–∞ –µ–¥—É –≤ 23:30). –°–Ω–∏–∂–µ–Ω–∏–µ `MOMENTUM_TARGET` —Å 10.0 –¥–æ 8.5 –¥–ª—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ DCS –ø—Ä–∏ 4-5 –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–∞—Ö. –ö—ç—à v6‚Üív7: –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ + –ø–µ—Ä–µ—Å—á—ë—Ç.                                                                                                                                                                                                      |
| v3.5.1 | 2026-02-25 | **normKcal fallback fix + retroactive DCS correction.** –§–∏–∫—Å: `normKcal` fallback `2000` ‚Üí `0` –≤ `computeDailyContribution` (false positive `deficit_overshoot` –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ normAbs). –†–µ—Ç—Ä–æ–∞–∫—Ç–∏–≤–Ω–∞—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å DCS = ‚àí0.500 (exact value) —á–µ—Ä–µ–∑ backfill pass ‚Äî —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –±—ã–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –±–∞–≥–∞ —Å normKcal=2000.                                                                                                                                                                                         |
| v3.6.0 | 2026-02-25 | **CRS = base + todayBoost.** EMA —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–º –¥–Ω—è–º (i‚â•1). –°–µ–≥–æ–¥–Ω—è—à–Ω–∏–π DCS –¥–∞—ë—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –±–æ–Ω—É—Å: `todayBoost = max(0, DCS) √ó 0.03` (0..+3%). –†–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É: —Ä–∞–Ω—å—à–µ —á–∞—Å—Ç–∏—á–Ω—ã–π –≤–µ—Å –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ–≥–æ –¥–Ω—è —Ç—è–Ω—É–ª CRS –≤–Ω–∏–∑ –ø—Ä–∏ DCS < CRS (–ø–∞—Ä–∞–¥–æ–∫—Å ¬´–¥–æ–±–∞–≤–∏–ª —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É ‚Üí CRS –Ω–µ –≤—ã—Ä–æ—Å¬ª). –¢–µ–ø–µ—Ä—å CRS_base —Å—Ç–∞–±–∏–ª–µ–Ω –≤–µ—Å—å –¥–µ–Ω—å, –∞ todayBoost —Ä–∞—Å—Ç—ë—Ç —Å –∫–∞–∂–¥—ã–º –Ω–æ–≤—ã–º —Å–æ–±—ã—Ç–∏–µ–º. –£—Ç—Ä–æ–º CRS_base –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å –≤—á–µ—Ä–∞—à–Ω–∏–º DCS. `CRS_TODAY_BOOST = 0.03` ‚Äî –Ω–æ–≤–∞—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞.                                 |
