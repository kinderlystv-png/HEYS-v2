---
template-version: 3.3.0
created: 2025-12-16
updated: 2025-12-17
purpose: –û–±—â–∞—è+–ª–∏—á–Ω–∞—è –±–∞–∑–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å –æ–±–ª–∞—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π –∏ –º–æ–¥–µ—Ä–∞—Ü–∏–µ–π
optimization: –°–ª–µ–¥—É–µ–º .github/copilot-instructions.md
---

# Task: Shared products + –ª–∏—á–Ω–∞—è –±–∞–∑–∞ + –º–æ–¥–µ—Ä–∞—Ü–∏—è (Supabase `shared_products`)

## üìå TL;DR (–ö—Ä–∞—Ç–∫–∏–π –±—Ä–∏—Ñ)

**–¶–µ–ª—å**: –í–≤–µ—Å—Ç–∏ **–≥–ª–æ–±–∞–ª—å–Ω—É—é –±–∞–∑—É –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π HEYS**
(`shared_products` –≤ Supabase) –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ª–∏—á–Ω—ã—Ö –±–∞–∑ –∫–ª–∏–µ–Ω—Ç–æ–≤, –¥–æ–±–∞–≤–∏—Ç—å
–ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (üë§/üåê/–æ–±–∞) –∏ –ª–æ–∫–∞–ª—å–Ω—É—é –º–æ–¥–µ—Ä–∞—Ü–∏—é (blocklist).

**–ß—Ç–æ –¥–µ–ª–∞–µ–º** (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É):

1. –ü—Ä–æ–µ–∫—Ç–∏—Ä—É–µ–º –∏ —Å–æ–∑–¥–∞—ë–º —Ç–∞–±–ª–∏—Ü—É `shared_products` –≤ Supabase ‚Äî **–≥–ª–æ–±–∞–ª—å–Ω—É—é**
   –±–µ–∑ `curator_id` scope, RLS: SELECT –≤—Å–µ–º, INSERT authenticated, UPDATE —Ç–æ–ª—å–∫–æ
   –∞–≤—Ç–æ—Ä—É, DELETE –∑–∞–ø—Ä–µ—â—ë–Ω.
2. –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞: —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ –ª–∏—á–Ω—É—é –±–∞–∑—É + –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤
   –≥–ª–æ–±–∞–ª—å–Ω—É—é `shared_products` (curator) –∏–ª–∏ pending-–æ—á–µ—Ä–µ–¥—å (PIN).
3. –†–∞–∑–¥–µ–ª—è–µ–º –≤–∫–ª–∞–¥–∫—É ¬´–†–∞—Ü–∏–æ–Ω¬ª –Ω–∞ **–¥–≤–µ –ø–æ–¥–≤–∫–ª–∞–¥–∫–∏**:
   - ¬´üë§ –ü—Ä–æ–¥—É–∫—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞¬ª ‚Äî –ª–∏—á–Ω–∞—è –±–∞–∑–∞ + –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (üë§/üåê/–æ–±–∞).
   - ¬´üåê –û–±—â–∞—è –±–∞–∑–∞¬ª (curator-only) ‚Äî pending-–∑–∞—è–≤–∫–∏ —Å–≤–æ–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, –ø–æ–∏—Å–∫ –ø–æ
     –≥–ª–æ–±–∞–ª—å–Ω–æ–π –±–∞–∑–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤–æ–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤, –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–∫—Ä—ã—Ç–∏–µ
     (blocklist).
4. –ú–æ–¥–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ **–ª–æ–∫–∞–ª—å–Ω—ã–π blocklist** ‚Äî –∫—É—Ä–∞—Ç–æ—Ä —Å–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–æ–¥—É–∫—Ç—ã ¬´–¥–ª—è —Å–µ–±—è
   –∏ —Å–≤–æ–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤¬ª, –Ω–µ –≤–ª–∏—è—è –Ω–∞ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**–ó–∞—á–µ–º**:

- –ì–ª–æ–±–∞–ª—å–Ω–∞—è –±–∞–∑–∞ = **–≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ HEYS** –¥–µ–ª—è—Ç—Å—è –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏, –±—ã—Å—Ç—Ä–æ–µ
  –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ.
- –õ–∏—á–Ω–∞—è –±–∞–∑–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å –∏ –∏—Å—Ç–æ—Ä–∏—é –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏ (anti-orphan).
- –õ–æ–∫–∞–ª—å–Ω—ã–π blocklist = –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –º–æ–¥–µ—Ä–∞—Ü–∏—è –±–µ–∑ –≤–ª–∏—è–Ω–∏—è –Ω–∞ –¥—Ä—É–≥–∏—Ö.

**–í—Ä–µ–º—è**: ~6 —á–∞—Å–æ–≤

---

## üéØ WHY (–ë–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç)

**Problem**: –°–µ–π—á–∞—Å –ø—Ä–æ–¥—É–∫—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ —É –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞; –Ω–µ—Ç
–≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –ø—É–ª–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥—É–±–ª–∏—Ä—É—é—Ç –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ —Ç–æ–≤–∞—Ä—ã, –Ω–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞
–¥–µ–ª–∏—Ç—å—Å—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É –≤—Å–µ–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ HEYS.

**Impact**: –ó–∞–º–µ–¥–ª–µ–Ω–Ω—ã–π –≤–≤–æ–¥ –ø—Ä–æ–¥—É–∫—Ç–æ–≤, –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–∏–ª–∏–π –ø–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é –æ–¥–Ω–∏—Ö
–∏ —Ç–µ—Ö –∂–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Ä–∞–∑–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –Ω–µ—Ç ¬´–∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∑–Ω–∞–Ω–∏—è¬ª.

**Value**: –ì–ª–æ–±–∞–ª—å–Ω–∞—è –±–∞–∑–∞ = –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ HEYS –≤–Ω–æ—Å—è—Ç –≤–∫–ª–∞–¥ –∏ –ø–æ–ª—É—á–∞—é—Ç
–¥–æ—Å—Ç—É–ø –∫ –æ–±—â–µ–º—É –ø—É–ª—É –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤; –ª–æ–∫–∞–ª—å–Ω—ã–π blocklist –¥–∞—ë—Ç
–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –±–µ–∑ –≤–ª–∏—è–Ω–∏—è –Ω–∞ –¥—Ä—É–≥–∏—Ö.

---

## ü§ñ Output Preferences

**Workflow**: Propose plan first, then implement.

**Code style**: Follow copilot-instructions.md (Tailwind/BEM, no inline styles,
HEYS.store / U.lsSet patterns, no console.log). –†—É—Å—Å–∫–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ legacy.

**SQL –º–∏–≥—Ä–∞—Ü–∏–∏**:

- SQL-—Ñ–∞–π–ª—ã **—Å–æ–∑–¥–∞–≤–∞—Ç—å** –≤ `database/` –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –∫–æ–º–º–∏—Ç–æ–≤ (version control).
- **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ** –≤—ã–¥–∞–≤–∞—Ç—å —Ç–µ –∂–µ SQL **–≥–æ—Ç–æ–≤—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏** –≤ —á–∞—Ç.
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏—Ö –≤—Ä—É—á–Ω—É—é –≤ **Supabase Dashboard ‚Üí SQL Editor**.
- –ö–∞–∂–¥—ã–π –±–ª–æ–∫ SQL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–º** (`IF NOT EXISTS`, `OR REPLACE`).

---

## üìã WHAT (–ß–µ–∫-–ª–∏—Å—Ç –∑–∞–¥–∞—á)

### üîê –ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è (—á—Ç–æ–±—ã –Ω–µ —Å–ª–æ–≤–∏—Ç—å –±–∞–≥–∏ —Ç–∏–ø–∞ Orphan products)

> –≠—Ç–∏ –ø—É–Ω–∫—Ç—ã ‚Äî –∫—Ä–∏—Ç–∏—á–Ω—ã–µ, –∏–Ω–∞—á–µ –ª–µ–≥–∫–æ –ø–æ–ª—É—á–∏—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é, –∫–æ–≥–¥–∞ MealItem
> —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑–µ, –∏ UI –ø–∞–¥–∞–µ—Ç/—É—Ö–æ–¥–∏—Ç –≤
> fallback.

- **MealItem –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–µ–Ω —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç –∏–∑ –ª–∏—á–Ω–æ–π –±–∞–∑—ã
  (`heys_products`)**.
  - –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –ø—Ä–æ–¥—É–∫—Ç –∏–∑ –æ–±—â–µ–π –±–∞–∑—ã ‚Äî **–º—ã –∫–ª–æ–Ω–∏—Ä—É–µ–º –µ–≥–æ –≤
    –ª–∏—á–Ω—É—é** (—Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π –ª–æ–∫–∞–ª—å–Ω—ã–π `product.id`), –∏ —É–∂–µ —ç—Ç–æ—Ç `id` –ø–∏—à–µ–º –≤
    `MealItem.product_id`.
  - –û–±—â–∞—è –±–∞–∑–∞ ‚Äî —ç—Ç–æ **–∫–∞—Ç–∞–ª–æ–≥/—à–∞–±–ª–æ–Ω—ã –¥–ª—è –ø–æ–∏—Å–∫–∞**, –∞ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫
    –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏.
- **–ü—É–±–ª–∏–∫–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ shared ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞—è**:
  - –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–¥—É–∫—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ª–∏—á–Ω—É—é –±–∞–∑—É —á–µ—Ä–µ–∑
    `HEYS.products.setAll()` (–∏–ª–∏ –¥—Ä—É–≥–æ–π —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø—É—Ç—å, –ù–ï –ø—Ä—è–º–æ–π
    localStorage).
  - –ó–∞—Ç–µ–º (–µ—Å–ª–∏ online) –ø—É–±–ª–∏–∫—É–µ–º –∫–æ–ø–∏—é –≤ `shared_products`.
  - –ï—Å–ª–∏ offline ‚Äî –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ–º –ø—É–±–ª–∏–∫–∞—Ü–∏—é –≤ –æ—á–µ—Ä–µ–¥—å `heys_shared_pending_queue`
    (localStorage):
    - –ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è ‚Äî retry –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤.
    - –û—á–µ—Ä–µ–¥—å: `[{ product, fingerprint, retryCount, createdAt }]`
    - Max retries: 3, –ø–æ—Å–ª–µ —á–µ–≥–æ –ø–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å".

- **Scope –æ–±—â–µ–π –±–∞–∑—ã**: shared-–ø—Ä–æ–¥—É–∫—Ç—ã ‚Äî —ç—Ç–æ **–≥–ª–æ–±–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –≤—Å–µ—Ö
  –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π HEYS**.
  - –í—Å–µ –∫—É—Ä–∞—Ç–æ—Ä—ã –∏ –∏—Ö –∫–ª–∏–µ–Ω—Ç—ã –≤–∏–¥—è—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –ø—É–ª –ø—Ä–æ–¥—É–∫—Ç–æ–≤.
  - –≠—Ç–æ —É—Å–∫–æ—Ä—è–µ—Ç –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–∑—ã: –ø—Ä–æ–¥—É–∫—Ç, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π –æ–¥–Ω–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º,
    —Å—Ä–∞–∑—É –¥–æ—Å—Ç—É–ø–µ–Ω –≤—Å–µ–º.
  - –ú–æ–¥–µ—Ä–∞—Ü–∏—è: –∫–∞–∂–¥—ã–π –∫—É—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —Å–∫—Ä—ã—Ç—å –ø—Ä–æ–¥—É–∫—Ç **–¥–ª—è —Å–µ–±—è –∏ —Å–≤–æ–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤**
    (–ª–æ–∫–∞–ª—å–Ω—ã–π blocklist), –Ω–æ –Ω–µ —É–¥–∞–ª–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω–æ.

### ÔøΩ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏)

> **–≠—Ç–∏ —Ä–µ—à–µ–Ω–∏—è ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∞—É–¥–∏—Ç–∞. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–≥–æ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é.**

1. **Pending-–∑–∞—è–≤–∫–∏: Supabase —Ç–∞–±–ª–∏—Ü–∞ `shared_products_pending`**
   - **–í–º–µ—Å—Ç–æ**: –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –ø–æ client-kv-store –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ (—Å–ª–æ–∂–Ω–æ, –º–µ–¥–ª–µ–Ω–Ω–æ)
   - **–†–µ—à–µ–Ω–∏–µ**: –û—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ `shared_products_pending` –≤ Supabase
   - **RLS**: `INSERT IF created_by_client_id IN curator's clients`,
     `SELECT IF curator's client`
   - PIN-–∫–ª–∏–µ–Ω—Ç —Å–æ–∑–¥–∞—ë—Ç –∑–∞—è–≤–∫—É —á–µ—Ä–µ–∑ RPC
     `create_pending_product(client_id, product_data)`
   - –ö—É—Ä–∞—Ç–æ—Ä –≤–∏–¥–∏—Ç –≤—Å–µ pending —Å–≤–æ–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –æ–¥–Ω–∏–º SELECT

2. **Fingerprint = IMMUTABLE –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è**
   - **–ü—Ä–æ–±–ª–µ–º–∞**: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–π, –≤–ª–∏—è—é—â–∏—Ö –Ω–∞ fingerprint, –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å
     unique constraint
   - **–†–µ—à–µ–Ω–∏–µ**: –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞ –º–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å **—Ç–æ–ª—å–∫–æ**:
     - `category`
     - `portions` (JSON)
     - `description` (–µ—Å–ª–∏ –µ—Å—Ç—å)
   - **–ù–µ–ª—å–∑—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å**: `name`, `simple100`, `complex100`, `protein100`,
     `badFat100`, `goodFat100`, `trans100`, `fiber100`, `gi`, `harm`
   - UI: –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∏–∑–º–µ–Ω–∏—Ç—å ¬´—è–¥—Ä–æ¬ª –ø—Ä–æ–¥—É–∫—Ç–∞ ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å: ¬´–ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å
     —Å–æ—Å—Ç–∞–≤. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç.¬ª

3. **–ú—è–≥–∫–∏–π merge –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ fingerprint** üÜï
   - **–°—Ü–µ–Ω–∞—Ä–∏–π**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–æ–¥—É–∫—Ç, fingerprint —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å
     —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –≤ shared
   - **UX**: –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª–∫—É:

     ```
     üîç –ü–æ—Ö–æ–∂–∏–π –ø—Ä–æ–¥—É–∫—Ç —É–∂–µ –µ—Å—Ç—å –≤ –æ–±—â–µ–π –±–∞–∑–µ:
     "[–ù–∞–∑–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ]" ‚Äî –∫–∫–∞–ª, –ë–ñ–£, –ì–ò

     [‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π]  [‚ûï –°–æ–∑–¥–∞—Ç—å —Å–≤–æ–π]
     ```

   - **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π**: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–π shared –≤ –ª–∏—á–Ω—É—é –±–∞–∑—É,
     –ù–ï –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π
   - **–°–æ–∑–¥–∞—Ç—å —Å–≤–æ–π**: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ª–∏—á–Ω—É—é –±–∞–∑—É, –ù–ï –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤ shared
     (fingerprint –∑–∞–Ω—è—Ç)
   - –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç unique-–æ—à–∏–±–∫–∏ –∏ –¥—É–±–ª–∏–∫–∞—Ç—ã

4. **VIEW `shared_products_public` –¥–ª—è SELECT**
   - **–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä—è–º–æ–π SELECT –∏–∑ `shared_products` —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç
     `created_by_user_id` (–ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å)
   - **–†–µ—à–µ–Ω–∏–µ**: –°–æ–∑–¥–∞—Ç—å VIEW –±–µ–∑ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π, –Ω–æ —Å computed
     `is_mine`:
     ```sql
     CREATE VIEW shared_products_public AS
     SELECT id, name, name_norm, simple100, complex100, protein100,
            badFat100, goodFat100, trans100, fiber100, gi, harm,
            category, portions, description, fingerprint, created_at,
            (created_by_user_id = auth.uid()) AS is_mine  -- –¥–ª—è UI: "–í—ã" / "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å HEYS"
     FROM shared_products;
     ```
   - –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥ —á–∏—Ç–∞–µ—Ç **—Ç–æ–ª—å–∫–æ** —á–µ—Ä–µ–∑ `shared_products_public`
   - `created_by_user_id` –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –Ω–∞ backend/RLS –ø—Ä–æ–≤–µ—Ä–∫–∞—Ö
   - `is_mine = true` ‚Üí UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–í—ã", –∏–Ω–∞—á–µ "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å HEYS"

5. **`shared_origin_id` –≤ Product model ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–µ–π –∫–ª–æ–Ω–æ–≤**
   - **–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç shared ‚Üí –∫–ª–æ–Ω, –ø–æ—Ç–æ–º —Å–Ω–æ–≤–∞ –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–æ—Ç
     –∂–µ shared ‚Üí –µ—â—ë –∫–ª–æ–Ω
   - **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `shared_origin_id` –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π Product:
     ```javascript
     // –ü—Ä–∏ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏–∑ shared:
     const existingClone = products.find(
       (p) => p.shared_origin_id === sharedProduct.id,
     );
     if (existingClone) {
       // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–ª–æ–Ω, –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–π
       return existingClone;
     }
     // –ò–Ω–∞—á–µ —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π –∫–ª–æ–Ω —Å shared_origin_id = sharedProduct.id
     ```
   - –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Ä–∞–∑—Ä–∞—Å—Ç–∞–Ω–∏–µ –ª–∏—á–Ω–æ–π –±–∞–∑—ã –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏ –æ–¥–Ω–æ–≥–æ
     shared-–ø—Ä–æ–¥—É–∫—Ç–∞

6. **pg_trgm –∏–Ω–¥–µ–∫—Å –¥–ª—è –ø–æ–∏—Å–∫–∞**
   - **–î–ª—è**: –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø–æ `name_norm ILIKE '%query%'` –Ω–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–∞—Ö
   - **SQL**:
     ```sql
     CREATE EXTENSION IF NOT EXISTS pg_trgm;
     CREATE INDEX IF NOT EXISTS idx_shared_products_name_trgm
       ON shared_products USING GIN (name_norm gin_trgm_ops);
     ```
   - –£—Å–∫–æ—Ä—è–µ—Ç ILIKE-–ø–æ–∏—Å–∫ –≤ 10-100√ó –Ω–∞ —Ç–∞–±–ª–∏—Ü–∞—Ö >10k —Å—Ç—Ä–æ–∫

7. **RPC –¥–ª—è blocklist PIN-–∫–ª–∏–µ–Ω—Ç–æ–≤**
   - **–ü—Ä–æ–±–ª–µ–º–∞**: PIN-–∫–ª–∏–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å Supabase —Ç–∞–±–ª–∏—Ü—ã –Ω–∞–ø—Ä—è–º—É—é (–Ω–µ—Ç
     session)
   - **–†–µ—à–µ–Ω–∏–µ**: RPC —Ñ—É–Ω–∫—Ü–∏—è `get_client_blocklist(p_client_id uuid)`:
     ```sql
     CREATE OR REPLACE FUNCTION get_client_blocklist(p_client_id uuid)
     RETURNS uuid[] AS $$
       SELECT COALESCE(
         array_agg(product_id),
         ARRAY[]::uuid[]
       )
       FROM shared_products_blocklist
       WHERE client_id = p_client_id;
     $$ LANGUAGE sql SECURITY DEFINER;
     ```
   - –ö—É—Ä–∞—Ç–æ—Ä –ø—Ä–∏ sync –∫–ª–∏–µ–Ω—Ç–∞ –≤—ã–∑—ã–≤–∞–µ—Ç —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –∏ –ø—É—à–∏—Ç –º–∞—Å—Å–∏–≤ –≤ client-kv
     `heys_shared_products_blocklist`
   - PIN-–∫–ª–∏–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π blocklist –∏–∑ client-kv –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
     shared

### ÔøΩüöÄ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **–®–∞–≥ 0 ‚Äî –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–ª–æ–∫–µ—Ä**: –ï—Å—Ç—å –ª–∏ API –¥–ª—è —á—Ç–µ–Ω–∏—è client-kv –¥—Ä—É–≥–∏—Ö
   –∫–ª–∏–µ–Ω—Ç–æ–≤? (—Å–º. pending-–∑–∞—è–≤–∫–∏)
2. **–®–∞–≥ 1 ‚Äî SQL —Å—Ö–µ–º–∞**: `shared_products` + `shared_products_blocklist` + RLS
3. **–®–∞–≥ 2 ‚Äî UI –ø–æ–¥–≤–∫–ª–∞–¥–∫–∏**: –†–∞–∑–¥–µ–ª–∏—Ç—å –≤–∫–ª–∞–¥–∫—É ¬´–†–∞—Ü–∏–æ–Ω¬ª –Ω–∞ –¥–≤–µ –ø–æ–¥–≤–∫–ª–∞–¥–∫–∏
4. **–®–∞–≥ 3 ‚Äî –ë–∞–∑–æ–≤—ã–π flow**: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞ ‚Üí –ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤ shared / –í—ã–±–æ—Ä –∏–∑
   shared ‚Üí –∫–ª–æ–Ω
5. **–®–∞–≥ 4 ‚Äî Pending –¥–ª—è PIN**: –û—á–µ—Ä–µ–¥—å –∑–∞—è–≤–æ–∫, approve/reject
6. **–®–∞–≥ 5 ‚Äî Blocklist**: –°–∫—Ä—ã—Ç–∏–µ ¬´–¥–ª—è —Å–µ–±—è¬ª
7. **–®–∞–≥ 6 ‚Äî –ú–∏–≥—Ä–∞—Ü–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤

### Must Have (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ä–µ–ª–∏–∑–∞)

- [ ] **Supabase / DB** ‚Äî –¥–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É `shared_products` + –º–∏–≥—Ä–∞—Ü–∏—è
  - **Why**: –ù—É–∂–µ–Ω –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã –¥–ª—è –æ–±—â–µ–π –±–∞–∑—ã + –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–æ–¥–µ—Ä–∞—Ü–∏–∏
  - **Acceptance**:
    - –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π SQL-—Ñ–∞–π–ª –≤ `database/` (–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–π:
      `create table if not exists`, `create index if not exists`, –∏ —Ç.–¥.).
    - –í SQL —É—á—Ç–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
      - `create extension if not exists pgcrypto;` (–¥–ª—è `gen_random_uuid()`),
        –µ—Å–ª–∏ –µ—â—ë –Ω–µ –≤–∫–ª—é—á–µ–Ω–æ –≤ –ø—Ä–æ–µ–∫—Ç–µ
      - (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) `create extension if not exists pg_trgm;` + GIN-–∏–Ω–¥–µ–∫—Å –¥–ª—è
        —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞ –ø–æ `name_norm ilike` –Ω–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–∞—Ö
    - –¢–∞–±–ª–∏—Ü–∞ `public.shared_products` (–º–∏–Ω–∏–º—É–º):
      - `id uuid primary key default gen_random_uuid()`
      - `created_by_user_id uuid null` ‚Äî `auth.uid()` –∫—É—Ä–∞—Ç–æ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π
        –¥–æ–±–∞–≤–∏–ª/–ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –ø—Ä–æ–¥—É–∫—Ç
      - `created_by_client_id uuid null` ‚Äî uuid –∫–ª–∏–µ–Ω—Ç–∞ (PIN), —á–µ–π –ø—Ä–æ–¥—É–∫—Ç –±—ã–ª
        –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω (–¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏)
      - `name text not null`
      - `name_norm text not null` ‚Äî –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –∏–º—è (lower/trim/whitespace
        collapse)
      - `fingerprint text not null` ‚Äî —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∫–ª—é—á –¥–µ–¥—É–ø–∞ (—Å–º. –Ω–∏–∂–µ)
      - –ù—É—Ç—Ä–∏–µ–Ω—Ç—ã **–≤ —Ç–æ–π –∂–µ —Å–µ–º–∞–Ω—Ç–∏–∫–µ —á—Ç–æ Product (–Ω–∞ 100–≥)**: `simple100`,
        `complex100`, `protein100`, `badFat100`, `goodFat100`, `trans100`,
        `fiber100`, `gi`, `harm`, `category`, `portions jsonb`
      - `description text null` ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ–µ –ø–æ–ª–µ)
      - `created_at timestamptz default timezone('utc', now())`
      - `updated_at timestamptz default timezone('utc', now())`
      - ~~`is_hidden`~~ ‚Äî **—É–±—Ä–∞–Ω–æ** (—Å–∫—Ä—ã—Ç–∏–µ —Ç–µ–ø–µ—Ä—å —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã–π blocklist)
    - –ò–Ω–¥–µ–∫—Å—ã/–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
      - `unique (fingerprint)` ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–π –¥–µ–¥—É–ø: –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –ø—Ä–æ–¥—É–∫—Ç –Ω–µ
        –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –≤ –±–∞–∑–µ
      - index –Ω–∞ `name_norm` (–¥–ª—è `ilike`/–ø–æ–∏—Å–∫–∞)
      - index –Ω–∞ `created_by_user_id` (–¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ "–º–æ–∏ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ")
    - –î–µ–¥—É–ø / fingerprint:
      - Fingerprint –¥–æ–ª–∂–µ–Ω —Å—Ç—Ä–æ–∏—Ç—å—Å—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ –∏–∑ `name_norm` +
        –Ω—É—Ç—Ä–∏–µ–Ω—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, sha256 —Å—Ç—Ä–æ–∫–∏ —Å –æ–∫—Ä—É–≥–ª—ë–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏). –≠—Ç–æ
        –ø–æ–∑–≤–æ–ª—è–µ—Ç:
        - –Ω–µ –ø–ª–æ–¥–∏—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã,
        - –¥–æ–ø—É—Å–∫–∞—Ç—å –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –∏–º—è —Å —Ä–∞–∑–Ω—ã–º–∏ –Ω—É—Ç—Ä–∏–µ–Ω—Ç–∞–º–∏ (—Ä–∞–∑–Ω—ã–π fingerprint).
    - –¢—Ä–∏–≥–≥–µ—Ä `updated_at` (–∫–∞–∫ –≤ `supabase_full_setup.sql` –ø–∞—Ç—Ç–µ—Ä–Ω–µ), –µ—Å–ª–∏ –≤
      –ø—Ä–æ–µ–∫—Ç–µ —É–∂–µ –µ—Å—Ç—å `set_updated_at()`.
    - –ü—Ä–∞–≤–∞ (—á–∞—Å—Ç–æ –∑–∞–±—ã–≤–∞—é—Ç –∏ –ø–æ—Ç–æ–º ¬´–≤—Å—ë 401/403¬ª):
      - `grant select on table public.shared_products to anon, authenticated;`
      - `grant insert, update on table public.shared_products to authenticated;`
        (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–æ –≤–∞—à–µ–π RLS-–º–æ–¥–µ–ª–∏)
    - RLS –ø–æ–ª–∏—Ç–∏–∫–∏ (–≥–ª–æ–±–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –±–µ–∑ curator scoping):
      - **SELECT**: —Ä–∞–∑—Ä–µ—à—ë–Ω –≤—Å–µ–º (–≤–∫–ª—é—á–∞—è `anon`) ‚Äî –≤—Å—è –±–∞–∑–∞ –ø—É–±–ª–∏—á–Ω–∞—è.
      - **INSERT**: —Ä–∞–∑—Ä–µ—à—ë–Ω —Ç–æ–ª—å–∫–æ `authenticated`.
      - **UPDATE**: —Ä–∞–∑—Ä–µ—à—ë–Ω —Ç–æ–ª—å–∫–æ **–∞–≤—Ç–æ—Ä—É** –ø—Ä–æ–¥—É–∫—Ç–∞:
        `created_by_user_id = auth.uid()`.
        - –ú–æ–¥–µ—Ä–∞—Ü–∏—è: –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å–∫—Ä—ã—Ç–∏—è –Ω–µ—Ç; –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ **–ª–æ–∫–∞–ª—å–Ω—ã–π
          blocklist** (—Å–º. –Ω–∏–∂–µ).
      - **DELETE**: **–∑–∞–ø—Ä–µ—â—ë–Ω** (–ø—Ä–æ–¥—É–∫—Ç—ã –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è –∏–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –±–∞–∑—ã;
        —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–∫—Ä—ã—Ç–∏–µ).
    - **–õ–æ–∫–∞–ª—å–Ω—ã–π blocklist** (–º–æ–¥–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Å–∫—Ä—ã—Ç–∏–µ ¬´–¥–ª—è —Å–µ–±—è¬ª):
      - –ö—É—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç ¬´—Å–∫—Ä—ã—Ç—å –¥–ª—è —Å–µ–±—è –∏ —Å–≤–æ–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤¬ª –ª—é–±–æ–π –ø—Ä–æ–¥—É–∫—Ç –∏–∑
        –≥–ª–æ–±–∞–ª—å–Ω–æ–π –±–∞–∑—ã.
      - **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è**: —Ç–∞–±–ª–∏—Ü–∞ `shared_products_blocklist` –≤ Supabase (–¥–ª—è
        —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –∫—É—Ä–∞—Ç–æ—Ä–∞):
        ```sql
        CREATE TABLE shared_products_blocklist (
          curator_id uuid REFERENCES auth.users(id) ON DELETE CASCADE,
          product_id uuid REFERENCES shared_products(id) ON DELETE CASCADE,
          created_at timestamptz DEFAULT now(),
          PRIMARY KEY (curator_id, product_id)
        );
        -- RLS: —Ç–æ–ª—å–∫–æ —Å–≤–æ–π blocklist
        ALTER TABLE shared_products_blocklist ENABLE ROW LEVEL SECURITY;
        CREATE POLICY "Users manage own blocklist" ON shared_products_blocklist
          FOR ALL USING (curator_id = auth.uid());
        ```
      - –ü—Ä–∏ –ø–æ–∏—Å–∫–µ –≤ shared: –∏—Å–∫–ª—é—á–∞—Ç—å –ø—Ä–æ–¥—É–∫—Ç—ã –∏–∑ blocklist —Ç–µ–∫—É—â–µ–≥–æ –∫—É—Ä–∞—Ç–æ—Ä–∞.
      - –≠—Ç–æ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Äî –æ–Ω–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –≤–∏–¥–µ—Ç—å –ø—Ä–æ–¥—É–∫—Ç.
    - **VIEW –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ SELECT** (—Å–∫—Ä—ã–≤–∞–µ—Ç `created_by_user_id`):

      ```sql
      CREATE OR REPLACE VIEW shared_products_public AS
      SELECT id, name, name_norm, simple100, complex100, protein100,
             badFat100, goodFat100, trans100, fiber100, gi, harm,
             category, portions, description, fingerprint, created_at,
             (created_by_user_id = auth.uid()) AS is_mine
      FROM shared_products;

      GRANT SELECT ON shared_products_public TO anon, authenticated;
      ```

      - –í–µ—Å—å –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥ —á–∏—Ç–∞–µ—Ç **—Ç–æ–ª—å–∫–æ** —á–µ—Ä–µ–∑ `shared_products_public`
      - `created_by_user_id` –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º –∏ RLS-–ø—Ä–æ–≤–µ—Ä–∫–∞–º
      - `is_mine = true` ‚Üí UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç ¬´–í—ã¬ª, –∏–Ω–∞—á–µ ¬´–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å HEYS¬ª

    - **pg_trgm –∏–Ω–¥–µ–∫—Å –¥–ª—è –ø–æ–∏—Å–∫–∞**:
      ```sql
      CREATE EXTENSION IF NOT EXISTS pg_trgm;
      CREATE INDEX IF NOT EXISTS idx_shared_products_name_trgm
        ON shared_products USING GIN (name_norm gin_trgm_ops);
      ```
    - **Pending-—Ç–∞–±–ª–∏—Ü–∞** (–¥–ª—è –∑–∞—è–≤–æ–∫ –æ—Ç PIN-–∫–ª–∏–µ–Ω—Ç–æ–≤):

      ```sql
      CREATE TABLE shared_products_pending (
        id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
        client_id uuid NOT NULL,  -- –∫–ª–∏–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–ª–æ–∂–∏–ª –ø—Ä–æ–¥—É–∫—Ç
        curator_id uuid NOT NULL REFERENCES auth.users(id),  -- –∫—É—Ä–∞—Ç–æ—Ä –∫–ª–∏–µ–Ω—Ç–∞
        product_data jsonb NOT NULL,  -- –ø–æ–ª–Ω—ã–π –æ–±—ä–µ–∫—Ç –ø—Ä–æ–¥—É–∫—Ç–∞
        name_norm text NOT NULL,
        fingerprint text NOT NULL,
        status text NOT NULL DEFAULT 'pending' CHECK (status IN ('pending', 'approved', 'rejected')),
        reject_reason text,
        created_at timestamptz DEFAULT now(),
        moderated_at timestamptz,
        moderated_by uuid REFERENCES auth.users(id)
      );

      -- RLS: –∫—É—Ä–∞—Ç–æ—Ä –≤–∏–¥–∏—Ç –∑–∞—è–≤–∫–∏ —Å–≤–æ–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
      ALTER TABLE shared_products_pending ENABLE ROW LEVEL SECURITY;
      CREATE POLICY "Curator sees own clients pending" ON shared_products_pending
        FOR SELECT USING (curator_id = auth.uid());
      CREATE POLICY "Curator manages own clients pending" ON shared_products_pending
        FOR UPDATE USING (curator_id = auth.uid());

      -- RPC –¥–ª—è PIN-–∫–ª–∏–µ–Ω—Ç–æ–≤ (—Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏ –±–µ–∑ session)
      CREATE OR REPLACE FUNCTION create_pending_product(
        p_client_id uuid,
        p_product_data jsonb,
        p_name_norm text,
        p_fingerprint text
      ) RETURNS jsonb AS $$
      DECLARE
        v_curator_id uuid;
        v_pending_id uuid;
        v_existing_id uuid;
      BEGIN
        -- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –ø—Ä–æ–¥—É–∫—Ç —Å —Ç–∞–∫–∏–º fingerprint —É–∂–µ –µ—Å—Ç—å –≤ shared?
        SELECT id INTO v_existing_id FROM shared_products WHERE fingerprint = p_fingerprint;
        IF v_existing_id IS NOT NULL THEN
          -- –í–µ—Ä–Ω—É—Ç—å existing_id –¥–ª—è soft merge –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
          RETURN jsonb_build_object('status', 'exists', 'existing_id', v_existing_id);
        END IF;

        -- –ü–æ–ª—É—á–∏—Ç—å –∫—É—Ä–∞—Ç–æ—Ä–∞ –∫–ª–∏–µ–Ω—Ç–∞
        SELECT curator_id INTO v_curator_id FROM clients WHERE id = p_client_id;
        IF v_curator_id IS NULL THEN
          RAISE EXCEPTION 'Client not found or has no curator';
        END IF;

        INSERT INTO shared_products_pending
          (client_id, curator_id, product_data, name_norm, fingerprint)
        VALUES
          (p_client_id, v_curator_id, p_product_data, p_name_norm, p_fingerprint)
        RETURNING id INTO v_pending_id;

        RETURN jsonb_build_object('status', 'pending', 'pending_id', v_pending_id);
      END;
      $$ LANGUAGE plpgsql SECURITY DEFINER;
      ```

    - **RPC –¥–ª—è blocklist PIN-–∫–ª–∏–µ–Ω—Ç–æ–≤**:
      ```sql
      CREATE OR REPLACE FUNCTION get_client_blocklist(p_client_id uuid)
      RETURNS uuid[] AS $$
        SELECT COALESCE(array_agg(b.product_id), ARRAY[]::uuid[])
        FROM shared_products_blocklist b
        JOIN clients c ON c.curator_id = b.curator_id
        WHERE c.id = p_client_id;
      $$ LANGUAGE sql SECURITY DEFINER;
      ```

  - **Files**: `database/2025-12-16_shared_products.sql`,
    `database/2025-12-16_shared_products_blocklist.sql`,
    `database/2025-12-16_shared_products_pending.sql`

- [ ] **Legacy storage** ‚Äî –ø—É–±–ª–∏–∫–∞—Ü–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ –æ–±–µ –±–∞–∑—ã
  - **Why**: –ù–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏—á–Ω–æ –∏ –≤ –æ–±—â–µ–º –ø—É–ª–µ
  - **Acceptance**:
    - –ü—Ä–∏ **—Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞** —á–µ—Ä–µ–∑ UI:
      1. –æ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ª–∏—á–Ω—É—é –±–∞–∑—É (`heys_products` —Å clientId namespace)
         —á–µ—Ä–µ–∑ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø—É—Ç—å (`HEYS.products.setAll()` /
         `HEYS.store.set('heys_products', ...)` ‚Äî –ù–ï –ø—Ä—è–º–æ–π
         `localStorage.setItem`).
      2. **–ú—è–≥–∫–∏–π merge**: –ø–µ—Ä–µ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π –ø—Ä–æ–≤–µ—Ä—è–µ–º fingerprint –≤ shared:
         - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω —Å–æ–≤–ø–∞–¥–∞—é—â–∏–π ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª–∫—É ¬´–ü–æ—Ö–æ–∂–∏–π –ø—Ä–æ–¥—É–∫—Ç —É–∂–µ –µ—Å—Ç—å¬ª
           (—Å–º. –ø.3 –≤ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ä–µ—à–µ–Ω–∏—è—Ö).
         - –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –ø—É–±–ª–∏–∫—É–µ–º –∫–æ–ø–∏—é –≤ `shared_products` (–µ—Å–ª–∏ online).
    - –ü—Ä–∏ **–≤—ã–±–æ—Ä–µ –ø—Ä–æ–¥—É–∫—Ç–∞ –∏–∑ shared** –≤ –ø—Ä–∏—ë–º –ø–∏—â–∏:
      - **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª—è –∫–ª–æ–Ω–∞**: —Å–Ω–∞—á–∞–ª–∞ –∏—â–µ–º –≤ –ª–∏—á–Ω–æ–π –±–∞–∑–µ –ø–æ
        `shared_origin_id === sharedProduct.id`.
      - –ï—Å–ª–∏ –∫–ª–æ–Ω —É–∂–µ –µ—Å—Ç—å ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ, –ù–ï —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π.
      - –ï—Å–ª–∏ –∫–ª–æ–Ω–∞ –Ω–µ—Ç ‚Üí —Å–æ–∑–¥–∞—ë–º –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç —Å
        `shared_origin_id = sharedProduct.id`.
      - –í `MealItem.product_id` –ø–∏—à–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–π `id`.
      - —ç—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç Orphan –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ –¥–µ–ª–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–π –æ—Ç shared.
      - **–í–∞–∂–Ω–æ**: –ï—Å–ª–∏ –∞–≤—Ç–æ—Ä —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç –ø—Ä–æ–¥—É–∫—Ç –≤ shared ‚Äî **–ª–æ–∫–∞–ª—å–Ω—ã–µ –∫–ª–æ–Ω—ã —É
        –∫–ª–∏–µ–Ω—Ç–æ–≤ –ù–ï –º–µ–Ω—è—é—Ç—Å—è**. –≠—Ç–æ feature, –Ω–µ bug ‚Äî –∑–∞—â–∏—â–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –ø—Ä–∏—ë–º–æ–≤
        –ø–∏—â–∏ –æ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π. –í –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é ¬´–æ–±–Ω–æ–≤–∏—Ç—å –∏–∑ –æ–±—â–µ–π
        –±–∞–∑—ã¬ª.
    - **–ü–æ–ª–µ `shared_origin_id`** (–¥–æ–±–∞–≤–∏—Ç—å –≤ Product model):
      - `shared_origin_id: string | null` ‚Äî ID –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ `shared_products`,
        –µ—Å–ª–∏ –ø—Ä–æ–¥—É–∫—Ç —Å–∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω –∏–∑ shared.
      - –ï—Å–ª–∏ `null` ‚Äî –ø—Ä–æ–¥—É–∫—Ç —Å–æ–∑–¥–∞–Ω –ª–æ–∫–∞–ª—å–Ω–æ (–Ω–µ –∏–∑ shared).
      - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–µ–π –∫–ª–æ–Ω–æ–≤ –æ–¥–Ω–æ–≥–æ shared-–ø—Ä–æ–¥—É–∫—Ç–∞.
      - ‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –ü–æ–ª–µ –¥–æ–ª–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ cloud sync (kv_store) ‚Äî –∏–Ω–∞—á–µ
        –ø—Ä–∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–µ —Å–≤—è–∑—å —Å shared –ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è.
    - –î–µ–¥—É–ø –ø—É–±–ª–∏–∫–∞—Ü–∏–∏:
      - –ø—É–±–ª–∏–∫–∞—Ü–∏—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞ –ø–æ `fingerprint` **–≥–ª–æ–±–∞–ª—å–Ω–æ**.
      - –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏.
      - –¥–ª—è upsert –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `onConflict: 'fingerprint'` (–≥–ª–æ–±–∞–ª—å–Ω—ã–π unique).
      - **–ü–µ—Ä–≤—ã–π –¥–æ–±–∞–≤–∏–≤—à–∏–π** –ø—Ä–æ–¥—É–∫—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –µ–≥–æ ¬´–∞–≤—Ç–æ—Ä–æ–º¬ª
        (`created_by_user_id`).
  - **Files**: —Ç–æ—á–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/–≤—ã–±–æ—Ä–∞ –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ `apps/web/heys_core_v12.js`
    (–∏–ª–∏ –≥–¥–µ —Å–µ–π—á–∞—Å —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–æ–¥—É–∫—Ç), –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Supabase –≤
    `apps/web/heys_storage_supabase_v1.js`.

- [ ] **UI –†–∞—Ü–∏–æ–Ω–∞** ‚Äî –¥–≤–µ –ø–æ–¥–≤–∫–ª–∞–¥–∫–∏ (tabs) –≤–Ω—É—Ç—Ä–∏ –≤–∫–ª–∞–¥–∫–∏ ¬´–†–∞—Ü–∏–æ–Ω¬ª
  - **Why**: –†–∞–∑–¥–µ–ª–∏—Ç—å –ª–∏—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞ –∏ –≥–ª–æ–±–∞–ª—å–Ω—É—é –±–∞–∑—É –≤—Å–µ—Ö
    –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π HEYS; –¥–∞—Ç—å –∫—É—Ä–∞—Ç–æ—Ä—É —É–¥–æ–±–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ.
  - **Acceptance**:
    - –í–∫–ª–∞–¥–∫–∞ ¬´–†–∞—Ü–∏–æ–Ω¬ª —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç **–¥–≤–µ –ø–æ–¥–≤–∫–ª–∞–¥–∫–∏** (tabs):
      1. **üë§ –ü—Ä–æ–¥—É–∫—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞** ‚Äî —Ç–µ–∫—É—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª: –ª–∏—á–Ω–∞—è –±–∞–∑–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
         –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞, –ø–æ–∏—Å–∫, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ.
      2. **üåê –û–±—â–∞—è –±–∞–∑–∞** ‚Äî **—Ç–æ–ª—å–∫–æ –¥–ª—è –∫—É—Ä–∞—Ç–æ—Ä–∞** (—Å–º. –Ω–∏–∂–µ).
    - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ—Ç–∫—Ä—ã—Ç–∞ –ø–µ—Ä–≤–∞—è –ø–æ–¥–≤–∫–ª–∞–¥–∫–∞ (–ª–∏—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã).
    - –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –ø–æ–¥–≤–∫–ª–∞–¥–∫–∞–º–∏ ‚Äî –≤–∏–∑—É–∞–ª—å–Ω–æ –∫–∞–∫ tabs/segmented control.
    - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ–∫—É—â–µ–π –ø–æ–¥–≤–∫–ª–∞–¥–∫–∏ **–ù–ï** —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è (–ø—Ä–∏ —Å–º–µ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞ –∏–ª–∏
      –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ ¬´üë§ –ü—Ä–æ–¥—É–∫—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞¬ª).
  - **Files**: `apps/web/heys_day_v12.js` (RationTab –∏–ª–∏ –≥–¥–µ —Å–µ–π—á–∞—Å —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è
    —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤); —Å—Ç–∏–ª–∏ –≤ `styles/heys-components.css` (BEM) –∏–ª–∏ Tailwind

- [ ] **UI ¬´üë§ –ü—Ä–æ–¥—É–∫—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞¬ª** ‚Äî –ª–∏—á–Ω–∞—è –±–∞–∑–∞ (–ø–æ–¥–≤–∫–ª–∞–¥–∫–∞)
  - **Why**: –¢–µ–∫—É—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ª–∏—á–Ω—ã–º–∏ –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ –∫–ª–∏–µ–Ω—Ç–∞.
  - **Acceptance**:
    - –°–æ–¥–µ—Ä–∂–∏—Ç –≤—Å—ë —á—Ç–æ –µ—Å—Ç—å —Å–µ–π—á–∞—Å:
      - –ø–æ–∏—Å–∫/–∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç,
      - —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤,
      - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞,
      - –≤—ã–±–æ—Ä –ø—Ä–æ–¥—É–∫—Ç–∞ –¥–ª—è –ø—Ä–∏—ë–º–∞ –ø–∏—â–∏.
    - –î–æ–±–∞–≤–∏—Ç—å **–ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø–æ–∏—Å–∫–∞** (segmented / radio):
      - –∑–Ω–∞—á–µ–Ω–∏—è: **üë§ –ú–æ–∏ / üåê –û–±—â–∏–µ / üë§+üåê –û–±–∞**
      - –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: **–û–±–∞**
      - –≤–ª–∏—è–µ—Ç –Ω–∞:
        - –ø–æ–∏—Å–∫/–∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç,
        - —Å–ø–∏—Å–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤,
        - –≤—ã–±–æ—Ä –ø—Ä–æ–¥—É–∫—Ç–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è.
      - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è **–Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞** (–≤ clientId namespace, —á–µ—Ä–µ–∑
        `HEYS.store`/`U.lsSet`) –∏ –Ω–µ –ª–æ–º–∞–µ—Ç —Ç–µ–∫—É—â–∏–π UX.
    - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞:
      - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ª–∏—á–Ω—É—é –±–∞–∑—É (`heys_products`),
      - –ø–ª—é—Å –ø–æ—è–≤–ª—è–µ—Ç—Å—è checkbox/toggle ¬´–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤ –æ–±—â—É—é –±–∞–∑—É¬ª (–ø–æ
        —É–º–æ–ª—á–∞–Ω–∏—é **–≤–∫–ª—é—á–µ–Ω**):
        - –¥–ª—è –∫—É—Ä–∞—Ç–æ—Ä–∞: –ø—Ä–æ–¥—É–∫—Ç —Å—Ä–∞–∑—É –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –≤ `shared_products`,
        - –¥–ª—è PIN-–∫–ª–∏–µ–Ω—Ç–∞: —Å–æ–∑–¥–∞—ë—Ç—Å—è –∑–∞—è–≤–∫–∞ –≤ pending-–æ—á–µ—Ä–µ–¥–∏.
    - –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –ø—Ä–æ–¥—É–∫—Ç–∞ –∏–∑ –ø–æ–∏—Å–∫–∞:
      - –ï—Å–ª–∏ —ç—Ç–æ **–ª–∏—á–Ω—ã–π** –ø—Ä–æ–¥—É–∫—Ç (`üë§`) ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ –Ω–∞–ø—Ä—è–º—É—é.
      - –ï—Å–ª–∏ —ç—Ç–æ **–æ–±—â–∏–π** –ø—Ä–æ–¥—É–∫—Ç (`üåê`) ‚Äî –∫–ª–æ–Ω–∏—Ä—É–µ–º –≤ –ª–∏—á–Ω—É—é –±–∞–∑—É –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º
        –∫–ª–æ–Ω (anti-orphan).
    - –ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ –≤ —Å–ø–∏—Å–∫–µ: `üë§` (–ª–∏—á–Ω—ã–π) / `üåê` (–æ–±—â–∏–π) ‚Äî –µ—Å–ª–∏ –ø–æ–∏—Å–∫ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç
      –æ–±–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞.
  - **Files**: —Ç–µ–∫—É—â–∏–π –∫–æ–¥ RationTab/ProductsManager

- [ ] **UI ¬´üåê –û–±—â–∞—è –±–∞–∑–∞¬ª (Curator-only)** ‚Äî –ø–æ–¥–≤–∫–ª–∞–¥–∫–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±—â–µ–π
      –±–∞–∑–æ–π
  - **Why**: –ö—É—Ä–∞—Ç–æ—Ä—É –Ω—É–∂–µ–Ω —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞, –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –∏
    —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—â–µ–π –±–∞–∑—ã –ø—Ä–æ–¥—É–∫—Ç–æ–≤.
  - **Acceptance**:
    - –ü–æ–¥–≤–∫–ª–∞–¥–∫–∞ –≤–∏–¥–Ω–∞ **—Ç–æ–ª—å–∫–æ –≤ curator-—Ä–µ–∂–∏–º–µ**:
      - –µ—Å—Ç—å Supabase session (`user != null`),
      - **–ù–ï** –≤–∫–ª—é—á—ë–Ω PIN/RPC-only —Ä–µ–∂–∏–º (`HEYS.cloud._rpcOnlyMode === false`).
    - –î–ª—è PIN-–∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ–¥–≤–∫–ª–∞–¥–∫–∞ **–Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è** (—Ç–æ–ª—å–∫–æ ¬´üë§ –ü—Ä–æ–¥—É–∫—Ç—ã
      –∫–ª–∏–µ–Ω—Ç–∞¬ª).
    - **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–¥–≤–∫–ª–∞–¥–∫–∏**:
      1. **–ë–ª–æ–∫ Pending-–∑–∞—è–≤–æ–∫** (—Å–≤–µ—Ä—Ö—É):
         - –ó–∞–≥–æ–ª–æ–≤–æ–∫: ¬´üÜï –û–∂–∏–¥–∞—é—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è¬ª + –±–µ–π–¥–∂ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä
           `(3)`).
         - –ï—Å–ª–∏ pending-–∑–∞—è–≤–æ–∫ –Ω–µ—Ç ‚Äî –±–ª–æ–∫ —Å–∫—Ä—ã—Ç –∏–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç ¬´–ù–µ—Ç –∑–∞—è–≤–æ–∫¬ª.
         - **–ó–∞–≥—Ä—É–∑–∫–∞ pending** ‚Äî –æ–¥–Ω–∏–º SELECT –∏–∑ `shared_products_pending`:
           ```javascript
           const { data: pending } = await supabase
             .from('shared_products_pending')
             .select('*')
             .eq('curator_id', user.id)
             .eq('status', 'pending')
             .order('created_at', { ascending: false });
           ```
         - –ø—Ä–µ–≤—å—é: –∏–º—è, –∫–∫–∞–ª100, –ë–ñ–£, –ì–ò/–≤—Ä–µ–¥ (–µ—Å–ª–∏ –µ—Å—Ç—å), –∏–º—è –∫–ª–∏–µ–Ω—Ç–∞,
         - –∫–Ω–æ–ø–∫–∏ **‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å** / **‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å** (–æ–ø—Ü. –ø–æ–ª–µ –ø—Ä–∏—á–∏–Ω—ã),
         - —Å–æ—Å—Ç–æ—è–Ω–∏—è: loading / empty / error.
         - **–ü—Ä–æ–≤–µ—Ä–∫–∞ blocklist**: –µ—Å–ª–∏ fingerprint –∑–∞—è–≤–∫–∏ —É–∂–µ —Å–∫—Ä—ã—Ç –≤ blocklist
           –∫—É—Ä–∞—Ç–æ—Ä–∞ ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ ¬´‚ö†Ô∏è –ü–æ—Ö–æ–∂–∏–π –ø—Ä–æ–¥—É–∫—Ç —Å–∫—Ä—ã—Ç –¥–ª—è –≤–∞—Å¬ª
           (–Ω–æ approve –≤—Å—ë —Ä–∞–≤–Ω–æ –≤–æ–∑–º–æ–∂–µ–Ω).
         - –ü–æ—Å–ª–µ approve: –ø—Ä–æ–¥—É–∫—Ç –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –≤ `shared_products` (upsert –ø–æ
           fingerprint), –∑–∞—è–≤–∫–∞ –ø–æ–º–µ—á–∞–µ—Ç—Å—è `approved`.
         - –ü–æ—Å–ª–µ reject: –∑–∞—è–≤–∫–∞ –ø–æ–º–µ—á–∞–µ—Ç—Å—è `rejected` —Å –ø—Ä–∏—á–∏–Ω–æ–π.
      2. **–ü–æ–∏—Å–∫ –ø–æ –æ–±—â–µ–π –±–∞–∑–µ**:
      - Input –ø–æ–∏—Å–∫–∞ –ø–æ `name_norm ilike` —á–µ—Ä–µ–∑ **VIEW**
        `shared_products_public` (–±–µ–∑ `created_by_user_id`).
      - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç **–≤—Å–µ** –ø—Ä–æ–¥—É–∫—Ç—ã.
      - –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏: –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π toggle ¬´–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–∫—Ä—ã—Ç—ã–µ –¥–ª—è
        –º–µ–Ω—è¬ª (–∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ blocklist).
      3. **–°–ø–∏—Å–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**:
      - –ö–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: –Ω–∞–∑–≤–∞–Ω–∏–µ, –∫–∫–∞–ª100, –ë–ñ–£, –∫–∞—Ç–µ–≥–æ—Ä–∏—è, —Å—Ç–∞—Ç—É—Å
        (—Å–∫—Ä—ã—Ç –¥–ª—è –º–µ–Ω—è / –∞–∫—Ç–∏–≤–µ–Ω), –∫—Ç–æ –¥–æ–±–∞–≤–∏–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä: ¬´–í—ã¬ª / ¬´–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
        HEYS¬ª), –¥–∞—Ç–∞.
      - **–î–µ–π—Å—Ç–≤–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞** (inline –∏–ª–∏ –ø–æ –∫–ª–∏–∫—É):
        - **‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å** ‚Äî –¥–æ—Å—Ç—É–ø–Ω–æ **—Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä—É**
          (`created_by_user_id = auth.uid()`).
          - ‚ö†Ô∏è **Fingerprint IMMUTABLE**: –ú–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¢–û–õ–¨–ö–û:
            `category`, `portions`, `description`.
          - **–ù–ï–õ–¨–ó–Ø** —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å: `name`, –Ω—É—Ç—Ä–∏–µ–Ω—Ç—ã (simple100, complex100,
            protein100 –∏ —Ç.–¥.), `gi`, `harm`.
          - –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∏–∑–º–µ–Ω–∏—Ç—å ¬´—è–¥—Ä–æ¬ª ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å: ¬´–ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å —Å–æ—Å—Ç–∞–≤.
            –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç.¬ª
        - **üö´ –°–∫—Ä—ã—Ç—å –¥–ª—è –º–µ–Ω—è** ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–æ–¥—É–∫—Ç –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π blocklist
          –∫—É—Ä–∞—Ç–æ—Ä–∞. –ü—Ä–æ–¥—É–∫—Ç –Ω–µ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ –ø–æ–∏—Å–∫–µ –¥–ª—è —ç—Ç–æ–≥–æ –∫—É—Ä–∞—Ç–æ—Ä–∞ –∏
          –µ–≥–æ –∫–ª–∏–µ–Ω—Ç–æ–≤. –î—Ä—É–≥–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –≤–∏–¥–µ—Ç—å –ø—Ä–æ–¥—É–∫—Ç.
        - **‚§¥Ô∏è –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å** ‚Äî —É–±–∏—Ä–∞–µ—Ç –∏–∑ blocklist (–¥–ª—è —Å–∫—Ä—ã—Ç—ã—Ö).
        - **‚ùå –£–¥–∞–ª–∏—Ç—å** ‚Äî **–Ω–µ –¥–æ—Å—Ç—É–ø–Ω–æ** (–≥–ª–æ–±–∞–ª—å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ RLS
          –ø–æ–ª–∏—Ç–∏–∫–æ–π).
    - **UX –¥–µ—Ç–∞–ª–µ–π**:
      - –ü—Ä–∏ —Å–∫—Ä—ã—Ç–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ ‚Äî optimistic update UI + –æ—Ç–∫–∞—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ.
      - –ü—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ ‚Äî —Ñ–æ—Ä–º–∞ modal –∏–ª–∏ inline-edit —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø–æ–ª—è–º–∏.
      - –ü–∞–≥–∏–Ω–∞—Ü–∏—è –∏–ª–∏ ¬´–ø–æ–∫–∞–∑–∞—Ç—å –µ—â—ë¬ª –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤.
  - **Files**: –≤–∫–ª–∞–¥–∫–∞ ¬´–†–∞—Ü–∏–æ–Ω¬ª, –Ω–æ–≤—ã–π –ø–æ–¥–∫–æ–º–ø–æ–Ω–µ–Ω—Ç (–º–æ–∂–Ω–æ inline –≤ legacy
    —Ñ–∞–π–ª–µ)

- [ ] **–ú–æ–¥–µ—Ä–∞—Ü–∏—è** ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–π blocklist (—Å–∫—Ä—ã—Ç–∏–µ ¬´–¥–ª—è —Å–µ–±—è¬ª)
  - **Why**: –ù—É–∂–Ω–æ —É–±–∏—Ä–∞—Ç—å –º—É—Å–æ—Ä–Ω—ã–µ/–æ—à–∏–±–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –∏–∑ –ø–æ–∏—Å–∫–∞, –Ω–æ **–±–µ–∑
    —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –±–∞–∑—ã** (–¥—Ä—É–≥–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å)
  - **Acceptance**:
    - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è: —Ç–∞–±–ª–∏—Ü–∞
      `shared_products_blocklist (curator_id uuid, product_id uuid, created_at timestamp)`
      –∏–ª–∏ localStorage key `heys_shared_blocklist_<curatorId>`.
    - –ö—É—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç ¬´—Å–∫—Ä—ã—Ç—å –¥–ª—è —Å–µ–±—è¬ª –ª—é–±–æ–π –ø—Ä–æ–¥—É–∫—Ç ‚Äî –æ–Ω –Ω–µ –±—É–¥–µ—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –≤
      –ø–æ–∏—Å–∫–µ –¥–ª—è —ç—Ç–æ–≥–æ –∫—É—Ä–∞—Ç–æ—Ä–∞ –∏ –µ–≥–æ –∫–ª–∏–µ–Ω—Ç–æ–≤.
    - –î—Ä—É–≥–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ **–ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –≤–∏–¥–µ—Ç—å** —ç—Ç–æ—Ç –ø—Ä–æ–¥—É–∫—Ç.
    - UI: –¥–µ–π—Å—Ç–≤–∏–µ ¬´üö´ –°–∫—Ä—ã—Ç—å –¥–ª—è –º–µ–Ω—è¬ª / ¬´–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å¬ª –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–º
      –º–µ–Ω—é/—Å–≤–∞–π–ø–µ.
    - –°–∫—Ä—ã—Ç–∏–µ –Ω–µ —É–¥–∞–ª—è–µ—Ç –ø—Ä–æ–¥—É–∫—Ç; —É–∂–µ —Å–∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–∏—á–Ω—ã–µ –∫–æ–ø–∏–∏ —É –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–µ
      –º–µ–Ω—è—é—Ç—Å—è.
    - ‚ö†Ô∏è **–ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è PIN/RPC-only –∫–ª–∏–µ–Ω—Ç–æ–≤**:
      - –£ PIN-–∫–ª–∏–µ–Ω—Ç–∞ –Ω–µ—Ç Supabase session ‚Üí –æ–Ω **–Ω–µ —Å–º–æ–∂–µ—Ç** —á–∏—Ç–∞—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—É—é
        —Ç–∞–±–ª–∏—Ü—É blocklist –∫—É—Ä–∞—Ç–æ—Ä–∞.
      - –ü–æ—ç—Ç–æ–º—É —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è blocklist –¥–ª—è PIN –∫–ª–∏–µ–Ω—Ç–æ–≤ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑
        **client-kv-store –∫–ª—é—á** (—Å–∏–Ω—Ö—Ä–æ–Ω–∏—Ç—Å—è —á–µ—Ä–µ–∑ RPC):
        - –∫–ª—é—á: `heys_shared_products_blocklist`
        - –∑–Ω–∞—á–µ–Ω–∏–µ: `{ productIds: string[], updatedAt: number }`
      - –ü–æ–≤–µ–¥–µ–Ω–∏–µ:
        - –í curator-—Ä–µ–∂–∏–º–µ: —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º blocklist –∫—É—Ä–∞—Ç–æ—Ä–∞ (Supabase —Ç–∞–±–ª–∏—Ü–∞
          –∏/–∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á), –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ **–ø—É—à–∏–º** –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π
          —Å–ø–∏—Å–æ–∫ –≤ `heys_shared_products_blocklist` –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ (–∞
          –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ ‚Äî ¬´–ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ –≤—Å–µ–º –º–æ–∏–º –∫–ª–∏–µ–Ω—Ç–∞–º¬ª).
        - –í PIN-—Ä–µ–∂–∏–º–µ: –ø–æ–∏—Å–∫ –ø–æ shared –∏—Å–∫–ª—é—á–∞–µ—Ç `productIds` –∏–∑
          `heys_shared_products_blocklist` —ç—Ç–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ (–∏–∑ localStorage,
          –ø—Ä–∏—à–ª–æ —á–µ—Ä–µ–∑ RPC sync).
  - **Files**: UI —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ + —Ç–∞–±–ª–∏—Ü–∞ `shared_products_blocklist` –≤
    Supabase (–¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏)

- [ ] **Shared –∑–∞–≥—Ä—É–∑–∫–∞ (–≥–ª–æ–±–∞–ª—å–Ω–∞—è –±–∞–∑–∞)** ‚Äî –ø–æ–∏—Å–∫ + –∫–µ—à
  - **Why**: –û–±—â–∞—è –±–∞–∑–∞ –º–æ–∂–µ—Ç —Ä–∞—Å—Ç–∏; –Ω–µ–ª—å–∑—è —Ç–∞—â–∏—Ç—å –≤—Å—ë –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
  - **Acceptance**:
    - –ó–∞–≥—Ä—É–∑–∫–∞ shared —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –∑–∞–ø—Ä–æ—Å—ã —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏:
      - **–ë–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞ –ø–æ `curator_id`** ‚Äî —ç—Ç–æ –≥–ª–æ–±–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        HEYS.
      - –ø–æ–∏—Å–∫ –ø–æ `name_norm ilike` (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥) + `limit` (–Ω–∞–ø—Ä–∏–º–µ—Ä 50-100).
      - –≤—ã–±–æ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã—Ö –ø–æ–ª–µ–π (–Ω–∏–∫–∞–∫–∏—Ö `select('*')`).
      - **—Ñ–∏–ª—å—Ç—Ä blocklist**:
        - curator-—Ä–µ–∂–∏–º: –∏—Å–∫–ª—é—á–∞—Ç—å `product_id` –∏–∑ `shared_products_blocklist`
          —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
        - PIN/RPC-only: –∏—Å–∫–ª—é—á–∞—Ç—å `product_id` –∏–∑ client-kv –∫–ª—é—á–∞
          `heys_shared_products_blocklist`.
    - **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏):
      - **–î–µ–±–∞—É–Ω—Å 300ms** –Ω–∞ –ø–æ–∏—Å–∫–æ–≤—ã–π input (–Ω–µ –¥—ë—Ä–≥–∞—Ç—å API –Ω–∞ –∫–∞–∂–¥—ã–π —Å–∏–º–≤–æ–ª).
      - –ü—Ä–∏ **–ø—É—Å—Ç–æ–º –ø–æ–∏—Å–∫–µ** –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å ¬´–ø–æ–ø—É–ª—è—Ä–Ω—ã–µ¬ª –ø—Ä–æ–¥—É–∫—Ç—ã (–ø–æ —Å—á—ë—Ç—á–∏–∫—É
        –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π –∏–ª–∏ –∫–µ—à), –Ω–µ –¥–µ–ª–∞—Ç—å full-scan.
    - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–µ—à–∏—Ä—É—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ **–≥–ª–æ–±–∞–ª—å–Ω—ã–π** –∫–ª—é—á
      `heys_shared_products_cache` (–±–µ–∑ clientId namespace) –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
      offline.
  - **Files**: –º–µ—Å—Ç–æ, –≥–¥–µ —Å–µ–π—á–∞—Å —Å—Ç—Ä–æ–∏—Ç—Å—è search list
    (RationTab/ProductsManager)

- [ ] **PIN/RPC-only —Ä–µ–∂–∏–º** ‚Äî –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å—Å—è —Å –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π –≤ shared
  - **Why**: –ö–ª–∏–µ–Ω—Ç—ã –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É+PIN —Å–µ–π—á–∞—Å —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ Supabase session;
    –ø—Ä—è–º–æ–π insert/update –≤ —Ç–∞–±–ª–∏—Ü—ã —Å RLS –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω.
  - **Decision (–≤—ã–±—Ä–∞–Ω–æ)**: ‚úÖ **pending ‚Üí –∫—É—Ä–∞—Ç–æ—Ä –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç** (—á–µ—Ä–µ–∑
    Supabase —Ç–∞–±–ª–∏—Ü—É)
  - **Acceptance**:
    - PIN-–∫–ª–∏–µ–Ω—Ç **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–∏—à–µ—Ç** –≤ `shared_products` –Ω–∞–ø—Ä—è–º—É—é.
    - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–∞ –∫–ª–∏–µ–Ω—Ç–æ–º (PIN auth) –∏ –≤–∫–ª—é—á—ë–Ω–Ω–æ–π –æ–ø—Ü–∏–∏ ¬´–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å
      –≤ –æ–±—â—É—é –±–∞–∑—É¬ª:
      1. –ø—Ä–æ–¥—É–∫—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ª–∏—á–Ω—É—é –±–∞–∑—É (–∫–∞–∫ –æ–±—ã—á–Ω–æ)
      2. **–ó–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ RPC**
         `create_pending_product(client_id, product_data, name_norm, fingerprint)`:
         - –§—É–Ω–∫—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫—É—Ä–∞—Ç–æ—Ä–∞ –∫–ª–∏–µ–Ω—Ç–∞
         - –°–æ–∑–¥–∞—ë—Ç –∑–∞–ø–∏—Å—å –≤ `shared_products_pending` —Ç–∞–±–ª–∏—Ü–µ
         - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `id` –∑–∞—è–≤–∫–∏
      3. –≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ Supabase session (SECURITY DEFINER —Ñ—É–Ω–∫—Ü–∏—è)
    - –í —Ä–µ–∂–∏–º–µ –∫—É—Ä–∞—Ç–æ—Ä–∞ (–µ—Å—Ç—å Supabase session) –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
      - –≤ –ø–æ–¥–≤–∫–ª–∞–¥–∫–µ ¬´üåê –û–±—â–∞—è –±–∞–∑–∞¬ª –±–ª–æ–∫ ¬´–û–∂–∏–¥–∞—é—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è¬ª –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç
        –±–µ–π–¥–∂ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º pending-–∑–∞—è–≤–æ–∫
      - –û–¥–Ω–∏–º SELECT –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ pending —Å–≤–æ–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤:
        `SELECT * FROM shared_products_pending WHERE curator_id = auth.uid() AND status = 'pending'`
      - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫ —Å –¥–µ–π—Å—Ç–≤–∏—è–º–∏ **Approve / Reject**
      - –ø—Ä–∏ Approve:
        1. –ø—É–±–ª–∏–∫—É–µ—Ç –ø—Ä–æ–¥—É–∫—Ç –≤ `shared_products` (upsert –ø–æ `fingerprint` —Å
           `ON CONFLICT DO NOTHING`)
        2. **–ü—Ä–æ–≤–µ—Ä–∫–∞**: –µ—Å–ª–∏ `RETURNING id` –≤–µ—Ä–Ω—É–ª null ‚Üí –ø—Ä–æ–¥—É–∫—Ç —É–∂–µ –±—ã–ª
           –¥–æ–±–∞–≤–ª–µ–Ω –¥—Ä—É–≥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å ¬´–ü—Ä–æ–¥—É–∫—Ç —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤
           –æ–±—â–µ–π –±–∞–∑–µ¬ª
        3. –æ–±–Ω–æ–≤–ª—è–µ—Ç –∑–∞—è–≤–∫—É: `status = 'approved'`, `moderated_at = now()`,
           `moderated_by = auth.uid()`
      - –ø—Ä–∏ Reject:
        1. –æ–±–Ω–æ–≤–ª—è–µ—Ç –∑–∞—è–≤–∫—É: `status = 'rejected'`, `reject_reason = ...`
    - **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Supabase —Ç–∞–±–ª–∏—Ü—ã vs client-kv**:
      - –û–¥–∏–Ω SELECT –≤–º–µ—Å—Ç–æ N –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ –∫–ª–∏–µ–Ω—Ç–∞–º
      - –ù–∞—Ç–∏–≤–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
      - –ù–µ –Ω—É–∂–µ–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π API –¥–ª—è —á—Ç–µ–Ω–∏—è client-kv –¥—Ä—É–≥–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
    - –ì–∞—Ä–∞–Ω—Ç–∏–∏:
      - –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ/–ø–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è –Ω–µ —Å–æ–∑–¥–∞—ë—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã
        (upsert –ø–æ `fingerprint`).
      - –ó–∞—è–≤–∫–∏ —Å `status != 'pending'` –º–æ–∂–Ω–æ –æ—á–∏—â–∞—Ç—å —á–µ—Ä–µ–∑ cron (TTL 30 –¥–Ω–µ–π).
      - –ï—Å–ª–∏ –∫—É—Ä–∞—Ç–æ—Ä offline/–æ—à–∏–±–∫–∞ —Å–µ—Ç–∏: –∑–∞—è–≤–∫–∞ –æ—Å—Ç–∞—ë—Ç—Å—è `pending`.

### Should Have (–≤–∞–∂–Ω–æ, –Ω–æ –Ω–µ –±–ª–æ–∫–µ—Ä)

- [ ] **–ú–∏–≥—Ä–∞—Ü–∏—è** ‚Äî –ø–æ–¥–Ω—è—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ª–∏—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –≤ shared
  - **Why**: –ó–∞–ø–æ–ª–Ω–∏—Ç—å –æ–±—â—É—é –±–∞–∑—É –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
  - **Acceptance**:
    - **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ –∫—É—Ä–∞—Ç–æ—Ä–∞:
      - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–ª–∞–≥ `profile.migrated_to_shared` (–∏–ª–∏ –∫–ª—é—á –≤ kv).
      - –ï—Å–ª–∏ `false` ‚Äî –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ñ–æ–Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é –ª–∏—á–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤
        `shared_products`.
      - **Batch insert**: –ø–æ 50-100 –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∑–∞ –∑–∞–ø—Ä–æ—Å —Å
        `ON CONFLICT (fingerprint) DO NOTHING`.
      - –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –∏–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ ¬´–ü—É–±–ª–∏–∫—É–µ–º –≤–∞—à–∏ –ø—Ä–æ–¥—É–∫—Ç—ã –≤ –æ–±—â—É—é
        –±–∞–∑—É...¬ª.
      - –ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–ª–∞–≥ `true`.
    - MVP: –∫–Ω–æ–ø–∫–∞ ¬´–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –º–æ–∏ –ø—Ä–æ–¥—É–∫—Ç—ã¬ª –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö.
    - –õ–æ–≥: —Å–∫–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ/–ø—Ä–æ–ø—É—â–µ–Ω–æ (–¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ fingerprint).
  - **Files**: helper –≤ legacy JS + –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤—ã–∑–æ–≤ cloud

- [ ] **Cleanup —Å—Ç–∞—Ä—ã—Ö pending-–∑–∞—è–≤–æ–∫** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, cron)
  - **Why**: –¢–∞–±–ª–∏—Ü–∞ `shared_products_pending` –±—É–¥–µ—Ç —Ä–∞—Å—Ç–∏ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
  - **Acceptance**:
    - SQL –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ (–∑–∞–ø—É—Å–∫–∞—Ç—å —á–µ—Ä–µ–∑ pg_cron –∏–ª–∏ –≤—Ä—É—á–Ω—É—é):
      ```sql
      -- –£–¥–∞–ª–∏—Ç—å –∑–∞—è–≤–∫–∏ —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º != 'pending'
      DELETE FROM shared_products_pending
      WHERE status != 'pending'
        AND created_at < now() - interval '30 days';
      ```
    - –ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å pg_cron job –∏–ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫—É—Ä–∞—Ç–æ—Ä–∞.

- [ ] **–ü–æ–∏—Å–∫** ‚Äî —É—á–∏—Ç—ã–≤–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ –∏ blocklist
  - **Why**: –ß–∏—Å—Ç—ã–π –ø–æ–∏—Å–∫ –±–µ–∑ —Å–∫—Ä—ã—Ç—ã—Ö –∑–∞–ø–∏—Å–µ–π
  - **Acceptance**: –ü–æ–∏—Å–∫ shared –∏—Å–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–¥—É–∫—Ç—ã –∏–∑ blocklist —Ç–µ–∫—É—â–µ–≥–æ
    –∫—É—Ä–∞—Ç–æ—Ä–∞; –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (üë§/üåê/–æ–±–∞) —Ä–∞–±–æ—Ç–∞–µ—Ç –≤
    –∞–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç–µ/—Å–ø–∏—Å–∫–µ.

- [ ] **–î–µ–¥—É–ø –≤ UI** ‚Äî –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ personal+shared –±–µ–∑ –¥–≤–æ–π–Ω—ã—Ö —Å—Ç—Ä–æ–∫
  - **Why**: –í –æ–±–µ–∏—Ö –±–∞–∑–∞—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –ø—Ä–æ–¥—É–∫—Ç
  - **Acceptance**:
    - –ü—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –≤ —Ä–µ–∂–∏–º–µ ¬´–æ–±–∞¬ª –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã (–ø–æ `name_norm` –∏–ª–∏
      fingerprint) –Ω–µ –¥—É–±–ª—è—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ.
    - –ü—Ä–∞–≤–∏–ª–æ –≤—ã–±–æ—Ä–∞: –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ –æ—Ç–¥–∞—ë–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ª–∏—á–Ω–æ–º—É –ø—Ä–æ–¥—É–∫—Ç—É (üë§) –ø–µ—Ä–µ–¥
      –æ–±—â–∏–º (üåê).

### Could Have (nice to have)

- [ ] **–†–µ–π—Ç–∏–Ω–≥/–ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å** ‚Äî —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –æ–±—â–∏—Ö –ø–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## ‚úÖ DONE (–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏)

### Functional

- [ ] –í–∫–ª–∞–¥–∫–∞ ¬´–†–∞—Ü–∏–æ–Ω¬ª —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–≤–µ –ø–æ–¥–≤–∫–ª–∞–¥–∫–∏: ¬´üë§ –ü—Ä–æ–¥—É–∫—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞¬ª –∏ ¬´üåê
      –û–±—â–∞—è –±–∞–∑–∞¬ª.
- [ ] –ü–æ–¥–≤–∫–ª–∞–¥–∫–∞ ¬´üåê –û–±—â–∞—è –±–∞–∑–∞¬ª –≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –∫—É—Ä–∞—Ç–æ—Ä—É (–µ—Å—Ç—å Supabase session,
      –Ω–µ PIN/RPC-only).
- [ ] –ù–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –∏ –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –≤ **–≥–ª–æ–±–∞–ª—å–Ω—É—é**
      `shared_products` (–≤ curator —Ä–µ–∂–∏–º–µ) –∏–ª–∏ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ pending-–æ—á–µ—Ä–µ–¥—å (–≤ PIN
      —Ä–µ–∂–∏–º–µ).
- [ ] –î–ª—è PIN —Ä–µ–∂–∏–º–∞: –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∑–∞—è–≤–∫–∞ –≤
      `heys_shared_products_pending`, –∫—É—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç Approve/Reject –≤–æ –≤–∫–ª–∞–¥–∫–µ
      ¬´üåê –û–±—â–∞—è –±–∞–∑–∞¬ª.
- [ ] –í –ø–æ–¥–≤–∫–ª–∞–¥–∫–µ ¬´üåê –û–±—â–∞—è –±–∞–∑–∞¬ª –∫—É—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç: –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å pending-–∑–∞—è–≤–∫–∏
      —Å–≤–æ–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, –∏—Å–∫–∞—Ç—å –ø–æ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –±–∞–∑–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–∏ –ø—Ä–æ–¥—É–∫—Ç—ã,
      —Å–∫—Ä—ã–≤–∞—Ç—å –ª—é–±—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –¥–ª—è —Å–µ–±—è (blocklist).
- [ ] –í –ø–æ–¥–≤–∫–ª–∞–¥–∫–µ ¬´üë§ –ü—Ä–æ–¥—É–∫—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞¬ª —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –∏—Å—Ç–æ—á–Ω–∏–∫–∞
      (üë§/üåê/–æ–±–∞): –≤–ª–∏—è–µ—Ç –Ω–∞ –ø–æ–∏—Å–∫/—Å–ø–∏—Å–æ–∫, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ¬´–æ–±–∞¬ª, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞
      –∫–ª–∏–µ–Ω—Ç–∞.
- [ ] –ü–æ–∏—Å–∫ shared –∏—Å–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–¥—É–∫—Ç—ã –∏–∑ blocklist —Ç–µ–∫—É—â–µ–≥–æ –∫—É—Ä–∞—Ç–æ—Ä–∞; –≤–æ –≤–∫–ª–∞–¥–∫–µ
      ¬´üåê –û–±—â–∞—è –±–∞–∑–∞¬ª —Å–∫—Ä—ã—Ç—ã–µ –≤–∏–¥–Ω—ã —Å –º–µ—Ç–∫–æ–π ¬´–°–∫—Ä—ã—Ç–æ –¥–ª—è –º–µ–Ω—è¬ª.
- [ ] RLS: —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä –ø—Ä–æ–¥—É–∫—Ç–∞
      (`created_by_user_id = auth.uid()`); —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ –¥–ª—è –≤—Å–µ—Ö.

### Quality Gates

- [ ] Testing Strategy: —Ä—É—á–Ω–æ–π –ø—Ä–æ–≥–æ–Ω –≤ –±—Ä–∞—É–∑–µ—Ä–µ (localhost:3001) +
      —é–Ω–∏—Ç/–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏.
- [ ] Type safety: `pnpm type-check` PASS (0 –æ—à–∏–±–æ–∫).
- [ ] –õ–∏–Ω—Ç: `pnpm lint` PASS.
- [ ] –¢–µ—Å—Ç—ã: `pnpm test:all` PASS.
- [ ] Build: `pnpm build` PASS.

### UI Testing (legacy React inline)

- [ ] Mobile (DevTools iPhone SE): –ø–æ–¥–≤–∫–ª–∞–¥–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—é—Ç—Å—è, –ø–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç,
      min-h-11 –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–æ–≤.
- [ ] Desktop: hover/keyboard —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–µ—Ç –æ—à–∏–±–æ–∫ –≤ console.
- [ ] Curator-only: –ø–æ–¥–≤–∫–ª–∞–¥–∫–∞ ¬´üåê –û–±—â–∞—è –±–∞–∑–∞¬ª –≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –∫—É—Ä–∞—Ç–æ—Ä—É;
      pending-–º–æ–¥–∞–ª–∫–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è, approve/reject —Ä–∞–±–æ—Ç–∞—é—Ç; —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
      (—Ç–æ–ª—å–∫–æ —Å–≤–æ–∏—Ö) –∏ —Å–∫—Ä—ã—Ç–∏–µ (blocklist) —Ä–∞–±–æ—Ç–∞—é—Ç; —É–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ.
- [ ] PIN —Ä–µ–∂–∏–º: –≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –ø–æ–¥–≤–∫–ª–∞–¥–∫–∞ ¬´üë§ –ü—Ä–æ–¥—É–∫—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞¬ª; –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏
      –ø—Ä–æ–¥—É–∫—Ç–∞ —Å –≥–∞–ª–æ—á–∫–æ–π ¬´–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å¬ª ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è pending-–∑–∞—è–≤–∫–∞.

### Performance

- [ ] Legacy JS —Ñ–∞–π–ª—ã –Ω–µ –≤—ã—Ä–æ—Å–ª–∏ >50KB; –Ω–µ—Ç —Ç—è–∂—ë–ª—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –≥–ª–∞–≤–Ω—ã–π –ø–æ—Ç–æ–∫.
- [ ] –ù–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ ¬´–≤—Å–µ–π shared –±–∞–∑—ã¬ª –±–µ–∑ –ª–∏–º–∏—Ç–æ–≤.

### Documentation

- [ ] PR —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Å—ã–ª–∫—É –Ω–∞ —ç—Ç–æ—Ç –ø—Ä–æ–º–ø—Ç.
- [ ] RLS/—Ç–∞–±–ª–∏—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–ø–∏—Å–∞–Ω—ã –≤ SQL-—Ñ–∞–π–ª–µ.

---

## ü§ñ AI Context (Technical Specs)

- Legacy –≤ `apps/web/` ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `U.lsSet`/`HEYS.store`; CDN React.
- Supabase: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏ (—Å–º. `SUPABASE_PROXY.md`), –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –±–µ–∑
  –∞–≤—Ç–æ-refresh.
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏/–ø–æ–ª—è –ø—Ä–æ–¥—É–∫—Ç–∞ —Å–º. `docs/DATA_MODEL_REFERENCE.md` (Product, MealItem,
  dayTot.prot –∏ —Ç.–¥.).
- –¶–≤–µ—Ç–æ–≤—ã–µ –∑–æ–Ω—ã ratio ‚Äî `apps/web/heys_ratio_zones_v1.js` (–Ω–µ —Ç—Ä–æ–≥–∞—Ç—å —Å—Ç–∏–ª—å –±–µ–∑
  –Ω—É–∂–¥—ã).

---

## üìù Notes

- **Priority**: high
- **Complexity**: M-L (–¥–æ–±–∞–≤–∏–ª–∞—Å—å –ø–æ–¥–≤–∫–ª–∞–¥–∫–∞ —Å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º + –≥–ª–æ–±–∞–ª—å–Ω–∞—è
  –±–∞–∑–∞)
- **Blockers**: –¢—Ä–µ–±—É—é—Ç—Å—è RLS –ø–æ–ª–∏—Ç–∏–∫–∏; —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ proxy URL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
  –¥–ª—è Supabase.
- **Related Tasks**: future ‚Äî –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å/—Ä–µ–π—Ç–∏–Ω–≥, —Ä–æ–ª—å –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞.
- **Created**: 2025-12-16
- **Updated**: 2025-12-17 ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –∞—É–¥–∏—Ç: –¥–æ–±–∞–≤–ª–µ–Ω—ã `is_mine` –≤ VIEW,
  `description` –ø–æ–ª–µ, –ø—Ä–æ–≤–µ—Ä–∫–∞ fingerprint –≤ RPC, offline retry queue, TTL
  cleanup, blocklist-–∫–æ–Ω—Ñ–ª–∏–∫—Ç –≤ pending
