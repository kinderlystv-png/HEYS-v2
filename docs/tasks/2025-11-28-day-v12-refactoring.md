# Task: –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ heys_day_v12.js

> **–¢–∏–ø –∑–∞–¥–∞—á–∏**: Strategic ‚Äî –º–Ω–æ–≥–æ—à–∞–≥–æ–≤—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

## üéØ WHY (–ë–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç)

**Problem**: –§–∞–π–ª `heys_day_v12.js` —Å–æ–¥–µ—Ä–∂–∏—Ç **~3400 —Å—Ç—Ä–æ–∫** –∫–æ–¥–∞ ‚Äî —ç—Ç–æ –º–æ–Ω–æ–ª–∏—Ç–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å UI, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π, —Ö—É–∫–∞–º–∏, –ø–∏–∫–µ—Ä–∞–º–∏ –∏ —É—Ç–∏–ª–∏—Ç–∞–º–∏ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ. –°–ª–æ–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å, –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å –∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å.

**Impact**: –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —Ç—Ä–∞—Ç–∏—Ç –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏—é –ø–æ —Ñ–∞–π–ª—É, –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ —Ä–µ–≥—Ä–µ—Å—Å–∏–π –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö, —Å–ª–æ–∂–Ω–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã.

**Value**: –ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:
- –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å ‚Üë (—Ñ–∞–π–ª—ã –ø–æ 100-300 —Å—Ç—Ä–æ–∫ –≤–º–µ—Å—Ç–æ 3300)
- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (–ø–∏–∫–µ—Ä—ã, –∫–∞—Ä—Ç–æ—á–∫–∏)
- –°–Ω–∏–∂–µ–Ω–∏–µ —Ä–∏—Å–∫–∞ —Ä–µ–≥—Ä–µ—Å—Å–∏–π (–∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏)
- –£–ø—Ä–æ—â–µ–Ω–∏–µ –±—É–¥—É—â–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## ü§ñ Output Preferences

**Workflow**: Propose plan first ‚Üí Implement phase by phase ‚Üí Test after each phase

**Code style**: Follow copilot-instructions.md, –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ª–æ–≥–∏–∫–µ

**Safety first**: 
- –ö–∞–∂–¥–∞—è —Ñ–∞–∑–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–æ–π `pnpm type-check && pnpm build`
- HMR –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ UI –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –ù–ï –º–µ–Ω—è—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É ‚Äî —Ç–æ–ª—å–∫–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–¥–∞

---

## üìã WHAT (–ß–µ–∫-–ª–∏—Å—Ç –∑–∞–¥–∞—á)

### Phase 1: –ê–Ω–∞–ª–∏–∑ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞

- [x] **–ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã** ‚Äî –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∫–∞—Ä—Ç—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–∞
  - **Why**: –ü–æ–Ω—è—Ç—å –∫–∞–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç –∫–∞–∫–∏—Ö –∑–∞–≤–∏—Å—è—Ç
  - **Acceptance**: –°–ø–∏—Å–æ–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å –∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
  - **Files**: `apps/web/heys_day_v12.js`

- [x] **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã –º–æ–¥—É–ª–µ–π** ‚Äî —Ä–∞–∑–±–∏—Ç—å –Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –≥—Ä—É–ø–ø—ã
  - **Why**: –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å –ø—Ä–∏ –≤—ã–Ω–æ—Å–µ
  - **Acceptance**: –ü–ª–∞–Ω —Ä–∞–∑–±–∏–µ–Ω–∏—è –Ω–∞ 5-8 —Ñ–∞–π–ª–æ–≤
  - **Groups** (–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ):
    1. `heys_day_utils.js` ‚Äî —É—Ç–∏–ª–∏—Ç—ã (pad2, todayISO, fmtDate, parseISO, uid, clamp, r0, r1, scale, per100)
    2. `heys_day_hooks.js` ‚Äî —Ö—É–∫–∏ (useDayAutosave, useMobileDetection)
    3. `heys_day_pickers.js` ‚Äî –ø–∏–∫–µ—Ä—ã (DatePicker, Calendar, TimePicker modals)
    4. `heys_day_modals.js` ‚Äî –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ (GramsPicker, ZonePicker, WeightPicker, DeficitPicker, HouseholdPicker)
    5. `heys_day_trainings.js` ‚Äî –±–ª–æ–∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ (trainingsBlock)
    6. `heys_day_meals.js` ‚Äî –ø—Ä–∏—ë–º—ã –ø–∏—â–∏ (MealAddProduct, mealsUI, –º–æ–±–∏–ª—å–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏)
    7. `heys_day_stats.js` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (mainBlock, sideBlock, dayTotals)
    8. `heys_day_v12.js` ‚Äî –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä (DayTab, –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å—ë)

### Phase 2: –í—ã–Ω–æ—Å —É—Ç–∏–ª–∏—Ç (SAFE ‚Äî –±–µ–∑ React)

- [x] **–°–æ–∑–¥–∞—Ç—å `heys_day_utils.js`** ‚Äî —á–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (267 —Å—Ç—Ä–æ–∫)
  - **Why**: –ù–∞–∏–±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–µ—Ä–≤—ã–π —à–∞–≥
  - **Acceptance**: –£—Ç–∏–ª–∏—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç, –∏–º–ø–æ—Ä—Ç –≤ heys_day_v12.js
  - **Functions**: pad2, todayISO, fmtDate, parseISO, uid, clamp, r0, r1, scale, per100, lsGet, lsSet, sleepHours, parseTime, formatDateDisplay, calcBMR, kcalPerMin, stepsKcal, getProfile, productsSignature, **haptic**
  - **Pattern**: IIFE —Å —ç–∫—Å–ø–æ—Ä—Ç–æ–º –≤ `HEYS.dayUtils`

- [x] **–¢–µ—Å—Ç Phase 2** ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
  - **How**: `pnpm dev` ‚Üí –æ—Ç–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É –î–µ–Ω—å ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å—á—ë—Ç—ã
  - **Acceptance**: UI —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ, –Ω–µ—Ç –æ—à–∏–±–æ–∫ –≤ console

### Phase 3: –í—ã–Ω–æ—Å —Ö—É–∫–æ–≤

- [x] **–°–æ–∑–¥–∞—Ç—å `heys_day_hooks.js`** ‚Äî React —Ö—É–∫–∏ (188 —Å—Ç—Ä–æ–∫)
  - **Why**: –•—É–∫–∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã, –º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
  - **Functions**: useDayAutosave, useMobileDetection
  - **Dependencies**: lsGet, lsSet –∏–∑ heys_day_utils.js, React.useState/useEffect/useRef/useCallback
  - **Pattern**: IIFE —Å —ç–∫—Å–ø–æ—Ä—Ç–æ–º –≤ `HEYS.dayHooks`
  - **‚ö†Ô∏è Note**: `useMobileDetection` —Å–µ–π—á–∞—Å –ù–ï —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ DayTab. –ü–æ—Å–ª–µ –≤—ã–Ω–æ—Å–∞ ‚Äî —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ `HEYS.dayHooks.useMobileDetection`

- [x] **–¢–µ—Å—Ç Phase 3** ‚Äî –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –¥–µ—Ç–µ–∫—Ü–∏—è –º–æ–±–∏–ª—å–Ω—ã—Ö
  - **How**: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç ‚Üí –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
  - **Acceptance**: –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è, isMobile –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è

### Phase 4: –í—ã–Ω–æ—Å –ø–∏–∫–µ—Ä–æ–≤ (DatePicker, Calendar)

- [x] **–°–æ–∑–¥–∞—Ç—å `heys_day_pickers.js`** ‚Äî –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã (155 —Å—Ç—Ä–æ–∫)
  - **Why**: –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
  - **Components**: DatePicker, Calendar
  - **Dependencies**: formatDateDisplay, parseISO, fmtDate, todayISO
  - **Pattern**: IIFE —Å —ç–∫—Å–ø–æ—Ä—Ç–æ–º –≤ `HEYS.DatePicker`, `HEYS.Calendar`

- [x] **–¢–µ—Å—Ç Phase 4** ‚Äî –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –¥–∞—Ç–∞–º
  - **How**: –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ –¥–∞—Ç–∞–ø–∏–∫–µ—Ä ‚Üí –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥—É—é –¥–∞—Ç—É ‚Üí –≤–µ—Ä–Ω—É—Ç—å—Å—è
  - **Acceptance**: –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç, –¥–∞—Ç–∞ –º–µ–Ω—è–µ—Ç—Å—è

### Phase 5: –í—ã–Ω–æ—Å –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω

- [ ] **–°–æ–∑–¥–∞—Ç—å `heys_day_modals.js`** ‚Äî iOS-style –ø–∏–∫–µ—Ä—ã (–û–¢–õ–û–ñ–ï–ù–û)
  - **Why**: –ö—Ä—É–ø–Ω—ã–µ UI –±–ª–æ–∫–∏ —Å wheel columns
  - **‚ö†Ô∏è –ó–ê–ú–ï–¢–ö–ê**: –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ —Ç–µ—Å–Ω–æ —Å–≤—è–∑–∞–Ω—ã —Å –ª–æ–∫–∞–ª—å–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º DayTab (showTimePicker, pendingMealTime, editingMealIndex –∏ —Ç.–¥.). –í—ã–Ω–æ—Å —Ç—Ä–µ–±—É–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ props-drilling –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Context API.
  - **Components**: 
    - Time Picker modal (showTimePicker state)
    - Grams Picker modal (showGramsPicker state)
    - Zone Picker modal (showZonePicker state)
    - Weight Picker modal (showWeightPicker state)
    - Deficit Picker modal (showDeficitPicker state)
    - Household Picker modal (showHouseholdPicker state)
  - **Dependencies**: HEYS.WheelColumn, —Ö—É–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è, **ReactDOM.createPortal**
  - **Pattern**: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã + –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (open/confirm/cancel)
  - **‚ö†Ô∏è Note**: –í—Å–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è —á–µ—Ä–µ–∑ `ReactDOM.createPortal(el, document.body)`

- [ ] **–¢–µ—Å—Ç Phase 5** ‚Äî –≤—Å–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
  - **How**: –û—Ç–∫—Ä—ã—Ç—å –∫–∞–∂–¥—ã–π –ø–∏–∫–µ—Ä ‚Üí –≤—ã–±—Ä–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ ‚Üí –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å
  - **Acceptance**: –í—Å–µ –ø–∏–∫–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç, –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

### Phase 6: –í—ã–Ω–æ—Å –±–ª–æ–∫–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫

- [ ] **–°–æ–∑–¥–∞—Ç—å `heys_day_trainings.js`** ‚Äî UI —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ (–û–¢–õ–û–ñ–ï–ù–û)
  - **Why**: –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π UI –±–ª–æ–∫ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–æ–π
  - **‚ö†Ô∏è –ó–ê–ú–ï–¢–ö–ê**: –ë–ª–æ–∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç TR, kcalMin, visibleTrainings, setVisibleTrainings, day, setDay ‚Äî –≤—Å–µ —ç—Ç–æ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ DayTab. –¢—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–¥–∞—á–∏ ~10+ props.
  - **Components**: trainingsBlock, trainIcons, removeTraining
  - **Dependencies**: TR, kcalMin, openZonePicker, r0
  - **Pattern**: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç TrainingsBlock(props)

- [ ] **–¢–µ—Å—Ç Phase 6** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
  - **How**: –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É ‚Üí –≤–≤–µ—Å—Ç–∏ –º–∏–Ω—É—Ç—ã ‚Üí —É–¥–∞–ª–∏—Ç—å
  - **Acceptance**: –ö–∞–ª–æ—Ä–∏–∏ —Å—á–∏—Ç–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### Phase 7: –í—ã–Ω–æ—Å –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏

- [ ] **–°–æ–∑–¥–∞—Ç—å `heys_day_meals.js`** ‚Äî UI –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏
  - **Why**: –°–∞–º—ã–π –±–æ–ª—å—à–æ–π UI –±–ª–æ–∫, –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω
  - **Components**: MealAddProduct, mealsUI, pRow, mTotals, mobile product cards
  - **Dependencies**: pIndex, products, day, setDay, isMobile, expandedMeals
  - **‚ö†Ô∏è POPULAR_CACHE**: module-level –∫—ç—à –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ ‚Äî –≤—ã–Ω–µ—Å—Ç–∏ –≤–º–µ—Å—Ç–µ —Å `computePopularProducts()`
  - **Pattern**: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç MealsSection(props)

- [ ] **–¢–µ—Å—Ç Phase 7** ‚Äî –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã —Å –µ–¥–æ–π
  - **How**: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏—ë–º ‚Üí –Ω–∞–π—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç ‚Üí –∏–∑–º–µ–Ω–∏—Ç—å –≥—Ä–∞–º–º—ã ‚Üí —É–¥–∞–ª–∏—Ç—å
  - **Acceptance**: –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç, –≥—Ä–∞–º–º—ã —Å—á–∏—Ç–∞—é—Ç—Å—è, UI –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

### Phase 8: –í—ã–Ω–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

- [ ] **–°–æ–∑–¥–∞—Ç—å `heys_day_stats.js`** ‚Äî –±–ª–æ–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
  - **Why**: –û—Ç–¥–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á—ë—Ç–æ–≤ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
  - **Components**: 
    - mainBlock (violet table)
    - sideBlock (—Å–æ–Ω, –æ—Ü–µ–Ω–∫–∞)
    - dayTotals
    - **Sparkline** (SVG –≥—Ä–∞—Ñ–∏–∫ –∫–∞–ª–æ—Ä–∏–π –∑–∞ 7 –¥–Ω–µ–π)
    - **Macro rings** (–∫–æ–ª—å—Ü–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ë–ñ–£ –≤ —Å—Ç–∏–ª–µ Apple Watch)
    - **Goal progress bar** (–ø—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–ª–æ—Ä–∏–π)
    - **Confetti** (–ø—Ä–∞–∑–¥–Ω–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏)
    - **macroTip toast** (–ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ –ë–ñ–£)
  - **Dependencies**: tdee, bmr, optimum, eatenKcal, factDefPct, day, setDay
  - **State**: showConfetti, animatedProgress, toastVisible, toastDismissed
  - **Pattern**: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã MainStatsBlock, SideStatsBlock

- [ ] **–¢–µ—Å—Ç Phase 8** ‚Äî —Ä–∞—Å—á—ë—Ç—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
  - **How**: –ò–∑–º–µ–Ω–∏—Ç—å –≤–µ—Å ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å BMR ‚Üí –¥–æ–±–∞–≤–∏—Ç—å —à–∞–≥–∏ ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å TDEE
  - **Acceptance**: –í—Å–µ —Ä–∞—Å—á—ë—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

### Phase 9: –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∏ –æ—á–∏—Å—Ç–∫–∞

- [ ] **–£–ø—Ä–æ—Å—Ç–∏—Ç—å heys_day_v12.js** ‚Äî –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—é
  - **Why**: –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Ç–∞–µ–º—ã–º
  - **Acceptance**: < 500 —Å—Ç—Ä–æ–∫, —Ç–æ–ª—å–∫–æ DayTab –∏ –∏–º–ø–æ—Ä—Ç—ã
  - **–û—Å—Ç–∞–≤–∏—Ç—å –≤ DayTab** (–Ω–µ –≤—ã–Ω–æ—Å–∏—Ç—å):
    - Skeleton loader (skeletonLoader, isHydrated)
    - Pull-to-refresh –ª–æ–≥–∏–∫–∞ (pullProgress, isPulling, handleRefresh)
    - Theme toggle (isDarkTheme, toggleTheme)
    - FAB –∫–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏—ë–º–∞
    - Empty state
  - **Structure**:
    ```javascript
    // heys_day_v12.js ‚Äî DayTab orchestrator
    (function(global){
      // Imports from sub-modules
      const { utils } = HEYS.dayUtils;
      const { useDayAutosave, useMobileDetection } = HEYS.dayHooks;
      // ... etc
      
      // DayTab component ‚Äî state + layout
      HEYS.DayTab = function DayTab(props) {
        // State management
        // Render sub-components
      };
    })(window);
    ```

- [ ] **–û–±–Ω–æ–≤–∏—Ç—å index.html** ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
  - **Why**: –ú–æ–¥—É–ª–∏ –¥–æ–ª–∂–Ω—ã –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
  - **Order**: utils ‚Üí hooks ‚Üí pickers ‚Üí modals ‚Üí trainings ‚Üí meals ‚Üí stats ‚Üí day_v12

- [ ] **–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç** ‚Äî –ø–æ–ª–Ω—ã–π —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç
  - **How**: –ü—Ä–æ–π—Ç–∏ –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º –∏ –¥–µ—Å–∫—Ç–æ–ø–µ
  - **Acceptance**: –í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –¥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

---

## ‚úÖ DONE (–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏)

### Functional

- [ ] **–í—Å–µ —Ñ–∏—á–∏ —Ä–∞–±–æ—Ç–∞—é—Ç**: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏—ë–º–æ–≤, –ø—Ä–æ–¥—É–∫—Ç–æ–≤, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
- [ ] **–†–∞—Å—á—ë—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã**: BMR, TDEE, –∫–∞–ª–æ—Ä–∏–∏, –ë–ñ–£
- [ ] **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**: –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ localStorage –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è
- [ ] **Mobile-friendly**: –≤—Å–µ –ø–∏–∫–µ—Ä—ã –∏ –∂–µ—Å—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ

### Quality Gates

- [ ] **Type safety**: `pnpm type-check` PASS
- [ ] **Linting**: `pnpm lint` PASS (–±–µ–∑ –Ω–æ–≤—ã—Ö –æ—à–∏–±–æ–∫)
- [ ] **Build**: `pnpm build` PASS
- [ ] **No console errors**: –≤ –±—Ä–∞—É–∑–µ—Ä–µ –Ω–µ—Ç –æ—à–∏–±–æ–∫

### Structure

- [ ] **–§–∞–π–ª—ã < 500 —Å—Ç—Ä–æ–∫**: –∫–∞–∂–¥—ã–π –º–æ–¥—É–ª—å —á–∏—Ç–∞–µ–º
- [ ] **–ß—ë—Ç–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –Ω–µ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∏–º–ø–æ—Ä—Ç–æ–≤
- [ ] **IIFE pattern**: –≤—Å–µ –º–æ–¥—É–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–¥–∏–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω
- [ ] **HEYS namespace**: –≤—Å–µ —ç–∫—Å–ø–æ—Ä—Ç—ã —á–µ—Ä–µ–∑ window.HEYS.*

### UI Testing

**Mobile (Chrome DevTools ‚Üí iPhone SE):**
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏—ë–º –ø–∏—â–∏ ‚Üí –≤—ã–±—Ä–∞—Ç—å –≤—Ä–µ–º—è ‚Üí –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å
- [ ] –ù–∞–π—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç ‚Üí –¥–æ–±–∞–≤–∏—Ç—å ‚Üí –∏–∑–º–µ–Ω–∏—Ç—å –≥—Ä–∞–º–º—ã
- [ ] –°–≤–∞–π–ø –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞
- [ ] –ü–∏–∫–µ—Ä —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

**Desktop (>768px):**
- [ ] –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] Hover-—ç—Ñ—Ñ–µ–∫—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –ö–ª–∞–≤–∏–∞—Ç—É—Ä–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –≤ –ø–æ–∏—Å–∫–µ

---

## ü§ñ AI Context (Technical Specs)

### üìê Current Architecture

```
apps/web/heys_day_v12.js (~3400 lines)
‚îú‚îÄ‚îÄ Utilities (lines 1-70)
‚îÇ   ‚îú‚îÄ‚îÄ pad2, todayISO, fmtDate, parseISO, uid, clamp, r0, r1
‚îÇ   ‚îú‚îÄ‚îÄ lsGet, lsSet (storage wrappers)
‚îÇ   ‚îú‚îÄ‚îÄ per100, scale (calculations)
‚îÇ   ‚îî‚îÄ‚îÄ haptic(type) ‚Äî —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ HEYS.haptic
‚îú‚îÄ‚îÄ Hooks (lines 70-200)
‚îÇ   ‚îú‚îÄ‚îÄ useDayAutosave (autosave with debounce + BroadcastChannel)
‚îÇ   ‚îî‚îÄ‚îÄ useMobileDetection (responsive)
‚îú‚îÄ‚îÄ Helper Functions (lines 200-300)
‚îÇ   ‚îú‚îÄ‚îÄ loadMealsForDate, computePopularProducts, POPULAR_CACHE
‚îÇ   ‚îú‚îÄ‚îÄ getProfile, calcBMR, kcalPerMin, stepsKcal
‚îÇ   ‚îî‚îÄ‚îÄ parseTime, sleepHours, formatDateDisplay
‚îú‚îÄ‚îÄ UI Components (lines 300-600)
‚îÇ   ‚îú‚îÄ‚îÄ DatePicker (compact dropdown)
‚îÇ   ‚îî‚îÄ‚îÄ Calendar (full month view)
‚îú‚îÄ‚îÄ DayTab Component (lines 429-3400)
‚îÇ   ‚îú‚îÄ‚îÄ State declarations (lines 600-900)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ showConfetti, animatedProgress, pullProgress, macroTip...
‚îÇ   ‚îú‚îÄ‚îÄ Modal pickers (lines 900-1400) ‚Äî –∏—Å–ø–æ–ª—å–∑—É—é—Ç ReactDOM.createPortal
‚îÇ   ‚îú‚îÄ‚îÄ Meal functions (lines 1400-1700)
‚îÇ   ‚îú‚îÄ‚îÄ Training blocks (lines 1700-1900)
‚îÇ   ‚îú‚îÄ‚îÄ Stats blocks (lines 1900-2200)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Sparkline, Macro rings, Goal progress, Confetti
‚îÇ   ‚îú‚îÄ‚îÄ Meals UI (lines 2200-2800)
‚îÇ   ‚îú‚îÄ‚îÄ Pull-to-refresh, Skeleton loader (lines 2800-2900)
‚îÇ   ‚îî‚îÄ‚îÄ Day totals & render (lines 2900-3400)
```

### ‚ùå Anti-Patterns (DO NOT)

1. **NO** –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ ‚Äî —Ç–æ–ª—å–∫–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
2. **NO** –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–π —Ñ—É–Ω–∫—Ü–∏–π ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å API
3. **NO** –Ω–æ–≤—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
4. **NO** TypeScript –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ ‚Äî –æ—Å—Ç–∞–≤–∏—Ç—å JavaScript
5. **NO** "—É–ª—É—á—à–µ–Ω–∏–π" –∫–æ–¥–∞ ‚Äî —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥, –Ω–µ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏–µ

### üîë Key Patterns

- **IIFE Module Pattern**: `(function(global){ ... })(window);`
- **HEYS Namespace**: `HEYS.moduleName = { ... }`
- **React from CDN**: `const React = global.React;`
- **ReactDOM.createPortal**: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω (document.body)
- **Storage via HEYS.store**: `HEYS.store.get/set` –∏–ª–∏ `U.lsGet/lsSet`

### üì¶ External Dependencies (–Ω–µ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å!)

–≠—Ç–∏ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –î–û `heys_day_v12.js` –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `HEYS.WheelColumn` ‚Äî –∏–∑ `heys_wheel_picker.js`
- `HEYS.SwipeableRow` ‚Äî –∏–∑ `heys_swipeable.js`  
- `HEYS.PullToRefresh` ‚Äî –∏–∑ `heys_pull_refresh.js`
- `HEYS.models` ‚Äî –∏–∑ `heys_models_v1.js`
- `HEYS.store` ‚Äî –∏–∑ `heys_storage_layer_v1.js`

### ‚ö†Ô∏è Module-level State (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)

–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–Ω–µ DayTab, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –ø—Ä–∏ –≤—ã–Ω–æ—Å–µ:
- `POPULAR_CACHE` ‚Äî –∫—ç—à –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (Map)
- `pIndex` ‚Äî –∏–Ω–¥–µ–∫—Å –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (–≤ scope —É computePopularProducts)

### üè∑Ô∏è –¢–µ–∫—É—â–∏–µ —ç–∫—Å–ø–æ—Ä—Ç—ã –≤ HEYS namespace

–ò–∑ `heys_day_v12.js` —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ:
- `HEYS.haptic` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –≤–∏–±—Ä–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 23)
- `HEYS.DatePicker` ‚Äî –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã (—Å—Ç—Ä–æ–∫–∞ 372)
- `HEYS.DayTab` ‚Äî –≥–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤–∫–ª–∞–¥–∫–∏ (—Å—Ç—Ä–æ–∫–∞ 429)

**–û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ª–æ–∫–∞–ª—å–Ω—ã** ‚Äî –ø—Ä–∏ –≤—ã–Ω–æ—Å–µ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –≤ `HEYS.dayUtils`, `HEYS.dayHooks` –∏ —Ç.–¥.

### üí° –†–∏—Å–∫ –æ–≤–µ—Ä–∫–∏–ª–ª–∞: Phase 4 + Phase 5

**–†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ**: `heys_day_pickers.js` + `heys_day_modals.js` ‚Üí `heys_day_pickers.js`
- –û–±–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `HEYS.WheelColumn` –∏ `ReactDOM.createPortal`
- –õ–æ–≥–∏—á–µ—Å–∫–∏ —Å–≤—è–∑–∞–Ω—ã (–≤—Å–µ picker-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ 2 —Ñ–∞–π–ª–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–±—ã—Ç–æ—á–Ω—ã–º –µ—Å–ª–∏ —Å—É–º–º–∞—Ä–Ω–æ < 400 —Å—Ç—Ä–æ–∫

### üìù File Loading Order in index.html

```html
<!-- Current order (ACTUAL from index.html) -->
<script defer src="heys_dev_utils.js"></script>
<script defer src="heys_simple_analytics.js"></script>
<script defer src="heys_core_v12.js"></script>
<script defer src="heys_storage_supabase_v1.js"></script>
<script defer src="heys_models_v1.js"></script>
<script defer src="heys_storage_layer_v1.js"></script>
<script defer src="heys_wheel_picker.js"></script>
<script defer src="heys_swipeable.js"></script>
<script defer src="heys_pull_refresh.js"></script>
<script defer src="heys_day_v12.js"></script>
<script defer src="heys_user_v12.js"></script>
<script defer src="heys_reports_v12.js"></script>
<script defer src="heys_app_v12.js"></script>

<!-- After refactoring (—Å–æ—Ö—Ä–∞–Ω—è–µ–º defer –∏ –ø–æ—Ä—è–¥–æ–∫) -->
<script defer src="heys_dev_utils.js"></script>
<script defer src="heys_simple_analytics.js"></script>
<script defer src="heys_core_v12.js"></script>
<script defer src="heys_storage_supabase_v1.js"></script>
<script defer src="heys_models_v1.js"></script>
<script defer src="heys_storage_layer_v1.js"></script>
<script defer src="heys_wheel_picker.js"></script>
<script defer src="heys_swipeable.js"></script>
<script defer src="heys_pull_refresh.js"></script>
<!-- Day module split (insert BEFORE heys_day_v12.js) -->
<script defer src="heys_day_utils.js"></script>
<script defer src="heys_day_hooks.js"></script>
<script defer src="heys_day_pickers.js"></script>
<script defer src="heys_day_modals.js"></script>
<script defer src="heys_day_trainings.js"></script>
<script defer src="heys_day_meals.js"></script>
<script defer src="heys_day_stats.js"></script>
<!-- End Day module split -->
<script defer src="heys_day_v12.js"></script>
<script defer src="heys_user_v12.js"></script>
<script defer src="heys_reports_v12.js"></script>
<script defer src="heys_app_v12.js"></script>
```

---

## üìÇ Quick Reference

### Key Files

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç—Ä–æ–∫ |
|------|-----------|-------|
| `apps/web/heys_day_v12.js` | –¶–µ–ª–µ–≤–æ–π —Ñ–∞–π–ª —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ | **~3400** |
| `apps/web/heys_models_v1.js` | –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (Product, Meal) | ~150 |
| `apps/web/heys_storage_layer_v1.js` | HEYS.store API | ~120 |
| `apps/web/heys_wheel_picker.js` | WheelColumn –¥–ª—è –ø–∏–∫–µ—Ä–æ–≤ | ~150 |
| `apps/web/heys_swipeable.js` | SwipeableRow –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö | ~100 |
| `apps/web/heys_pull_refresh.js` | PullToRefresh –∫–æ–º–ø–æ–Ω–µ–Ω—Ç | ~80 |
| `apps/web/index.html` | –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤ | ‚Äî |

### Commands

```bash
pnpm dev           # Start dev server ‚Üí localhost:3001
pnpm type-check    # TypeScript validation
pnpm lint          # ESLint check
pnpm build         # Production build
```

---

## üìù Notes

- **Priority**: medium
- **Complexity**: L (8-10 —Ñ–∞–∑, 4-6 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã)
- **Risk**: medium ‚Äî –º–Ω–æ–≥–æ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –Ω—É–∂–Ω–æ —Ç—â–∞—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Blockers**: –Ω–µ—Ç
- **Related Tasks**: CSS Refactoring (–∑–∞–≤–µ—Ä—à—ë–Ω), Mobile UX (–≤ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ)
- **Created**: 2025-11-28

---

## ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. defer —Å–∫—Ä–∏–ø—Ç—ã –∏ –ø–æ—Ä—è–¥–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏
- –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç `defer` ‚Äî –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ HTML –≤ –ø–æ—Ä—è–¥–∫–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
- **–†–∏—Å–∫**: –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –î–û `heys_day_v12.js` –≤ HTML
- **–†–µ—à–µ–Ω–∏–µ**: –≤—Å—Ç–∞–≤–ª—è—Ç—å —Å—Ç—Ä–æ–≥–æ –ø–µ—Ä–µ–¥ `<script defer src="heys_day_v12.js">`

### 2. –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- `heys_day_v12.js` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `HEYS.store` –∏ `HEYS.models`
- –í—ã–Ω–µ—Å–µ–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏ —Ç–æ–∂–µ –±—É–¥—É—Ç –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
- **–†–∏—Å–∫**: –µ—Å–ª–∏ –º–æ–¥—É–ª—å A –∑–∞–≤–∏—Å–∏—Ç –æ—Ç B, –∞ B –æ—Ç A ‚Äî —Å–ª–æ–º–∞–µ—Ç—Å—è
- **–†–µ—à–µ–Ω–∏–µ**: utils ‚Üí hooks ‚Üí pickers (—Å—Ç—Ä–æ–≥–∏–π –ø–æ—Ä—è–¥–æ–∫ –±–µ–∑ –æ–±—Ä–∞—Ç–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)

### 3. –°–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏
- `useDayAutosave` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `lsGet`/`lsSet` –∏–∑ utils
- `POPULAR_CACHE` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ meals
- **–†–∏—Å–∫**: –ø–æ—Å–ª–µ –≤—ã–Ω–æ—Å–∞ –∫—ç—à –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å
- **–†–µ—à–µ–Ω–∏–µ**: –≤—ã–Ω–æ—Å–∏—Ç—å `POPULAR_CACHE` –≤–º–µ—Å—Ç–µ —Å `computePopularProducts`

### 4. ReactDOM.createPortal
- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è –≤ `document.body`
- **–†–∏—Å–∫**: –ø—Ä–∏ –≤—ã–Ω–æ—Å–µ –º–æ–∂–µ—Ç –ø–æ—Ç–µ—Ä—è—Ç—å—Å—è –∫–æ–Ω—Ç–µ–∫—Å—Ç React
- **–†–µ—à–µ–Ω–∏–µ**: –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å ReactDOM –∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∏–ª–∏ –±—Ä–∞—Ç—å –∏–∑ `global.ReactDOM`

---

## üöÄ Execution Plan

1. **–ù–∞—á–∞—Ç—å —Å Phase 2** (—É—Ç–∏–ª–∏—Ç—ã) ‚Äî —Å–∞–º—ã–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —à–∞–≥
2. **–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã**: `pnpm build` + —Ä—É—á–Ω–æ–π —Ç–µ—Å—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ
3. **–ö–æ–º–º–∏—Ç –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã**: `refactor: extract heys_day_utils.js`
4. **–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö**: –æ—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –∫–æ–º–º–∏—Ç—É
5. **–ü–æ—Å–ª–µ Phase 9**: –ø–æ–ª–Ω—ã–π —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç

---

**Version**: 1.2.0 | **Created**: 2025-11-28 | **Last audit**: 2025-11-28

### Changelog
- **1.2.0**: –í—ã–ø–æ–ª–Ω–µ–Ω—ã Phase 2-4 ‚Äî —Å–æ–∑–¥–∞–Ω—ã heys_day_utils.js (267 —Å—Ç—Ä–æ–∫), heys_day_hooks.js (188 —Å—Ç—Ä–æ–∫), heys_day_pickers.js (155 —Å—Ç—Ä–æ–∫). heys_day_v12.js —É–º–µ–Ω—å—à–µ–Ω —Å 3434 –¥–æ 3051 —Å—Ç—Ä–æ–∫ (-11%). Phases 5-9 –æ—Ç–ª–æ–∂–µ–Ω—ã –∏–∑-–∑–∞ —Å–∏–ª—å–Ω–æ–π —Å–≤—è–∑–Ω–æ—Å—Ç–∏ —Å –ª–æ–∫–∞–ª—å–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º DayTab.
- **1.1.0**: –ì–ª—É–±–æ–∫–∏–π –∞—É–¥–∏—Ç ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ (3400), –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –ø–æ—Ä—è–¥–æ–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤ –≤ index.html —Å defer, –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å–µ–∫—Ü–∏—è —Ä–∏—Å–∫–æ–≤, —É—Ç–æ—á–Ω–µ–Ω–∏–µ –ø–æ useMobileDetection, –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ–∫—É—â–∏–µ HEYS —ç–∫—Å–ø–æ—Ä—Ç—ã, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ–± –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏ Phase 4+5
