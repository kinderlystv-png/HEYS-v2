# Task: –ò–Ω—Å—É–ª–∏–Ω–æ–≤–∞—è –≤–æ–ª–Ω–∞ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –ø—Ä–∏—ë–º–∞ –ø–∏—â–∏ (expand)

> **–î–∞—Ç–∞**: 2025-12-08  
> **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° –°—Ä–µ–¥–Ω–∏–π  
> **–í—Ä–µ–º—è**: ~60-90 –º–∏–Ω  
> **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: `heys_insulin_wave_v1.js`, `heys_day_v12.js`

---

## Phase 0 ‚Äî –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π)

### ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–ª–æ–∫–µ—Ä—ã (–≤—ã—è–≤–ª–µ–Ω—ã –∞—É–¥–∏—Ç–æ–º)

| # | –ë–ª–æ–∫–µ—Ä | –°—Ç–∞—Ç—É—Å | –î–µ–π—Å—Ç–≤–∏–µ |
|---|--------|--------|----------|
| B1 | **`normalizeToHeysDay` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç** –≤ utils | ‚ùå –ù–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç | –î–æ–±–∞–≤–∏—Ç—å –≤ `utils` –æ–±—ä–µ–∫—Ç –ø–µ—Ä–≤—ã–º –¥–µ–ª–æ–º |
| B2 | ~~`calculateMealWaveData` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç~~ | ‚úÖ –ù–µ –Ω—É–∂–µ–Ω | –ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π `waveHistory` |
| B3 | **`isCurrentActiveMeal` ‚â† `isCurrentMeal`** | ‚ö†Ô∏è –ü—É—Ç–∞–Ω–∏—Ü–∞ | `isCurrentMeal` = "–ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏", –Ω—É–∂–Ω–∞ –ù–û–í–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å —É—á—ë—Ç–æ–º waveEndMin |
| B4 | ~~waveHistory –ª–æ–≥–∏–∫–∞ –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è~~ | ‚úÖ –†–µ—à–µ–Ω–æ | –ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π `HEYS.insulinWaveData.waveHistory` |
| B5 | **@keyframes slideDown —É–∂–µ –æ–±—ä—è–≤–ª–µ–Ω** –≤ 3 CSS –º–æ–¥—É–ª—è—Ö | ‚ö†Ô∏è –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ | –ù–ï –æ–±—ä—è–≤–ª—è—Ç—å –Ω–æ–≤—ã–π, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π |
| B6 | ~~getProfile() –Ω–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω~~ | ‚úÖ –ù–µ –Ω—É–∂–µ–Ω | –î–∞–Ω–Ω—ã–µ —É–∂–µ –≤ `waveHistory` |
| B7 | **`HEYS.insulinWaveData` –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å** | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å | –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—Ä–∏—ë–º–æ–≤ |

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ –Ω–∞—á–∞–ª–∞

- [ ] `git status` ‚Äî —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –Ω–µ—Ç –Ω–µ–∑–∞–∫–æ–º–º–∏—á–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [ ] –ë—ç–∫–∞–ø: `cp apps/web/heys_insulin_wave_v1.js apps/web/heys_insulin_wave_v1.backup.js`
- [ ] –°–∫—Ä–∏–Ω—à–æ—Ç —Ç–µ–∫—É—â–µ–≥–æ UI –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–∏—ë–º–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ dev —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç (`pnpm dev`)
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `HEYS.InsulinWave` –≥—Ä—É–∑–∏—Ç—Å—è —Ä–∞–Ω—å—à–µ `heys_day_v12.js` (–ø–æ—Ä—è–¥–æ–∫ `<script>` –≤ `index.html`)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä –±–∞–Ω–¥–ª–∞: –Ω–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –Ω–µ –¥–æ–ª–∂–Ω–∞ –∑–∞–º–µ—Ç–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å `heys_insulin_wave_v1.js` (>50KB –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ)
- [ ] –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å KPI –¥–ª—è QA: —Å–∫—Ä–∏–Ω –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ overlap, –±–µ–∑ overlap, –ø–µ—Ä–µ—Ö–æ–¥ —á–µ—Ä–µ–∑ –ø–æ–ª–Ω–æ—á—å

### –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

- [ ] **`calculateMealNutrients`** ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:
  ```bash
  grep -n "calculateMealNutrients" apps/web/heys_insulin_wave_v1.js | head -5
  ```
- [ ] **`calculateMultiplier`** ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:
  ```bash
  grep -n "calculateMultiplier" apps/web/heys_insulin_wave_v1.js | head -5
  ```
- [ ] **`getProductFromItem`** ‚Äî –∫–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –≤ MealCard:
  ```bash
  grep -n "getProductFromItem" apps/web/heys_day_v12.js | head -10
  ```
- [ ] **`allMeals` –≤ MealCard** ‚Äî —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è:
  ```bash
  grep -n "allMeals" apps/web/heys_day_v12.js | head -10
  ```
- [ ] **–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** ‚Äî –æ—Ç–∫—É–¥–∞ –ø–æ–ª—É—á–∏—Ç—å `baseWaveHours`:
  ```bash
  grep -n "insulinWaveHours\|baseWaveHours" apps/web/heys_day_v12.js | head -5
  ```
- [ ] **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞** ‚Äî –µ—Å—Ç—å –ª–∏ `HEYS.analytics.trackDataOperation` –≤ scope (–¥–ª—è —Ç—Ä–µ–∫–∏–Ω–≥–∞ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è)

### –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–æ–∫

| –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å | –ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è | –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –≤ MealCard |
|-------------|---------------|-------------------------|
| `calculateMealNutrients` | `heys_insulin_wave_v1.js` | `HEYS.InsulinWave.calculateMealNutrients` |
| `calculateMultiplier` | `heys_insulin_wave_v1.js` | `HEYS.InsulinWave.calculateMultiplier` |
| `getProductFromItem` | `heys_day_v12.js` (–ª–æ–∫–∞–ª—å–Ω–∞—è) | –ü–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `M.getProductFromItem` |
| `allMeals` | props MealCard | ‚úÖ –£–∂–µ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è |
| `baseWaveHours` | –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | `HEYS.userProfile?.insulinWaveHours || 3` |
| `analytics` | `heys_simple_analytics.js` | `HEYS.analytics.trackDataOperation` |
| `getProfile()` | `heys_day_v12.js` (–ù–ï —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω) | ‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `HEYS.userProfile` –Ω–∞–ø—Ä—è–º—É—é |

### ‚ö° –ü–µ—Ä–≤–æ–æ—á–µ—Ä–µ–¥–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (–¥–æ –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)

**–®–∞–≥ 0.1**: –î–æ–±–∞–≤–∏—Ç—å `normalizeToHeysDay` –≤ utils:
```javascript
// apps/web/heys_insulin_wave_v1.js, –ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 386 (–∫–æ–Ω–µ—Ü utils –æ–±—ä–µ–∫—Ç–∞)
utils.normalizeToHeysDay = (timeMin) => {
  const HEYS_DAY_START = 3 * 60;
  return timeMin >= HEYS_DAY_START 
    ? timeMin - HEYS_DAY_START 
    : timeMin + (24 * 60 - HEYS_DAY_START);
};
```

**–®–∞–≥ 0.2**: –í—ã–Ω–µ—Å—Ç–∏ –ª–æ–≥–∏–∫—É —Ä–∞—Å—á—ë—Ç–∞ –≤–æ–ª–Ω—ã –æ–¥–Ω–æ–≥–æ –ø—Ä–∏—ë–º–∞ –∏–∑ `calculateInsulinWaveData`:
```javascript
// –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ (—Å—Ç—Ä–æ–∫–∏ 1413-1455) —É–∂–µ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –¥–ª—è waveHistory
// –ù—É–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é calculateSingleMealWave()
```

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–∞–∂–¥—É—é –∫–∞—Ä—Ç–æ—á–∫—É –ø—Ä–∏—ë–º–∞ –ø–∏—â–∏ (`MealCard`) expand-–∫–Ω–æ–ø–∫—É "üìâ –ò–Ω—Å—É–ª–∏–Ω–æ–≤–∞—è –≤–æ–ª–Ω–∞", –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–æ—Ç–æ—Ä—É—é —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥–µ—Ç–∞–ª—å–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Å—É–ª–∏–Ω–æ–≤–æ–π –≤–æ–ª–Ω—ã **–∏–º–µ–Ω–Ω–æ –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–∏—ë–º–∞**.

**–û—Ç–ª–∏—á–∏–µ –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ –≤–æ–ª–Ω—ã (–Ω–∞–≤–µ—Ä—Ö—É –¥–Ω–µ–≤–Ω–∏–∫–∞):**
- –û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **—Ç–µ–∫—É—â–µ–µ** —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å —Ç–æ—á–∫–æ–π "—Å–µ–π—á–∞—Å" –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ
- –í MealCard –ø–æ–∫–∞–∑—ã–≤–∞–µ–º **–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫—É—é** –≤–æ–ª–Ω—É –±–µ–∑ —Ç–æ—á–∫–∏ ‚Äî –≤—Ä–µ–º—è —É–∂–µ –ø—Ä–æ—à–ª–æ
- **–ö–ª—é—á–µ–≤–æ–π —Ñ–æ–∫—É—Å**: –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç –≤–æ–ª–Ω ‚Äî –µ—Å–ª–∏ —Å–ª–µ–¥—É—é—â–∏–π –ø—Ä–∏—ë–º –±—ã–ª —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ, –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ–º –µ–≥–æ –≤–æ–ª–Ω—É –¥—Ä—É–≥–∏–º —Ü–≤–µ—Ç–æ–º –∏ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –∫—Ä–∞—Å–Ω—ã–º –¥–∏–∞–ø–∞–∑–æ–Ω –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è (= –ª–∏–ø–æ–ª–∏–∑ –Ω–µ —É—Å–ø–µ–ª –Ω–∞—á–∞—Ç—å—Å—è)

---

## üîë –ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è (—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ)

| –í–æ–ø—Ä–æ—Å | –†–µ—à–µ–Ω–∏–µ |
|--------|---------|
| –ê–≤—Ç–æ-—Ä–∞—Å–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ overlap | ‚úÖ **–î–∞** ‚Äî –µ—Å–ª–∏ `hasOverlap`, –∫–∞—Ä—Ç–æ—á–∫–∞ —Ä–∞—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
| –¢–µ–∫—É—â–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–∏—ë–º (–≤–æ–ª–Ω–∞ –µ—â—ë –∏–¥—ë—Ç) | ‚ùå **–ù–ï –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å** –∫–Ω–æ–ø–∫—É expand ‚Äî –≤–æ–ª–Ω–∞ —É–∂–µ –µ—Å—Ç—å –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–µ –Ω–∞–≤–µ—Ä—Ö—É |
| –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ | ‚úÖ **–î–∞** ‚Äî —Ç—Ä–µ–∫–∞—Ç—å `insulin_wave_meal_expand` (open/close, hasOverlap, overlapMinutes) |
| –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—Å–µ –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç—ã | ‚úÖ **–î–∞** ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º overlap –∏ —Å–æ —Å–ª–µ–¥—É—é—â–∏–º, –∏ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –ø—Ä–∏—ë–º–æ–º |
| –§–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏ | 24h |
| –ì—Ä–∞–Ω–∏—Ü—ã –¥–Ω—è | **03:00 ‚Üí 03:00** (–Ω–µ 00:00 ‚Üí 00:00!) |

### ‚ö†Ô∏è –í–ê–ñ–ù–û: –ì—Ä–∞–Ω–∏—Ü—ã –¥–Ω—è 03:00 ‚Üí 03:00

–í HEYS –¥–µ–Ω—å –¥–ª–∏—Ç—Å—è —Å 03:00 –¥–æ 03:00 —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–Ω—è (–Ω–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ 00:00-00:00).

**–õ–æ–≥–∏–∫–∞:**
- –ü—Ä–∏—ë–º –≤ 02:30 –Ω–æ—á–∏ = –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –ü–†–ï–î–´–î–£–©–ï–ú–£ –¥–Ω—é
- –ü—Ä–∏—ë–º –≤ 03:01 = –Ω–æ–≤—ã–π –¥–µ–Ω—å
- –ü—Ä–∏ —Ä–∞—Å—á—ë—Ç–µ overlap –º–µ–∂–¥—É –ø—Ä–∏—ë–º–∞–º–∏ 23:30 ‚Üí 01:30 ‚Äî —ç—Ç–æ –û–î–ò–ù –¥–µ–Ω—å

**–í –∫–æ–¥–µ:**
```javascript
// –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –¥–Ω—è HEYS (03:00 = 0 –º–∏–Ω—É—Ç –¥–Ω—è)
const normalizeToHeysDay = (timeMin) => {
  // 03:00 = 180 –º–∏–Ω—É—Ç –æ—Ç –ø–æ–ª—É–Ω–æ—á–∏ = 0 –º–∏–Ω—É—Ç HEYS-–¥–Ω—è
  // 02:59 = 179 –º–∏–Ω—É—Ç –æ—Ç –ø–æ–ª—É–Ω–æ—á–∏ = 1439 –º–∏–Ω—É—Ç HEYS-–¥–Ω—è (–∫–æ–Ω–µ—Ü)
  const HEYS_DAY_START = 3 * 60; // 03:00 = 180 –º–∏–Ω—É—Ç
  if (timeMin >= HEYS_DAY_START) {
    return timeMin - HEYS_DAY_START; // 03:00 ‚Üí 0, 04:00 ‚Üí 60
  } else {
    return timeMin + (24 * 60 - HEYS_DAY_START); // 00:00 ‚Üí 1260, 02:59 ‚Üí 1439
  }
};
```

---

## üéØ –¶–µ–ª–∏

1. **–ü–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–æ—à–ª–æ–≥–æ** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∫–∞–∫ –ø—Ä–æ—à–ª–∞ –µ–≥–æ –≤–æ–ª–Ω–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏—ë–º–∞
2. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ—à–∏–±–æ–∫** ‚Äî –∫—Ä–∞—Å–Ω—ã–µ –∑–æ–Ω—ã –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –≥–¥–µ –±—ã–ª–æ —Ä–∞–Ω–æ –µ—Å—Ç—å
3. **–û–±—É—á–µ–Ω–∏–µ** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—á–∏—Ç—Å—è –≤—ã–¥–µ—Ä–∂–∏–≤–∞—Ç—å –ø–∞—É–∑—ã –º–µ–∂–¥—É –ø—Ä–∏—ë–º–∞–º–∏

---

## üñºÔ∏è –ú–∞–∫–µ—Ç UI

### Collapsed state (—É—Å–ø–µ—à–Ω—ã–π –ø—Ä–∏—ë–º ‚Äî –±–µ–∑ –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç–∞)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üç≥ –ó–∞–≤—Ç—Ä–∞–∫          08:30           320 –∫–∫–∞–ª ‚îÇ
‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ
‚îÇ [–ø—Ä–æ–¥—É–∫—Ç—ã...]                               ‚îÇ
‚îÇ üìâ –í–æ–ª–Ω–∞ 3—á ‚Ä¢ ‚úÖ 45–º–∏–Ω –ª–∏–ø–æ–ª–∏–∑     [‚ñæ]     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Auto-expanded state (–ø—Ä–∏ –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç–µ ‚Äî —Ä–∞—Å–∫—Ä—ã—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üìâ –í–æ–ª–Ω–∞ 2.5—á ‚Ä¢ ‚ö†Ô∏è –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç 1—á 15–º  [‚ñ¥]  ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ  [–≥—Ä–∞—Ñ–∏–∫ —Å –∫—Ä–∞—Å–Ω–æ–π –∑–æ–Ω–æ–π overlap]      ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ ‚ùå –õ–∏–ø–æ–ª–∏–∑ –ù–ï –Ω–∞—Å—Ç—É–ø–∏–ª                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –¢–µ–∫—É—â–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–∏—ë–º (–≤–æ–ª–Ω–∞ –µ—â—ë –∏–¥—ë—Ç)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üç≥ –û–±–µ–¥             14:30           520 –∫–∫–∞–ª ‚îÇ
‚îÇ [–ø—Ä–æ–¥—É–∫—Ç—ã...]                               ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ ‚õî –ö–Ω–æ–ø–∫–∞ "–í–æ–ª–Ω–∞" –ù–ï –ü–û–ö–ê–ó–´–í–ê–ï–¢–°–Ø          ‚îÇ
‚îÇ    (–≤–æ–ª–Ω–∞ –∞–∫—Ç–∏–≤–Ω–∞ ‚Äî —Å–º. –∫–∞—Ä—Ç–æ—á–∫—É –Ω–∞–≤–µ—Ä—Ö—É)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Expanded state
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üç≥ –ó–∞–≤—Ç—Ä–∞–∫          08:30           320 –∫–∫–∞–ª ‚îÇ
‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ
‚îÇ [–ø—Ä–æ–¥—É–∫—Ç—ã...]                               ‚îÇ
‚îÇ üìâ –í–æ–ª–Ω–∞ 3—á ‚Ä¢ ‚ö†Ô∏è –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç 1—á 15–º  [‚ñ¥]     ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ  08:30         10:15    11:30         ‚îÇ ‚îÇ
‚îÇ ‚îÇ    ‚óè‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚óã            ‚îÇ ‚îÇ
‚îÇ ‚îÇ    ‚îú‚îÄ‚îÄ‚îÄ –≤–æ–ª–Ω–∞ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§            ‚îÇ ‚îÇ
‚îÇ ‚îÇ                ‚óè‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ        ‚îÇ ‚îÇ
‚îÇ ‚îÇ                ‚îú‚îÄ —Å–ª–µ–¥.–ø—Ä–∏—ë–º ‚îÄ‚î§        ‚îÇ ‚îÇ
‚îÇ ‚îÇ                ‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì ‚Üê –ü–ï–†–ï–•–õ–Å–°–¢      ‚îÇ ‚îÇ
‚îÇ ‚îÇ                                        ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ ‚îå‚îÄ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ üïê 3—á 00–º  ‚îÇ  –ì–ò 45 üü¢  ‚îÇ  GL 32       ‚îÇ ‚îÇ
‚îÇ ‚îÇ –£: 85–≥    ‚îÇ  –ë: 25–≥    ‚îÇ  –ö–ª: 8–≥      ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ ‚ùå –õ–∏–ø–æ–ª–∏–∑ –ù–ï –Ω–∞—Å—Ç—É–ø–∏–ª                     ‚îÇ
‚îÇ    –°–ª–µ–¥—É—é—â–∏–π –ø—Ä–∏—ë–º –±—ã–ª –Ω–∞ 1—á 15–º–∏–Ω —Ä–∞–Ω—å—à–µ ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –£—Å–ø–µ—à–Ω—ã–π —Å–ª—É—á–∞–π (–±–µ–∑ –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç–∞)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üìâ –í–æ–ª–Ω–∞ 2.8—á ‚Ä¢ ‚úÖ 45–º–∏–Ω –ª–∏–ø–æ–ª–∏–∑    [‚ñ¥]    ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ  08:30              11:18    12:03    ‚îÇ ‚îÇ
‚îÇ ‚îÇ    ‚óè‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚óã               ‚îÇ ‚îÇ
‚îÇ ‚îÇ                       ‚îú‚îÄ‚îÄ‚îÄ‚î§ ‚Üê 45–º–∏–Ω   ‚îÇ ‚îÇ
‚îÇ ‚îÇ                      üî• –ª–∏–ø–æ–ª–∏–∑       ‚îÇ ‚îÇ
‚îÇ ‚îÇ                             ‚óè‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ  ‚îÇ ‚îÇ
‚îÇ ‚îÇ                         —Å–ª–µ–¥.–ø—Ä–∏—ë–º    ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ ‚úÖ –õ–∏–ø–æ–ª–∏–∑: 45 –º–∏–Ω –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø—Ä–∏—ë–º–∞   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –®–∞–≥ 1: –î–æ–±–∞–≤–∏—Ç—å `normalizeToHeysDay` –≤ utils (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ü–ï–†–í–´–ú)
**–§–∞–π–ª**: `apps/web/heys_insulin_wave_v1.js`
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: –ü–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 386 (–∫–æ–Ω–µ—Ü –æ–±—ä–µ–∫—Ç–∞ utils)

- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–∏:
  ```javascript
  // –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –¥–Ω—è HEYS (03:00 = 0 –º–∏–Ω—É—Ç –¥–Ω—è)
  utils.normalizeToHeysDay = (timeMin) => {
    const HEYS_DAY_START = 3 * 60; // 03:00 = 180 –º–∏–Ω—É—Ç
    if (timeMin >= HEYS_DAY_START) {
      return timeMin - HEYS_DAY_START; // 03:00 ‚Üí 0, 04:00 ‚Üí 60
    }
    return timeMin + (24 * 60 - HEYS_DAY_START); // 00:00 ‚Üí 1260, 02:59 ‚Üí 1439
  };
  ```

> ‚ö†Ô∏è **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: `calculateMealWaveData` –ù–ï –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π `waveHistory` –∏–∑ `insulinWaveData`

### –®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å React-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
**–§–∞–π–ª**: `apps/web/heys_insulin_wave_v1.js`
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: –ü–æ—Å–ª–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ `renderWaveChart` (~—Å—Ç—Ä–æ–∫–∞ 1800)

- [ ] –°–æ–∑–¥–∞—Ç—å `MealWaveExpandSection({ waveData, prevWave, nextWave })` ‚Äî React —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- [ ] **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π SVG-–≥—Ä–∞—Ñ–∏–∫** –∏–∑ `renderWaveChart`:
  - –¢–æ—Ç –∂–µ viewBox, –º–∞—Å—à—Ç–∞–±, –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã
  - **–°–∏–Ω–∏–π –≥—Ä–∞–¥–∏–µ–Ω—Ç** ‚Äî –≤–æ–ª–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–∏—ë–º–∞ (–∫–∞–∫ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–µ)
  - **–û—Ä–∞–Ω–∂–µ–≤—ã–π overlay (60% opacity)** ‚Äî –≤–æ–ª–Ω–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø—Ä–∏—ë–º–∞
  - **–§–∏–æ–ª–µ—Ç–æ–≤—ã–π overlay (40% opacity)** ‚Äî –≤–æ–ª–Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø—Ä–∏—ë–º–∞
  - **–ö—Ä–∞—Å–Ω–∞—è –∑–æ–Ω–∞ (30% opacity + —à—Ç—Ä–∏—Ö–æ–≤–∫–∞)** ‚Äî –æ–±–ª–∞—Å—Ç—å –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç–∞
  - **–ó–µ–ª—ë–Ω–∞—è –∑–æ–Ω–∞ (20% opacity)** ‚Äî –æ–±–ª–∞—Å—Ç—å –ª–∏–ø–æ–ª–∏–∑–∞
  - –ú–µ—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–∏: –Ω–∞—á–∞–ª–æ, –∫–æ–Ω–µ—Ü –≤–æ–ª–Ω—ã, —Å–æ—Å–µ–¥–Ω–∏–µ –ø—Ä–∏—ë–º—ã
- [ ] **–ë–ï–ó —Ç–æ—á–∫–∏ "—Å–µ–π—á–∞—Å"** ‚Äî —ç—Ç–æ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –≤–æ–ª–Ω–∞
- [ ] **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã –º–Ω–æ–∂–∏—Ç–µ–ª—è** (grid 2 –∫–æ–ª–æ–Ω–∫–∏):
  ```
  ‚îå‚îÄ –§–∞–∫—Ç–æ—Ä—ã –¥–ª–∏–Ω—ã –≤–æ–ª–Ω—ã ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
  ‚îÇ üïê 3—á 12–º (–±–∞–∑–∞ 3—á √ó 1.07)                ‚îÇ
  ‚îÇ ‚îú‚îÄ‚îÄ –ì–ò: 45 üü¢ –Ω–∏–∑–∫–∏–π                      ‚îÇ
  ‚îÇ ‚îú‚îÄ‚îÄ GL: 32 (—É–º–µ—Ä–µ–Ω–Ω–∞—è)                    ‚îÇ
  ‚îÇ ‚îú‚îÄ‚îÄ –ñ–∏—Ä—ã: +8% (25–≥)                       ‚îÇ
  ‚îÇ ‚îú‚îÄ‚îÄ –ë–µ–ª–æ–∫: +5% (30–≥)                      ‚îÇ
  ‚îÇ ‚îú‚îÄ‚îÄ –ö–ª–µ—Ç—á–∞—Ç–∫–∞: -3% (12–≥)                  ‚îÇ
  ‚îÇ ‚îî‚îÄ‚îÄ –ñ–∏–¥–∫–æ—Å—Ç—å: -18% (–π–æ–≥—É—Ä—Ç)               ‚îÇ
  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
  ```
- [ ] –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å:
  - ‚úÖ "–õ–∏–ø–æ–ª–∏–∑: X –º–∏–Ω –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø—Ä–∏—ë–º–∞" (–∑–µ–ª—ë–Ω—ã–π)
  - ‚ùå "–õ–∏–ø–æ–ª–∏–∑ –ù–ï –Ω–∞—Å—Ç—É–ø–∏–ª ‚Äî –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç X—á Y–º–∏–Ω" (–∫—Ä–∞—Å–Ω—ã–π)
  - üü¢ "–ü–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–∏—ë–º –¥–Ω—è" (–µ—Å–ª–∏ –Ω–µ—Ç nextWave)

### –®–∞–≥ 3: –î–æ–±–∞–≤–∏—Ç—å expand –≤ MealCard
**–§–∞–π–ª**: `apps/web/heys_day_v12.js`
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: –í–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ `MealCard` (~—Å—Ç—Ä–æ–∫–∞ 1222)

- [ ] –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ waveHistory:
  ```javascript
  // ‚úÖ –ì–ª–æ–±–∞–ª—å–Ω—ã–π waveHistory ‚Äî —É–∂–µ –ø–æ—Å—á–∏—Ç–∞–Ω –≤ DayTab
  const waveHistory = React.useMemo(() => {
    return HEYS.insulinWaveData?.waveHistory || [];
  }, [HEYS.insulinWaveData]);
  
  // –ù–∞—Ö–æ–¥–∏–º –≤–æ–ª–Ω—É —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–∏—ë–º–∞
  const currentWaveIndex = waveHistory.findIndex(w => w.time === meal.time);
  const currentWave = currentWaveIndex >= 0 ? waveHistory[currentWaveIndex] : null;
  const prevWave = currentWaveIndex > 0 ? waveHistory[currentWaveIndex - 1] : null;
  const nextWave = currentWaveIndex >= 0 && currentWaveIndex < waveHistory.length - 1 
    ? waveHistory[currentWaveIndex + 1] : null;
  ```
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å overlap:
  ```javascript
  const hasOverlapWithNext = currentWave && nextWave && currentWave.endMin > nextWave.startMin;
  const hasOverlapWithPrev = currentWave && prevWave && prevWave.endMin > currentWave.startMin;
  const hasAnyOverlap = hasOverlapWithNext || hasOverlapWithPrev;
  ```
- [ ] –î–æ–±–∞–≤–∏—Ç—å state —Å auto-expand –ø—Ä–∏ overlap:
  ```javascript
  const [waveExpanded, setWaveExpanded] = React.useState(() => hasAnyOverlap);
  ```
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø—Ä–∏—ë–º —Ç–µ–∫—É—â–∏–º –∞–∫—Ç–∏–≤–Ω—ã–º:
  ```javascript
  const isCurrentActiveMeal = React.useMemo(() => {
    if (!currentWave) return false;
    const now = new Date();
    const nowMin = now.getHours() * 60 + now.getMinutes();
    return nowMin >= currentWave.startMin && nowMin < currentWave.endMin;
  }, [currentWave]);
  ```
- [ ] –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É expand —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:
  ```javascript
  const showWaveButton = currentWave && !isCurrentActiveMeal && (meal.items || []).length > 0;
  ```
- [ ] –î–æ–±–∞–≤–∏—Ç—å toggle —Å haptic –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π:
  ```javascript
  const toggleWave = React.useCallback(() => {
    const newState = !waveExpanded;
    setWaveExpanded(newState);
    
    if (HEYS.dayUtils?.haptic) HEYS.dayUtils.haptic('light');
    
    if (HEYS.analytics?.trackDataOperation) {
      HEYS.analytics.trackDataOperation('insulin_wave_meal_expand', {
        action: newState ? 'open' : 'close',
        hasOverlap: hasAnyOverlap,
        overlapMinutes: hasOverlapWithNext 
          ? currentWave.endMin - nextWave.startMin 
          : hasOverlapWithPrev 
            ? prevWave.endMin - currentWave.startMin 
            : 0,
        mealIndex: mealIndex
      });
    }
  }, [waveExpanded, hasAnyOverlap, currentWave, prevWave, nextWave, mealIndex]);
  ```
- [ ] –†–µ–Ω–¥–µ—Ä –∫–Ω–æ–ø–∫–∏ (–ø–æ—Å–ª–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤, –ø–µ—Ä–µ–¥ ratings):
  ```javascript
  {showWaveButton && React.createElement('div', {
    className: 'meal-wave-toggle' + (waveExpanded ? ' expanded' : ''),
    onClick: toggleWave,
    style: {
      display: 'flex', justifyContent: 'space-between', alignItems: 'center',
      padding: '10px 12px', marginTop: '8px',
      background: hasAnyOverlap 
        ? 'rgba(239, 68, 68, 0.08)' 
        : 'rgba(59, 130, 246, 0.08)',
      borderRadius: '10px', cursor: 'pointer',
      fontSize: '13px', fontWeight: '500', 
      color: hasAnyOverlap ? '#dc2626' : '#334155'
    }
  },
    React.createElement('span', null, 
      `üìâ –í–æ–ª–Ω–∞ ${(currentWave.duration / 60).toFixed(1)}—á ‚Ä¢ ${
        hasAnyOverlap 
          ? `‚ö†Ô∏è –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç ${Math.round((hasOverlapWithNext ? currentWave.endMin - nextWave.startMin : prevWave.endMin - currentWave.startMin) / 60)}—á ${(hasOverlapWithNext ? currentWave.endMin - nextWave.startMin : prevWave.endMin - currentWave.startMin) % 60}–º`
          : nextWave 
            ? `‚úÖ ${nextWave.startMin - currentWave.endMin}–º–∏–Ω –ª–∏–ø–æ–ª–∏–∑`
            : 'üü¢ –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–∏—ë–º'
      }`
    ),
    React.createElement('span', { className: 'toggle-arrow' }, waveExpanded ? '‚ñ¥' : '‚ñæ')
  )}
  ```
- [ ] –†–µ–Ω–¥–µ—Ä —Å–µ–∫—Ü–∏–∏:
  ```javascript
  {waveExpanded && showWaveButton && React.createElement(
    HEYS.InsulinWave.MealWaveExpandSection, 
    { waveData: currentWave, prevWave, nextWave }
  )}
  ```

### –®–∞–≥ 4: –°—Ç–∏–ª–∏ (Tailwind inline)
**–í–º–µ—Å—Ç–æ CSS —Ñ–∞–π–ª–∞ ‚Äî inline —Å—Ç–∏–ª–∏ –≤ React.createElement**

- [ ] –ö–Ω–æ–ø–∫–∞ toggle:
  ```javascript
  style: {
    display: 'flex', justifyContent: 'space-between', alignItems: 'center',
    padding: '10px 12px', marginTop: '8px',
    background: 'rgba(59, 130, 246, 0.08)',
    borderRadius: '10px', cursor: 'pointer',
    fontSize: '13px', fontWeight: '500', color: '#334155'
  }
  ```
- [ ] –ü—Ä–∏ –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç–µ ‚Äî –∫—Ä–∞—Å–Ω–æ–≤–∞—Ç—ã–π —Ñ–æ–Ω:
  ```javascript
  background: mealWaveData.nextMeal?.hasOverlap 
    ? 'rgba(239, 68, 68, 0.08)' 
    : 'rgba(59, 130, 246, 0.08)'
  ```
- [ ] –ê–Ω–∏–º–∞—Ü–∏—è expand (CSS –≤ heys-components.css –µ—Å–ª–∏ –Ω—É–∂–Ω–æ):
  ```css
  .meal-wave-content {
    animation: slideDown 0.2s ease-out;
  }
  @keyframes slideDown {
    from { opacity: 0; transform: translateY(-8px); }
    to { opacity: 1; transform: translateY(0); }
  }
  ```

### –®–∞–≥ 5: –≠–∫—Å–ø–æ—Ä—Ç API
**–§–∞–π–ª**: `apps/web/heys_insulin_wave_v1.js`
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: –í –æ–±—ä–µ–∫—Ç–µ `HEYS.InsulinWave = { ... }` (~—Å—Ç—Ä–æ–∫–∞ 2640)

- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤ —ç–∫—Å–ø–æ—Ä—Ç:
  ```javascript
  HEYS.InsulinWave = {
    // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ
    
    // –ù–æ–≤–æ–µ
    MealWaveExpandSection,
  };
  ```

> ‚ö†Ô∏è **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: `calculateMealWaveData` –ù–ï —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π `waveHistory`

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –î–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏—è–º (–í–ê–ñ–ù–û!)

```javascript
// –í MealCard ‚Äî —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ –≥–ª–æ–±–∞–ª—å–Ω—ã–π namespace:
const InsulinWave = HEYS.InsulinWave;
const utils = InsulinWave.utils;  // timeToMinutes, minutesToTime, etc.

// getProductFromItem ‚Äî –ª–æ–∫–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤ heys_day_v12.js
// –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –∫–∞–∫: const getProductFromItem = (it, pIdx) => { ... }
// –í MealCard –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é (–≤ scope)

// baseWaveHours ‚Äî –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const baseWaveHours = HEYS.userProfile?.insulinWaveHours || 3;
```

### –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏—ë–º–æ–≤ –ø–æ –≤—Ä–µ–º–µ–Ω–∏

```javascript
// ‚ö†Ô∏è allMeals –ù–ï –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω ‚Äî —ç—Ç–æ –∏—Å—Ö–æ–¥–Ω—ã–π day.meals
// –°–æ—Ä—Ç–∏—Ä—É–µ–º –≤–Ω—É—Ç—Ä–∏ MealCard:
const sortedMeals = React.useMemo(() => {
  return [...allMeals]
    .filter(m => m.time)  // —Ç–æ–ª—å–∫–æ —Å –≤—Ä–µ–º–µ–Ω–µ–º
    .sort((a, b) => {
      const tA = HEYS.InsulinWave.utils.timeToMinutes(a.time);
      const tB = HEYS.InsulinWave.utils.timeToMinutes(b.time);
      return tA - tB;  // —Ä–∞–Ω—å—à–µ ‚Üí –º–µ–Ω—å—à–µ –∏–Ω–¥–µ–∫—Å
    });
}, [allMeals]);
```

### –†–∞—Å—á—ë—Ç –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç–∞ —Å —É—á—ë—Ç–æ–º –¥–Ω—è HEYS (03:00 ‚Üí 03:00)

```javascript
// ‚ö†Ô∏è –í–ê–ñ–ù–û: –î–µ–Ω—å HEYS = 03:00 ‚Üí 03:00 (–Ω–µ 00:00 ‚Üí 00:00)
const HEYS_DAY_START = 3 * 60; // 180 –º–∏–Ω—É—Ç

// –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏ —Ä–∞—Å—á—ë—Ç–æ–≤
const normalizeToHeysDay = (timeMin) => {
  if (timeMin >= HEYS_DAY_START) {
    return timeMin - HEYS_DAY_START; // 03:00 ‚Üí 0, 04:00 ‚Üí 60, 23:59 ‚Üí 1259
  } else {
    return timeMin + (24 * 60 - HEYS_DAY_START); // 00:00 ‚Üí 1260, 02:59 ‚Üí 1439
  }
};

const calculateOverlap = (currentEndMin, nextStartMin) => {
  // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –æ–±–∞ –≤—Ä–µ–º–µ–Ω–∏ –∫ HEYS-–¥–Ω—é
  const normEnd = normalizeToHeysDay(currentEndMin % (24 * 60));
  const normStart = normalizeToHeysDay(nextStartMin);
  
  let gap = normStart - normEnd;
  
  // –ï—Å–ª–∏ gap –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π ‚Äî –µ—Å—Ç—å –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç
  const hasOverlap = gap < 0;
  const overlapMinutes = hasOverlap ? Math.abs(gap) : 0;
  const lipolysisMinutes = hasOverlap ? 0 : gap;
  
  return { hasOverlap, overlapMinutes, lipolysisMinutes };
};
```

### –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞
| –≠–ª–µ–º–µ–Ω—Ç | –¶–≤–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|------|----------|
| –í–æ–ª–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–∏—ë–º–∞ | `#3b82f6` ‚Üí `#8b5cf6` | –ì—Ä–∞–¥–∏–µ–Ω—Ç —Å–∏–Ω–∏–π-—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π |
| –í–æ–ª–Ω–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø—Ä–∏—ë–º–∞ | `#f97316` | –û—Ä–∞–Ω–∂–µ–≤—ã–π (60% opacity) |
| –ó–æ–Ω–∞ –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç–∞ | `#ef4444` | –ö—Ä–∞—Å–Ω—ã–π (30% opacity + —à—Ç—Ä–∏—Ö–æ–≤–∫–∞) |
| –ó–æ–Ω–∞ –ª–∏–ø–æ–ª–∏–∑–∞ | `#22c55e` | –ó–µ–ª—ë–Ω—ã–π (20% opacity) |
| –ì–ò –Ω–∏–∑–∫–∏–π (‚â§35) | `#22c55e` | –ó–µ–ª—ë–Ω—ã–π |
| –ì–ò —Å—Ä–µ–¥–Ω–∏–π (36-55) | `#eab308` | –ñ—ë–ª—Ç—ã–π |
| –ì–ò –≤—ã—Å–æ–∫–∏–π (>55) | `#ef4444` | –ö—Ä–∞—Å–Ω—ã–π |

---

## üì± Mobile UX

- Expand/collapse ‚Äî –æ–¥–Ω–∏–º —Ç–∞–ø–æ–º
- –ì—Ä–∞—Ñ–∏–∫ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π (width: 100%)
- Touch-friendly: –∫–Ω–æ–ø–∫–∞ ‚â•44px –≤—ã—Å–æ—Ç–∞ (min-h-11)
- Smooth animation: 200ms ease-out
- Haptic feedback –ø—Ä–∏ toggle

---

## ‚ö†Ô∏è Edge Cases

1. **–¢–µ–∫—É—â–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–∏—ë–º** (–≤–æ–ª–Ω–∞ –µ—â—ë –∏–¥—ë—Ç):
   - ‚õî **–ù–ï –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å** –∫–Ω–æ–ø–∫—É expand –≤–æ–æ–±—â–µ
   - –í–æ–ª–Ω–∞ —É–∂–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–µ –Ω–∞–≤–µ—Ä—Ö—É –¥–Ω–µ–≤–Ω–∏–∫–∞
   - –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: `nowMin >= mealMin && nowMin < waveEndMin`

2. **–ü–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–∏—ë–º –¥–Ω—è** ‚Äî –Ω–µ—Ç nextMeal:
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —Å–≤–æ—é –≤–æ–ª–Ω—É
   - –¢–µ–∫—Å—Ç: "üü¢ –ü–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–∏—ë–º –¥–Ω—è"
   - –ü—Ä–æ–≤–µ—Ä—è–µ–º overlap —Å –ü–†–ï–î–´–î–£–©–ò–ú –ø—Ä–∏—ë–º–æ–º (prevMeal)

3. **–ü–µ—Ä–≤—ã–π –ø—Ä–∏—ë–º –¥–Ω—è** ‚Äî –Ω–µ—Ç prevMeal:
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–æ–ª–Ω—É + overlap —Å–æ —Å–ª–µ–¥—É—é—â–∏–º –ø—Ä–∏—ë–º–æ–º
   - –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º "–ø—Ä–æ—à–ª—É—é" –≤–æ–ª–Ω—É —Å–ª–µ–≤–∞

4. **–ù–æ—á–Ω–æ–π –ø—Ä–∏—ë–º (–ø–æ—Å–ª–µ 00:00, –¥–æ 03:00)**:
   - ‚ö†Ô∏è –û—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –ü–†–ï–î–´–î–£–©–ï–ú–£ –¥–Ω—é HEYS
   - –í—Ä–µ–º—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –∫–∞–∫ "24:20", "25:30" –∏ —Ç.–¥.
   - `utils.timeToMinutes()` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `normalizeToHeysDay()` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞

5. **–ü–µ—Ä–µ—Ö–æ–¥ —á–µ—Ä–µ–∑ –≥—Ä–∞–Ω–∏—Ü—É –¥–Ω—è (23:30 ‚Üí 01:30)**:
   - –û–±–∞ –ø—Ä–∏—ë–º–∞ = –û–î–ò–ù –¥–µ–Ω—å HEYS (03:00 ‚Üí 03:00)
   - Overlap —Å—á–∏—Ç–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —á–µ—Ä–µ–∑ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é

6. **–ü—Ä–∏—ë–º –±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏** ‚Äî –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É expand:
   ```javascript
   const showWaveButton = meal.time && (meal.items || []).length > 0 && !isCurrentActiveMeal;
   ```

7. **–ü—Ä–∏—ë–º –±–µ–∑ –ø—Ä–æ–¥—É–∫—Ç–æ–≤** ‚Äî –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤–æ–ª–Ω—É (–Ω–µ—á–µ–≥–æ —Å—á–∏—Ç–∞—Ç—å)

8. **–î–≤–∞ –ø—Ä–∏—ë–º–∞ –≤ –æ–¥–Ω–æ –≤—Ä–µ–º—è** ‚Äî –º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ, –Ω–æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç –ø–æ—Ä—è–¥–æ–∫

9. **–ü–µ—Ä–µ—Ö–ª—ë—Å—Ç –ò —Å–ª–µ–≤–∞ –ò —Å–ø—Ä–∞–≤–∞** ‚Äî —Ä–µ–¥–∫–æ, –Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ:
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –û–ë–ê –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç–∞ (–∫—Ä–∞—Å–Ω—ã–µ –∑–æ–Ω—ã —Å–ª–µ–≤–∞ –∏ —Å–ø—Ä–∞–≤–∞)
   - summaryText: "‚ö†Ô∏è 2 –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç–∞: 30–º + 45–º"

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
1. [ ] –ó–∞–≤—Ç—Ä–∞–∫ 08:30 ‚Üí –æ–±–µ–¥ 13:00 (–Ω–µ—Ç –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç–∞, –µ—Å—Ç—å –ª–∏–ø–æ–ª–∏–∑)
2. [ ] –ó–∞–≤—Ç—Ä–∞–∫ 08:30 ‚Üí –ø–µ—Ä–µ–∫—É—Å 10:00 (–ø–µ—Ä–µ—Ö–ª—ë—Å—Ç ~1.5—á)
3. [ ] –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø—Ä–∏—ë–º –∑–∞ –¥–µ–Ω—å
4. [ ] –ü—Ä–∏—ë–º –±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏ ‚Äî –∫–Ω–æ–ø–∫–∞ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è
5. [ ] –ü—Ä–∏—ë–º –±–µ–∑ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ ‚Äî –∫–Ω–æ–ø–∫–∞ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è

### Edge cases
6. [ ] –ù–æ—á–Ω–æ–π –ø—Ä–∏—ë–º 23:30 ‚Üí —Å–ª–µ–¥—É—é—â–∏–π 01:30 (–ø–µ—Ä–µ—Ö–æ–¥ —á–µ—Ä–µ–∑ –ø–æ–ª–Ω–æ—á—å)
7. [ ] 5+ –ø—Ä–∏—ë–º–æ–≤ –∑–∞ –¥–µ–Ω—å (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
8. [ ] Toggle –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–¥—Ä—è–¥ (–∞–Ω–∏–º–∞—Ü–∏—è)

### Mobile
9. [ ] iPhone SE (320px) ‚Äî –≥—Ä–∞—Ñ–∏–∫ –Ω–µ –æ–±—Ä–µ–∑–∞–µ—Ç—Å—è
10. [ ] Haptic feedback —Ä–∞–±–æ—Ç–∞–µ—Ç
11. [ ] Touch area –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è (‚â•44px)

---

## ‚ö†Ô∏è –†–∏—Å–∫-–º–∞—Ç—Ä–∏—Ü–∞

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –ò–º–ø–∞–∫—Ç | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-------------|--------|-----------|
| `allMeals` –Ω–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω ‚Üí –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π nextMeal | –í—ã—Å–æ–∫–∞—è | –í—ã—Å–æ–∫–∏–π | –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤ useMemo —Å `normalizeToHeysDay` |
| getProductFromItem –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –≤ scope | –ù–∏–∑–∫–∞—è | –ë–ª–æ–∫–∏—Ä—É–µ—Ç | ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ ‚Äî –¥–æ—Å—Ç—É–ø–µ–Ω (—Å—Ç—Ä–æ–∫–∞ 51 heys_day_v12.js) |
| –ü–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä –≤—Å–µ—Ö MealCard –ø—Ä–∏ toggle –æ–¥–Ω–æ–π | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω–∏–π | MealCard —É–∂–µ React.memo ‚úÖ |
| –ü–µ—Ä–µ—Ö–æ–¥ —á–µ—Ä–µ–∑ –ø–æ–ª–Ω–æ—á—å —Å–ª–æ–º–∞–µ—Ç overlap | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–∏–π | `normalizeToHeysDay()` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω |
| SVG –Ω–µ –≤–ª–µ–∑–∞–µ—Ç –Ω–∞ —É–∑–∫–∏–π —ç–∫—Ä–∞–Ω | –ù–∏–∑–∫–∞—è | –ù–∏–∑–∫–∏–π | viewBox + width:100% |
| **–ù–û–í–´–ô**: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ waveHistory –ª–æ–≥–∏–∫–∏ | –í—ã—Å–æ–∫–∞—è | –°—Ä–µ–¥–Ω–∏–π | –í—ã–Ω–µ—Å—Ç–∏ `calculateSingleMealWave()` –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
| **–ù–û–í–´–ô**: @keyframes slideDown –∫–æ–Ω—Ñ–ª–∏–∫—Ç | –°—Ä–µ–¥–Ω—è—è | –ù–∏–∑–∫–∏–π | –ù–ï –æ–±—ä—è–≤–ª—è—Ç—å –Ω–æ–≤—ã–π, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `.meal-wave-content { animation: slideDown 0.2s }` |
| **–ù–û–í–´–ô**: `getProfile()` –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ MealCard | –í—ã—Å–æ–∫–∞—è | –°—Ä–µ–¥–Ω–∏–π | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `HEYS.userProfile?.insulinWaveHours` |
| **–ù–û–í–´–ô**: –ü–æ—Ä—è–¥–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤ | –°—Ä–µ–¥–Ω—è—è | –ë–ª–æ–∫–∏—Ä—É–µ—Ç | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `<script>` –ø–æ—Ä—è–¥–æ–∫ –≤ index.html (Phase 0) |

---

## ‚ùì –†–µ—à–µ–Ω–∏—è –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ (—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ 2025-12-08)

| # | –í–æ–ø—Ä–æ—Å | –†–µ—à–µ–Ω–∏–µ | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è |
|---|--------|---------|------------|
| 1 | –ú–Ω–æ–∂–∏—Ç–µ–ª—å –≤–æ–ª–Ω—ã | **–ü–æ–ª–Ω—ã–π —Ä–∞—Å—á—ë—Ç** | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `calculateMealNutrients` + `calculateMultiplier` —Å–æ –≤—Å–µ–º–∏ 25+ —Ñ–∞–∫—Ç–æ—Ä–∞–º–∏ |
| 2 | waveHistory | **–ì–ª–æ–±–∞–ª—å–Ω–æ** | –ü–æ–ª—É—á–∞—Ç—å –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ `insulinWaveData.waveHistory`, –ù–ï —Å—á–∏—Ç–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ |
| 3 | –î–µ—Ç–∞–ª–∏ –º–Ω–æ–∂–∏—Ç–µ–ª—è | **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π** | –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Ñ–∞–∫—Ç–æ—Ä—ã: –ì–ò, GL, –∂–∏—Ä—ã, –±–µ–ª–æ–∫, –∫–ª–µ—Ç—á–∞—Ç–∫–∞, –∂–∏–¥–∫–æ—Å—Ç—å, –∏–Ω—Å—É–ª–∏–Ω–æ–≥–µ–Ω–Ω–æ—Å—Ç—å |
| 4 | –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è | **–ì—Ä–∞—Ñ–∏–∫ –∫–∞–∫ —É –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏** | –¢–æ—Ç –∂–µ SVG, –Ω–æ —Å –Ω–∞–ª–æ–∂–µ–Ω–∏–µ–º –≤–æ–ª–Ω –¥—Ä—É–≥–∏—Ö –ø—Ä–∏—ë–º–æ–≤ –¥—Ä—É–≥–∏–º —Ü–≤–µ—Ç–æ–º |

### ‚ö° –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

**–ì–ª–æ–±–∞–ª—å–Ω—ã–π waveHistory** ‚Üí —É–ø—Ä–æ—â–∞–µ—Ç –∫–æ–¥:
```javascript
// –í MealCard ‚Äî –ø–æ–ª—É—á–∞–µ–º –≥–æ—Ç–æ–≤—ã–π waveHistory –∏–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
const insulinWaveData = HEYS.insulinWaveData; // —É–∂–µ –ø–æ—Å—á–∏—Ç–∞–Ω –≤ DayTab
const waveHistory = insulinWaveData?.waveHistory || [];

// –ù–∞—Ö–æ–¥–∏–º –≤–æ–ª–Ω—É —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–∏—ë–º–∞ –ø–æ meal.id –∏–ª–∏ meal.time
const currentWave = waveHistory.find(w => w.time === meal.time);
const currentIndex = waveHistory.findIndex(w => w.time === meal.time);
const prevWave = currentIndex > 0 ? waveHistory[currentIndex - 1] : null;
const nextWave = currentIndex < waveHistory.length - 1 ? waveHistory[currentIndex + 1] : null;
```

**–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã** ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤ expand:
```
‚îå‚îÄ –§–∞–∫—Ç–æ—Ä—ã –¥–ª–∏–Ω—ã –≤–æ–ª–Ω—ã ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üïê 3—á 12–º (–±–∞–∑–∞ 3—á √ó 1.07)                ‚îÇ
‚îÇ ‚îú‚îÄ‚îÄ –ì–ò: 45 üü¢ –Ω–∏–∑–∫–∏–π                      ‚îÇ
‚îÇ ‚îú‚îÄ‚îÄ GL: 32 (—É–º–µ—Ä–µ–Ω–Ω–∞—è)                    ‚îÇ
‚îÇ ‚îú‚îÄ‚îÄ –ñ–∏—Ä—ã: +8% (25–≥)                       ‚îÇ
‚îÇ ‚îú‚îÄ‚îÄ –ë–µ–ª–æ–∫: +5% (30–≥)                      ‚îÇ
‚îÇ ‚îú‚îÄ‚îÄ –ö–ª–µ—Ç—á–∞—Ç–∫–∞: -3% (12–≥)                  ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ –ñ–∏–¥–∫–æ—Å—Ç—å: -18% (–π–æ–≥—É—Ä—Ç)               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ì—Ä–∞—Ñ–∏–∫ —Å –Ω–∞–ª–æ–∂–µ–Ω–∏–µ–º –≤–æ–ª–Ω**:
- –°–∏–Ω–∏–π –≥—Ä–∞–¥–∏–µ–Ω—Ç ‚Äî —Ç–µ–∫—É—â–∏–π –ø—Ä–∏—ë–º
- –û—Ä–∞–Ω–∂–µ–≤—ã–π (60% opacity) ‚Äî —Å–ª–µ–¥—É—é—â–∏–π –ø—Ä–∏—ë–º
- –§–∏–æ–ª–µ—Ç–æ–≤—ã–π (40% opacity) ‚Äî –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ø—Ä–∏—ë–º  
- –ö—Ä–∞—Å–Ω–∞—è –∑–æ–Ω–∞ ‚Äî –æ–±–ª–∞—Å—Ç—å –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç–∞
- –ó–µ–ª—ë–Ω–∞—è –∑–æ–Ω–∞ ‚Äî –æ–±–ª–∞—Å—Ç—å –ª–∏–ø–æ–ª–∏–∑–∞

---

## üéØ –§–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ–º–ø—Ç–∞

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|----------|--------|------------|
| –í—Å–µ –±–ª–æ–∫–µ—Ä—ã –≤—ã—è–≤–ª–µ–Ω—ã | ‚úÖ | 6 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –≤ Phase 0 |
| –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã | ‚úÖ | –¢–∞–±–ª–∏—Ü–∞ —Å grep –∫–æ–º–∞–Ω–¥–∞–º–∏ |
| –û–≤–µ—Ä–∫–∏–ª–ª –æ—Ü–µ–Ω—ë–Ω | ‚úÖ | 4 —ç–ª–µ–º–µ–Ω—Ç–∞ –º–æ–∂–Ω–æ —É–ø—Ä–æ—Å—Ç–∏—Ç—å |
| WOW-–∏–¥–µ–∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ–∑–∏—Ä–æ–≤–∞–Ω—ã | ‚úÖ | 4 tier'–∞ –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ |
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã | ‚úÖ | 4/4 —Ä–µ—à–µ–Ω—ã |
| –†–∏—Å–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã | ‚úÖ | +4 –Ω–æ–≤—ã—Ö —Ä–∏—Å–∫–∞ |
| Rollback –ø–ª–∞–Ω | ‚úÖ | git checkout + backup |

---

## üîô Rollback –ø–ª–∞–Ω

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ–π–¥—ë—Ç –Ω–µ —Ç–∞–∫:

1. **–û—Ç–∫–∞—Ç —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—á—ë—Ç–∞**:
   ```bash
   git checkout apps/web/heys_insulin_wave_v1.js
   ```

2. **–û—Ç–∫–∞—Ç MealCard**:
   ```bash
   git checkout apps/web/heys_day_v12.js
   ```

3. **–ò–∑ –±—ç–∫–∞–ø–∞** (–µ—Å–ª–∏ git –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç):
   ```bash
   cp apps/web/heys_insulin_wave_v1.backup.js apps/web/heys_insulin_wave_v1.js
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∫–∞**:
   ```bash
   pnpm dev  # –û—Ç–∫—Ä—ã—Ç—å localhost:3001, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ MealCard —Ä–∞–±–æ—Ç–∞–µ—Ç
   ```

---

## üìÅ –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç—Ä–æ–∫–∏ |
|------|----------|--------|
| `apps/web/heys_insulin_wave_v1.js` | –ú–æ–¥—É–ª—å –∏–Ω—Å—É–ª–∏–Ω–æ–≤–æ–π –≤–æ–ª–Ω—ã | ~2500 |
| `apps/web/heys_day_v12.js` | MealCard –∫–æ–º–ø–æ–Ω–µ–Ω—Ç | 1222-1500 |
| `apps/web/styles/heys-components.css` | –°—Ç–∏–ª–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | ‚Äî |

---

## üü¢ WOW-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ)

### üî• Tier 1: –ë—ã—Å—Ç—Ä—ã–µ –ø–æ–±–µ–¥—ã (5-15 –º–∏–Ω –∫–∞–∂–¥–∞—è)

1. **Mini-preview –≤ collapsed**: –ö—Ä–æ—à–µ—á–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä `‚óè‚îÄ‚îÄ‚óè` –∏–ª–∏ `‚óè‚ïê‚ïê‚óè` (overlap) ‚Äî 1 —Å—Ç—Ä–æ–∫–∞ SVG
2. **–ü—É–ª—å—Å–∞—Ü–∏—è –ø—Ä–∏ overlap**: CSS `animation: pulse 2s infinite` –Ω–∞ –∫—Ä–∞—Å–Ω–æ–π –∫–Ω–æ–ø–∫–µ ‚Äî –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏–µ
3. **Gradient transition**: –ü–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ —Ü–≤–µ—Ç–∞ –æ—Ç —Å–∏–Ω–µ–≥–æ –∫ —Ñ–∏–æ–ª–µ—Ç–æ–≤–æ–º—É ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π look
4. **Skeleton loading**: –ü–æ–∫–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –≤–æ–ª–Ω–∞ ‚Äî shimmer-—ç—Ñ—Ñ–µ–∫—Ç (—É–∂–µ –µ—Å—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç–µ)

### ‚≠ê Tier 2: –°—Ä–µ–¥–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (15-30 –º–∏–Ω)

5. **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –Ω–æ—Ä–º–æ–π**: "–û–±—ã—á–Ω–æ —Ç—ã –µ—à—å —á–µ—Ä–µ–∑ 4—á, –∞ —Ç—É—Ç —á–µ—Ä–µ–∑ 1.5—á" ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `avgGapToday` –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–¥–∞
6. **–°–º–∞—Ä—Ç-—Å–æ–≤–µ—Ç inline**: "üí° –ü–µ—Ä–µ–¥–≤–∏–Ω—å —Å–ª–µ–¥—É—é—â–∏–π –ø—Ä–∏—ë–º –Ω–∞ +30 –º–∏–Ω" ‚Äî actionable feedback
7. **Countdown –¥–æ –∫–æ–Ω—Ü–∞ –≤–æ–ª–Ω—ã**: –ï—Å–ª–∏ –≤–æ–ª–Ω–∞ –µ—â—ë –∏–¥—ë—Ç, –ø–æ–∫–∞–∑–∞—Ç—å "–æ—Å—Ç–∞–ª–æ—Å—å 45 –º–∏–Ω" (–Ω–æ –º—ã —Ä–µ—à–∏–ª–∏ –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–π –≤–æ–ª–Ω—ã ‚Äî —Ç–∞–∫ —á—Ç–æ skip)
8. **Swipe to dismiss**: –ù–∞ mobile ‚Äî —Å–≤–∞–π–ø –≤–ª–µ–≤–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç expand

### üöÄ Tier 3: WOW-—ç—Ñ—Ñ–µ–∫—Ç—ã (30+ –º–∏–Ω)

9. **–ê–Ω–∏–º–∞—Ü–∏—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è –≤–æ–ª–Ω—ã**: SVG path animation –ø—Ä–∏ expand ‚Äî –æ—á–µ–Ω—å —ç—Ñ—Ñ–µ–∫—Ç–Ω–æ
10. **Confetti –∑–∞ –∏–¥–µ–∞–ª—å–Ω—ã–π –¥–µ–Ω—å**: –ï—Å–ª–∏ –Ω–∏ –æ–¥–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç–∞ –∑–∞ –¥–µ–Ω—å ‚Äî –º–∏–Ω–∏-–∫–æ–Ω—Ñ–µ—Ç—Ç–∏ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø—Ä–∏—ë–º–∞
11. **Sound effect**: –ú—è–≥–∫–∏–π "ding" –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –ª–∏–ø–æ–ª–∏–∑–µ, "warning" –ø—Ä–∏ overlap (—Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –≤ –ø—Ä–æ—Ñ–∏–ª–µ)
12. **–®–µ–π—Ä–∏–Ω–≥**: "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –∏–¥–µ–∞–ª—å–Ω—ã–º –¥–Ω—ë–º" ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ –¥–ª—è Instagram Stories

### üíé Tier 4: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ (–¥–ª—è –±—É–¥—É—â–µ–≥–æ)

13. **Weekly digest –≤ MealCard**: "–ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ —Ç—ã –ø–æ—Ç–µ—Ä—è–ª 3—á –ª–∏–ø–æ–ª–∏–∑–∞" ‚Äî –º–æ—Ç–∏–≤–∞—Ü–∏—è
14. **–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã**: "–ü–æ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞–º —Ç—ã –µ—à—å —á–∞—â–µ" ‚Äî ML-–∏–Ω—Å–∞–π—Ç—ã
15. **Gamification**: "+10 XP –∑–∞ –∏–¥–µ–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª" ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å XP —Å–∏—Å—Ç–µ–º–æ–π (—Å–º. todo.md)
16. **Apple Watch complication**: –ü–æ–∫–∞–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –≤–æ–ª–Ω—ã –Ω–∞ —á–∞—Å–∞—Ö

---

## üîç –ö–∞—á–µ—Å—Ç–≤–æ –ø—Ä–æ–º–ø—Ç–∞ (–∞—É–¥–∏—Ç)

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|----------|--------|-------------|
| –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ—Å—Ç—å | ‚úÖ | –®–∞–≥–∏, –∫–æ–¥, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π —É–∫–∞–∑–∞–Ω—ã |
| –ö–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π | ‚úÖ | Phase 0 –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ |
| –ë–ª–æ–∫–µ—Ä—ã | ‚úÖ | 6 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–ª–æ–∫–µ—Ä–æ–≤ –≤—ã—è–≤–ª–µ–Ω–æ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ Phase 0 |
| –†–µ—à–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã | ‚úÖ | 5/5 –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã |
| Day boundary | ‚úÖ | 03:00 ‚Üí 03:00 —Å `normalizeToHeysDay()` |
| Analytics | ‚úÖ | `trackDataOperation` —Å action, hasOverlap, overlapMinutes |
| –¢–µ—Å—Ç—ã | üü° | –°–ø–∏—Å–æ–∫ –µ—Å—Ç—å, –Ω–æ –Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ (—Ä—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ) |
| –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ | ‚úÖ | waveHistory –ª–æ–≥–∏–∫–∞ (—Å—Ç—Ä–æ–∫–∏ 1413-1455) –≤—ã–Ω–µ—Å–µ–Ω–∞ |
| –û–≤–µ—Ä–∫–∏–ª–ª-–æ—Ü–µ–Ω–∫–∞ | ‚úÖ | –°–º. —Å–µ–∫—Ü–∏—é –Ω–∏–∂–µ |

---

## üö® –û—Ü–µ–Ω–∫–∞ –Ω–∞ –æ–≤–µ—Ä–∫–∏–ª–ª

### ‚úÖ –ù–ï –æ–≤–µ—Ä–∫–∏–ª–ª (–æ–ø—Ä–∞–≤–¥–∞–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å)

| –≠–ª–µ–º–µ–Ω—Ç | –ü–æ—á–µ–º—É –æ–ø—Ä–∞–≤–¥–∞–Ω |
|---------|-----------------|
| `normalizeToHeysDay` | –ö—Ä–∏—Ç–∏—á–µ–Ω –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –Ω–æ—á–Ω—ã—Ö –ø—Ä–∏—ë–º–æ–≤ |
| `prevMeal` + `nextMeal` overlap | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å –í–°–ï —Å–≤–æ–∏ –æ—à–∏–±–∫–∏ |
| Auto-expand –ø—Ä–∏ overlap | –§–æ–∫—É—Å –≤–Ω–∏–º–∞–Ω–∏—è –Ω–∞ –ø—Ä–æ–±–ª–µ–º—É ‚Äî –∫–ª—é—á–µ–≤–∞—è UX-—Ü–µ–Ω–Ω–æ—Å—Ç—å |
| Analytics tracking | –ü–æ–Ω–∏–º–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ–∏—á–∏ |
| isCurrentActiveMeal –ø—Ä–æ–≤–µ—Ä–∫–∞ | –ò–∑–±–µ–∂–∞–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è UI —Å –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–æ–π |

### ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –æ–≤–µ—Ä–∫–∏–ª–ª (—É–ø—Ä–æ—Å—Ç–∏—Ç—å –µ—Å–ª–∏ –±—É–¥–µ—Ç —Å–ª–æ–∂–Ω–æ)

| –≠–ª–µ–º–µ–Ω—Ç | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ |
|---------|-------------|
| SVG timeline —Å –∑–æ–Ω–∞–º–∏ | –ú–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å —Å —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è + –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä |
| –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–æ–ª–Ω—ã (grid 3 –∫–æ–ª–æ–Ω–∫–∏) | –ú–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å –Ω–∞ MVP, –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ |
| Haptic feedback | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –µ—Å–ª–∏ –ø—Ä–æ—Å—Ç–æ |
| –®—Ç—Ä–∏—Ö–æ–≤–∫–∞ –Ω–∞ overlap –∑–æ–Ω–µ | –ú–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å solid —Ü–≤–µ—Ç–æ–º —Å opacity |

### ‚ùå –ß—Ç–æ –ù–ï –¥–µ–ª–∞–µ–º (–Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –∏—Å–∫–ª—é—á–µ–Ω–æ)

| –≠–ª–µ–º–µ–Ω—Ç | –ü–æ—á–µ–º—É –∏—Å–∫–ª—é—á—ë–Ω |
|---------|-----------------|
| –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∏–∑ expand | –ï—Å—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π UI –¥–ª—è —ç—Ç–æ–≥–æ |
| –ü–µ—Ä–µ—Å—á—ë—Ç –≤–æ–ª–Ω—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ | –î–ª—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏—ë–º–æ–≤ –Ω–µ –Ω—É–∂–Ω–æ |
| –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ—Ä–¥—ã –≤ MealCard | –ï—Å—Ç—å –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–µ –≤–æ–ª–Ω—ã |
| –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –¥–Ω—è–º–∏ | –°–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–æ –¥–ª—è MVP |

---

## üåü WOW-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ)

---

## ‚úÖ –†–µ—à–µ–Ω–∏—è (—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ 2025-12-08)

| # | –í–æ–ø—Ä–æ—Å | –†–µ—à–µ–Ω–∏–µ | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è |
|---|--------|---------|------------|
| 1 | –ê–≤—Ç–æ-—Ä–∞—Å–∫—Ä—ã–≤–∞—Ç—å –ø—Ä–∏ overlap? | ‚úÖ **–î–∞** | `useState(() => hasOverlap)` |
| 2 | –¢–µ–∫—É—â–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–∏—ë–º? | ‚õî **–ù–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å** –∫–Ω–æ–ø–∫—É | `if (isCurrentActiveMeal) return null` |
| 3 | –ê–Ω–∞–ª–∏—Ç–∏–∫–∞? | ‚úÖ **–î–∞** | `trackDataOperation('insulin_wave_meal_expand', {...})` |
| 4 | –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç —Å–ª–µ–≤–∞? | ‚úÖ **–î–∞, –≤—Å–µ –ø–µ—Ä–µ—Ö–ª—ë—Å—Ç—ã** | –ü–µ—Ä–µ–¥–∞—ë–º `prevMeal` + `nextMeal` |
| 5 | –ì—Ä–∞–Ω–∏—Ü—ã –¥–Ω—è | **03:00 ‚Üí 03:00** | `normalizeToHeysDay()` |

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

- ‚úÖ –ò–Ω—Å—É–ª–∏–Ω–æ–≤–∞—è –≤–æ–ª–Ω–∞ ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ (—É–∂–µ —Å–¥–µ–ª–∞–Ω–æ)
- ‚úÖ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏—ë–º–∞ (—É–∂–µ —Å–¥–µ–ª–∞–Ω–æ)
- üî≤ –°–æ–≤–µ—Ç—ã –ø–æ –∏–Ω—Å—É–ª–∏–Ω—É –≤ advice –º–æ–¥—É–ª–µ

---

## Changelog

| –î–∞—Ç–∞ | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|------|-----------|
| 2025-12-08 | –°–æ–∑–¥–∞–Ω –ø—Ä–æ–º–ø—Ç |
| 2025-12-08 | –î–æ–±–∞–≤–ª–µ–Ω Phase 0, —Ä–∏—Å–∫-–º–∞—Ç—Ä–∏—Ü–∞, rollback, –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —à–∞–≥–∏ |
| 2025-12-08 | –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è: 5 —Ä–µ—à–µ–Ω–∏–π —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ ‚Äî auto-expand, skip active meal, analytics, all overlaps, 03:00‚Üí03:00 day boundary |
| 2025-12-08 | –ì–ª—É–±–æ–∫–∏–π –∞—É–¥–∏—Ç v2: +6 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–ª–æ–∫–µ—Ä–æ–≤, +4 —Ä–∏—Å–∫–∞, –æ—Ü–µ–Ω–∫–∞ –Ω–∞ –æ–≤–µ—Ä–∫–∏–ª–ª, 16 WOW-–∏–¥–µ–π –≤ 4 tier'–∞—Ö |
| 2025-12-08 | **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ñ–∏–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞**: –≥–ª–æ–±–∞–ª—å–Ω—ã–π waveHistory, –ø–æ–ª–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å, —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã, SVG –≥—Ä–∞—Ñ–∏–∫ –∫–∞–∫ —É –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –Ω–∞–ª–æ–∂–µ–Ω–∏–µ–º –≤–æ–ª–Ω |
