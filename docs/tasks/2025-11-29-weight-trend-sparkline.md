# Task: ะัะดะตะปัะฝัะน ะณัะฐัะธะบ ััะตะฝะดะฐ ะฒะตัะฐ

> **ะัะดะธั v3** โ 2025-11-29 | ะะปัะฑะพะบะธะน ะฐะฝะฐะปะธะท ะบะพะดะฐ, edge cases, WOW-ัะธัะธ

## ๐ฏ WHY (ะะธะทะฝะตั-ะบะพะฝัะตะบัั)

**Problem**: ะะพะปัะทะพะฒะฐัะตะปั ะฒะธะดะธั ัะพะปัะบะพ ะณัะฐัะธะบ ะบะฐะปะพัะธะน, ะฝะพ ะฝะต ะฒะธะดะธั ะดะธะฝะฐะผะธะบั ะฒะตัะฐ ะทะฐ ะฝะตะดะตะปั ะฒะธะทัะฐะปัะฝะพ.

**Impact**: ะะตั ะฒะธะทัะฐะปัะฝะพะน ัะฒัะทะธ ะผะตะถะดั ะฟะธัะฐะฝะธะตะผ ะธ ัะตะทัะปััะฐัะพะผ โ ะดะตะผะพัะธะฒะธััะตั.

**Value**: ะะธะดั ะณัะฐัะธะบ ะฒะตัะฐ ััะดะพะผ ั ะบะฐะปะพัะธัะผะธ, ะฟะพะปัะทะพะฒะฐัะตะปั ะผะพัะธะฒะธัะพะฒะฐะฝ ะฟัะพะดะพะปะถะฐัั.

**ะฃะถะต ัะฐะฑะพัะฐะตั**: 
- โ weightTrend ะฒ weight-card (ัััะพะบะฐ 3458-3475)
- โ sparklineData ะดะปั ะบะฐะปะพัะธะน (ัััะพะบะฐ 2917)
- โ renderSparkline ััะฝะบัะธั (ัััะพะบะฐ 3196)
- โ Dark mode ะดะปั ะบะฐะปะพัะธะน sparkline (CSS 5467-5499)
- โ Haptic feedback `haptic('light')` ะฟะฐััะตัะฝ (20+ ะธัะฟะพะปัะทะพะฒะฐะฝะธะน)

---

## ๐จ ะะธะทะฐะนะฝ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ ะกะขะะขะะกะขะะะ                                   โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โ ๐ฝ๏ธ ะะฐะปะพัะธะธ        [7ะด] [14ะด] [30ะด]         โ โ
โ โ ~~~~~~~~~~๐~~~~~~~  โ โ ัะตะปั               โ โ
โ โ 23  24  25  26  27  28  29                  โ โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โ       ๐ฏ ะะฐะปะพัะธะธโ ะะตัโ = ะัะปะธัะฝะพ!           โ โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โ โ๏ธ ะะตั            โฌ๏ธ-0.8ะบะณ  ~-2ะบะณ/ะผะตั       โ โ
โ โ ~~~~~~~~๐~~~~~~~~~~  (gradient fill)       โ โ
โ โ 23  24  25  26  27  28  29                  โ โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะัะพะฑะตะฝะฝะพััะธ:**
- **Swipe 7โ14โ30 ะดะฝะตะน** โ ะฟะตัะตะบะปััะฐัะตะปั ะฟะตัะธะพะดะฐ (pill tabs)
- **ะะพััะตะปััะธั** โ ะฑะปะพะบ ะผะตะถะดั ะณัะฐัะธะบะฐะผะธ "ะะฐะปะพัะธะธโ ะะตัโ = ะฃัะฟะตั!"
- **ะัะพะณะฝะพะท** โ "~-2ะบะณ/ะผะตั" ััะดะพะผ ั ััะตะฝะดะพะผ
- **Gradient fill** โ ัะธะพะปะตัะพะฒะฐั ะทะฐะปะธะฒะบะฐ ะฟะพะด ะปะธะฝะธะตะน
- ะกะบััะฒะฐะตััั ะตัะปะธ <2 ัะพัะตะบ ะฒะตัะฐ

---

## โช ะคะะะ 0 โ ะัะพะฒะตัะบะฐ ะธ ะฟะพะดะณะพัะพะฒะบะฐ (ะะซะะะะะะะ โ)

### ะัะธัะธัะตัะบะธะต ะฟัะพะฒะตัะบะธ

| # | ะัะพะฒะตัะบะฐ | ะกัะฐััั | ะะพะผะผะตะฝัะฐัะธะน |
|---|----------|--------|-------------|
| 0.1 | **weightTrend ัะถะต ะตััั** โ ะฟัะพะฒะตัะธัั ััะพ ัะฐะฑะพัะฐะตั | โ | `heys_day_v12.js:2860` โ ะฒะพะทะฒัะฐัะฐะตั `{text, diff, direction}` |
| 0.2 | **weightTrend ัะถะต ะฟะพะบะฐะทัะฒะฐะตััั!** โ ะฒ weight-card | โ | ะกััะพะบะฐ 3458-3475 โ ะฑะตะนะดะถ ะฟะพะด ัะตะบััะธะผ ะฒะตัะพะผ |
| 0.3 | **Dark mode ะดะปั ะบะฐะปะพัะธะน sparkline** | โ | CSS 5467-5499 โ ะดะพะฑะฐะฒะปะตะฝั ะฒัะต ััะธะปะธ |
| 0.4 | **ะะตััะพ ะฒ UI** โ ะฟะพัะปะต sparkline-container | โ | ะกััะพะบะฐ 3351 โ ะฒ `statsBlock` |
| 0.5 | **weightTrend clientId namespace** | โ | ะกััะพะบะฐ 2864 โ ะธัะฟัะฐะฒะปะตะฝะพ |

### ะะพัะตะฝัะธะฐะปัะฝัะต ะฑะปะพะบะตัั (ะพัะตะฝะบะฐ ะฟะพัะปะต ะฐัะดะธัะฐ v3)

| # | ะะปะพะบะตั | ะะตัะตะฝะธะต | ะะธัะบ |
|---|--------|---------|------|
| B1 | **ะัะฑะปะธัะพะฒะฐะฝะธะต weightTrend** โ ะฑะตะนะดะถ ะฒ weight-card | ะััะฐะฒะธัั โ ัะฐะทะฝัะน ะบะพะฝัะตะบัั | โ ะะตัะตะฝะพ |
| B2 | **ะขะตััะพะฒัะต ะดะฐะฝะฝัะต ะฒะตัะฐ** | ะะฒะตััะธ ะฒะตั ะทะฐ 3-5 ะดะฝะตะน ะฒ ะฑัะฐัะทะตัะต | ๐ข ะขัะธะฒะธะฐะปัะฝะพ |
| B3 | **ะััััะต ะดะฝะธ ะฒ ัะตัะตะดะธะฝะต** | ะัะฝะบัะธัะฝะฐั ะปะธะฝะธั (ะฝะต ัะฐะทััะฒ!) | ๐ก ะะธะทะฐะนะฝ |
| B4 | **ะะดะธะฝะฐะบะพะฒัะต ะฒะตัะฐ** (75.0, 75.0) | ะะธะฝะธะผัะผ range 1 ะบะณ | ๐ก Edge case |
| B5 | **ะคะฐะนะป 4758 ัััะพะบ** | ะะพะผะฟะฐะบัะฝัะน ะบะพะด, โค150 ะฝะพะฒัั ัััะพะบ | ๐ก Maintainability |
| B6 | **chartPeriod state** | ะะฑัะธะน useState ะดะปั ะพะฑะพะธั ะณัะฐัะธะบะพะฒ | ๐ก Architecture |
| B7 | **Performance 30 ะดะฝะตะน** | 30 ััะตะฝะธะน localStorage โ OK (sync API) | ๐ข ะัะธะตะผะปะตะผะพ |
| B8 | **ะะพะผะฟัะตััะธั `ยคZยค`** | ะะฐััะธัั ัะพะปัะบะพ weightMorning | ๐ข ะะฟัะธะผะธะทะฐัะธั |
| B9 | **kcalTrend ะดะปั ะบะพััะตะปััะธะธ** | ะััะธัะปะธัั ะฐะฝะฐะปะพะณะธัะฝะพ weightTrend | ๐ก ะะพะฒัะน ะบะพะด |
| B10 | **ะะฝะธะผะฐัะธั ะฟัะธ ัะผะตะฝะต ะฟะตัะธะพะดะฐ** | CSS transition ะฝะฐ SVG path | ๐ข Nice to have |

### ะะพะดะณะพัะพะฒะบะฐ ััะฝะดะฐะผะตะฝัะฐ (ะะซะะะะะะะ)

- [x] **โ ะะกะะะะะะะ weightTrend** โ clientId namespace ะดะพะฑะฐะฒะปะตะฝ (ัััะพะบะฐ 2864)
- [x] **โ Dark mode ะบะฐะปะพัะธะน sparkline** โ CSS ะฟัะฐะฒะธะปะฐ ะดะพะฑะฐะฒะปะตะฝั (5467-5499)
- [x] **โ Build ะฟัะพัะพะดะธั** โ pnpm type-check && pnpm build
- [ ] **ะัะพะฒะตัะธัั ัะตััะพะฒัะต ะดะฐะฝะฝัะต** โ ะผะธะฝะธะผัะผ 3 ะดะฝั ั ะฒะตัะพะผ (ะฒ ะฑัะฐัะทะตัะต)

---

## ๐ค Output Preferences

**Workflow**: Implement directly  
**Code style**: Follow copilot-instructions.md, ะผะธะฝะธะผัะผ ะบะพะผะผะตะฝัะฐัะธะตะฒ

---

## ๐ WHAT (ะงะตะบ-ะปะธัั ะทะฐะดะฐั)

### ๐ฏ Must Have (40 ะผะธะฝ)

- [ ] **weightSparklineData useMemo** โ ะดะฐะฝะฝัะต ะฒะตัะฐ ะทะฐ N ะดะฝะตะน
  - **Acceptance**: `[{date, weight, isToday, dayNum}]` ัะพะปัะบะพ ั ะฝะตะฟััััะผะธ ะทะฝะฐัะตะฝะธัะผะธ
  - **ะะฐััะตัะฝ**: ะกะบะพะฟะธัะพะฒะฐัั ะธะท weightTrend (ัััะพะบะฐ 2860), ะฟะฐัะฐะผะตััะธะทะพะฒะฐัั period
  - **Files**: `heys_day_v12.js` (~ัััะพะบะฐ 2915, ะฟะพัะปะต weightTrend)

- [ ] **renderWeightSparkline ััะฝะบัะธั** โ SVG ะดะปั ะฒะตัะฐ
  - **Acceptance**: ะคะธะพะปะตัะพะฒะฐั ะปะธะฝะธั, ัะพัะบะธ, ะผะตัะบะธ ะดะฝะตะน, gradient fill
  - **ะะฐัััะฐะฑ**: `minWeight - 0.5` โ `maxWeight + 0.5` (ะผะธะฝะธะผัะผ 1 ะบะณ range!)
  - **ะะฐััะตัะฝ**: ะกะบะพะฟะธัะพะฒะฐัั renderSparkline (ัััะพะบะฐ 3196), ะธะทะผะตะฝะธัั ัะฒะตัะฐ
  - **Files**: `heys_day_v12.js` (~ัััะพะบะฐ 3290, ะฟะพัะปะต renderSparkline)

- [ ] **UI ะฑะปะพะบ ะฒ statsBlock** โ ะฟะพัะปะต ะบะฐะปะพัะธะน sparkline
  - **ะฃัะปะพะฒะธะต**: ะะพะบะฐะทัะฒะฐัั ัะพะปัะบะพ ะตัะปะธ โฅ2 ัะพัะบะธ ะฒะตัะฐ
  - **ะกัััะบัััะฐ**: Header + SVG + (ะบะพััะตะปััะธั ะตัะปะธ ะตััั)
  - **Files**: `heys_day_v12.js` (~ัััะพะบะฐ 3355, ะฟะพัะปะต sparkline-container)

- [ ] **Header ั ะฑะตะนะดะถะตะผ** โ `โ๏ธ ะะตั` + ััะตะฝะด ัะฟัะฐะฒะฐ
  - **ะัะฟะพะปัะทะพะฒะฐัั**: ะกััะตััะฒัััะธะน `weightTrend` (ะะ ะดัะฑะปะธัะพะฒะฐัั!)
  - **ะกัะธะปั**: ะะฐะบ sparkline-container header

- [ ] **CSS ััะธะปะธ** โ `.weight-sparkline-*` ะบะปะฐััั
  - **Files**: `main.css` (~ัััะพะบะฐ 3650, ะฟะพัะปะต sparkline ััะธะปะตะน)
  - **ะะบะปััะธัั**: Light + Dark mode!

### ๐ Should Have (15 ะผะธะฝ)

- [ ] **Tooltip ะฝะฐ ัะพัะบะฐั** โ `<title>26: 75.2 ะบะณ</title>`
- [ ] **ะัะฝะบัะธั ะดะปั ะฟัะพะฟััะบะพะฒ** โ ะตัะปะธ ะฝะตั ะฒะตัะฐ ะทะฐ ะดะตะฝั, ะปะธะฝะธั ะฟัะฝะบัะธัะพะผ
- [ ] **ะะฝะธะผะฐัะธั ะฟะพัะฒะปะตะฝะธั** โ `animation: fadeIn 0.3s ease` (keyframes ัะถะต ะตััั!)

### โจ WOW Features (25 ะผะธะฝ)

- [ ] **๐ฑ Period tabs 7/14/30** โ ะฟะตัะตะบะปััะฐัะตะปั ะฟะตัะธะพะดะฐ
  - **State**: `const [chartPeriod, setChartPeriod] = useState(7)`
  - **UI**: Pill tabs ะฝะฐะด ะะะะะะ ะณัะฐัะธะบะฐะผะธ
  - **Haptic**: `haptic('light')` ะฟัะธ ะฟะตัะตะบะปััะตะฝะธะธ
  - **โ๏ธ ะะฐะฒะธัะธะผะพััั**: sparklineData ัะพะถะต ะดะพะปะถะตะฝ ะฟัะธะฝะธะผะฐัั period!

- [ ] **๐ฏ Correlation block** โ ะผะตะถะดั ะณัะฐัะธะบะฐะผะธ
  - **ะะพะณะธะบะฐ**:
    - ะะฐะปะพัะธะธโ + ะะตัโ โ `"๐ฏ ะัะปะธัะฝะฐั ะดะธะฝะฐะผะธะบะฐ!"` (ะทะตะปัะฝัะน)
    - ะะฐะปะพัะธะธโ + ะะตัโ โ `"โณ ะะตะทัะปััะฐั ัะบะพัะพ!"` (ะถัะปััะน)
    - ะะฐะปะพัะธะธโ + ะะตัโ โ `"โ๏ธ ะะพัะฐ ะบ ะฟะปะฐะฝั"` (ะพัะฐะฝะถะตะฒัะน)
  - **ะัะถะตะฝ kcalTrend**: ะััะธัะปะธัั direction ะบะฐะปะพัะธะน ะฐะฝะฐะปะพะณะธัะฝะพ
  - **ะกะบััะฒะฐัั**: ะัะปะธ <3 ะดะฝะตะน ะดะฐะฝะฝัั

- [ ] **๐ ะัะพะณะฝะพะท ะผะตััั** โ `~-2ะบะณ/ะผะตั` ััะดะพะผ ั ะฑะตะนะดะถะตะผ
  - **ะคะพัะผัะปะฐ**: `weekDiff * 4` (ะปะธะฝะตะนะฝะฐั ัะบัััะฐะฟะพะปััะธั)
  - **ะกะบััะฒะฐัั**: ะัะปะธ |diff| < 0.2 ะบะณ ะทะฐ ะฝะตะดะตะปั

- [ ] **โจ Gradient fill** โ ัะธะพะปะตัะพะฒะฐั ะทะฐะปะธะฒะบะฐ ะฟะพะด ะปะธะฝะธะตะน
  - **ะะฐััะตัะฝ**: `sparklineGrad` โ `weightSparklineGrad`
  - **ะฆะฒะตัะฐ**: `#8b5cf6 opacity 0.3 โ 0.05`

- [ ] **๐จ ะฆะฒะตัะพะฒัะต ะทะพะฝั ัะพะฝะฐ** โ ะดะธะฝะฐะผะธัะตัะบะธะน ัะพะฝ ะฟะพ ััะตะฝะดั
  - **ะะพะณะธะบะฐ**:
    - ะะตัโ (direction: 'down') โ ะทะตะปัะฝัะน gradient ัะพะฝ (ััะฟะตั!)
    - ะะตัโ (direction: 'same') โ ะฝะตะนััะฐะปัะฝัะน ัะธะพะปะตัะพะฒัะน ัะพะฝ
    - ะะตัโ (direction: 'up') โ ะบัะฐัะฝะพะฒะฐััะน gradient ัะพะฝ (ะพัะบะฐั)
  - **CSS**: `.weight-sparkline-container.trend-down/same/up`
  - **ะฆะฒะตัะฐ Light**:
    - down: `#dcfce7 โ #f0fdf4` (green-100 โ green-50)
    - same: `#faf5ff โ #f3e8ff` (ััะฐะฝะดะฐััะฝัะน purple)
    - up: `#fef2f2 โ #fff1f2` (red-50 โ rose-50)
  - **ะฆะฒะตัะฐ Dark**:
    - down: `#14532d โ #166534` (green-900 โ green-800)
    - same: `#1e1b2e โ #2e1f47` (ััะฐะฝะดะฐััะฝัะน purple)
    - up: `#450a0a โ #7f1d1d` (red-950 โ red-900)

- [ ] **๐ฌ ะะฝะธะผะฐัะธั ะปะธะฝะธะธ ะฟัะธ ัะผะตะฝะต ะฟะตัะธะพะดะฐ** โ ะฟะปะฐะฒะฝะฐั ะฟะตัะตัะธัะพะฒะบะฐ
  - **ะขะตัะฝะธะบะฐ**: CSS `stroke-dashoffset` animation
  - **CSS**: `.weight-sparkline-line { stroke-dasharray: 1000; stroke-dashoffset: 1000; animation: drawLine 0.6s ease forwards; }`
  - **Keyframes**: `@keyframes drawLine { to { stroke-dashoffset: 0; } }`
  - **ะขัะธะณะณะตั**: ะัะธ ะธะทะผะตะฝะตะฝะธะธ `chartPeriod` ะดะพะฑะฐะฒะธัั key ะบ SVG ะดะปั re-mount

### โ Won't Do

- ~~ะะตะดะฐะบัะธัะพะฒะฐะฝะธะต ะฒะตัะฐ ะธะท ะณัะฐัะธะบะฐ~~ โ ะตััั weight-card
- ~~ะฃะฑะธัะฐัั weightTrend ะธะท weight-card~~ โ ัะฐะทะฝัะน ะบะพะฝัะตะบัั
- ~~ะะฐััะพััะธะน swipe gesture~~ โ ะพะฒะตัะบะธะปะป ะดะปั MVP
- ~~Moving average ะปะธะฝะธั~~ โ ะฟะพัะปะต ัะตะปะธะทะฐ

---

## ๐ง ะขะตัะฝะธัะตัะบะธะต ะดะตัะฐะปะธ

### ะกััะตััะฒัััะธะน ะบะพะด (ะฟะตัะตะธัะฟะพะปัะทัะตะผ)

```javascript
// heys_day_v12.js:2860 โ weightTrend ัะถะต ัะฐะฑะพัะฐะตั!
const weightTrend = React.useMemo(() => {
  // ะะพะทะฒัะฐัะฐะตั: { text, diff, direction } ะธะปะธ null
  // text: "โฌ๏ธ -0.8 ะบะณ" (ั emoji)
  // diff: -0.8
  // direction: "down" | "up" | "same"
}, [date, day.weightMorning]);

// heys_day_v12.js:2864 โ clientId ะฟะฐััะตัะฝ
const clientId = (window.HEYS && window.HEYS.currentClientId) || '';
const scopedKey = clientId 
  ? 'heys_' + clientId + '_dayv2_' + dateStr 
  : 'heys_dayv2_' + dateStr;

// Haptic feedback
const haptic = U.haptic || (() => {});
haptic('light'); // ะฟัะธ ะฟะตัะตะบะปััะตะฝะธะธ ะฟะตัะธะพะดะฐ
```

### ะะพะฒัะน ะบะพะด: weightSparklineData

```javascript
// ะะพัะปะต weightTrend (~ัััะพะบะฐ 2915)
const weightSparklineData = React.useMemo(() => {
  const today = new Date(date);
  const days = [];
  const clientId = (window.HEYS && window.HEYS.currentClientId) || '';
  const period = chartPeriod || 7; // ะธัะฟะพะปัะทัะตะผ chartPeriod state
  
  for (let i = period - 1; i >= 0; i--) {
    const d = new Date(today);
    d.setDate(d.getDate() - i);
    const dateStr = fmtDate(d);
    const scopedKey = clientId 
      ? 'heys_' + clientId + '_dayv2_' + dateStr 
      : 'heys_dayv2_' + dateStr;
    
    let dayData = null;
    try {
      const raw = localStorage.getItem(scopedKey);
      if (raw) {
        // ะะปั ะฒะตัะฐ ะฝัะถะตะฝ ัะพะปัะบะพ weightMorning โ ะผะธะฝะธะผะฐะปัะฝัะน ะฟะฐััะธะฝะณ
        dayData = raw.startsWith('ยคZยค') 
          ? JSON.parse(raw.substring(3)) 
          : JSON.parse(raw);
      }
    } catch(e) {}
    
    if (dayData?.weightMorning > 0) {
      days.push({ 
        date: dateStr, 
        weight: +dayData.weightMorning,
        isToday: i === 0,
        dayNum: dateStr.slice(-2).replace(/^0/, '')
      });
    }
  }
  
  return days;
}, [date, day.weightMorning, chartPeriod]);
```

### ะะฐัััะฐะฑะธัะพะฒะฐะฝะธะต (Edge Cases)

```javascript
// ะะฐะถะฝะพ! ะะธะฝะธะผะฐะปัะฝัะน range 1 ะบะณ
const weights = data.map(d => d.weight);
const minWeight = Math.min(...weights);
const maxWeight = Math.max(...weights);
const rawRange = maxWeight - minWeight;
const range = Math.max(1, rawRange + 0.5); // ะผะธะฝะธะผัะผ 1 ะบะณ!
const adjustedMin = minWeight - 0.25;

// Y ะบะพะพัะดะธะฝะฐัะฐ
const y = paddingTop + chartHeight - ((weight - adjustedMin) / range) * chartHeight;
```

### ะฆะฒะตัะพะฒะฐั ััะตะผะฐ

| ะญะปะตะผะตะฝั | Light | Dark |
|---------|-------|------|
| **ะะตั โ ะปะธะฝะธั** | `#8b5cf6` (purple-500) | `#a78bfa` (purple-400) |
| **ะะตั โ ัะพัะบะธ** | `#8b5cf6` | `#a78bfa` |
| **ะะตั โ gradient** | `rgba(139,92,246,0.2โ0.05)` | `rgba(167,139,250,0.25โ0.05)` |
| **ะะตั โ ัะพะฝ (neutral)** | `#faf5ff โ #f3e8ff` | `#1e1b2e โ #2e1f47` |
| **ะะตั โ ัะพะฝ (down โ)** | `#dcfce7 โ #f0fdf4` | `#14532d โ #166534` |
| **ะะตั โ ัะพะฝ (up โ๏ธ)** | `#fef2f2 โ #fff1f2` | `#450a0a โ #7f1d1d` |
| **ะะตั โ border** | `#e9d5ff` | `#4c1d95` |
| **ะะตะนะดะถ โฌ๏ธ** | `#22c55e bg:#dcfce7` | `#4ade80 bg:#14532d` |
| **ะะตะนะดะถ โฌ๏ธ** | `#f59e0b bg:#fef3c7` | `#fbbf24 bg:#78350f` |
| **ะัะพะณะฝะพะท** | `#64748b` | `#94a3b8` |
| **ะะพััะตะปััะธั ๐ฏ** | `#22c55e bg:#dcfce7` | `#4ade80 bg:#14532d` |
| **Period tabs active** | `#8b5cf6 bg:#f3e8ff` | `#a78bfa bg:#2e1f47` |
| **Period tabs inactive** | `#94a3b8 bg:#f1f5f9` | `#64748b bg:#1e293b` |

---

## โ DONE (ะัะธัะตัะธะธ ะฟัะธัะผะบะธ)

### Functional

- [ ] ะัะฐัะธะบ ะฒะตัะฐ ะฟะพะบะฐะทัะฒะฐะตััั ะฟะพะด ะณัะฐัะธะบะพะผ ะบะฐะปะพัะธะน
- [ ] ะะพะบะฐะทัะฒะฐะตััั ัะพะปัะบะพ ะตัะปะธ โฅ2 ัะพัะบะธ ะฒะตัะฐ
- [ ] ะะตะนะดะถ ะฟะพะบะฐะทัะฒะฐะตั ััะตะฝะด: โฌ๏ธ/โฌ๏ธ/โ ะธ ัะฐะทะฝะธัั ะฒ ะบะณ
- [ ] Tooltip ะฝะฐ ัะพัะบะฐั โ ะฒะตั ะฟัะธ ะฝะฐะฒะตะดะตะฝะธะธ
- [ ] ะะฐะฑะพัะฐะตั ั clientId namespace (ะผัะปััะธ-ะบะปะธะตะฝัั)
- [ ] Period tabs 7/14/30 ัะฐะฑะพัะฐัั ะดะปั ะพะฑะพะธั ะณัะฐัะธะบะพะฒ
- [ ] Correlation block ะฟะพะบะฐะทัะฒะฐะตััั ะผะตะถะดั ะณัะฐัะธะบะฐะผะธ
- [ ] ะัะพะณะฝะพะท ~Xะบะณ/ะผะตั ะฟะพะบะฐะทัะฒะฐะตััั (ะตัะปะธ |diff| โฅ 0.2)

### Visual

- [ ] ะคะธะพะปะตัะพะฒะฐั ัะฒะตัะพะฒะฐั ััะตะผะฐ (ะพัะปะธัะฐะตััั ะพั ะทะตะปัะฝัั ะบะฐะปะพัะธะน)
- [ ] Gradient fill ะฟะพะด ะปะธะฝะธะตะน ะฒะตัะฐ
- [ ] Light mode: ัะธัะฐะตััั ะฝะฐ ัะฒะตัะปะพะผ ัะพะฝะต
- [ ] Dark mode: ัะธัะฐะตััั ะฝะฐ ััะผะฝะพะผ ัะพะฝะต
- [ ] Mobile: ะณัะฐัะธะบ ะฝะต ะพะฑัะตะทะฐะตััั, ัะธัะฐะตััั
- [ ] ะะฝะธะผะฐัะธั fadeIn ะฟัะธ ะฟะพัะฒะปะตะฝะธะธ
- [ ] Period tabs ััะธะปะธะทะพะฒะฐะฝั ะบะฐะบ pills
- [ ] **๐จ ะฆะฒะตัะพะฒัะต ะทะพะฝั ัะพะฝะฐ** โ ะทะตะปัะฝัะน ะฟัะธ down, ะบัะฐัะฝัะน ะฟัะธ up, neutral ะฟัะธ same
- [ ] **๐ฌ ะะฝะธะผะฐัะธั ะปะธะฝะธะธ** โ ะฟะปะฐะฒะฝะฐั ะฟะตัะตัะธัะพะฒะบะฐ ะฟัะธ ัะผะตะฝะต ะฟะตัะธะพะดะฐ (stroke-dashoffset)

### Edge Cases

- [ ] ะะดะธะฝะฐะบะพะฒัะต ะฒะตัะฐ โ ะปะธะฝะธั ะะ ะฟะปะพัะบะฐั (range โฅ1 ะบะณ)
- [ ] ะัะพะฟััะบะธ ะดะฝะตะน โ ะฟัะฝะบัะธัะฝะฐั ะปะธะฝะธั (ะฝะต ัะฐะทััะฒ)
- [ ] ะขะพะปัะบะพ 1 ัะพัะบะฐ โ ะฑะปะพะบ ัะบััั
- [ ] |diff| < 0.2 ะบะณ โ ะฟัะพะณะฝะพะท ัะบััั
- [ ] ะะตะดะพััะฐัะพัะฝะพ ะดะฐะฝะฝัั โ correlation ัะบััั

### Quality Gates

- [ ] `pnpm type-check` PASS
- [ ] `pnpm lint` PASS
- [ ] `pnpm build` PASS
- [ ] ะะตั ะพัะธะฑะพะบ ะฒ console
- [ ] Haptic ัะฐะฑะพัะฐะตั ะฝะฐ mobile

---

## ๐ก ะะดะตะธ ะฝะฐ ะฑัะดััะตะต (Phase 2)

### ๐ Milestone "ะะพะฒัะน ะผะธะฝะธะผัะผ"
> ะะพะณะดะฐ ะฒะตั ะฝะธะถะต ะฒัะตั ะทะฐ 30 ะดะฝะตะน โ confetti + haptic('success') + ัะพะฒะตั

### ๐ Moving Average
> ะกะณะปะฐะถะตะฝะฝะฐั ะปะธะฝะธั ััะตะฝะดะฐ (7-ะดะฝะตะฒะฝะพะต ัะบะพะปัะทััะตะต ััะตะดะฝะตะต) ะฟะพะฒะตัั ัะพัะตะบ

### ๐ฑ Swipe gesture
> Touch events ะดะปั ัะฒะฐะนะฟะฐ ะผะตะถะดั ะฟะตัะธะพะดะฐะผะธ (ะบะฐะบ ะฒ ะณะฐะปะตัะตะต iOS)

### ๐พ Persist chartPeriod
> ะกะพััะฐะฝััั ะฒัะฑัะฐะฝะฝัะน ะฟะตัะธะพะด ะฒ localStorage

### ๐ ะกัะฐะฒะฝะตะฝะธะต ะฝะตะดะตะปั
> "ะญัะฐ ะฝะตะดะตะปั ะปัััะต ะฟัะพัะปะพะน ะฝะฐ 0.3 ะบะณ" โ ะดะพะฟะพะปะฝะธัะตะปัะฝัะน ะฑะตะนะดะถ

---

## โ๏ธ ะะธัะบะธ ะธ ะผะธัะธะณะฐัะธั

| ะะธัะบ | ะะตัะพััะฝะพััั | ะะธัะธะณะฐัะธั |
|------|-------------|-----------|
| Period tabs ะดะพะฑะฐะฒัั 50+ ัััะพะบ JS + CSS | ๐ก Medium | ะะธะฝะธะผะฐะปัะฝัะน ะบะพะด, ะฑะตะท ะฐะฝะธะผะฐัะธะน ัะฒะฐะนะฟะฐ |
| Correlation ะปะพะณะธะบะฐ ัะปะพะถะฝะฐั | ๐ข Low | 3 ะฟัะพัััั if/else |
| ะคะฐะนะป ััะฐะฝะตั 4900+ ัััะพะบ | ๐ก Medium | ะะพะผะฟะฐะบัะฝัะน ะบะพะด, ~150 ะฝะพะฒัั ัััะพะบ max |
| sparklineData refactor ะดะปั period | ๐ก Medium | ะะพะฑะฐะฒะธัั ะฟะฐัะฐะผะตัั, ะฝะต ะปะพะผะฐั existing |
| Dark mode ะทะฐะฑััั | ๐ข Low | ะงะตะบะปะธัั ะฒ DONE |

---

## ๐ Notes

- **Priority**: high
- **Complexity**: L (90 ะผะธะฝ ะฒัะตะณะพ)
  - Must Have: 40 ะผะธะฝ
  - Should Have: 15 ะผะธะฝ  
  - WOW Features: 35 ะผะธะฝ (+10 ะผะธะฝ ะดะปั ัะฒะตัะพะฒัั ะทะพะฝ ะธ ะฐะฝะธะผะฐัะธะธ)
- **Blockers**: ะัะต ะธัะฟัะฐะฒะปะตะฝั ะฒ Phase 0 โ
- **Dependencies**: weightTrend (ัะฐะฑะพัะฐะตั), renderSparkline (ะฟะตัะตะธัะฟะพะปัะทัะตะผ)
- **Created**: 2025-11-29
- **Audited**: 2025-11-29 v3 โ Phase 0 ะฒัะฟะพะปะฝะตะฝะฐ

---

## ๐ ะะพััะดะพะบ ัะตะฐะปะธะทะฐัะธะธ

1. ~~**ะคะฐะทะฐ 0** โ ะัะฟัะฐะฒะธัั ะฑะฐะณะธ~~ โ ะะซะะะะะะะ
2. **Must Have** โ weightSparklineData + renderWeightSparkline + UI + CSS (40 ะผะธะฝ)
3. **WOW: Period tabs** โ chartPeriod state + UI + refactor sparklineData (15 ะผะธะฝ)
4. **WOW: Correlation** โ kcalTrend + block (10 ะผะธะฝ)
5. **WOW: ะัะพะณะฝะพะท** โ ะฟัะพััะฐั ัะพัะผัะปะฐ (5 ะผะธะฝ)
6. **Should Have** โ Tooltips, ะฟัะฝะบัะธั, ะฐะฝะธะผะฐัะธั (10 ะผะธะฝ)
7. **ะขะตััะธัะพะฒะฐะฝะธะต** โ Edge cases (5 ะผะธะฝ)

---

## ๐ ะััะพัะธั ะฐัะดะธัะพะฒ

### v3 (2025-11-29) โ ะะปัะฑะพะบะธะน ะฐัะดะธั ะฟะพัะปะต Phase 0

**ะงัะพ ัะดะตะปะฐะฝะพ:**
- โ weightTrend clientId bug ะธัะฟัะฐะฒะปะตะฝ (ัััะพะบะฐ 2864)
- โ Dark mode ะดะปั ะบะฐะปะพัะธะน sparkline ะดะพะฑะฐะฒะปะตะฝ (CSS 5467-5499)
- โ Build ะฟัะพัะพะดะธั

**ะงัะพ ะฟัะพะฒะตัะตะฝะพ:**
- Haptic feedback ะฟะฐััะตัะฝ ะตััั (20+ ะธัะฟะพะปัะทะพะฒะฐะฝะธะน)
- fadeIn keyframes ัะถะต ะพะฟัะตะดะตะปะตะฝั (ัััะพะบะฐ 1070)
- sparkline ััะธะปะธ ะฟะพะปะฝัะต (ัััะพะบะธ 3571-3649)
- weight-card ะฟะพะบะฐะทัะฒะฐะตั weightTrend (ัััะพะบะธ 3458-3475)

**ะะพะฒัะต ะฝะฐัะพะดะบะธ:**
- ะคะฐะนะป 4758 ัััะพะบ (ะฝะต 4747)
- renderSparkline ะฝะฐ ัััะพะบะต 3196 (ะผะพะถะฝะพ ะบะพะฟะธัะพะฒะฐัั)
- statsBlock ะฝะฐ ัััะพะบะต 3299

**ะะตะบะพะผะตะฝะดะฐัะธะธ:**
- ะัะฟะพะปัะทะพะฒะฐัั `haptic('light')` ะดะปั period tabs
- ะะตัะตะธัะฟะพะปัะทะพะฒะฐัั fadeIn ะฐะฝะธะผะฐัะธั
- ะัะฐะดะธะตะฝั ะฝะฐะทัะฒะฐัั `weightSparklineGrad` (ัะฝะธะบะฐะปัะฝัะน ID ะดะปั SVG)

### v2 (2025-11-29) โ ะะตัะฒัะน ะฐัะดะธั
- ะะฐะนะดะตะฝ ะบัะธัะธัะตัะบะธะน ะฑะฐะณ clientId ะฒ weightTrend
- ะะฐะนะดะตะฝะพ ะพััััััะฒะธะต dark mode ะดะปั sparkline
- ะะพะฑะฐะฒะปะตะฝั WOW features ะฒ scope
