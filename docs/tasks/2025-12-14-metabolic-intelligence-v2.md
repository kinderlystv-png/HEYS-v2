---
template-version: 3.5.0
created: 2025-12-14
updated: 2025-12-15
purpose: Metabolic Intelligence v2.0 ‚Äî —Å—Ç–∞—Ç—É—Å 0-100 —Å –Ω–∞—É—á–Ω—ã–º –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º
scope: –¢–û–õ–¨–ö–û –≤–∫–ª–∞–¥–∫–∞ Insights (–¥–Ω–µ–≤–Ω–∏–∫/—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ù–ï –¢–†–û–ì–ê–ï–ú)
---

# Task: Metabolic Intelligence v2.0

## üéØ –¶–µ–ª—å
**–°—Ç–∞—Ç—É—Å 0‚Äì100** —Å –ø—Ä–∏—á–∏–Ω–∞–º–∏, –¥–µ–π—Å—Ç–≤–∏—è–º–∏, —Ä–∏—Å–∫–æ–º —Å—Ä—ã–≤–∞ –∏ –º–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–æ–π —Ñ–∞–∑–æ–π.

## üìç Scope
**–í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û –≤–Ω—É—Ç—Ä–∏ –≤–∫–ª–∞–¥–∫–∏ Insights** (`InsightsTab`).  
–í–∫–ª–∞–¥–∫–∏ –î–µ–Ω—å/–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞/–†–∞—Ü–∏–æ–Ω/–ü—Ä–æ—Ñ–∏–ª—å ‚Äî **–ù–ï –¢–†–û–ì–ê–ï–ú**.

## üìÇ –î–µ—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

| # | –ü—Ä–æ–º–ø—Ç | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –í—Ä–µ–º—è |
|---|--------|--------|-----------|-------|
| 1 | [StatusCard](./2025-12-15-01-statuscard-metabolic-status.md) | **ENHANCE** (–∫–æ–º–ø–æ–Ω–µ–Ω—Ç –µ—Å—Ç—å) | üî• HIGH | ~2—á |
| 2 | [PredictiveDashboard](./2025-12-15-02-predictive-dashboard.md) | **ENHANCE** (–∫–æ–º–ø–æ–Ω–µ–Ω—Ç –µ—Å—Ç—å) | HIGH | ~2-3—á |
| 3 | [Feedback Loop](./2025-12-15-03-feedback-loop.md) | **NEW** | MEDIUM | ~2-3—á |
| 4 | [UI —Ñ–µ–Ω–æ—Ç–∏–ø–∞](./2025-12-15-04-phenotype-ui.md) | **NEW** | LOW | ~2—á |

---

## ‚úÖ –£–ñ–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

### Core (`heys_metabolic_intelligence_v1.js`)
- [x] `HEYS.Metabolic.getStatus()` ‚Äî score, reasons, nextSteps, risk, confidence
- [x] `calculateCrashRisk()` / `calculateCrashRisk24h()` ‚Äî —Ä–∏—Å–∫ —Å—Ä—ã–≤–∞ 0-100
- [x] `identifyPhenotype()` ‚Äî –º–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–∏–π —Ñ–µ–Ω–æ—Ç–∏–ø (‚â•30 –¥–Ω–µ–π)
- [x] `calculatePersonalThresholds()` ‚Äî –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –ø–æ—Ä–æ–≥–∏

### UI (`heys_predictive_insights_v1.js`)
- [x] `InsightsTab` (line 2899) ‚Äî –≥–ª–∞–≤–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞ —Å today/week —Ç–∞–±–∞–º–∏
- [x] `MetabolicStatusCard` (line 3216) ‚Äî score badge, phase, risk, reasons, nextSteps
- [x] `PredictiveDashboard` (line 3419) ‚Äî CrashRiskAlert, TomorrowForecast
- [x] `MetabolicStateRing` ‚Äî –∫–æ–ª—å—Ü–æ —Ñ–∞–∑—ã (anabolic/transitional/catabolic)
- [x] `RiskTrafficLight` ‚Äî —Å–≤–µ—Ç–æ—Ñ–æ—Ä —Ä–∏—Å–∫–∞ (low/medium/high)
- [x] `DataCompletenessCard` ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–ª–Ω–æ—Ç—ã –¥–∞–Ω–Ω—ã—Ö
- [x] `MealTimingCard` ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ —Ç–∞–π–º–∏–Ω–≥–∞ –ø—Ä–∏—ë–º–æ–≤

### CSS (`720-predictive-insights.css`)
- [x] –°—Ç–∏–ª–∏ –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤—ã—à–µ

---

## ‚ùå –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û (–Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å)

### StatusCard ‚Äî —É–ª—É—á—à–µ–Ω–∏—è (–ø—Ä–æ–º–ø—Ç #1)
- [ ] **–ö–æ–ª—å—Ü–æ —Å count-up –∞–Ω–∏–º–∞—Ü–∏–µ–π** (—Å–µ–π—á–∞—Å badge ‚Äî –Ω—É–∂–µ–Ω progress ring)
- [ ] **–¢—Ä–µ–Ω–¥ ‚Üë/‚Üì** ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –≤—á–µ—Ä–∞—à–Ω–∏–º —Å—Ç–∞—Ç—É—Å–æ–º
- [ ] **Breakdown –ø–æ —Å—Ç–æ–ª–ø–∞–º** ‚Äî mini-bars (–ø–∏—Ç–∞–Ω–∏–µ/—Ç–∞–π–º–∏–Ω–≥/—Å–æ–Ω/–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)
- [ ] **Gradient —Ü–≤–µ—Ç** ‚Äî –ø–ª–∞–≤–Ω—ã–π 0-100 (—Å–µ–π—á–∞—Å discrete zones)
- [ ] **Confidence badge** ‚Äî —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (low/medium/high)

### PredictiveDashboard ‚Äî —É–ª—É—á—à–µ–Ω–∏—è (–ø—Ä–æ–º–ø—Ç #2)
- [ ] **–¢–∞–±—ã Risk|Forecast|Phenotype** ‚Äî —Å–µ–π—á–∞—Å –ª–∏–Ω–µ–π–Ω—ã–π layout
- [ ] **Timeline [-7..+7 –¥–Ω–µ–π]** ‚Äî —Å–∫—Ä–æ–ª–ª–µ—Ä –¥–ª—è –ø—Ä–æ—à–ª–æ–≥–æ/–±—É–¥—É—â–µ–≥–æ
- [ ] **RiskMeter (gauge)** ‚Äî –≤–∏–∑—É–∞–ª—å–Ω—ã–π —Å–ø–∏–¥–æ–º–µ—Ç—Ä 0-100%
- [ ] **What-if —Å—Ü–µ–Ω–∞—Ä–∏–∏** ‚Äî optimistic/likely/worst –ø—Ä–æ–≥–Ω–æ–∑—ã

### Feedback Loop ‚Äî –Ω–æ–≤–æ–µ (–ø—Ä–æ–º–ø—Ç #3)
- [ ] `FeedbackStore` ‚Äî —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –æ—Ç–∫–ª–∏–∫–∞
- [ ] `FeedbackWidget` ‚Äî –º–∏–∫—Ä–æ-–æ–ø—Ä–æ—Å (FORECAST_ACCURACY, ADVICE_USEFULNESS –∏ —Ç.–¥.)
- [ ] –¢—Ä–∏–≥–≥–µ—Ä—ã –ø–æ–∫–∞–∑–∞ (–Ω–µ —á–∞—â–µ 1/–¥–µ–Ω—å)
- [ ] –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ feedback

### UI —Ñ–µ–Ω–æ—Ç–∏–ø–∞ ‚Äî –Ω–æ–≤–æ–µ (–ø—Ä–æ–º–ø—Ç #4)
- [ ] `PhenotypeSection` ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ —Ç–∏–ø–∞ —Å –∏–∫–æ–Ω–∫–æ–π/—Ü–≤–µ—Ç–æ–º
- [ ] RadarChart —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ (D3/SVG)
- [ ] PersonalThresholds view ‚Äî –∑–æ–Ω—ã + —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
- [ ] Evolution timeline ‚Äî —Å–º–µ–Ω—ã —Ç–∏–ø–∞
- [ ] Recommendations ‚Äî –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### Guardrails
- **EMA —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ** —Å—Ç–∞—Ç—É—Å–∞ (–Ω–µ —Å–∫–∞–∫–∞—Ç—å)
- **–ì–∏—Å—Ç–µ—Ä–µ–∑–∏—Å** –¥–ª—è riskLevel
- **Graceful degradation**: –æ—à–∏–±–∫–∞ ‚Üí fallback
- **Kill-switch**: `localStorage.heys_feature_metabolic=0`

### –ü—Ä–∞–≤–∏–ª–∞
- `dayTot.prot` (–ù–ï `protein`), `normAbs.prot`
- `HEYS.ratioZones` –¥–ª—è ratio/streak –ª–æ–≥–∏–∫–∏
- `HEYS.InsulinWave` –¥–ª—è —Ñ–∞–∑—ã/–≤–æ–ª–Ω—ã
- Refeed Day: –Ω–µ —à—Ç—Ä–∞—Ñ–æ–≤–∞—Ç—å –≤ –∑–æ–Ω–µ refeed
- –ë–µ–∑ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –æ–±–µ—â–∞–Ω–∏–π/–¥–∏–∞–≥–Ω–æ–∑–æ–≤

### –§–∞–π–ª—ã
- `apps/web/heys_metabolic_intelligence_v1.js` ‚Äî core
- `apps/web/heys_predictive_insights_v1.js` ‚Äî UI
- `apps/web/styles/modules/720-predictive-insights.css` ‚Äî —Å—Ç–∏–ª–∏

---

## üìã –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: StatusCard

**–°–¥–µ–ª–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `StatusCard`**:
1. –ö–æ–ª—å—Ü–æ 0-100 —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º
2. –°–ø–∏—Å–æ–∫ –ø—Ä–∏—á–∏–Ω –ø–æ —Å—Ç–æ–ª–ø–∞–º (–ø–∏—Ç–∞–Ω–∏–µ/—Ç–∞–π–º–∏–Ω–≥/—Å–æ–Ω/–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)
3. Expand –¥–µ—Ç–∞–ª–µ–π –ø–æ –∫–ª–∏–∫—É —Å –Ω–∞—É—á–Ω—ã–º –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º
4. –°–ø–∏—Å–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π —Å ETA
5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ InsightsTab

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏
- [ ] StatusCard —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –°—Ç–∞—Ç—É—Å 0-100 –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
- [ ] –ü—Ä–∏—á–∏–Ω—ã –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã –∏ —Ä–∞—Å–∫—Ä—ã–≤–∞—é—Ç—Å—è
- [ ] Mobile: touch ‚â•44px
- [ ] `pnpm type-check && pnpm build` PASS

---

**Priority**: high | **Complexity**: M (4-6—á –æ—Å—Ç–∞–ª–æ—Å—å) | **Created**: 2025-12-14
