---
template-version: 3.3.0
created: 2026-01-27
updated: 2026-01-27
purpose: Task-First prompt ‚Äî —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü –ø—Ä–æ–¥—É–∫—Ç–æ–≤
---

# Task: –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –ª–∏—á–Ω–æ–π –∏ –æ–±—â–µ–π —Ç–∞–±–ª–∏—Ü –ø—Ä–æ–¥—É–∫—Ç–æ–≤

## üìå TL;DR (–ö—Ä–∞—Ç–∫–∏–π –±—Ä–∏—Ñ)

**–¶–µ–ª—å**: –ø—Ä–∏–≤–µ—Å—Ç–∏ –æ–±—â—É—é –±–∞–∑—É –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∫ —Ç–æ–º—É –∂–µ —Ñ–æ—Ä–º–∞—Ç—É –≤—ã–≤–æ–¥–∞, —á—Ç–æ –∏ –ª–∏—á–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞, —á—Ç–æ–±—ã –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å **–∏–¥–µ–Ω—Ç–∏—á–Ω–æ**.

**–ß—Ç–æ –¥–µ–ª–∞–µ–º** (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É):
1. **–§–∞–∑–∞ 0**: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ ‚Äî –∞—É–¥–∏—Ç —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π, mapping –ø–æ–ª–µ–π, —Ç–µ—Å—Ç—ã.
2. **–§–∞–∑–∞ 1**: –†–∞—Å—à–∏—Ä–∏—Ç—å `normalizeSharedProduct()` –¥–ª—è –≤—Å–µ—Ö extended –ø–æ–ª–µ–π.
3. **–§–∞–∑–∞ 2**: –ü—Ä–∏–º–µ–Ω–∏—Ç—å `computeDerived()` –∫ shared-–ø—Ä–æ–¥—É–∫—Ç–∞–º.
4. **–§–∞–∑–∞ 3**: –í—ã–¥–µ–ª–∏—Ç—å –µ–¥–∏–Ω—ã–π `ProductTableRow` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç.
5. **–§–∞–∑–∞ 4**: –£–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ —Ä–µ–Ω–¥–µ—Ä–∞.

**–ó–∞—á–µ–º**:
- –£—Å—Ç—Ä–∞–Ω–∏—Ç—å —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è: **–£—Ä–±–µ—á** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 680 vs 693 –∫–∫–∞–ª, –≤–∏—Ç–∞–º–∏–Ω—ã ¬´‚Äî¬ª –≤–º–µ—Å—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–π.
- –û–±–µ—Å–ø–µ—á–∏—Ç—å –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã –∏ –æ–¥–Ω—É —Ç–æ—á–∫—É –ø—Ä–∞–≤–æ–∫.
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —á–∏—Å—Ç–æ—Ç–∞: ¬´Normalize Once, Render Anywhere¬ª.

**–í—Ä–µ–º—è**: 3‚Äì5 —á–∞—Å–æ–≤ (—Å —É—á—ë—Ç–æ–º —Ñ–∞–∑—ã 0)

---

## üî¨ –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê (—Ä–µ–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä)

**–ü—Ä–æ–¥—É–∫—Ç**: –£—Ä–±–µ—á –∏–∑ –º—è–∫–æ—Ç–∏ –∫–æ–∫–æ—Å–∞ (100%)

| –ü–æ–ª–µ | –õ–∏—á–Ω–∞—è | –û–±—â–∞—è | –ü—Ä–æ–±–ª–µ–º–∞ |
|------|--------|-------|----------|
| **–ö–∫–∞–ª** | 680 | 693 | ‚ùå –†–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º—É–ª—ã: –ª–∏—á–Ω–∞—è = `computeDerived()`, –æ–±—â–∞—è = inline Math |
| **Na** | 20 | ‚Äî | ‚ùå `sodium100` –Ω–µ —á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ shared |
| **Œ©3** | 0.05 | ‚Äî | ‚ùå `omega3_100` –Ω–µ —á–∏—Ç–∞–µ—Ç—Å—è |
| **Œ©6** | 1 | ‚Äî | ‚ùå `omega6_100` –Ω–µ —á–∏—Ç–∞–µ—Ç—Å—è |
| **NOVA** | 1 | ‚Äî | ‚ùå `nova_group` –µ—Å—Ç—å –≤ normalizer, –Ω–æ –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è |
| **ND** | 15.6 | ‚Äî | ‚ùå `nutrient_density` –Ω–µ —á–∏—Ç–∞–µ—Ç—Å—è |
| **Raw** | –¥–∞ | –Ω–µ—Ç | ‚ùå `is_raw` NULL –≤ –ë–î –∏–ª–∏ –Ω–µ —á–∏—Ç–∞–µ—Ç—Å—è |
| **–í–∏—Ç–∞–º–∏–Ω—ã A-I** | –∑–∞–ø–æ–ª–Ω–µ–Ω—ã | ‚Äî | ‚ùå `vitamin_*` –Ω–µ —á–∏—Ç–∞—é—Ç—Å—è |

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞**: Shared-—Ç–∞–±–ª–∏—Ü–∞ —Ä–µ–Ω–¥–µ—Ä–∏—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –ë–î snake_case –±–µ–∑ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –±–µ–∑ `computeDerived()`.

**üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ë–ê–ì (–Ω–∞–π–¥–µ–Ω –ø—Ä–∏ –∞—É–¥–∏—Ç–µ)**:
```js
// Shared —Ç–∞–±–ª–∏—Ü–∞ (—Å—Ç—Ä–æ–∫–∞ 3208) ‚Äî –ù–ï–ü–†–ê–í–ò–õ–¨–ù–ê–Ø –§–û–†–ú–£–õ–ê:
const kcal = Math.round(safeNum(p.protein100) * 4 + ...);  // ‚ùå protein √ó 4

// computeDerived() (—Å—Ç—Ä–æ–∫–∞ 127) ‚Äî –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –§–û–†–ú–£–õ–ê:
const kcal100 = 3 * toNum(p.protein100) + 4 * carbs100 + 9 * fat100;  // ‚úÖ protein √ó 3 (TEF-aware)
```

**–ü—Ä–∏–º–µ—Ä**: –£—Ä–±–µ—á —Å 6–≥ –±–µ–ª–∫–∞ ‚Üí —Ä–∞–∑–Ω–∏—Ü–∞ 6 √ó (4‚àí3) = **+6 –∫–∫–∞–ª** –≤ shared vs –ª–∏—á–Ω–∞—è. –ü—Ä–∏ 13–≥ –±–µ–ª–∫–∞ ‚Üí **+13 –∫–∫–∞–ª**.

---

## üìã –†–ï–®–ï–ù–ò–Ø –ü–û –ö–õ–Æ–ß–ï–í–´–ú –í–û–ü–†–û–°–ê–ú

### 1Ô∏è‚É£ –ò—Å—Ç–æ—á–Ω–∏–∫ –∫–∞–ª–æ—Ä–∏–π: `kcal100` –∏–∑ –ë–î vs `computeDerived()` ‚Äî ‚úÖ –†–ï–®–ï–ù–û

**–û—Ç–≤–µ—Ç**: –í –ë–î —Ö—Ä–∞–Ω–∏–º **—Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–æ–µ –ø–æ —Ñ–æ—Ä–º—É–ª–µ** `kcal100`; –ø—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —É `kcal100` –∏–∑ –ë–î, fallback –Ω–∞ `computeDerived()`.

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ**:
- `heys_yesterday_verify_v1.js:166` —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç–æ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
- –ë–î —Ö—Ä–∞–Ω–∏—Ç —É–∂–µ –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ ‚Äî –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–æ—Ä–º—É–ª—ã —Å—Ç–∞—Ä—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Å–≤–æ–∏ –∫–∞–ª–æ—Ä–∏–∏ (–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å)
- –î–ª—è **–Ω–æ–≤—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤**: `kcal100` –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ –∏ **—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è** –≤ –ë–î
- `computeDerived()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ fallback –¥–ª—è –ø—É—Å—Ç—ã—Ö/–±–∏—Ç—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

### 2Ô∏è‚É£ NULL –ø–æ–ª–∏—Ç–∏–∫–∞: –≥–¥–µ ¬´‚Äî¬ª –¥–æ–ø—É—Å—Ç–∏–º–æ ‚Äî ‚úÖ –†–ï–®–ï–ù–û

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ü—Ä–∏–º–µ—Ä—ã –ø–æ–ª–µ–π | NULL ‚Üí |
|-----------|---------------|--------|
| **–ë–∞–∑–æ–≤—ã–µ –º–∞–∫—Ä–æ—Å—ã** | kcal100, protein100, carbs100, fat100 | **0** –∏–ª–∏ –≤—ã—á–∏—Å–ª–∏—Ç—å |
| **–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –º–∞–∫—Ä–æ—Å–æ–≤** | simple100, complex100, badFat100... | **0** |
| **Extended —á–∏—Å–ª–æ–≤—ã–µ** | sodium100, omega3_100, vitamin_a... | **¬´‚Äî¬ª** |
| **Extended boolean** | is_organic, is_raw... | **¬´‚Äî¬ª** (–Ω–µ ¬´–Ω–µ—Ç¬ª!) |

### 3Ô∏è‚É£ Shared —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: —Ç–æ–ª—å–∫–æ –∫—É—Ä–∞—Ç–æ—Ä ‚Äî ‚úÖ –†–ï–®–ï–ù–û

**–û—Ç–≤–µ—Ç**: –î–∞, shared-—Ç–∞–±–ª–∏—Ü–∞ **—Å—Ç—Ä–æ–≥–æ read-only** –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞. –ö–Ω–æ–ø–∫–∏ edit/delete —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `isCurator === true`.

---

## üîç 50 –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Äî –æ—Ç–≤–µ—Ç—ã –∏ –∞—É–¥–∏—Ç (—Ñ–∞–∫—Ç—ã –∏–∑ —Ä–µ–ø–æ)

> –ü—Ä–∏–Ω—Ü–∏–ø: **–Ω–µ –≤—ã–¥—É–º—ã–≤–∞—Ç—å**. –ï—Å–ª–∏ –≤ –∫–æ–¥–µ/–¥–æ–∫–∞—Ö –Ω–µ—Ç –æ—Ç–≤–µ—Ç–∞ ‚Äî —Ç–∞–∫ –∏ —É–∫–∞–∑–∞–Ω–æ.

| ‚Ññ | –í–æ–ø—Ä–æ—Å | –ò–¥–µ–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤ –ø—Ä–æ–º–ø—Ç–µ) | –ö–∞–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ (–∞—É–¥–∏—Ç) | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|---|--------|--------------------------------------------|--------------------------|---------|
| 1 | –§–æ—Ä–º—É–ª–∞ –∫–∞–ª–æ—Ä–∏–π: $3$ –∏–ª–∏ $4$ –¥–ª—è –±–µ–ª–∫–∞? –ù—É–∂–Ω–∞ –ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤? | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å **TEF‚Äëaware $3$ –∫–∫–∞–ª/–≥ –±–µ–ª–∫–∞** –∫–∞–∫ SoT –∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ —Ä–µ–Ω–¥–µ—Ä –∫ –Ω–µ–º—É; –º–∏–≥—Ä–∞—Ü–∏—è **–Ω–µ –æ–ø–∏—Å–∞–Ω–∞** ‚Üí —Ç—Ä–µ–±—É–µ—Ç—Å—è —è–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ. | –í –∫–æ–¥–µ: `computeDerivedProduct()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç $3$; shared‚Äë—Ç–∞–±–ª–∏—Ü–∞ –≤ UI —Å—á–∏—Ç–∞–µ—Ç $4$; –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—É–ª–∞ $4$ ‚Üí –∫–æ–Ω—Ñ–ª–∏–∫—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤. | `apps/web/heys_models_v1.js` (`computeDerivedProduct`), `apps/web/heys_core_v12.js` (shared table kcal), `docs/DATA_MODEL_REFERENCE.md` (computeDerived —Ñ–æ—Ä–º—É–ª–∞) |
| 2 | –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è —ç—Ç–∞–ª–æ–Ω–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞? | –°–¥–µ–ª–∞—Ç—å **–µ–¥–∏–Ω—ã–π SoT** –Ω–∞ —É—Ä–æ–≤–Ω–µ `HEYS.models.computeDerivedProduct()` –∏ —Å–æ—Å–ª–∞—Ç—å—Å—è –Ω–∞ –Ω–µ—ë –≤ –ø—Ä–æ–º–ø—Ç–µ. | –ü–æ —Ñ–∞–∫—Ç—É: `HEYS.models.computeDerivedProduct()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ, –Ω–æ –≤ UI shared –µ—Å—Ç—å —Å–≤–æ—è —Ñ–æ—Ä–º—É–ª–∞; –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ —É–∫–∞–∑–∞–Ω–∞ –¥—Ä—É–≥–∞—è. | `apps/web/heys_models_v1.js`, `apps/web/heys_core_v12.js`, `docs/DATA_MODEL_REFERENCE.md` |
| 3 | –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å–º–µ–Ω–µ —Ñ–æ—Ä–º—É–ª—ã | –¢—Ä–µ–±—É–µ—Ç—Å—è —è–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –≤ –ø—Ä–æ–º–ø—Ç–µ (–ø–µ—Ä–µ—Å—á—ë—Ç –∏–ª–∏ —Ñ–∏–∫—Å–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π). | –í –∫–æ–¥–µ/–¥–æ–∫–∞—Ö –Ω–µ—Ç –ø–æ–ª–∏—Ç–∏–∫–∏ –ø–µ—Ä–µ—Å—á—ë—Ç–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö. | –ù–µ –Ω–∞–π–¥–µ–Ω–æ |
| 4 | SQL –ø—Ä–∞–≤–∞ –Ω–∞ UPDATE `shared_products` | –£–∫–∞–∑–∞—Ç—å —è–≤–Ω–æ –≤ –ø—Ä–æ–º–ø—Ç–µ (–µ—Å—Ç—å/–Ω–µ—Ç). | –í –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è REST `POST/PATCH/DELETE`, –Ω–æ –ø—Ä–∞–≤–∞ –≤ –ë–î –Ω–µ –æ–ø–∏—Å–∞–Ω—ã. | `apps/web/heys_cloud_shared_v1.js` |
| 5 | –ü–µ—Ä–µ—Å—á—ë—Ç `kcal100` –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –≤ `shared_products` | –ù—É–∂–Ω–∞ —è–≤–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞. | –ú–∏–≥—Ä–∞—Ü–∏—è `kcal100` –Ω–µ –æ–ø–∏—Å–∞–Ω–∞; –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω—ã–π `fixMissingKcal`. | `apps/web/heys_core_v12.js` (`fixMissingKcal`) |
| 6 | –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ shared‚Äë–ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –∫–ª–æ–Ω—ã | –û–ø–∏—Å–∞—Ç—å –≤ –ø—Ä–æ–º–ø—Ç–µ: –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ shared. | –ï—Å—Ç—å –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞: `shared_origin_id`, `shared_updated_at`, `cloned_at`, `user_modified`. | `apps/web/heys_models_v1.js` (`getProductPrioritySource`) |
| 7 | `vitamin_a` vs `vitaminA` (camelCase) | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å: shared —Ö—Ä–∞–Ω–∏—Ç **snake_case**, –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º –≤ JS –±–µ–∑ camelCase. | –í –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è `vitamin_a` –∏ –¥—Ä.; –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ camelCase –¥–ª—è vitamin* –Ω–µ—Ç. | `apps/web/heys_models_v1.js` (`normalizeExtendedProduct`) |
| 8 | –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ 29 extended‚Äë–ø–æ–ª–µ–π | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –≤ –ø—Ä–æ–º–ø—Ç–µ. | –°–ø–∏—Å–æ–∫ –µ—Å—Ç—å –≤ JSDoc/–∫–ª—é—á–∞—Ö –ø–∞—Ä—Å–µ—Ä–∞: `sodium100, omega3_100, omega6_100, nutrient_density, nova_group, additives, is_organic, is_whole_grain, is_fermented, is_raw, vitamin_a/c/d/e/k/b1/b2/b3/b6/b9/b12, calcium/iron/magnesium/phosphorus/potassium/zinc/selenium/iodine` (29). | `apps/web/heys_models_v1.js` (Product JSDoc, `EXTENDED_NUTRIENT_KEYS`) |
| 9 | Boolean –ø–æ–ª—è: —Ç–∏–ø/—Ç—Ä–∏‚Äë—Å–æ—Å—Ç–æ—è–Ω–∏—è | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∏‚Äë—Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ UI, –Ω–æ –ë–î‚Äë–ø–æ–ª–∏—Ç–∏–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ–ø–∏—Å–∞–Ω–∞. | –í UI/–∫–ª–æ–Ω–∞—Ö –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è `null` –∫–∞–∫ ¬´–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ¬ª; `publishToShared()` –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `false` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Üí —Ç—Ä–∏‚Äë—Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏. | `apps/web/heys_core_v12.js`, `apps/web/heys_cloud_shared_v1.js` |
| 10 | `nutrient_density`: —Ö—Ä–∞–Ω–∏—Ç—Å—è –∏–ª–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è? | –Ø–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å: –ª–∏–±–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ë–î, –ª–∏–±–æ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `HEYS.Harm.calculateNutrientDensity`. | –í –∫–æ–¥–µ —ç—Ç–æ **—Ö—Ä–∞–Ω–∏–º–æ–µ –ø–æ–ª–µ** (`nutrient_density`), –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤ `computeDerived` –Ω–µ—Ç; –≤ –¥–æ–∫–µ –µ—Å—Ç—å API `calculateNutrientDensity`. | `apps/web/heys_models_v1.js`, `docs/DATA_MODEL_REFERENCE.md` |
| 11 | `carbs100` vs `simple+complex+fiber` | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å: **carbs = simple + complex** (fiber –æ—Ç–¥–µ–ª—å–Ω–æ). | `computeDerivedProduct()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç simple+complex. | `apps/web/heys_models_v1.js` |
| 12 | `fat100` vs `bad+good(+trans)` | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å: **fat = bad + good + trans**. | `computeDerivedProduct()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç bad+good+trans. | `apps/web/heys_models_v1.js` |
| 13 | –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ | –£–∫–∞–∑–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1 –∑–Ω–∞–∫). | –í `computeDerivedProduct()` ‚Äî `round1` (1 –∑–Ω–∞–∫). | `apps/web/heys_models_v1.js` |
| 14 | –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è | –Ø–≤–Ω–æ –æ–ø–∏—Å–∞—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É –≤ –ø—Ä–æ–º–ø—Ç–µ. | –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è `kcal100 >= 0`; –ø—Ä–æ—á–∏–µ –ø–æ–ª—è –Ω–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è. | `apps/web/heys_models_v1.js` (`validateProduct`) |
| 15 | –°–∫–æ–ª—å–∫–æ –∫–æ–ª–æ–Ω–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–Ω–æ–µ —á–∏—Å–ª–æ –∏ —Å–ø–∏—Å–æ–∫. | –í —Ç–∞–±–ª–∏—Ü–∞—Ö –ª–∏—á–Ω–æ–π/–æ–±—â–µ–π –±–∞–∑—ã **44 –∫–æ–ª–æ–Ω–∫–∏** (–≤–∫–ª—é—á–∞—è actions). | `apps/web/heys_core_v12.js` (thead —Ç–∞–±–ª–∏—Ü) |
| 16 | –ú–æ–±–∏–ª—å–Ω—ã–π UX: –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª, sticky‚Äë–∫–æ–ª–æ–Ω–∫–∞ | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤ –ø—Ä–æ–º–ø—Ç–µ. | –ï—Å—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä `.products-table-scroll`; sticky‚Äë–ª–æ–≥–∏–∫–∞ –≤ –∫–æ–¥–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. | `apps/web/heys_core_v12.js` |
| 17 | –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∫–æ–ª–æ–Ω–æ–∫ | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏. | –ü–æ—Ä—è–¥–æ–∫ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω –≤ —Ä–∞–∑–º–µ—Ç–∫–µ, UI‚Äë–ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–µ—Ç. | `apps/web/heys_core_v12.js` |
| 18 | –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∫–æ–ª–æ–Ω–æ–∫ (–º–∞–∫—Ä–æ/–≤–∏—Ç/–º–∏–Ω–µ—Ä–∞–ª—ã) | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å: –Ω—É–∂–Ω—ã –ª–∏ group‚Äëheaders. | –í —Ç–µ–∫—É—â–µ–º UI –≥—Ä—É–ø–ø–∏—Ä–æ–≤–æ–∫ –Ω–µ—Ç. | `apps/web/heys_core_v12.js` |
| 19 | –ì–¥–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è `isCurator` | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏ –ª–æ–≥–∏–∫—É. | –†–∞–∑–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏: `heys_curator_token`; `heys_curator_session`/`heys_supabase_auth_token`/`HEYS.cloud.role`; `HEYS.cloud.getUser()`. | `apps/web/heys_bootstrap_v1.js`, `apps/web/heys_app_onboarding_v1.js`, `apps/web/heys_app_desktop_gate_v1.js` |
| 20 | Curator vs admin | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ä–æ–ª–∏ –≤ –ø—Ä–æ–º–ø—Ç–µ. | –í —Ç–∏–ø–∞—Ö –ø–∞–Ω–µ–ª–∏ –∫—É—Ä–∞—Ç–æ—Ä–∞ –µ—Å—Ç—å —Ä–æ–ª–∏ `admin/curator/moderator/user`; –≤ legacy‚Äë–∫–æ–¥–µ —è–≤–Ω–æ–π —Ä–æ–ª–∏ admin –Ω–µ—Ç. | `apps/web/src/components/CuratorPanel/types/curator.types.ts` |
| 21 | Multi‚Äëcurator | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å, –∫–∞–∫ –¥–µ–ª—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ. | –í shared‚Äë–±–ª–æ–∫–ª–∏—Å—Ç–∞—Ö/–º–æ–¥–µ—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `curator_id`, —á—Ç–æ –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∫—É—Ä–∞—Ç–æ—Ä–æ–≤, –Ω–æ –ø–æ–ª–∏—Ç–∏–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –Ω–µ –æ–ø–∏—Å–∞–Ω–∞. | `apps/web/heys_cloud_shared_v1.js` |
| 22 | `clonedFromSharedId` ‚Äî –Ω–æ–≤–æ–µ –ø–æ–ª–µ? | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª–µ. | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `shared_origin_id` + `cloned_at`, –ø–æ–ª—è `clonedFromSharedId` –Ω–µ—Ç. | `apps/web/heys_core_v12.js`, `apps/web/heys_models_v1.js` |
| 23 | –ö–æ–Ω—Ñ–ª–∏–∫—Ç –∏–º—ë–Ω –ø—Ä–∏ –∫–ª–æ–Ω–µ | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É (—Å—É—Ñ—Ñ–∏–∫—Å/merge). | –°—É—Ñ—Ñ–∏–∫—Å –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è; `addFromShared` –∏—â–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø–æ –∏–º–µ–Ω–∏ –∏ merge‚Äë–∏—Ç. | `apps/web/heys_core_v12.js` |
| 24 | –ü–æ—Ä—Ü–∏–∏ –ø—Ä–∏ –∫–ª–æ–Ω–µ | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å: –∫–æ–ø–∏—Ä—É–µ–º –∏–ª–∏ –Ω–µ—Ç. | `cloneSharedToPersonal` –∫–æ–ø–∏—Ä—É–µ—Ç `portions`. | `apps/web/heys_core_v12.js` |
| 25 | –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –∫–ª–∏–µ–Ω—Ç–∞ (–∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ shared) | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫ –º–æ–¥–µ—Ä–∞—Ü–∏–∏. | –ï—Å—Ç—å `create_pending_product_by_session` ‚Üí approve/reject curator. | `apps/web/heys_cloud_shared_v1.js` |
| 26 | `omega3_100` vs `omega3100` | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å snake_case. | –í –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `omega3_100`. | `apps/web/heys_models_v1.js` |
| 27 | –í–∏—Ç–∞–º–∏–Ω—ã –≥—Ä—É–ø–ø—ã B (–ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä?) | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫. | –í –∫–æ–¥–µ: **B1, B2, B3, B6, B9, B12** (6 —à—Ç). | `apps/web/heys_models_v1.js` |
| 28 | –ú–∏–Ω–µ—Ä–∞–ª—ã ‚Äî –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫. | –í –∫–æ–¥–µ: **calcium, iron, magnesium, phosphorus, potassium, zinc, selenium, iodine**. | `apps/web/heys_models_v1.js` |
| 29 | –ï–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤ –ø—Ä–æ–º–ø—Ç–µ. | JSDoc: sodium mg/100–≥, omega –≤ –≥/100–≥, vitamins/minerals % DV. | `apps/web/heys_models_v1.js` (Product JSDoc) |
| 30 | –°—Ç–∞—Ä—ã–µ –∫–ª–æ–Ω—ã –±–µ–∑ `shared_origin_id` | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ. | `addFromShared` –¥–µ–ª–∞–µ—Ç fallback‚Äëmerge –ø–æ –∏–º–µ–Ω–∏. | `apps/web/heys_core_v12.js` |
| 31 | Legacy –ø—Ä–æ–¥—É–∫—Ç—ã –±–µ–∑ extended –ø–æ–ª–µ–π | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é. | `normalizeProductFields` –ø–æ–∫—Ä—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ harm –∏ bad/good case; extended –ø–æ–ª—è –Ω–µ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è. | `apps/web/heys_models_v1.js` |
| 32 | Orphan products | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫/–ø–æ–≤–µ–¥–µ–Ω–∏–µ. | –í —ç—Ç–æ–º –ø—Ä–æ–º–ø—Ç–µ –Ω–µ –æ–ø–∏—Å–∞–Ω–æ; –æ—Ç–¥–µ–ª—å–Ω–æ –æ–ø–∏—Å–∞–Ω–æ –≤ `STORAGE_PATTERNS.md` –∫–∞–∫ `HEYS.orphanProducts`. | `docs/dev/STORAGE_PATTERNS.md` |
| 33 | –†–∞–∑–º–µ—Ä `shared_products` | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫—É. | –¢–æ—á–Ω–æ–µ —á–∏—Å–ª–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ; –≤ UI –µ—Å—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø—Ä–æ ¬´29k+ –ø—Ä–æ–¥—É–∫—Ç–æ–≤¬ª (–æ–±—â–∏–π —Ä–∏—Å–∫ –ø–æ –æ–±—ä—ë–º—É). | `apps/web/heys_core_v12.js` |
| 34 | –ü–∞–≥–∏–Ω–∞—Ü–∏—è shared | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é. | `getAllSharedProducts` –±–µ—Ä—ë—Ç limit (default 500), offset 0; –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–µ—Ç. | `apps/web/heys_cloud_shared_v1.js` |
| 35 | –ü–æ–∏—Å–∫: —Å–µ—Ä–≤–µ—Ä/–∫–ª–∏–µ–Ω—Ç | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å. | –ü–æ–∏—Å–∫ –≤ API ‚Äî —Å–µ—Ä–≤–µ—Ä–Ω—ã–π `ilike` (`YandexAPI.rest`), –∞ –≤ —Ç–∞–±–ª–∏—Ü–µ ‚Äî –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π —Ñ–∏–ª—å—Ç—Ä –ø–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–º—É –º–∞—Å—Å–∏–≤—É. | `apps/web/heys_cloud_shared_v1.js`, `apps/web/heys_core_v12.js` |
| 36 | Test environment | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å, –≥–¥–µ —Ç–µ—Å—Ç–∏—Ç—å. | –û—Ç–¥–µ–ª—å–Ω–∞—è —Ç–µ—Å—Ç‚Äë–ë–î –≤ —Ä–µ–ø–æ –Ω–µ –æ–ø–∏—Å–∞–Ω–∞. | –ù–µ –Ω–∞–π–¥–µ–Ω–æ |
| 37 | Rollback –ø–ª–∞–Ω | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —à–∞–≥–∏. | –í –∫–æ–¥–µ/–¥–æ–∫–∞—Ö –Ω–µ—Ç –≥–æ—Ç–æ–≤–æ–≥–æ rollback‚Äë–ø–ª–∞–Ω–∞ (–≤ –ø—Ä–æ–º–ø—Ç–µ –µ—Å—Ç—å –ª–∏—à—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è `pg_dump`). | `docs/tasks/2026-01-27-unify-product-tables.md` |
| 38 | A/B testing | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å. | –í —ç—Ç–æ–π –∑–∞–¥–∞—á–µ A/B –Ω–µ –æ–ø–∏—Å–∞–Ω; A/B –µ—Å—Ç—å –≤ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª—è—Ö, –Ω–æ –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ —Ç–∞–±–ª–∏—Ü–∞–º. | `docs/HEYS_BRIEF.md` (A/B tech debt) |
| 39 | –ü—Ä–æ–¥—É–∫—Ç –±–µ–∑ –º–∞–∫—Ä–æ—Å–æ–≤, –Ω–æ —Å –≤–∏—Ç–∞–º–∏–Ω–∞–º–∏ | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É. | `computeDerivedProduct` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω—É–ª–∏ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –º–∞–∫—Ä–æ—Å–æ–≤; –≤–∞–ª–∏–¥–∞—Ç–æ—Ä —Ç—Ä–µ–±—É–µ—Ç `kcal100` ‚â• 0. | `apps/web/heys_models_v1.js` |
| 40 | –ü—Ä–æ–¥—É–∫—Ç—ã —Å `protein100 > 100` | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É. | –í–∞–ª–∏–¥–∞—Ü–∏–∏/–∫—ç–ø–∏–Ω–≥–∞ –Ω–µ—Ç; –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–æ—Ö–æ–¥—è—Ç –∫–∞–∫ –µ—Å—Ç—å. | `apps/web/heys_models_v1.js` |
| 41 | –ê–ª–∫–æ–≥–æ–ª—å (7 –∫–∫–∞–ª/–≥) | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–ª–∏—á–∏–µ –ø–æ–ª—è. | –ü–æ–ª—è `alcohol100`/—Ñ–æ—Ä–º—É–ª—ã 7 –∫–∫–∞–ª/–≥ –≤ –º–æ–¥–µ–ª–∏ –Ω–µ—Ç. | `apps/web/heys_models_v1.js` |
| 42 | Composite –ø—Ä–æ–¥—É–∫—Ç—ã/—Ä–µ—Ü–µ–ø—Ç—ã | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç. | –†–µ—Ü–µ–ø—Ç—É—Ä–Ω–æ–π –º–æ–¥–µ–ª–∏ –Ω–µ—Ç; –ø—Ä–æ–¥—É–∫—Ç ‚Äî –ø–ª–æ—Å–∫–∏–π –Ω–∞–±–æ—Ä –º–∞–∫—Ä–æ—Å–æ–≤. | `apps/web/heys_models_v1.js` |
| 43 | –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å `heys_yesterday_verify_v1.js` | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –Ω–µ –ª–æ–º–∞–µ–º. | `yesterday_verify` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `item.kcal100` ‚Üí `product.kcal100` ‚Üí –≤—ã—á–∏—Å–ª–µ–Ω–∏—è; –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ `shared_origin_id` –º–æ–∂–µ—Ç –ø–æ–¥—Ç—è–≥–∏–≤–∞—Ç—å shared —á–µ—Ä–µ–∑ `getProductFromItem`. | `apps/web/heys_yesterday_verify_v1.js`, `apps/web/heys_models_v1.js` |
| 44 | –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –ª–∏—á–Ω–æ–π –±–∞–∑—ã | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç. | –ï—Å—Ç—å UI‚Äë—ç–∫—Å–ø–æ—Ä—Ç –ø–æ–ª–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞ –∏ –∏–º–ø–æ—Ä—Ç JSON. | `apps/web/heys_core_v12.js` (—ç–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –±–ª–æ–∫) |
| 45 | API‚Äë—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å. | –í —Ä–µ–ø–æ –Ω–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è –≤–Ω–µ—à–Ω–∏—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ —á–∏—Ç–∞—é—Ç `shared_products`. | –ù–µ –Ω–∞–π–¥–µ–Ω–æ |
| 46 | –ú–æ–¥–µ—Ä–∞—Ü–∏—è shared | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫. | –ö–ª–∏–µ–Ω—Ç ‚Üí `createPendingProduct` ‚Üí curator approve/reject; –∫—É—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é. | `apps/web/heys_cloud_shared_v1.js` |
| 47 | –£–¥–∞–ª–µ–Ω–∏–µ shared –∏ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –∫–ª–æ–Ω—ã | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ. | UI‚Äë—Ç–µ–∫—Å—Ç: —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ shared **–Ω–µ —É–¥–∞–ª—è–µ—Ç** –∫–ª–æ–Ω—ã —É –∫–ª–∏–µ–Ω—Ç–æ–≤. | `apps/web/heys_core_v12.js` (confirm delete message) |
| 48 | Merge –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ shared | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É. | –ï—Å—Ç—å fingerprint‚Äë–¥–µ–¥—É–ø –∏ merge‚Äë–º–æ–¥–∞–ª –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏, –Ω–æ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥—É–±–ª–µ–π –≤ shared –Ω–µ –æ–ø–∏—Å–∞–Ω—ã. | `apps/web/heys_models_v1.js`, `apps/web/heys_core_v12.js` |
| 49 | Backup –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å. | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup –≤ —Ä–µ–ø–æ –Ω–µ –æ–ø–∏—Å–∞–Ω (–≤ –ø—Ä–æ–º–ø—Ç–µ —Ç–æ–ª—å–∫–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è `pg_dump`). | `docs/tasks/2026-01-27-unify-product-tables.md` |
| 50 | Downtime –Ω–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ | –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å. | –í —Ä–µ–ø–æ –Ω–µ—Ç –ø–æ–ª–∏—Ç–∏–∫–∏ downtime –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ `kcal100`. | –ù–µ –Ω–∞–π–¥–µ–Ω–æ |

---

## ‚úÖ –ò–¥–µ–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç–≤–µ—Ç–æ–≤ (—Ñ–∏–∫—Å–∏—Ä—É–µ–º—ã–µ —Ä–µ—à–µ–Ω–∏—è)

| ‚Ññ | –ò–¥–µ–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç (–Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ —Ñ–∏–∫—Å–∏—Ä—É–µ–º –≤ –ø—Ä–æ–º–ø—Ç–µ) |
|---|---|
| 1 | –§–æ—Ä–º—É–ª–∞ –∫–∞–ª–æ—Ä–∏–π: **TEF‚Äëaware $3$ –∫–∫–∞–ª/–≥ –±–µ–ª–∫–∞** ‚Äî –µ–¥–∏–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç. –ú–∞—Å—Å–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é **–Ω–µ –¥–µ–ª–∞–µ–º**, —Ç–æ–ª—å–∫–æ backfill –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö `kcal100`. |
| 2 | –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π SoT —Ñ–æ—Ä–º—É–ª—ã ‚Äî `HEYS.models.computeDerivedProduct()`. –õ—é–±—ã–µ —Ä–∞—Å—á—ë—Ç—ã –≤ UI –∑–∞–ø—Ä–µ—â–µ–Ω—ã. |
| 3 | –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ `kcal100` –Ω–µ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º; –ø–µ—Ä–µ—Å—á—ë—Ç ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —è–≤–Ω–æ–º —Ä–µ—à–µ–Ω–∏–∏ –∏ –º–∏–≥—Ä–∞—Ü–∏–∏. |
| 4 | UPDATE/DELETE `shared_products` —Ä–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ –∫—É—Ä–∞—Ç–æ—Ä—É/–∞–¥–º–∏–Ω—É —á–µ—Ä–µ–∑ RPC —Å RLS; –∫–ª–∏–µ–Ω—Ç ‚Äî read‚Äëonly. |
| 5 | –ü–µ—Ä–µ—Å—á—ë—Ç `kcal100` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ** –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏/–ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∏–ª–∏ –µ—Å–ª–∏ `kcal100` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç. |
| 6 | –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ: `shared_updated_at` —Ö—Ä–∞–Ω–∏—Ç—Å—è; –∫–ª–æ–Ω—ã –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –±–µ–π–¥–∂ ¬´–æ–±–Ω–æ–≤–ª–µ–Ω–æ –≤ shared¬ª. |
| 7 | –•—Ä–∞–Ω–∏–º –≤ –ë–î **snake_case** (`vitamin_a`), –≤ UI ‚Äî –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º –≤ camelCase. |
| 8 | –§–∏–∫—Å–∏—Ä—É–µ–º –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ 29 extended‚Äë–ø–æ–ª–µ–π (–∏–∑ `EXTENDED_NUTRIENT_KEYS`). |
| 9 | Boolean ‚Äî **—Ç—Ä–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è**: `true/false/null`; `null` = ¬´–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ¬ª. –ó–∞–ø—Ä–µ—â–µ–Ω–æ –∞–≤—Ç–æ–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ `null ‚Üí false`. |
| 10 | `nutrient_density` –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (client/server) –∏ —Ö—Ä–∞–Ω–∏—Ç—Å—è; –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Äî –≤—ã—á–∏—Å–ª—è–µ–º –Ω–∞ –∑–∞–≥—Ä—É–∑–∫–µ. |
| 11 | `carbs100 = simple100 + complex100` (fiber –æ—Ç–¥–µ–ª—å–Ω–æ). |
| 12 | `fat100 = badFat100 + goodFat100 + trans100`. |
| 13 | –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ derived‚Äë–ø–æ–ª–µ–π ‚Äî **1 –∑–Ω–∞–∫**. UI –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å 1 –∑–Ω–∞–∫–æ–º. |
| 14 | –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî clamp –≤ 0; —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî warning, –Ω–æ –Ω–µ –±–ª–æ–∫. |
| 15 | –ö–æ–ª–æ–Ω–∫–∏ —Ç–∞–±–ª–∏—Ü –ª–∏—á–Ω–æ–π/–æ–±—â–µ–π **–∏–¥–µ–Ω—Ç–∏—á–Ω—ã** (44 –∫–æ–ª–æ–Ω–∫–∏, –≤–∫–ª—é—á–∞—è actions). |
| 16 | –ú–æ–±–∏–ª—å–Ω—ã–π UX: –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª + sticky –∫–æ–ª–æ–Ω–∫–∞ ¬´–ù–∞–∑–≤–∞–Ω–∏–µ¬ª –∏ ¬´–î–µ–π—Å—Ç–≤–∏—è¬ª. |
| 17 | –î–µ—Ñ–æ–ª—Ç‚Äë—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: `COALESCE(updated_at, created_at) DESC`, —Ä—É—á–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ. |
| 18 | –ì—Ä—É–ø–ø‚Äë–∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫–æ–ª–æ–Ω–æ–∫ (–º–∞–∫—Ä–æ/—Ñ—ç—Ç—ã/–≤–∏—Ç/–º–∏–Ω/—Ñ–ª–∞–≥–∏) ‚Äî –≤–∫–ª—é—á–∏—Ç—å –∫–∞–∫ UX‚Äë—É–ª—É—á—à–µ–Ω–∏–µ. |
| 19 | –ï–¥–∏–Ω—ã–π `isCurator()` —Å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º: curator token **–∏–ª–∏** `HEYS.cloud.role in ['admin','curator']`. |
| 20 | –†–æ–ª–∏: `admin` (–ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø), `curator` (—É–ø—Ä–∞–≤–ª—è–µ—Ç shared), `moderator` (–º–æ–¥–µ—Ä–∞—Ü–∏—è), `user` (read‚Äëonly shared). |
| 21 | Multi‚Äëcurator: shared ‚Äî –≥–ª–æ–±–∞–ª—å–Ω–∞—è –±–∞–∑–∞, –Ω–æ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–∏ —Å—Ç—Ä–æ–≥–æ –ø–æ —Ä–æ–ª–∏/RLS. |
| 22 | –ü–æ–ª–µ –∫–ª–æ–Ω–∞: **—Ç–æ–ª—å–∫–æ** `shared_origin_id` + `cloned_at` + `shared_updated_at`. –ù–æ–≤–æ–µ –ø–æ–ª–µ –Ω–µ –≤–≤–æ–¥–∏–º. |
| 23 | –ö–æ–Ω—Ñ–ª–∏–∫—Ç –∏–º—ë–Ω –ø—Ä–∏ –∫–ª–æ–Ω–µ: –¥–æ–±–∞–≤–ª—è–µ–º —Å—É—Ñ—Ñ–∏–∫—Å ¬´(–∫–æ–ø–∏—è)¬ª, merge –ø–æ –∏–º–µ–Ω–∏ **–Ω–µ –¥–µ–ª–∞–µ–º**. |
| 24 | –ü–æ—Ä—Ü–∏–∏ –ø—Ä–∏ –∫–ª–æ–Ω–µ: deep‚Äëcopy –±–µ–∑ —Å—Å—ã–ª–æ–∫. |
| 25 | –§–ª–æ—É –∫–ª–∏–µ–Ω—Ç–∞: `create_pending_product_by_session` ‚Üí –º–æ–¥–µ—Ä–∞—Ü–∏—è ‚Üí publish. |
| 26 | `omega3_100/omega6_100` ‚Äî —Å—Ç—Ä–æ–≥–æ snake_case; –≤ UI –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –∫–∞–∫ Œ©3/Œ©6. |
| 27 | –í–∏—Ç–∞–º–∏–Ω—ã –≥—Ä—É–ø–ø—ã B: B1, B2, B3, B6, B9, B12. |
| 28 | –ú–∏–Ω–µ—Ä–∞–ª—ã: calcium, iron, magnesium, phosphorus, potassium, zinc, selenium, iodine. |
| 29 | –ï–¥–∏–Ω–∏—Ü—ã: –º–∞–∫—Ä–æ—Å—ã –≥/100–≥; sodium ‚Äî –º–≥/100–≥; omega ‚Äî –≥/100–≥; vitamins/minerals ‚Äî %DV; NOVA 1‚Äì4; ND 0‚Äì100. |
| 30 | –°—Ç–∞—Ä—ã–µ –∫–ª–æ–Ω—ã –±–µ–∑ `shared_origin_id` —Å—á–∏—Ç–∞–µ–º **–ª–æ–∫–∞–ª—å–Ω—ã–º–∏** –∏ –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º. |
| 31 | Legacy –±–µ–∑ extended: –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º –≤ `null` –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º ¬´‚Äî¬ª, –±–µ–∑ –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è. |
| 32 | Orphan‚Äë–ø—Ä–æ–¥—É–∫—Ç—ã: –Ω–µ —Ç—Ä–æ–≥–∞–µ–º, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã. |
| 33 | Shared –º–∞—Å—à—Ç–∞–±: –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º 30k+; UI –æ–±—è–∑–∞–Ω —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π/–ø–æ–∏—Å–∫–æ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. |
| 34 | –ü–∞–≥–∏–Ω–∞—Ü–∏—è shared ‚Äî —Å–µ—Ä–≤–µ—Ä–Ω–∞—è: `limit/offset` (–∏–ª–∏ cursor), UI –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç –ø–∞—Ä—Ç–∏—è–º–∏. |
| 35 | –ü–æ–∏—Å–∫ shared ‚Äî —Å–µ—Ä–≤–µ—Ä–Ω—ã–π; –ø–æ–∏—Å–∫ personal ‚Äî –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π. |
| 36 | –¢–µ—Å—Ç‚Äë–∫–æ–Ω—Ç—É—Ä: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π API (`API_PORT=4001`) –∏–ª–∏ staging –ë–î —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏. |
| 37 | Rollback: `pg_dump` + –≤—Ä–µ–º–µ–Ω–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞ –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π `kcal100`. |
| 38 | A/B testing **–Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è** –≤ —ç—Ç–æ–π –∑–∞–¥–∞—á–µ. |
| 39 | –ü—Ä–æ–¥—É–∫—Ç—ã –±–µ–∑ –º–∞–∫—Ä–æ—Å–æ–≤ –¥–æ–ø—É—Å—Ç–∏–º—ã: `kcal100=0`, –≤–∏—Ç–∞–º–∏–Ω—ã –æ—Å—Ç–∞—é—Ç—Å—è. |
| 40 | `protein100 > 100` –Ω–µ –∑–∞–ø—Ä–µ—â–∞–µ–º, –Ω–æ –ª–æ–≥–∏—Ä—É–µ–º warning. |
| 41 | –ê–ª–∫–æ–≥–æ–ª—å–Ω–∞—è –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è (–Ω–µ—Ç –ø–æ–ª—è) ‚Äî out of scope. |
| 42 | –†–µ—Ü–µ–ø—Ç—ã/–∫–æ–º–ø–æ–∑–∏—Ç—ã ‚Äî out of scope (–æ—Å—Ç–∞–µ—Ç—Å—è –ø–ª–æ—Å–∫–∞—è –º–æ–¥–µ–ª—å). |
| 43 | –ù–µ –ª–æ–º–∞–µ–º `heys_yesterday_verify_v1.js`: `kcal100` –æ—Å—Ç–∞—ë—Ç—Å—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º. |
| 44 | –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ extended‚Äë–ø–æ–ª—è –∏ `shared_origin_id`. |
| 45 | API‚Äë—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: —Å—Ö–µ–º—É `shared_products` –Ω–µ –ª–æ–º–∞–µ–º, –¥–æ–±–∞–≤–ª–µ–Ω–∏—è ‚Äî —Ç–æ–ª—å–∫–æ backward‚Äëcompatible. |
| 46 | –ú–æ–¥–µ—Ä–∞—Ü–∏—è shared: –∫–ª–∏–µ–Ω—Ç —Ç–æ–ª—å–∫–æ ¬´pending¬ª, –∫—É—Ä–∞—Ç–æ—Ä/–º–æ–¥–µ—Ä–∞—Ç–æ—Ä –ø—É–±–ª–∏–∫—É–µ—Ç/–æ—Ç–∫–ª–æ–Ω—è–µ—Ç. |
| 47 | –£–¥–∞–ª–µ–Ω–∏–µ shared **–Ω–µ** —É–¥–∞–ª—è–µ—Ç –∫–ª–æ–Ω—ã, —Ç–æ–ª—å–∫–æ –ø–æ–º–µ—Ç–∫–∞/–∏—Å—Ç–æ—Ä–∏—è. |
| 48 | –î–µ–¥—É–ø –≤ shared: fingerprint‚Äë–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ + merge‚Äë–º–æ–¥–∞–ª; –±–µ–∑ –∞–≤—Ç–æ‚Äë–º–µ—Ä–∂–∞ –≤ —Ñ–æ–Ω–µ. |
| 49 | –ü–µ—Ä–µ–¥ –ª—é–±–æ–π –º–∏–≥—Ä–∞—Ü–∏–µ–π ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π backup `shared_products`. |
| 50 | Downtime –Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è: –º–∏–≥—Ä–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –±–∞—Ç—á–∞–º–∏, –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ UI. |

### üîü –¢–û–ü‚Äë10 –±–ª–æ–∫–µ—Ä–æ–≤ (–µ—Å–ª–∏ –Ω–µ –∑–∞–∫—Ä—ã—Ç—ã ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–µ—â–µ–Ω–∞)

1. –§–æ—Ä–º—É–ª–∞ –∫–∞–ª–æ—Ä–∏–π ($3$ vs $4$) ‚Äî –∫–æ–Ω—Ñ–ª–∏–∫—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.
2. –ü—Ä–∞–≤–∞ UPDATE –Ω–∞ `shared_products`.
3. –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ 29 –ø–æ–ª–µ–π —Å —Ç–∏–ø–∞–º–∏.
4. –ï–¥–∏–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ `isCurator`.
5. –†–∞–∑–º–µ—Ä `shared_products` (–º–∞—Å—à—Ç–∞–±).
6. Backup/rollback –ø–ª–∞–Ω.
7. –ü–æ–ª–∏—Ç–∏–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ `kcal100`.
8. –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.
9. Test environment.
10. –ü–æ–ª–µ –∫–ª–æ–Ω–∞ (`shared_origin_id`) –∏ –ø–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –∫–ª–æ–Ω–æ–≤.

---

## üéØ WHY (–ë–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç)

**Problem**: –û–¥–∏–Ω –ø—Ä–æ–¥—É–∫—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –ª–∏—á–Ω–æ–π –∏ –æ–±—â–µ–π —Ç–∞–±–ª–∏—Ü–∞—Ö ‚Äî –ø–æ—Ç–µ—Ä—è –¥–æ–≤–µ—Ä–∏—è –∫ –¥–∞–Ω–Ω—ã–º.

**Impact**: –ö—É—Ä–∞—Ç–æ—Ä –≤–∏–¥–∏—Ç ¬´693 –∫–∫–∞–ª¬ª, –∫–ª–æ–Ω–∏—Ä—É–µ—Ç ‚Üí –≤–∏–¥–∏—Ç ¬´680 –∫–∫–∞–ª¬ª ‚Äî WTF?! –†—É—á–Ω—ã–µ –ø—Ä–∞–≤–∫–∏, –ø—É—Ç–∞–Ω–∏—Ü–∞.

**Value**: 
- –ò–¥–µ–Ω—Ç–∏—á–Ω—ã–π –≤—ã–≤–æ–¥ ‚Üí –¥–æ–≤–µ—Ä–∏–µ –∫ –¥–∞–Ω–Ω—ã–º
- –û–¥–∏–Ω –∫–æ–¥ —Ä–µ–Ω–¥–µ—Ä–∞ ‚Üí –º–µ–Ω—å—à–µ –±–∞–≥–æ–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —á–∏—Å—Ç–æ—Ç–∞ ‚Üí –ø—Ä–æ—â–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å

---

## ü§ñ Output Preferences

**Workflow**: Explain logic first ‚Üí —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—à–∞–≥–æ–≤–æ

**Code style**: Follow copilot-instructions.md, minimal changes, –±–µ–∑ –ø–µ—Ä–µ–µ–∑–¥–∞ legacy –≤ TS.

**–ü—Ä–∏–Ω—Ü–∏–ø**: ¬´Normalize Once, Render Anywhere¬ª ‚Äî –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ, —Ä–µ–Ω–¥–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–æ—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ.

---

## üöß –§–ê–ó–ê 0: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–±–ª–æ–∫–µ—Ä—ã)

> **–¶–µ–ª—å**: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–æ–Ω–∏–º–∞–µ–º –ø—Ä–æ–±–ª–µ–º—É –Ω–∞ 100% –∏ –Ω–µ —Å–ª–æ–º–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ.

### 0.1 –ê—É–¥–∏—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `normalizeSharedProduct()` –≤ `heys_cloud_shared_v1.js`
  - **–¢–µ–∫—É—â–µ–µ**: –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ `harm`, `gi`, `nova_group`
  - **–ù—É–∂–Ω–æ**: –≤—Å–µ extended –ø–æ–ª—è + `computeDerived()`
  - **Files**: `apps/web/heys_cloud_shared_v1.js:67-95`

- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `normalizeProductFields()` –≤ `heys_models_v1.js`
  - **–¢–µ–∫—É—â–µ–µ**: `harm`, `badFat100/goodFat100` case normalization
  - **–ù—É–∂–Ω–æ**: –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–ª–∏ —Ä–∞—Å—à–∏—Ä–∏—Ç—å
  - **Files**: `apps/web/heys_models_v1.js:572-586`

### 0.2 Mapping –ø–æ–ª–µ–π DB ‚Üí Local

| DB field (snake_case) | Local field (camelCase) | –°—Ç–∞—Ç—É—Å |
|-----------------------|-------------------------|--------|
| `protein100` | `protein100` | ‚úÖ OK |
| `badfat100` | `badFat100` | ‚ö†Ô∏è –ù—É–∂–µ–Ω mapping |
| `goodfat100` | `goodFat100` | ‚ö†Ô∏è –ù—É–∂–µ–Ω mapping |
| `nova_group` | `novaGroup` | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ –µ—Å—Ç—å |
| `sodium100` | `sodium100` | ‚úÖ OK |
| `omega3_100` | `omega3_100` | ‚úÖ OK |
| `nutrient_density` | `nutrientDensity` | ‚ö†Ô∏è –ù—É–∂–µ–Ω mapping |
| `is_organic` | `isOrganic` | ‚ö†Ô∏è –ù—É–∂–µ–Ω mapping |
| `is_whole_grain` | `isWholeGrain` | ‚ö†Ô∏è –ù—É–∂–µ–Ω mapping |
| `is_fermented` | `isFermented` | ‚ö†Ô∏è –ù—É–∂–µ–Ω mapping |
| `is_raw` | `isRaw` | ‚ö†Ô∏è –ù—É–∂–µ–Ω mapping |
| `vitamin_a` | `vitaminA` | ‚ö†Ô∏è –ù—É–∂–µ–Ω mapping |
| `vitamin_b1` | `vitaminB1` | ‚ö†Ô∏è –ù—É–∂–µ–Ω mapping |
| ... | ... | ... |

### 0.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

- [ ] `cloneSharedToPersonal()` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç shared –Ω–∞–ø—Ä—è–º—É—é, –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [ ] `getProductFromItem()` ‚Äî fallback –ª–æ–≥–∏–∫–∞ –¥–ª—è orphan-–ø—Ä–æ–¥—É–∫—Ç–æ–≤
- [ ] –ü–æ–∏—Å–∫ –≤ shared ‚Äî `searchSharedDebounced` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `allSharedProducts`

### 0.4 –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

- [ ] –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç-–ø—Ä–æ–¥—É–∫—Ç –≤ shared —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ extended –ø–æ–ª—è–º–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –æ–±–µ–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö
- [ ] –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å
- [ ] –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–ª–æ–Ω ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ shared –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è

### 0.5 SoT –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏–π (kcal100)

- [ ] –£—Ç–≤–µ—Ä–¥–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ: **–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç `kcal100` –∏–∑ –ë–î**, fallback –Ω–∞ `computeDerived()`
- [ ] –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤ JSDoc, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ —Ä–µ–≥—Ä–µ—Å—Å–∏–π

### 0.6 –ü–æ–ª–∏—Ç–∏–∫–∞ NULL/undefined –∏ —Ç—Ä–∏-—Å–æ—Å—Ç–æ—è–Ω–∏—è boolean

- [ ] –î–ª—è extended —á–∏—Å–ª–æ–≤—ã—Ö: `null/undefined ‚Üí '‚Äî'`
- [ ] –î–ª—è boolean: `null ‚Üí '‚Äî'`, `true ‚Üí '–¥–∞'`, `false ‚Üí '–Ω–µ—Ç'`
- [ ] –î–ª—è –±–∞–∑–æ–≤—ã—Ö –º–∞–∫—Ä–æ—Å–æ–≤: –≤—Å–µ–≥–¥–∞ —á–∏—Å–ª–æ (0 –∏–ª–∏ –≤—ã—á–∏—Å–ª–∏—Ç—å)

### 0.7 –ü—Ä–æ–≤–µ—Ä–∫–∞ API —Å—Ö–µ–º—ã

- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `get_shared_products` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–≤—Å–µ extended –ø–æ–ª—è (29 –∫–æ–ª–æ–Ω–æ–∫)**
- [ ] –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî —Ä–∞—Å—à–∏—Ä–∏—Ç—å SELECT –≤ RPC

### 0.8 –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ shared –ø–æ –¥–∞—Ç–µ

- [ ] SQL/JS fallback: `ORDER BY COALESCE(updated_at, created_at) DESC`
- [ ] –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ –∫–∞–∫ –¥–µ—Ñ–æ–ª—Ç –¥–ª—è shared-—Ç–∞–±–ª–∏—Ü—ã

### 0.9 –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ –ø–µ—Ä—Ñ–æ—Ä–º–∞–Ω—Å

- [ ] –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å **–æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞ –∑–∞–≥—Ä—É–∑–∫–µ**, –Ω–µ –≤ render-–ø—É—Ç–∏
- [ ] –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å, –≥–¥–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `normalizeSharedProduct()`

### 0.10 –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ `kcal100` + rollback

- [ ] –ü–µ—Ä–µ–¥ –∞–ø–¥–µ–π—Ç–æ–º —Å–¥–µ–ª–∞—Ç—å `pg_dump` —Ç–∞–±–ª–∏—Ü—ã `shared_products`
- [ ] –í –º–∏–≥—Ä–∞—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ temp-–∫–æ–ª–æ–Ω–∫—É –¥–ª—è –æ—Ç–∫–∞—Ç–∞

### 0.11 –ü—Ä–∞–≤–∏–ª–∞ –∫–ª–æ–Ω–∞ (shared ‚Üí personal)

- [ ] –î–æ–±–∞–≤–ª—è—Ç—å —Å—É—Ñ—Ñ–∏–∫—Å –∏–º–µ–Ω–∏ `(–∫–æ–ø–∏—è)` –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ
- [ ] –î–µ–ª–∞—Ç—å deep clone –ø–æ—Ä—Ü–∏–π
- [ ] –•—Ä–∞–Ω–∏—Ç—å `clonedFromSharedId` (—Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö –∫–ª–æ–Ω–æ–≤)
- [ ] –£–¥–∞–ª–µ–Ω–∏–µ shared –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–ª–æ–Ω—ã

### 0.12 –ì–µ–π—Ç–∏–Ω–≥ shared-—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- [ ] Edit/Delete –≤ shared ‚Äî **—Ç–æ–ª—å–∫–æ –∫—É—Ä–∞—Ç–æ—Ä** (`isCurator === true`)
- [ ] –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ü–∏–π –≤ shared ‚Äî —Ç–æ–∂–µ —Ç–æ–ª—å–∫–æ –∫—É—Ä–∞—Ç–æ—Ä

---

## üìã WHAT (–ß–µ–∫-–ª–∏—Å—Ç –∑–∞–¥–∞—á)

### –§–∞–∑–∞ 1: –†–∞—Å—à–∏—Ä–∏—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é (Must Have)

- [ ] **1.1** `heys_cloud_shared_v1.js` ‚Üí —Ä–∞—Å—à–∏—Ä–∏—Ç—å `normalizeSharedProduct()`
  - **Why**: –í—Å–µ extended –ø–æ–ª—è + case mapping (`badfat100 ‚Üí badFat100` –∏ —Ç.–ø.)
  - **Acceptance**: –ü–æ–ª—è –∏–∑ mapping-—Ç–∞–±–ª–∏—Ü—ã –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã
  - **Files**: `apps/web/heys_cloud_shared_v1.js:67-95`

- [ ] **1.2** Defensive-normalize: try/catch –≤–Ω—É—Ç—Ä–∏ `.map()`
  - **Why**: –û–¥–∏–Ω –±–∏—Ç—ã–π –ø—Ä–æ–¥—É–∫—Ç –Ω–µ –¥–æ–ª–∂–µ–Ω –ª–æ–º–∞—Ç—å –º–∞—Å—Å–∏–≤
  - **Acceptance**: –ë–∏—Ç—ã–µ –∑–∞–ø–∏—Å–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –∏ –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è

- [ ] **1.3** –í–≤–µ—Å—Ç–∏ `normalizePersonalProduct()` –∏ –ø—Ä–∏–º–µ–Ω—è—Ç—å –≤ `loadProducts()`
  - **Why**: –õ–∏—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã —Ç–æ–∂–µ –º–æ–≥—É—Ç –±—ã—Ç—å –±–∏—Ç—ã–º–∏/—É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏
  - **Acceptance**: Personal/shared –ø—Ä–∏–≤–æ–¥—è—Ç—Å—è –∫ –æ–¥–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É

- [ ] **1.4** –ü—Ä–∏–º–µ–Ω–∏—Ç—å `computeDerived()` –∫ shared –ø–æ—Å–ª–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
  - **Why**: `kcal100`, `carbs100`, `fat100` –¥–æ–ª–∂–Ω—ã —Å—á–∏—Ç–∞—Ç—å—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤–æ
  - **Acceptance**: Shared –∫–∞–ª–æ—Ä–∏–∏ = –ª–∏—á–Ω—ã–µ –∫–∞–ª–æ—Ä–∏–∏ –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞
  - **Files**: `apps/web/heys_cloud_shared_v1.js` (after normalize)

- [ ] **1.5** –í `saveProduct()` –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å `kcal100`
  - **Why**: –ó–Ω–∞—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
  - **Acceptance**: `kcal100` –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ localStorage

- [ ] **1.6** –ú—è–≥–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ NaN-–∑–∞—â–∏—Ç–∞
  - **Why**: –ú–∞–∫—Ä–æ—Å—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏; UI –Ω–µ –¥–æ–ª–∂–µ–Ω –ø–∞–¥–∞—Ç—å
  - **Acceptance**: `>100` –¥–æ–ø—É—Å—Ç–∏–º–æ, `<0` –∏–ª–∏ `>1000` ‚Üí warn; `NaN` ‚Üí fallback `0`

### –§–∞–∑–∞ 2: –ï–¥–∏–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä —Å—Ç—Ä–æ–∫–∏ (Must Have)

- [ ] **2.1** –°–æ–∑–¥–∞—Ç—å `renderProductTableRow(product, options)` helper
  - **Why**: –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ —Ä–µ–Ω–¥–µ—Ä–∞ –¥–ª—è –æ–±–µ–∏—Ö —Ç–∞–±–ª–∏—Ü
  - **Options**: `{ mode: 'personal'|'shared', isCurator, onEdit, onDelete, ... }`
  - **Acceptance**: –û–¥–∏–Ω –∫–æ–¥, —Ä–∞–∑–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
  - **Files**: `apps/web/heys_core_v12.js` (–Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è)

- [ ] **2.2** –ó–∞–º–µ–Ω–∏—Ç—å inline-—Ä–µ–Ω–¥–µ—Ä –≤ –ª–∏—á–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –Ω–∞ `renderProductTableRow`
  - **Why**: –£–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
  - **Acceptance**: –õ–∏—á–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ
  - **Files**: `apps/web/heys_core_v12.js:2900-3000`

- [ ] **2.3** –ó–∞–º–µ–Ω–∏—Ç—å inline-—Ä–µ–Ω–¥–µ—Ä –≤ shared —Ç–∞–±–ª–∏—Ü–µ –Ω–∞ `renderProductTableRow`
  - **Why**: –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –≤—ã–≤–æ–¥–∞
  - **Acceptance**: Shared —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
  - **Files**: `apps/web/heys_core_v12.js:3100-3300`

- [ ] **2.4** –ë–∞–∑–æ–≤—ã–π –Ω–∞–±–æ—Ä –∫–æ–ª–æ–Ω–æ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  - **Why**: UX –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö, 40+ –∫–æ–ª–æ–Ω–æ–∫ –Ω–µ–ª—å–∑—è –¥–µ—Ä–∂–∞—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–º–∏
  - **Acceptance**: Default = –ò–º—è, –ö–∫–∞–ª, –ë/–ñ/–£, –ì–ò, Harm, NOVA

- [ ] **2.5** –ì–µ–π—Ç–∏–Ω–≥ –¥–µ–π—Å—Ç–≤–∏–π –≤ shared
  - **Why**: Shared read-only –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞
  - **Acceptance**: Edit/Delete –∏ –ø–æ—Ä—Ü–∏–∏ –≤ shared –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ `isCurator`

### –§–∞–∑–∞ 3: –û—á–∏—Å—Ç–∫–∞ (Should Have)

- [ ] **3.1** –£–¥–∞–ª–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ `safeNum()` –∏ inline-—Ä–∞—Å—á—ë—Ç—ã –≤ shared-—Ä–µ–Ω–¥–µ—Ä–µ
  - **Why**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  - **Acceptance**: –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–≥–∏–∫–∏

- [ ] **3.2** –î–æ–±–∞–≤–∏—Ç—å JSDoc –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–º –ø—Ä–∏–Ω—Ü–∏–ø–æ–º
  - **Why**: Prevent regression
  - **Content**: ¬´Normalize Once, Render Anywhere ‚Äî –ª–∏—á–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ = —ç—Ç–∞–ª–æ–Ω¬ª

### –§–∞–∑–∞ 4: UX —É–ª—É—á—à–µ–Ω–∏—è (Could Have)

- [ ] **4.1** Column toggle —Å –ø—Ä–µ—Å–µ—Ç–∞–º–∏ (–±–∞–∑–æ–≤—ã–π / —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π / –ø–æ–ª–Ω—ã–π)
  - **Why**: 40+ –∫–æ–ª–æ–Ω–æ–∫ ‚Äî UX-–∫–æ—à–º–∞—Ä –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
  - **Acceptance**: –ú–æ–∂–Ω–æ —Å–∫—Ä—ã—Ç—å –≤–∏—Ç–∞–º–∏–Ω—ã/–º–∏–Ω–µ—Ä–∞–ª—ã

- [ ] **4.2** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è toggle
  - **Why**: –ù–µ —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å –≤—ã–±–æ—Ä –ø–æ—Å–ª–µ reload
  - **Acceptance**: `localStorage: heys_product_table_view = 'basic'|'extended'`

- [ ] **4.3** Diff-highlighting –¥–ª—è –∫–ª–æ–Ω–æ–≤
  - **Why**: –ü–æ–∫–∞–∑–∞—Ç—å –µ—Å–ª–∏ shared –æ–±–Ω–æ–≤–∏–ª—Å—è –ø–æ—Å–ª–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
  - **Acceptance**: –ë–µ–π–¥–∂ üîÑ —Å popup ¬´–û–±–Ω–æ–≤–ª–µ–Ω–æ –≤ –æ–±—â–µ–π –±–∞–∑–µ¬ª
  - **Note**: –¢–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö –∫–ª–æ–Ω–æ–≤ (—Å—Ç–∞—Ä—ã–µ –±–µ–∑ `clonedFromSharedId`)

---

## ‚úÖ DONE (–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏)

### Functional

- [ ] **–ò–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å**: ¬´–£—Ä–±–µ—á¬ª –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 680 –∫–∫–∞–ª –≤ –û–ë–ï–ò–• —Ç–∞–±–ª–∏—Ü–∞—Ö
- [ ] **Extended nutrients**: Na, Œ©3, Œ©6, NOVA, ND, –≤–∏—Ç–∞–º–∏–Ω—ã ‚Äî –∏–¥–µ–Ω—Ç–∏—á–Ω—ã
- [ ] **–§–ª–∞–≥–∏**: `is_raw` = ¬´–¥–∞¬ª –≤ –æ–±–µ–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö (–µ—Å–ª–∏ true –≤ –ë–î)
- [ ] **Edge cases**: NULL ‚Üí ¬´‚Äî¬ª, undefined ‚Üí ¬´‚Äî¬ª
- [ ] **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: `cloneSharedToPersonal()` —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞**: shared –ø–æ `COALESCE(updated_at, created_at) DESC`
- [ ] **–ì–µ–π—Ç–∏–Ω–≥**: shared edit/delete –∏ –ø–æ—Ä—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –∫—É—Ä–∞—Ç–æ—Ä—É

### Quality Gates

- [ ] **Testing Strategy**:
  - **How**: Manual browser test + console.log —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
  - **Where**: localhost:3001
  - **Edge cases**: –ø—Ä–æ–¥—É–∫—Ç –±–µ–∑ extended –ø–æ–ª–µ–π, –ø—Ä–æ–¥—É–∫—Ç —Å NULL, –Ω–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç

- [ ] **Regression**: –õ–∏—á–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ
- [ ] **Performance**: –ù–µ—Ç –∑–∞–º–µ—Ç–Ω–æ–π –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ shared

### Technical

- [ ] `pnpm type-check` PASS
- [ ] `pnpm lint` PASS  
- [ ] `pnpm build` PASS
- [ ] –ù–µ—Ç console.error –≤ –±—Ä–∞—É–∑–µ—Ä–µ

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –ß—Ç–æ –º–µ–Ω—è–µ–º |
|------|------------|
| `apps/web/heys_cloud_shared_v1.js` | `normalizeSharedProduct()` + apply `computeDerived` |
| `apps/web/heys_core_v12.js` | `renderProductTableRow()` + —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü |
| `apps/web/heys_models_v1.js` | –í–æ–∑–º–æ–∂–Ω–æ: —Ä–∞—Å—à–∏—Ä–∏—Ç—å `normalizeProductFields()` |

---

## üìù Notes

- **Priority**: high
- **Complexity**: M-L (–∏–∑-–∑–∞ –æ–±—ä—ë–º–∞ —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏)
- **Blockers**: –§–∞–∑–∞ 0 –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º
- **Risk**: –ü–æ–ª–æ–º–∫–∞ `cloneSharedToPersonal()` ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã
- **Created**: 2026-01-27
## ‚ùó –ó–∞–ø—Ä–µ—Ç –Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é

–ü–æ–∫–∞ **–ù–ï –Ω–∞—á–∏–Ω–∞—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é** ‚Äî —Ç–æ–ª—å–∫–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –ø—Ä–∞–≤–∫–∏ –ø—Ä–æ–º–ø—Ç–∞.