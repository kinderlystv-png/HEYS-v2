# üçû Smart Toast Recommendations ‚Äî –£–ª—É—á—à–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

> **–¶–µ–ª—å**: –†–∞—Å—à–∏—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–∏—Å—Ç–µ–º—É toast-–ø–æ–¥—Å–∫–∞–∑–æ–∫, –¥–æ–±–∞–≤–∏–≤ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ —É–ª—É—á—à–∏–≤ –ª–æ–≥–∏–∫—É —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.

**‚û°Ô∏è –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ**: [2025-11-29-advice-module.md](./2025-11-29-advice-module.md) ‚Äî –º–æ–¥—É–ª—å —Å–æ–≤–µ—Ç–æ–≤ —Å –ø–æ–ª–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π

---

## üìä –ü–û–õ–ù–´–ô –°–ü–ò–°–û–ö –î–û–°–¢–£–ü–ù–´–• –ü–ê–†–ê–ú–ï–¢–†–û–í

### –î–∞–Ω–Ω—ã–µ –¥–Ω—è (DayRecord)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|----------|
| `date` | string | –î–∞—Ç–∞ YYYY-MM-DD |
| `sleepStart`, `sleepEnd` | string | –í—Ä–µ–º—è —Å–Ω–∞ (HH:MM) |
| `sleepQuality` | number | –ö–∞—á–µ—Å—Ç–≤–æ —Å–Ω–∞ (1-5) |
| `sleepNote` | string | –ó–∞–º–µ—Ç–∫–∞ –æ —Å–Ω–µ |
| `weightMorning` | number | –£—Ç—Ä–µ–Ω–Ω–∏–π –≤–µ—Å (–∫–≥) |
| `deficitPct` | number | % –¥–µ—Ñ–∏—Ü–∏—Ç–∞ –∫–∞–ª–æ—Ä–∏–π |
| `steps` | number | –®–∞–≥–∏ |
| `householdMin` | number | –î–æ–º–∞—à–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–º–∏–Ω) |
| `dayScore` | number | –û—Ü–µ–Ω–∫–∞ –¥–Ω—è (1-10) |
| `moodAvg`, `wellbeingAvg`, `stressAvg` | number | –°—Ä–µ–¥–Ω–∏–µ –∑–∞ –¥–µ–Ω—å (1-5) |
| `dayComment` | string | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –¥–Ω—é |
| `waterMl` | number | –í–æ–¥–∞ (–º–ª) ‚úÖ |
| `meals` | Meal[] | –ü—Ä–∏—ë–º—ã –ø–∏—â–∏ |
| `trainings` | Training[] | –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (–¥–æ 3) |

### –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (Training)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `z[4]` | –ú–∏–Ω—É—Ç—ã –≤ –ø—É–ª—å—Å–æ–≤—ã—Ö –∑–æ–Ω–∞—Ö [z1, z2, z3, z4] |
| `time` | –í—Ä–µ–º—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ |
| `type` | –¢–∏–ø —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ |

### –ü—É–ª—å—Å–æ–≤—ã–µ –∑–æ–Ω—ã (heys_hr_zones)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `name` | –ù–∞–∑–≤–∞–Ω–∏–µ –∑–æ–Ω—ã |
| `hrFrom`, `hrTo` | –î–∏–∞–ø–∞–∑–æ–Ω –ø—É–ª—å—Å–∞ |
| `MET` | –ú–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–∏–π —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç |

### –ü—Ä–∏—ë–º—ã –ø–∏—â–∏ (Meal)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `id`, `name`, `time` | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–∏—ë–º–∞ |
| `mood`, `wellbeing`, `stress` | –°–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ (1-5) |
| `items` | –ü—Ä–æ–¥—É–∫—Ç—ã –≤ –ø—Ä–∏—ë–º–µ |

### –ü—Ä–æ–¥—É–∫—Ç –≤ –ø—Ä–∏—ë–º–µ (MealItem)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `id`, `product_id` | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã |
| `name` | –ù–∞–∑–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| `grams` | –ì—Ä–∞–º–º—ã |

### –ü—Ä–æ–¥—É–∫—Ç (Product)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `simple100`, `complex100` | –ü—Ä–æ—Å—Ç—ã–µ/—Å–ª–æ–∂–Ω—ã–µ —É–≥–ª–µ–≤–æ–¥—ã –Ω–∞ 100–≥ |
| `protein100` | –ë–µ–ª–æ–∫ –Ω–∞ 100–≥ |
| `badFat100`, `goodFat100`, `trans100` | –ñ–∏—Ä—ã –Ω–∞ 100–≥ |
| `fiber100` | –ö–ª–µ—Ç—á–∞—Ç–∫–∞ –Ω–∞ 100–≥ |
| `gi` | –ì–ª–∏–∫–µ–º–∏—á–µ—Å–∫–∏–π –∏–Ω–¥–µ–∫—Å |
| `harm` | –ò–Ω–¥–µ–∫—Å –≤—Ä–µ–¥–∞ |
| `carbs100`, `fat100`, `kcal100` | **–í—ã—á–∏—Å–ª—è–µ–º—ã–µ** |

### –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (heys_profile)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `firstName`, `lastName` | –ò–º—è |
| `gender` | '–ú—É–∂—Å–∫–æ–π'/'–ñ–µ–Ω—Å–∫–∏–π'/'–î—Ä—É–≥–æ–µ' |
| `weight`, `height`, `age` | –§–∏–∑. –¥–∞–Ω–Ω—ã–µ |
| `sleepHours` | –ù–æ—Ä–º–∞ —Å–Ω–∞ |
| `insulinWaveHours` | –ü–µ—Ä–∏–æ–¥ –∏–Ω—Å—É–ª–∏–Ω–æ–≤–æ–π –≤–æ–ª–Ω—ã |
| `deficitPctTarget` | –¶–µ–ª–µ–≤–æ–π % –¥–µ—Ñ–∏—Ü–∏—Ç–∞ |
| `stepsGoal` | –¶–µ–ª—å –ø–æ —à–∞–≥–∞–º |

### –ù–æ—Ä–º—ã –ø–∏—Ç–∞–Ω–∏—è (heys_norms) ‚Äî % –æ—Ç –∫–∞–ª–æ—Ä–∞–∂–∞
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `carbsPct`, `proteinPct` | % —É–≥–ª–µ–≤–æ–¥–æ–≤/–±–µ–ª–∫–∞ |
| `simpleCarbPct` | % –ø—Ä–æ—Å—Ç—ã—Ö –æ—Ç —É–≥–ª–µ–≤–æ–¥–æ–≤ |
| `badFatPct`, `superbadFatPct` | % –≤—Ä–µ–¥–Ω—ã—Ö/—Ç—Ä–∞–Ω—Å –∂–∏—Ä–æ–≤ |
| `fiberPct`, `giPct`, `harmPct` | –ö–ª–µ—Ç—á–∞—Ç–∫–∞, –ì–ò, –≤—Ä–µ–¥ |

### –í—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å—É–º–º—ã –¥–Ω—è (dayTot)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `kcal`, `carbs`, `simple`, `complex` | –ö–∞–ª–æ—Ä–∏–∏, —É–≥–ª–µ–≤–æ–¥—ã |
| `prot` ‚ö†Ô∏è | –ë–µ–ª–æ–∫ (–ù–ï protein!) |
| `fat`, `bad`, `good`, `trans` | –ñ–∏—Ä—ã |
| `fiber`, `gi`, `harm` | –ö–ª–µ—Ç—á–∞—Ç–∫–∞, –ì–ò, –≤—Ä–µ–¥ |

### –í—ã—á–∏—Å–ª—è–µ–º—ã–µ –Ω–æ—Ä–º—ã (normAbs)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `kcal`, `carbs`, `simple`, `complex` | –ù–æ—Ä–º—ã —É–≥–ª–µ–≤–æ–¥–æ–≤ |
| `prot` ‚ö†Ô∏è | –ù–æ—Ä–º–∞ –±–µ–ª–∫–∞ (–ù–ï protein!) |
| `fat`, `bad`, `good`, `trans` | –ù–æ—Ä–º—ã –∂–∏—Ä–æ–≤ |
| `fiber`, `gi`, `harm` | –ù–æ—Ä–º–∞ –∫–ª–µ—Ç—á–∞—Ç–∫–∏, –ì–ò, –≤—Ä–µ–¥–∞ |

### –ú–µ—Ç–∞–±–æ–ª–∏–∑–º (–≤—ã—á–∏—Å–ª—è–µ–º—ã–µ)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `BMR` | –ë–∞–∑–æ–≤—ã–π –º–µ—Ç–∞–±–æ–ª–∏–∑–º |
| `TDEE` | –û–±—â–∏–π —Ä–∞—Å—Ö–æ–¥ —ç–Ω–µ—Ä–≥–∏–∏ |
| `optimum` | –¶–µ–ª–µ–≤–æ–π –∫–∞–ª–æ—Ä–∞–∂ |
| `trainingKcal` | –ö–∞–ª–æ—Ä–∏–∏ –æ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ |
| `ratio` | –°—ä–µ–¥–µ–Ω–æ/–æ–ø—Ç–∏–º—É–º |

### Streak –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `currentStreak` | –î–Ω–µ–π –ø–æ–¥—Ä—è–¥ –≤ –Ω–æ—Ä–º–µ (75-115%) |
| `activeDays` | Map –¥–Ω–µ–π —Å ratio –∑–∞ –º–µ—Å—è—Ü |

---

## üìã –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –ß—Ç–æ –µ—Å—Ç—å | –ß—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å |
|------|----------|--------------|
| `apps/web/heys_day_v12.js` | `macroTip` useMemo (—Å—Ç—Ä–æ–∫–∏ 2653-2698) | –ù–æ–≤—ã–µ —É—Å–ª–æ–≤–∏—è, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è streak |
| `apps/web/heys_day_pickers.js` | `streakInfo` (—Å—Ç—Ä–æ–∫–∏ 62-85) | ‚Äî (–ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É) |
| `apps/web/styles/main.css` | `.macro-toast-*` (—Å—Ç—Ä–æ–∫–∏ 4860-4935) | `.macro-toast-achievement`, `.macro-toast-fiber`, `.macro-toast-tip` |

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ë–ê–ì –í –°–£–©–ï–°–¢–í–£–Æ–©–ï–ú –ö–û–î–ï (–∏—Å–ø—Ä–∞–≤–∏—Ç—å –ü–ï–†–í–´–ú!)

**–ü—Ä–æ–±–ª–µ–º–∞**: –í `macroTip` useMemo (—Å—Ç—Ä–æ–∫–∞ 2654) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `dayTot.protein` –∏ `normAbs.protein`, –Ω–æ –≤–æ –≤—Å—ë–º –æ—Å—Ç–∞–ª—å–Ω–æ–º –∫–æ–¥–µ –∫–ª—é—á–∏ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è `prot`:
- `dayTot.prot` ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–ª—é—á
- `normAbs.prot` ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–ª—é—á
- Dependencies useMemo (—Å—Ç—Ä–æ–∫–∞ 2698) —Ç–æ–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `dayTot.protein` ‚Äî –û–®–ò–ë–ö–ê!

**–°–ª–µ–¥—Å—Ç–≤–∏–µ**: `proteinPct` –≤—Å–µ–≥–¥–∞ = 0, –ø–æ—Ç–æ–º—É —á—Ç–æ `dayTot.protein` = undefined!

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã –∑–∞–º–µ–Ω–∏—Ç—å –≤ `macroTip`:
```javascript
// –ë–´–õ–û (–û–®–ò–ë–ö–ê!)
const proteinPct = (dayTot.protein || 0) / (normAbs.protein || 1);

// –°–¢–ê–õ–û (–ü–†–ê–í–ò–õ–¨–ù–û)
const proteinPct = (dayTot.prot || 0) / (normAbs.prot || 1);
```

–ò –≤ dependencies useMemo:
```javascript
// –ë–´–õ–û
}, [dayTot.protein, dayTot.fat, ...]);

// –°–¢–ê–õ–û
}, [dayTot.prot, dayTot.fat, ...]);
```

---

## ‚úÖ –£–ñ–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û (–Ω–µ —Ç—Ä–æ–≥–∞—Ç—å):

- ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è: –ø—Ä–æ—Å—Ç—ã–µ —É–≥–ª–µ–≤–æ–¥—ã >50%, –≤—Ä–µ–¥–Ω—ã–µ –∂–∏—Ä—ã >40%
- ü•©ü•ëüçû –°–æ–≤–µ—Ç—ã –ø–æ –ë–ñ–£ –ø—Ä–∏ –¥–µ—Ñ–∏—Ü–∏—Ç–µ <50%
- ‚úÖ –ü–æ—Ö–≤–∞–ª–∞ –ø—Ä–∏ –≤—Å–µ—Ö –º–∞–∫—Ä–æ—Å–∞—Ö ‚â•80%
- Dismiss –ø–æ –∫–ª–∏–∫—É, auto-hide 7.5 —Å–µ–∫
- Dark theme —Å—Ç–∏–ª–∏
- –ê–Ω–∏–º–∞—Ü–∏—è slide-up —Å bounce

---

## üéØ –ó–∞–¥–∞—á–∏ —É–ª—É—á—à–µ–Ω–∏—è

### –ó–∞–¥–∞—á–∞ 1: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∫–ª–µ—Ç—á–∞—Ç–∫–∏

**–ì–¥–µ**: `macroTip` useMemo, –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Ä–µ–¥–Ω—ã—Ö –∂–∏—Ä–æ–≤, –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ë–ñ–£

**–£—Å–ª–æ–≤–∏–µ**: –ö–ª–µ—Ç—á–∞—Ç–∫–∞ <50% –æ—Ç –Ω–æ—Ä–º—ã –ò —É–∂–µ —Å—ä–µ–¥–µ–Ω–æ >500 –∫–∫–∞–ª

```javascript
// –ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ badFatPct
const fiberPct = (dayTot.fiber || 0) / (normAbs.fiber || 25);
if (fiberPct < 0.5 && dayTot.kcal > 500) {
  return { icon: 'ü•¨', text: '–î–æ–±–∞–≤—å –∫–ª–µ—Ç—á–∞—Ç–∫–∏: –æ–≤–æ—â–∏, —Ñ—Ä—É–∫—Ç—ã, –∫–∞—à–∞', type: 'fiber' };
}
```

### –ó–∞–¥–∞—á–∞ 2: –ü–æ–¥—Å–∫–∞–∑–∫–∞ –æ –∫–∞–ª–æ—Ä–∏—è—Ö

**–ì–¥–µ**: –ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ë–ñ–£ –¥–µ—Ñ–∏—Ü–∏—Ç–æ–≤, –ø–µ—Ä–µ–¥ success

**–£—Å–ª–æ–≤–∏–µ**: –ö–∞–ª–æ—Ä–∏–∏ 80-95% –æ—Ç –Ω–æ—Ä–º—ã

```javascript
const kcalPct = (dayTot.kcal || 0) / optimum;
if (kcalPct >= 0.8 && kcalPct < 0.95) {
  const remaining = Math.round(optimum - dayTot.kcal);
  return { icon: 'üéØ', text: `–û—Å—Ç–∞–ª–æ—Å—å ${remaining} –∫–∫–∞–ª ‚Äî –∏–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –ø–µ—Ä–µ–∫—É—Å–∞`, type: 'tip' };
}
```

### –ó–∞–¥–∞—á–∞ 3: –í—ã—á–∏—Å–ª–∏—Ç—å streak –≤ DayTab

**–ì–¥–µ**: –í –Ω–∞—á–∞–ª–µ DayTab, –ø–æ—Å–ª–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è `activeDays`

**–ó–∞—á–µ–º**: `streakInfo` –∏–∑ DatePickerCompact –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –≤ DayTab

**‚úÖ –•–û–†–û–®–ê–Ø –ù–û–í–û–°–¢–¨**: `activeDays` —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ DayTab (—Å—Ç—Ä–æ–∫–∞ 1344) ‚Äî —ç—Ç–æ Map —Å ratio –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è! –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.

```javascript
// –ü–æ—Å–ª–µ const activeDays = useMemo(...) (—Å—Ç—Ä–æ–∫–∞ 1348)
// –í—ã—á–∏—Å–ª—è–µ–º streak –∏—Å–ø–æ–ª—å–∑—É—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π activeDays
const currentStreak = React.useMemo(() => {
  try {
    if (!activeDays || activeDays.size === 0) return 0;
    
    let count = 0;
    let checkDate = new Date();
    checkDate.setHours(12);
    
    for (let i = 0; i < 30; i++) {
      const dateStr = fmtDate(checkDate);
      const dayData = activeDays.get(dateStr);
      
      // –•–æ—Ä–æ—à–∏–π –¥–µ–Ω—å = ratio –æ—Ç 0.75 –¥–æ 1.15
      if (dayData && dayData.ratio >= 0.75 && dayData.ratio <= 1.15) {
        count++;
      } else if (i > 0) { // –ü–µ—Ä–≤—ã–π –¥–µ–Ω—å (—Å–µ–≥–æ–¥–Ω—è) –º–æ–∂–µ—Ç –±—ã—Ç—å –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö
        break;
      }
      
      checkDate.setDate(checkDate.getDate() - 1);
    }
    return count;
  } catch (e) {
    return 0;
  }
}, [activeDays, fmtDate]);
```

**‚ö†Ô∏è –û–ì–†–ê–ù–ò–ß–ï–ù–ò–ï**: `activeDays` —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü! –ï—Å–ª–∏ streak –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –≥—Ä–∞–Ω–∏—Ü—É –º–µ—Å—è—Ü–∞, –Ω—É–∂–Ω–æ –ª–∏–±–æ:
1. –†–∞—Å—à–∏—Ä–∏—Ç—å `getActiveDaysForMonth` —á—Ç–æ–±—ã –±—Ä–∞—Ç—å 2 –º–µ—Å—è—Ü–∞
2. –õ–∏–±–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å localStorage –Ω–∞–ø—Ä—è–º—É—é —Å –∫–ª—é—á–æ–º `heys_dayv2_` + dateStr

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ —á–µ—Ä–µ–∑ localStorage**:
```javascript
const currentStreak = React.useMemo(() => {
  try {
    let count = 0;
    let checkDate = new Date();
    checkDate.setHours(12);
    
    for (let i = 0; i < 30; i++) {
      const dateStr = fmtDate(checkDate);
      const dayData = lsGet('heys_dayv2_' + dateStr, null);
      
      if (dayData && dayData.meals && dayData.meals.length > 0) {
        // –í—ã—á–∏—Å–ª—è–µ–º –∫–∞–ª–æ—Ä–∏–∏ –∑–∞ –¥–µ–Ω—å
        let totalKcal = 0;
        (dayData.meals || []).forEach(meal => {
          (meal.items || []).forEach(item => {
            const grams = +item.grams || 0;
            const product = pIndex.get(item.product_id);
            if (product && grams > 0) {
              totalKcal += ((+product.kcal100 || 0) * grams / 100);
            }
          });
        });
        
        // –•–æ—Ä–æ—à–∏–π –¥–µ–Ω—å = 75-115% –æ—Ç optimum
        const ratio = totalKcal / (optimum || 1);
        if (ratio >= 0.75 && ratio <= 1.15) {
          count++;
        } else if (i > 0) break;
      } else if (i > 0) break;
      
      checkDate.setDate(checkDate.getDate() - 1);
    }
    return count;
  } catch (e) {
    return 0;
  }
}, [optimum, pIndex, fmtDate, lsGet]);
```

### –ó–∞–¥–∞—á–∞ 4: Toast –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

**–ì–¥–µ**: –í macroTip, –ü–ï–†–í–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ (–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

**–£—Å–ª–æ–≤–∏–µ**: streak ‚â•3 –¥–Ω—è –ò –ø–µ—Ä–≤—ã–π –ø–æ–∫–∞–∑ –∑–∞ —Å–µ—Å—Å–∏—é

```javascript
// –í —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ macroTip useMemo
// –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è ‚Äî –≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–∞–∑ –∑–∞ —Å–µ—Å—Å–∏—é
if (currentStreak >= 7 && !sessionStorage.getItem('heys_streak7')) {
  sessionStorage.setItem('heys_streak7', '1');
  return { icon: 'üèÜ', text: `–ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ! ${currentStreak} –¥–Ω–µ–π –≤ –Ω–æ—Ä–º–µ!`, type: 'achievement' };
}
if (currentStreak >= 3 && !sessionStorage.getItem('heys_streak3')) {
  sessionStorage.setItem('heys_streak3', '1');
  return { icon: 'üî•', text: `${currentStreak} –¥–Ω—è –ø–æ–¥—Ä—è–¥ –≤ –Ω–æ—Ä–º–µ! –¢–∞–∫ –¥–µ—Ä–∂–∞—Ç—å!`, type: 'achievement' };
}
```

### –ó–∞–¥–∞—á–∞ 5: –£–º–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–≥–ª—É–±–æ–∫–∞—è –ª–æ–≥–∏–∫–∞)

**–ì–¥–µ**: –í macroTip useMemo, –ø–æ—Å–ª–µ warnings, –ø–µ—Ä–µ–¥ –¥–µ—Ñ–∏—Ü–∏—Ç–∞–º–∏ –ë–ñ–£

#### 5.1 –ë–∞–ª–∞–Ω—Å –º–∞–∫—Ä–æ—Å–æ–≤ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥—Ä—É–≥ –¥—Ä—É–≥–∞

```javascript
// –ú–Ω–æ–≥–æ —É–≥–ª–µ–≤–æ–¥–æ–≤, –º–∞–ª–æ –±–µ–ª–∫–∞ ‚Üí –±—ã—Å—Ç—Ä—ã–π –≥–æ–ª–æ–¥
// –í–ê–ñ–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º proteinPct (—É–∂–µ –≤—ã—á–∏—Å–ª–µ–Ω –≤—ã—à–µ –∫–∞–∫ dayTot.prot / normAbs.prot)
if (carbsPct > 0.7 && proteinPct < 0.4) {
  return { icon: 'üçΩÔ∏è', text: '–£–≥–ª–µ–≤–æ–¥—ã –±–µ–∑ –±–µ–ª–∫–∞ = –±—ã—Å—Ç—Ä—ã–π –≥–æ–ª–æ–¥. –î–æ–±–∞–≤—å –±–µ–ª–æ–∫!', type: 'tip' };
}
// –ú–Ω–æ–≥–æ –∂–∏—Ä–æ–≤, –º–∞–ª–æ —É–≥–ª–µ–≤–æ–¥–æ–≤ ‚Üí –Ω–µ—Ç —ç–Ω–µ—Ä–≥–∏–∏
if (fatPct > 0.7 && carbsPct < 0.4) {
  return { icon: '‚ö°', text: '–î–ª—è —ç–Ω–µ—Ä–≥–∏–∏ –Ω—É–∂–Ω—ã —É–≥–ª–µ–≤–æ–¥—ã ‚Äî –ø–æ–ø—Ä–æ–±—É–π –∫–∞—à—É', type: 'tip' };
}
```

#### 5.2 –ë–ª–∏–∑–æ—Å—Ç—å –∫ —Ü–µ–ª–∏ (–ø–µ—Ä–µ–±–æ—Ä)

```javascript
// –í—ã—á–∏—Å–ª—è–µ–º kcalPct –≤ –Ω–∞—á–∞–ª–µ macroTip (–¥–æ–±–∞–≤–∏—Ç—å —Ä—è–¥–æ–º —Å proteinPct)
const kcalPct = (dayTot.kcal || 0) / (optimum || 1);

// –ü–µ—Ä–µ–±–æ—Ä –∫–∞–ª–æ—Ä–∏–π
if (kcalPct >= 1.1 && kcalPct < 1.25) {
  return { icon: 'üìä', text: '–ù–µ–º–Ω–æ–≥–æ –ø–µ—Ä–µ–±–æ—Ä ‚Äî –∑–∞–≤—Ç—Ä–∞ —á—É—Ç—å –º–µ–Ω—å—à–µ, –∏ –≤—Å—ë –æ–∫ üòä', type: 'tip' };
}
if (kcalPct >= 1.25) {
  return { icon: '‚ö†Ô∏è', text: '–ü–µ—Ä–µ–±–æ—Ä –∫–∞–ª–æ—Ä–∏–π! –ó–∞–≤—Ç—Ä–∞ —Å–¥–µ–ª–∞–π —Ä–∞–∑–≥—Ä—É–∑–æ—á–Ω—ã–π –¥–µ–Ω—å', type: 'warning' };
}
```

#### 5.3 –í—ã—Å–æ–∫–∏–π —Å—Ä–µ–¥–Ω–∏–π –ì–ò

```javascript
// –í—ã—Å–æ–∫–∏–π —Å—Ä–µ–¥–Ω–∏–π –ì–ò –∑–∞ –¥–µ–Ω—å (–µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å)
const avgGI = dayTot.gi || 0;
if (avgGI > 70 && dayTot.kcal > 500) {
  return { icon: 'üìà', text: '–í—ã—Å–æ–∫–∏–π –ì–ò ‚Äî –∑–∞–º–µ–Ω–∏ –±—ã—Å—Ç—Ä—ã–µ —É–≥–ª–µ–≤–æ–¥—ã –Ω–∞ —Å–ª–æ–∂–Ω—ã–µ', type: 'warning' };
}
```

#### 5.4 –í—Ä–µ–º—è —Å—É—Ç–æ–∫ (–≤–µ—á–µ—Ä–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã–µ —É–≥–ª–µ–≤–æ–¥—ã)

```javascript
// –í–µ—á–µ—Ä (–ø–æ—Å–ª–µ 18:00) + –º–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—ã—Ö —É–≥–ª–µ–≤–æ–¥–æ–≤
const hour = new Date().getHours();
if (hour >= 18 && simplePct > 0.4 && simpleCarbs > 50) {
  return { icon: 'üåô', text: '–°–ª–∞–¥–∫–æ–µ –≤–µ—á–µ—Ä–æ–º ‚Üí –ø–ª–æ—Ö–æ–π —Å–æ–Ω. –õ—É—á—à–µ –±–µ–ª–æ–∫!', type: 'tip' };
}
```

#### 5.5 –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø—Ä–∏—ë–º–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```javascript
// –ï—Å–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–∏—ë–º ‚Äî —Å–ª–∞–¥–∫–æ–µ, –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –±–µ–ª–æ–∫
const lastMeal = (day.meals || []).slice(-1)[0];
if (lastMeal && lastMeal.items?.length > 0) {
  const lastMealTotals = M.mealTotals(lastMeal, pIndex);
  const lastMealSimplePct = (lastMealTotals.simple || 0) / ((lastMealTotals.carbs || 1));
  if (lastMealSimplePct > 0.6) {
    return { icon: 'ü•ú', text: '–ü–æ—Å–ª–µ —Å–ª–∞–¥–∫–æ–≥–æ –¥–æ–±–∞–≤—å –±–µ–ª–æ–∫ ‚Äî –æ—Ä–µ—Ö–∏ –∏–ª–∏ —Ç–≤–æ—Ä–æ–≥', type: 'tip' };
  }
}
```

#### 5.6 –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏ (meal distribution)

```javascript
// –û–¥–∏–Ω –±–æ–ª—å—à–æ–π –ø—Ä–∏—ë–º vs –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ–ª–∫–∏—Ö
const mealCount = (day.meals || []).filter(m => m.items?.length > 0).length;
if (mealCount === 1 && dayTot.kcal > 800) {
  return { icon: 'üçΩÔ∏è', text: '–õ—É—á—à–µ 3-4 –Ω–µ–±–æ–ª—å—à–∏—Ö –ø—Ä–∏—ë–º–∞ —á–µ–º 1 –±–æ–ª—å—à–æ–π', type: 'tip' };
}
```

#### 5.7 –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π –∑–∞–≤—Ç—Ä–∞–∫

```javascript
// –ï—Å–ª–∏ —Å–µ–π—á–∞—Å –ø–æ—Å–ª–µ 12:00 –∏ –µ—â—ë –Ω–µ—Ç –ø—Ä–∏—ë–º–æ–≤
const hour = new Date().getHours();
if (hour >= 12 && mealCount === 0) {
  return { icon: 'üåÖ', text: '–ó–∞–≤—Ç—Ä–∞–∫ –∑–∞–ø—É—Å–∫–∞–µ—Ç –º–µ—Ç–∞–±–æ–ª–∏–∑–º ‚Äî –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞–π!', type: 'tip' };
}
```

#### 5.8 –ö–æ–Ω—Ç–µ–∫—Å—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ)

```javascript
// –ï—Å–ª–∏ –±—ã–ª–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Å–µ–≥–æ–¥–Ω—è, –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –±–µ–ª–æ–∫
const TR = (day.trainings || []);
const hasTraining = TR.some(t => t.z && t.z.some(m => m > 0));
if (hasTraining && proteinPct < 0.6) {
  return { icon: 'üí™', text: '–ü–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –≤–∞–∂–µ–Ω –±–µ–ª–æ–∫ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è', type: 'tip' };
}
```

#### 5.9 –ö–æ–Ω—Ç–µ–∫—Å—Ç –≤–æ–¥—ã

```javascript
// ‚úÖ Water tracking —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω! day.waterMl —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
const waterMl = day.waterMl || 0;
const waterGoal = 2000; // 2–ª –Ω–æ—Ä–º–∞ (–∏–ª–∏ –≤–∑—è—Ç—å –∏–∑ profile –µ—Å–ª–∏ –µ—Å—Ç—å)
if (waterMl < waterGoal * 0.5 && hour >= 15) {
  return { icon: 'üíß', text: '–í—ã–ø–µ–π –≤–æ–¥—ã ‚Äî —Ç—ã –∑–∞ –ø–æ–ª–¥–Ω—è –Ω–∏–∂–µ 50% –Ω–æ—Ä–º—ã', type: 'tip' };
}
```

#### 5.10 –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Ä–∞—Ü–∏–æ–Ω–∞

```javascript
// –ï—Å–ª–∏ –≤—Å–µ –ø—Ä–∏—ë–º—ã –ø–æ—Ö–æ–∂–∏ (–æ–¥–∏–Ω –ø—Ä–æ–¥—É–∫—Ç –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –º–Ω–æ–≥–æ —Ä–∞–∑)
// ‚ö†Ô∏è –í–ê–ñ–ù–û: –ë–µ—Ä—ë–º –Ω–∞–∑–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ getProductFromItem, –Ω–µ —á–µ—Ä–µ–∑ it.name –Ω–∞–ø—Ä—è–º—É—é
const allItems = (day.meals || []).flatMap(m => m.items || []);
const productNames = allItems.map(it => {
  const product = getProductFromItem(it, pIndex);
  return (product?.name || it.name || '').toLowerCase().trim();
}).filter(Boolean);
const uniqueProducts = new Set(productNames).size;
if (productNames.length >= 5 && uniqueProducts < 3) {
  return { icon: 'üåà', text: '–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑—å —Ä–∞—Ü–∏–æ–Ω ‚Äî –¥–æ–±–∞–≤—å –¥—Ä—É–≥–∏–µ –ø—Ä–æ–¥—É–∫—Ç—ã', type: 'tip' };
}
```

#### 5.11 –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤

```javascript
// –ñ–µ–ª–µ–∑–æ + –≤–∏—Ç–∞–º–∏–Ω C = –ª—É—á—à–µ —É—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è
// –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ –∫–æ–≥–¥–∞ –±—É–¥—É—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ –º–∏–∫—Ä–æ—ç–ª–µ–º–µ–Ω—Ç–∞–º
```

#### 5.12 –°–µ–∑–æ–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```javascript
// –ó–∏–º–∞: –±–æ–ª—å—à–µ –≤–∏—Ç–∞–º–∏–Ω–∞ D
// –õ–µ—Ç–æ: –±–æ–ª—å—à–µ –≤–æ–¥—ã
const month = new Date().getMonth();
if ((month >= 10 || month <= 2) && !sessionStorage.getItem('heys_winter_tip')) {
  sessionStorage.setItem('heys_winter_tip', '1');
  return { icon: '‚ùÑÔ∏è', text: '–ó–∏–º–æ–π –≤–∞–∂–µ–Ω –≤–∏—Ç–∞–º–∏–Ω D ‚Äî —Ä—ã–±–∞, —è–π—Ü–∞, –≥—Ä–∏–±—ã', type: 'tip' };
}
```

#### 5.13 –ù–µ—Ç –æ–≤–æ—â–µ–π/—Ñ—Ä—É–∫—Ç–æ–≤ —Å–µ–≥–æ–¥–Ω—è

```javascript
// –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –æ–≤–æ—â–µ–π/—Ñ—Ä—É–∫—Ç–æ–≤ –≤ —Ä–∞—Ü–∏–æ–Ω–µ
// ‚ö†Ô∏è –í–ê–ñ–ù–û: MealItem –Ω–µ –∏–º–µ–µ—Ç –ø–æ–ª—è category! –ù—É–∂–Ω–æ –±—Ä–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ getProductFromItem
const allItems = (day.meals || []).flatMap(m => m.items || []);
const hasVeggies = allItems.some(it => {
  const product = getProductFromItem(it, pIndex);
  const name = product?.name || it.name || '';
  return /–æ–≤–æ—â|—Å–∞–ª–∞—Ç|–ø–æ–º–∏–¥–æ—Ä|–æ–≥—É—Ä–µ—Ü|–∫–∞–ø—É—Å—Ç–∞|–º–æ—Ä–∫–æ–≤—å|—è–±–ª–æ–∫|–±–∞–Ω–∞–Ω|–∞–ø–µ–ª—å—Å–∏–Ω|–≥—Ä—É—à–∞|—Å–≤—ë–∫–ª–∞|–±—Ä–æ–∫–∫–æ–ª–∏|—à–ø–∏–Ω–∞—Ç|–ª—É–∫|–ø–µ—Ä–µ—Ü|–∫–∞–±–∞—á–æ–∫|—Ç—ã–∫–≤–∞|–∑–µ–ª–µ–Ω—å|–ø–µ—Ç—Ä—É—à–∫–∞|—É–∫—Ä–æ–ø|—Å–µ–ª—å–¥–µ—Ä–µ–π/i.test(name);
});
if (!hasVeggies && dayTot.kcal > 800) {
  return { icon: 'ü•ó', text: '–î–æ–±–∞–≤—å –æ–≤–æ—â–∏ –∏–ª–∏ —Ñ—Ä—É–∫—Ç—ã ‚Äî –≤–∏—Ç–∞–º–∏–Ω—ã –∏ –∫–ª–µ—Ç—á–∞—Ç–∫–∞', type: 'tip' };
}
```

#### 5.14 –ë–æ–ª—å—à–æ–π –ø–µ—Ä–µ—Ä—ã–≤ –º–µ–∂–¥—É –ø—Ä–∏—ë–º–∞–º–∏

```javascript
// –ï—Å–ª–∏ —Å–µ–π—á–∞—Å –ø–æ—Å–ª–µ 14:00 –∏ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø—Ä–∏—ë–º –ø–∏—â–∏ ‚Äî –±–æ–ª—å—à–æ–π –ø–µ—Ä–µ—Ä—ã–≤
const hour = new Date().getHours();
if (hour >= 14 && mealCount === 1 && dayTot.kcal > 300) {
  return { icon: '‚è∞', text: '–ë–æ–ª—å—à–∏–µ –ø–µ—Ä–µ—Ä—ã–≤—ã –∑–∞–º–µ–¥–ª—è—é—Ç –º–µ—Ç–∞–±–æ–ª–∏–∑–º ‚Äî –ø–µ—Ä–µ–∫—É—Å–∏!', type: 'tip' };
}
```

#### 5.15 –ú–∞–ª–æ –±–µ–ª–∫–∞ –Ω–∞ –∑–∞–≤—Ç—Ä–∞–∫

```javascript
// –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–≤—ã–π –ø—Ä–∏—ë–º –ø–∏—â–∏ –Ω–∞ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –±–µ–ª–∫–∞
// –í–ê–ñ–ù–û: –∫–ª—é—á prot, –Ω–µ protein (—Å–º. M.mealTotals)
const breakfastMeal = (day.meals || [])[0];
if (breakfastMeal && breakfastMeal.items?.length > 0) {
  const breakfastTotals = M.mealTotals ? M.mealTotals(breakfastMeal, pIndex) : {};
  if ((breakfastTotals.prot || 0) < 10 && (breakfastTotals.kcal || 0) > 200) {
    return { icon: 'ü•ö', text: '–ë–µ–ª–æ–∫ –Ω–∞ –∑–∞–≤—Ç—Ä–∞–∫ = —Å—ã—Ç–æ—Å—Ç—å –¥–æ –æ–±–µ–¥–∞. –î–æ–±–∞–≤—å —è–π—Ü–∞/—Ç–≤–æ—Ä–æ–≥', type: 'tip' };
  }
}
```

#### 5.16 –ò–¥–µ–∞–ª—å–Ω—ã–π –¥–µ–Ω—å (–±–ª–∏–∑–∫–æ –∫ 100% –ø–æ –≤—Å–µ–º –º–∞–∫—Ä–æ—Å–∞–º)

```javascript
// –ï—Å–ª–∏ –≤—Å–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –±–ª–∏–∑–∫–∏ –∫ –∏–¥–µ–∞–ª—É ‚Äî –ø–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!
// –í–ê–ñ–ù–û: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å proteinPct (—É–∂–µ –≤—ã—á–∏—Å–ª–µ–Ω –∫–∞–∫ dayTot.prot / normAbs.prot)
if (kcalPct >= 0.95 && kcalPct <= 1.05 && 
    proteinPct >= 0.9 && fatPct >= 0.9 && carbsPct >= 0.9) {
  return { icon: '‚≠ê', text: '–ò–¥–µ–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å! –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ üéâ', type: 'achievement' };
}
```

#### 5.17 –°–ª–∏—à–∫–æ–º –º–∞–ª–æ –∫–∞–ª–æ—Ä–∏–π (–≥–æ–ª–æ–¥–∞–Ω–∏–µ)

```javascript
// –í–µ—á–µ—Ä + –æ—á–µ–Ω—å –º–∞–ª–æ –∫–∞–ª–æ—Ä–∏–π = –≤–æ–∑–º–æ–∂–Ω–æ –≥–æ–ª–æ–¥–∞–Ω–∏–µ
const hour = new Date().getHours();
if (hour >= 18 && dayTot.kcal < 500 && dayTot.kcal > 0) {
  return { icon: '‚ö†Ô∏è', text: '–°–ª–∏—à–∫–æ–º –º–∞–ª–æ –∫–∞–ª–æ—Ä–∏–π ‚Äî —ç—Ç–æ –≤—Ä–µ–¥–∏—Ç –º–µ—Ç–∞–±–æ–ª–∏–∑–º—É', type: 'warning' };
}
```

#### 5.18 –ü–µ—Ä–≤—ã–π –¥–µ–Ω—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

```javascript
// –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
if (mealCount === 1 && !localStorage.getItem('heys_first_meal_tip')) {
  localStorage.setItem('heys_first_meal_tip', '1');
  return { icon: 'üëã', text: '–û—Ç–ª–∏—á–Ω–æ–µ –Ω–∞—á–∞–ª–æ! –ó–∞–ø–∏—Å—ã–≤–∞–π –≤—Å—ë ‚Äî —ç—Ç–æ –∫–ª—é—á –∫ —É—Å–ø–µ—Ö—É', type: 'achievement' };
}
```

### –ó–∞–¥–∞—á–∞ 6: CSS –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤

**–ì–¥–µ**: –ü–æ—Å–ª–µ `.macro-toast-success` (—Å—Ç—Ä–æ–∫–∞ ~4925)

```css
/* Fiber - –∑–µ–ª—ë–Ω—ã–π */
.macro-toast-fiber {
  background: #ecfdf5;
  border: 1px solid #10b981;
}

/* Tip - —Å–∏–Ω–∏–π */
.macro-toast-tip {
  background: #eff6ff;
  border: 1px solid #3b82f6;
}

/* Achievement - –∑–æ–ª–æ—Ç–æ–π —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π */
.macro-toast-achievement {
  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
  border: 1px solid #f59e0b;
}

/* Dark theme */
[data-theme="dark"] .macro-toast-fiber {
  background: #064e3b;
  border-color: #059669;
}

[data-theme="dark"] .macro-toast-tip {
  background: #1e3a5f;
  border-color: #2563eb;
}

[data-theme="dark"] .macro-toast-achievement {
  background: linear-gradient(135deg, #78350f 0%, #92400e 100%);
  border-color: #d97706;
}
```

---

## ‚ú® WOW-—Ñ–∏—á–∏ (–ø—Ä–µ–º–∏–∞–ª—å–Ω—ã–π UX)

### –ó–∞–¥–∞—á–∞ 7: Progress bar (auto-hide –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä)

**–ì–¥–µ**: –î–æ–±–∞–≤–∏—Ç—å –≤ `.macro-toast` —Å—Ç—Ä—É–∫—Ç—É—Ä—É

**JS**: –î–æ–±–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞ –≤ toast

```javascript
// –í —Ä–µ–Ω–¥–µ—Ä–µ toast'–∞ –¥–æ–±–∞–≤–∏—Ç—å:
React.createElement('div', { className: 'macro-toast-progress' })
```

**CSS**:
```css
.macro-toast-progress {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 3px;
  background: currentColor;
  opacity: 0.3;
  border-radius: 0 0 12px 12px;
  animation: toast-progress 7.5s linear forwards;
}

@keyframes toast-progress {
  from { width: 100%; }
  to { width: 0%; }
}

/* –î–ª—è achievement ‚Äî –¥–æ–ª—å—à–µ */
.macro-toast-achievement .macro-toast-progress {
  animation-duration: 10s;
}
```

### –ó–∞–¥–∞—á–∞ 8: Swipe-to-dismiss (–º–æ–±–∏–ª—å–Ω—ã–π –∂–µ—Å—Ç)

**–ì–¥–µ**: –í DayTab, —Ä—è–¥–æ–º —Å dismissToast

**JS**: –î–æ–±–∞–≤–∏—Ç—å touch handlers –¥–ª—è toast

```javascript
// –°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —Å–≤–∞–π–ø–∞
const [toastSwipeX, setToastSwipeX] = useState(0);
const toastTouchStart = useRef(0);

const handleToastTouchStart = (e) => {
  toastTouchStart.current = e.touches[0].clientX;
};

const handleToastTouchMove = (e) => {
  const diff = e.touches[0].clientX - toastTouchStart.current;
  setToastSwipeX(diff);
};

const handleToastTouchEnd = () => {
  if (Math.abs(toastSwipeX) > 80) {
    dismissToast(); // –°–≤–∞–π–ø –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π ‚Äî –∑–∞–∫—Ä—ã—Ç—å
  }
  setToastSwipeX(0);
};

// –í —Ä–µ–Ω–¥–µ—Ä–µ toast'–∞:
// style: { transform: `translateX(${toastSwipeX}px)`, opacity: 1 - Math.abs(toastSwipeX) / 150 }
// onTouchStart, onTouchMove, onTouchEnd
```

**CSS**:
```css
.macro-toast {
  /* –î–æ–±–∞–≤–∏—Ç—å –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º */
  will-change: transform;
  touch-action: pan-x;
}

.macro-toast.swiping {
  transition: none; /* –£–±—Ä–∞—Ç—å transition –ø—Ä–∏ —Å–≤–∞–π–ø–µ */
}
```

### –ó–∞–¥–∞—á–∞ 9: –ê–Ω–∏–º–∞—Ü–∏–∏ –∏–∫–æ–Ω–æ–∫

**CSS**: –†–∞–∑–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤

```css
/* üî• –û–≥–æ–Ω—å ‚Äî –º–µ—Ä—Ü–∞–Ω–∏–µ */
.macro-toast-achievement .macro-toast-icon {
  animation: fire-flicker 0.5s ease-in-out infinite alternate;
}

@keyframes fire-flicker {
  0% { transform: scale(1) rotate(-2deg); filter: brightness(1); }
  100% { transform: scale(1.05) rotate(2deg); filter: brightness(1.1); }
}

/* ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ ‚Äî –ø—É–ª—å—Å */
.macro-toast-warning .macro-toast-icon {
  animation: warning-pulse 1s ease-in-out infinite;
}

@keyframes warning-pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

/* ‚úÖ –£—Å–ø–µ—Ö ‚Äî –æ–¥–∏–Ω —Ä–∞–∑ bounce */
.macro-toast-success .macro-toast-icon {
  animation: success-bounce 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes success-bounce {
  0% { transform: scale(0); }
  50% { transform: scale(1.2); }
  100% { transform: scale(1); }
}

/* üéØ Tip ‚Äî –ª–µ–≥–∫–æ–µ –ø–æ–∫–∞—á–∏–≤–∞–Ω–∏–µ */
.macro-toast-tip .macro-toast-icon {
  animation: tip-wobble 0.5s ease-in-out;
}

@keyframes tip-wobble {
  0%, 100% { transform: rotate(0); }
  25% { transform: rotate(-10deg); }
  75% { transform: rotate(10deg); }
}

/* ü•¨ Fiber ‚Äî bounce –ø–æ—è–≤–ª–µ–Ω–∏–µ */
.macro-toast-fiber .macro-toast-icon {
  animation: success-bounce 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}
```

---

## üìä –ò—Ç–æ–≥–æ–≤—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–ø–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫)

1. **Achievement** ‚Äî streak ‚â•3 (—Ä–∞–∑ –∑–∞ —Å–µ—Å—Å–∏—é)
2. **First day** ‚Äî –ø–µ—Ä–≤—ã–π –¥–µ–Ω—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ (—Ä–∞–∑ –Ω–∞–≤—Å–µ–≥–¥–∞)
3. **Warning** ‚Äî –ø—Ä–æ—Å—Ç—ã–µ —É–≥–ª–µ–≤–æ–¥—ã / –≤—Ä–µ–¥–Ω—ã–µ –∂–∏—Ä—ã / –≤—ã—Å–æ–∫–∏–π –ì–ò / –ø–µ—Ä–µ–±–æ—Ä –∫–∞–ª–æ—Ä–∏–π / –º–∞–ª–æ –∫–∞–ª–æ—Ä–∏–π
4. **Fiber** ‚Äî –º–∞–ª–æ –∫–ª–µ—Ç—á–∞—Ç–∫–∏
5. **Veggies** ‚Äî –Ω–µ—Ç –æ–≤–æ—â–µ–π/—Ñ—Ä—É–∫—Ç–æ–≤
6. **Balance** ‚Äî –¥–∏—Å–±–∞–ª–∞–Ω—Å –º–∞–∫—Ä–æ—Å–æ–≤ (—É–≥–ª–µ–≤–æ–¥—ã –±–µ–∑ –±–µ–ª–∫–∞ –∏ —Ç.–¥.)
7. **Breakfast protein** ‚Äî –º–∞–ª–æ –±–µ–ª–∫–∞ –Ω–∞ –∑–∞–≤—Ç—Ä–∞–∫
8. **Time context** ‚Äî –≤–µ—á–µ—Ä–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã–µ —É–≥–ª–µ–≤–æ–¥—ã / –±–æ–ª—å—à–æ–π –ø–µ—Ä–µ—Ä—ã–≤
9. **Last meal** ‚Äî –ø–æ—Å–ª–µ —Å–ª–∞–¥–∫–æ–≥–æ ‚Üí –¥–æ–±–∞–≤—å –±–µ–ª–æ–∫
10. **Protein/Fat/Carbs** ‚Äî –¥–µ—Ñ–∏—Ü–∏—Ç –º–∞–∫—Ä–æ—Å–∞ <50%
11. **Tip** ‚Äî –æ—Å—Ç–∞–ª–æ—Å—å –Ω–µ–º–Ω–æ–≥–æ –∫–∞–ª–æ—Ä–∏–π / –Ω–µ–±–æ–ª—å—à–æ–π –ø–µ—Ä–µ–±–æ—Ä
12. **Ideal day** ‚Äî –∏–¥–µ–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å ‚≠ê
13. **Success** ‚Äî –≤—Å—ë ‚â•80%

> Early return –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

---

## üö´ –ù–ï –î–ï–õ–ê–¢–¨ (–æ–≤–µ—Ä–∫–∏–ª–ª):

- ‚ùå ~~–°–æ–∑–¥–∞–≤–∞—Ç—å ToastEngine –∫–ª–∞—Å—Å~~ ‚Üí —Å–º. [advice-module.md](./2025-11-29-advice-module.md)
- ‚ùå –î–æ–±–∞–≤–ª—è—Ç—å confetti
- ‚ùå –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è —Å –∏–º–µ–Ω–µ–º
- ‚ùå Haptic feedback (–µ—Å—Ç—å –≤ pull-to-refresh, –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å)
- ‚ùå –ú–µ–Ω—è—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ª–æ–≥–∏–∫—É ‚Äî —Ç–æ–ª—å–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ–º

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ü–æ–ª–Ω–∞—è –º–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–æ–≤–µ—Ç–æ–≤ ‚Äî –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–æ–º–ø—Ç–µ. –ó–¥–µ—Å—å –¥–µ–ª–∞–µ–º –±—ã—Å—Ç—Ä—ã–µ —É–ª—É—á—à–µ–Ω–∏—è macroTip.

---

## ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–∏—Å–∫–∏

1. **daysDataMap –º–æ–∂–µ—Ç –±—ã—Ç—å undefined** ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
2. **sessionStorage –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –≤ SSR** ‚Äî –æ–±–µ—Ä–Ω—É—Ç—å –≤ try/catch –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É
3. **–°–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã–µ toast'—ã** ‚Äî streak –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ä–∞–∑ –∑–∞ —Å–µ—Å—Å–∏—é, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∏ —Å–º–µ–Ω–µ –¥–∞–Ω–Ω—ã—Ö
4. **–ú–Ω–æ–≥–æ —É—Å–ª–æ–≤–∏–π** ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥–æ–µ –æ—Ç–¥–µ–ª—å–Ω–æ

---

## üîç –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ê–£–î–ò–¢–ê

### üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (–ª–æ–º–∞—é—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª)

- [x] **–ë–∞–≥ prot/protein** ‚Äî `dayTot.protein` ‚Üí –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `dayTot.prot` (—Å–º. —Å–µ–∫—Ü–∏—é –≤—ã—à–µ)
- [x] **breakfastTotals.protein** ‚Üí –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `breakfastTotals.prot` (M.mealTotals –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `prot`)
- [x] **it.category –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç** ‚Äî MealItem –Ω–µ –∏–º–µ–µ—Ç –ø–æ–ª—è category (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ 5.13: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `getProductFromItem(it, pIndex).name`)

### üü° –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è (—É—á–µ—Å—Ç—å –ø—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)

1. **–ö–ª—é—á localStorage –¥–ª—è –¥–Ω–µ–π ‚Äî `heys_dayv2_`**, –∞ –ù–ï `heys_day_`! (—Å–º. heys_day_hooks.js —Å—Ç—Ä–æ–∫–∞ 17)

2. **`activeDays` —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ DayTab** (—Å—Ç—Ä–æ–∫–∞ 1344) ‚Äî —ç—Ç–æ Map —Å ratio –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è. –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è streak –≤–º–µ—Å—Ç–æ —Ä—É—á–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è localStorage. –ù–û: —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü!

3. **–ö–ª—é—á–∏ –¥–ª—è –Ω–æ—Ä–º—ã –∫–ª–µ—Ç—á–∞—Ç–∫–∏**: –í `normAbs` –∫–ª—é—á `fiber` –µ—Å—Ç—å (—Å—Ç—Ä–æ–∫–∞ 2142), –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –æ–Ω —Å—á–∏—Ç–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

4. **`day.waterMl` –†–ï–ê–õ–ò–ó–û–í–ê–ù** ‚Äî water tracking —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è 5.9 –∞–∫—Ç–∏–≤–Ω–∞

5. **`pIndex` –Ω—É–∂–µ–Ω –¥–ª—è mealTotals** ‚Äî –ü—Ä–∏ —Ä–∞—Å—á—ë—Ç–µ `breakfastTotals` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `M.mealTotals(breakfastMeal, pIndex)`

6. **–ü–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤–∞–∂–µ–Ω** ‚Äî Early return –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç. –ï—Å–ª–∏ –ø–æ—Å—Ç–∞–≤–∏—Ç—å streak –ø–æ—Å–ª–µ–¥–Ω–∏–º ‚Äî –æ–Ω –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–∫–∞–∂–µ—Ç—Å—è

7. **`lsGet` –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —Å–∫–æ—É–ø–µ DayTab** ‚Äî –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é (—Å—Ç—Ä–æ–∫–∞ 99)

8. **`getProductFromItem` –Ω—É–∂–µ–Ω –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–º–µ–Ω–∏ –ø—Ä–æ–¥—É–∫—Ç–∞** ‚Äî –í —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è—Ö 5.10 –∏ 5.13 –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ –¥–ª—è –ø–æ–∏—Å–∫–∞ –æ–≤–æ—â–µ–π/—Ñ—Ä—É–∫—Ç–æ–≤ –ø–æ –∏–º–µ–Ω–∏

9. **–ù–æ–º–µ—Ä–∞ —Å—Ç—Ä–æ–∫ –∞–∫—Ç—É–∞–ª—å–Ω—ã –Ω–∞ 2025-11-28** ‚Äî –ü–æ—Å–ª–µ –ø—Ä–∞–≤–æ–∫ –Ω–æ–º–µ—Ä–∞ —Å—Ç—Ä–æ–∫ –º–æ–≥—É—Ç —Å–º–µ—Å—Ç–∏—Ç—å—Å—è. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É

10. **`new Date().getHours()` –≤ useMemo** ‚Äî –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫ (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ 5.4, 5.7, 5.14, 5.17). –ü—Ä–∏ —Å–º–µ–Ω–µ —á–∞—Å–∞ toast –Ω–µ –ø–µ—Ä–µ—Å—á–∏—Ç–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚Äî —ç—Ç–æ –û–ö –¥–ª—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Ü–µ–ª–µ–π (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–±—ã—á–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ)

### üü¢ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∏ –û–ö

- ‚úÖ `day.trainings` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Å—Ç—Ä–æ–∫–∞ 339, 684)
- ‚úÖ `day.meals` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- ‚úÖ `optimum` –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —Å–∫–æ—É–ø–µ (—Å—Ç—Ä–æ–∫–∞ 347)
- ‚úÖ `normAbs.fiber` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Å—Ç—Ä–æ–∫–∞ 2142)
- ‚úÖ `fmtDate` –¥–æ—Å—Ç—É–ø–µ–Ω (—Å—Ç—Ä–æ–∫–∞ 20)
- ‚úÖ CSS `.macro-toast-*` —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è (—Å—Ç—Ä–æ–∫–∏ 4860-4935)
- ‚úÖ Toast —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (—Å—Ç—Ä–æ–∫–∞ 3321-3327)
- ‚úÖ `activeDays` Map –¥–æ—Å—Ç—É–ø–µ–Ω –≤ DayTab (—Å—Ç—Ä–æ–∫–∞ 1344)
- ‚úÖ `M.mealTotals` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{kcal, carbs, simple, complex, prot, fat, bad, good, trans, fiber}`
- ‚úÖ `getProductFromItem` –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ `M.getProductFromItem` –∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é (—Å—Ç—Ä–æ–∫–∞ 108 –≤ heys_models_v1.js)
- ‚úÖ `dayTot.gi` –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (—Å—Ç—Ä–æ–∫–∞ 2019) ‚Äî weighted average –ø–æ –≥—Ä–∞–º–º–∞–º

---

## ‚úÖ Definition of Done

- [ ] **–ü–ï–†–í–´–ú**: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –±–∞–≥ prot/protein –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º macroTip (—Å—Ç—Ä–æ–∫–∞ 2654 –∏ dependencies 2698)
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª–µ—Ç—á–∞—Ç–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞
- [ ] –£–º–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–±–∞–ª–∞–Ω—Å –º–∞–∫—Ä–æ—Å–æ–≤, –ø–µ—Ä–µ–±–æ—Ä, –ì–ò, –≤—Ä–µ–º—è, –∫–æ–Ω—Ç–µ–∫—Å—Ç)
- [ ] –ü–æ–¥—Å–∫–∞–∑–∫–∞ –∫–∞–ª–æ—Ä–∏–π –¥–æ–±–∞–≤–ª–µ–Ω–∞  
- [ ] Streak –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –≤ DayTab (—á–µ—Ä–µ–∑ activeDays Map –∏–ª–∏ localStorage —Å –∫–ª—é—á–æ–º `heys_dayv2_`)
- [ ] Achievement toast –¥–ª—è streak ‚â•3
- [ ] –ù–µ—Ç –æ–≤–æ—â–µ–π/—Ñ—Ä—É–∫—Ç–æ–≤ ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `getProductFromItem(it, pIndex).name`, –ù–ï `it.category`)
- [ ] –ë–æ–ª—å—à–æ–π –ø–µ—Ä–µ—Ä—ã–≤ –º–µ–∂–¥—É –ø—Ä–∏—ë–º–∞–º–∏ ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞
- [ ] –ú–∞–ª–æ –±–µ–ª–∫–∞ –Ω–∞ –∑–∞–≤—Ç—Ä–∞–∫ ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `prot`, –Ω–µ `protein`!)
- [ ] –ò–¥–µ–∞–ª—å–Ω—ã–π –¥–µ–Ω—å ‚Äî achievement –¥–æ–±–∞–≤–ª–µ–Ω
- [ ] –°–ª–∏—à–∫–æ–º –º–∞–ª–æ –∫–∞–ª–æ—Ä–∏–π ‚Äî warning –¥–æ–±–∞–≤–ª–µ–Ω
- [ ] –ü–µ—Ä–≤—ã–π –¥–µ–Ω—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ‚Äî –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ
- [ ] –ú–∞–ª–æ –≤–æ–¥—ã –ø–æ—Å–ª–µ 15:00 ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ (day.waterMl —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
- [ ] CSS –¥–ª—è fiber, tip, achievement
- [ ] Dark theme –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤
- [ ] Progress bar (auto-hide –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä)
- [ ] Swipe-to-dismiss –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
- [ ] –ê–Ω–∏–º–∞—Ü–∏–∏ –∏–∫–æ–Ω–æ–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞
- [ ] **Dependencies useMemo –æ–±–Ω–æ–≤–ª–µ–Ω—ã** (–¥–æ–±–∞–≤–∏—Ç—å kcalPct, currentStreak, day, etc.)
- [ ] –ù–µ—Ç —Ä–µ–≥—Ä–µ—Å—Å–∏–π –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö toast'–∞—Ö

---

## üìù –û–±–Ω–æ–≤–∏—Ç—å dependencies –≤ useMemo

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫, –æ–±–Ω–æ–≤–∏—Ç—å dependencies –º–∞—Å—Å–∏–≤:

```javascript
}, [
  // –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ (–ò–°–ü–†–ê–í–ò–¢–¨ prot –≤–º–µ—Å—Ç–æ protein!)
  dayTot.prot, dayTot.fat, dayTot.carbs, dayTot.simple, dayTot.complex, dayTot.bad, 
  normAbs.prot, normAbs.fat, normAbs.carbs,
  // –ù–æ–≤—ã–µ
  dayTot.kcal, dayTot.fiber, dayTot.gi,
  normAbs.fiber, optimum,
  currentStreak,
  day.meals, day.trainings, day.waterMl,
  pIndex
]);
```

---

**–í—Ä–µ–º—è**: ~60-70 –º–∏–Ω—É—Ç (–¥–æ–±–∞–≤–ª–µ–Ω–æ –≤—Ä–µ–º—è –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–∞)
**–°–ª–æ–∂–Ω–æ—Å—Ç—å**: –ù–∏–∑–∫–∞—è-–°—Ä–µ–¥–Ω—è—è (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ + WOW-—Ñ–∏—á–∏ + –±–∞–≥—Ñ–∏–∫—Å)
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è ‚Üí [2025-11-29-advice-module.md](./2025-11-29-advice-module.md)
