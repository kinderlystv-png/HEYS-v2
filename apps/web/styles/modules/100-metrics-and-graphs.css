/* Table of Contents
 * 01. METRICS CARDS (Hero Cards)
 * 02. KCAL SPARKLINE ‚Äî –≥—Ä–∞—Ñ–∏–∫ –∫–∞–ª–æ—Ä–∏–π (—Å—Ç–∏–ª—å –∫–∞–∫ –≤–µ—Å)
 * 03. SPARKLINE ‚Äî –º–∏–Ω–∏-–≥—Ä–∞—Ñ–∏–∫ –∫–∞–ª–æ—Ä–∏–π
 * 04. SPARKLINE POPUP ‚Äî –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ –ø—Ä–∏ —Ç–∞–ø–µ –Ω–∞ —Ç–æ—á–∫—É
 * 05. SPARKLINE POPUP V2 ‚Äî –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–π —Å metric-popup
 * 06. HEATMAP ‚Äî –º–∏–Ω–∏ –ø–æ–ª–æ—Å–∫–∞ –ø–æ–¥ –≥—Ä–∞—Ñ–∏–∫–æ–º
 * 07. MOOD-–ü–û–õ–û–°–ê ‚Äî –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–∞—è –ø–æ–ª–æ—Å–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è
 * 08. Slider Elements
 * 09. TODAY LINE ‚Äî –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è –Ω–∞ —Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å
 * 10. BRUSH SELECTION ‚Äî –≤—ã–¥–µ–ª–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
 * 11. SPARKLINE ANNOTATIONS ‚Äî –∏–∫–æ–Ω–∫–∏ —Å–æ–±—ã—Ç–∏–π –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ
 * 12. CORRELATION BLOCK ‚Äî —Å–≤—è–∑—å –∫–∞–ª–æ—Ä–∏–π –∏ –≤–µ—Å–∞
 * 13. Week Heatmap (compact)
 * 14. WEIGHT SPARKLINE ‚Äî –≥—Ä–∞—Ñ–∏–∫ –≤–µ—Å–∞ —Å —Ç—Ä–µ–Ω–¥–æ–º
 * 15. GOAL PROGRESS BAR (—Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–∞—Ç—É—Å-–±–∞—Ä)
 * 16. MACRO + WEIGHT ROW (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–æ–ª–µ—Ü –∏ –≤–µ—Å–∞)
 * 17. MACRO RINGS (–ë–ñ–£ –≤ —Å—Ç–∏–ª–µ Apple Watch)
 * 18. MACRO BADGE POPUP
 * 19. MACRO TIP ‚Äî —É–º–Ω–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ –ë–ñ–£
 * 20. WEIGHT CARD MODERN (—Å—Ç–∏–ª—å –∫–∞–∫ —É goal progress bar)
 * 21. DEFICIT CARD
 * 22. DEFICIT PICKER MODAL
 * 23. HOUSEHOLD (–ë—ã—Ç–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å) PICKER
 * 24. FORMULA CARD (–†–∞—Å—á—ë—Ç –∫–∞–ª–æ—Ä–∏–π)
 * 25. Training Rating Section (Step 3)
 * 26. WEIGHT PICKER MODAL
 * 27. FAB (Floating Action Button)
 * 28. MACRO TOAST ‚Äî –ø–æ–¥—Å–∫–∞–∑–∫–∞ –ë–ñ–£ —Å–Ω–∏–∑—É
 * 29. EXPANDABLE ADVICE TOAST
 * 30. PULL-TO-REFRESH (Modern Design)
 */

/* === 01. METRICS CARDS (Hero Cards) === */
.metrics-cards {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 8px;
  margin-top: 8px;
  margin-bottom: 8px;
}

.metrics-card {
  position: relative;
  min-width: 0;
  background: #f8fafc;
  border: 1px solid var(--color-slate-200);
  border-radius: 10px;
  padding: 8px 4px;
  text-align: center;
  transition: transform 0.15s ease, box-shadow 0.15s ease, background-color 0.3s ease, border-color 0.3s ease;
}

.metrics-icon {
  font-size: 16px;
  margin-bottom: 2px;
}

/* –ê–Ω–∏–º–∞—Ü–∏—è "–ø—Ä—ã–∂–∫–∞" –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ */
.metrics-value {
  font-size: 18px;
  font-weight: 700;
  line-height: 1.2;
  margin-bottom: 2px;
  transition:
    transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1),
    color 0.3s ease;
}

.metrics-card.value-changed .metrics-value {
  animation: valueBounce 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes valueBounce {
  0% { transform: scale(1); }
  50% { transform: scale(1.15); }
  100% { transform: scale(1); }
}

/* –í–∑–¥—Ä–∞–≥–∏–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ */
.metrics-card.saved {
  animation: cardPulse 0.4s ease;
}

.metrics-label {
  font-size: 9px;
  color: var(--color-slate-500);
  text-transform: uppercase;
  letter-spacing: 0.3px;
  font-weight: 500;
}

@keyframes cardPulse {
  0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.4); }
  50% { transform: scale(1.02); box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.2); }
  100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); }
}

/* üîî Shake –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –Ω–æ—Ä–º—ã */
.metrics-card.shake-excess {
  animation: shakeCard 0.5s ease-in-out;
}

@keyframes shakeCard {
  0%, 100% { transform: translateX(0); }
  10%, 30%, 50%, 70%, 90% { transform: translateX(-3px); }
  20%, 40%, 60%, 80% { transform: translateX(3px); }
}

/* === 02. KCAL SPARKLINE ‚Äî –≥—Ä–∞—Ñ–∏–∫ –∫–∞–ª–æ—Ä–∏–π (—Å—Ç–∏–ª—å –∫–∞–∫ –≤–µ—Å) === */
.kcal-sparkline-container {
  grid-column: 1 / -1;
  display: block;
  background: linear-gradient(135deg, #ecfdf5 0%, #dcfce7 100%);
  border: 1px solid #bbf7d0;
  border-radius: 12px;
  padding: 12px 12px 14px;
  padding-top: 24px; /* –º–µ—Å—Ç–æ –¥–ª—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π —Å–≤–µ—Ä—Ö—É */
  margin-top: 4px;
  overflow: visible; /* —á—Ç–æ–±—ã –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –Ω–µ –æ–±—Ä–µ–∑–∞–ª–∏—Å—å */
}

.kcal-sparkline-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.kcal-sparkline-title {
  font-size: 13px;
  font-weight: 600;
  color: #166534;
}

/* Header right: badge + pills */
.kcal-header-right {
  display: flex;
  align-items: center;
  gap: 8px;
}

/* Inline badge –≤ header */
.kcal-header-right .kcal-goal-badge-inline {
  position: static;
  top: auto;
  right: auto;
}

.kcal-goal-badge-inline {
  font-size: 10px;
  padding: 3px 8px;
}

.kcal-period-pills {
  display: flex;
  gap: 2px;
  background: rgba(34, 197, 94, 0.15);
  border-radius: 6px;
  padding: 2px;
}

.kcal-period-pill {
  font-size: 10px;
  font-weight: 600;
  padding: 3px 8px;
  border: none;
  border-radius: 5px;
  background: transparent;
  color: #166534;
  cursor: pointer;
  transition: all 0.2s ease;
}

.kcal-period-pill:active {
  transform: scale(0.95);
}

.kcal-period-pill.active {
  background: var(--color-white);
  color: #166534;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

/* === 03. SPARKLINE ‚Äî –º–∏–Ω–∏-–≥—Ä–∞—Ñ–∏–∫ –∫–∞–ª–æ—Ä–∏–π === */
.sparkline-container {
  display: block;
  position: relative; /* –¥–ª—è –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ç—É–ª—Ç–∏–ø–∞ */
  padding: 0;
  overflow: visible; /* —á—Ç–æ–±—ã —Ç—É–ª—Ç–∏–ø –Ω–µ –æ–±—Ä–µ–∑–∞–ª—Å—è */
}

.sparkline-label {
  font-size: 11px;
  font-weight: 500;
  color: var(--color-slate-500);
  white-space: nowrap;
}

.sparkline-svg {
  display: block;
  width: 100%;
  height: auto; /* –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ inline style */
  min-height: 100px;
  overflow: visible; /* —á—Ç–æ–±—ã –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –Ω–µ –æ–±—Ä–µ–∑–∞–ª–∏—Å—å */
}

.sparkline-area {
  opacity: 0.15;
}

.sparkline-line {
  fill: none;
  stroke: #22c55e;
  stroke-width: 3;
  stroke-linecap: round;
  stroke-linejoin: round;
  /* –ê–Ω–∏–º–∞—Ü–∏—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è –ª–∏–Ω–∏–∏ ‚Äî dasharray/offset –∑–∞–¥–∞—ë—Ç—Å—è inline –¥–ª—è —Ç–æ—á–Ω–æ–π –¥–ª–∏–Ω—ã */
  animation: drawSparkline 3s linear forwards;
  transition: stroke-width 0.2s ease;
}

/* Hover-—ç—Ñ—Ñ–µ–∫—Ç ‚Äî —É—Ç–æ–ª—â–µ–Ω–∏–µ –ª–∏–Ω–∏–∏ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
.sparkline-svg:hover .sparkline-line {
  stroke-width: 4;
}

/* Transition –º–µ–∂–¥—É –ø–µ—Ä–∏–æ–¥–∞–º–∏ ‚Äî –ø–ª–∞–≤–Ω–∞—è —Å–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã—Ö */
.sparkline-svg {
  transition: opacity 0.3s ease;
}

.sparkline-svg.transitioning {
  opacity: 0.5;
}

/* Transition –º–µ–∂–¥—É –ø–µ—Ä–∏–æ–¥–∞–º–∏ */
.sparkline-transitioning {
  opacity: 0.3;
  transform: scale(0.97);
  transition: opacity 0.2s ease-out, transform 0.2s ease-out;
}

@keyframes drawSparkline {
  to {
    stroke-dashoffset: 0;
  }
}

/* === Meal Sparkline Animations === */
.meal-sparkline-line {
  animation: drawMealSparkline 2.5s ease-out forwards;
}

@keyframes drawMealSparkline {
  to {
    stroke-dashoffset: 0;
  }
}

.meal-sparkline-area {
  opacity: 0;
  animation: fadeInMealArea 1.5s ease-out 1s forwards;
}

@keyframes fadeInMealArea {
  to {
    opacity: 1;
  }
}

.meal-sparkline-dot {
  opacity: 0;
  transform: scale(0);
  transform-origin: center;
  animation: mealDotAppear 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
  animation-delay: var(--dot-delay, 1s);
}

@keyframes mealDotAppear {
  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* Hover —ç—Ñ—Ñ–µ–∫—Ç –Ω–∞ —Ç–æ—á–∫–∞—Ö */
.meal-sparkline-dot circle {
  transition: r 0.15s ease, filter 0.15s ease, stroke-width 0.15s ease;
}
.meal-sparkline-dot:hover circle {
  filter: drop-shadow(0 0 4px currentColor);
}

/* –õ–∏–Ω–∏—è –≤—á–µ—Ä–∞—à–Ω–µ–≥–æ –¥–Ω—è –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è */
.meal-sparkline-yesterday {
  opacity: 0.25;
  stroke-dasharray: 4 3;
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–ª–∏–≤–∫–∏ ‚Äî –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å –ª–∏–Ω–∏–µ–π */
.sparkline-area-animated {
  opacity: 0;
  animation: fadeInArea 5s ease-in-out forwards;
}

@keyframes fadeInArea {
  0% { opacity: 0; }
  50% { opacity: 0.15; }
  100% { opacity: 1; }
}

/* –ê–Ω–∏–º–∞—Ü–∏—è —Ç–æ—á–µ–∫ ‚Äî –ø–æ—è–≤–ª—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –∫–æ–≥–¥–∞ –ª–∏–Ω–∏—è –¥–æ—Ö–æ–¥–∏—Ç */
.sparkline-dot {
  transition: r 0.2s cubic-bezier(0.34, 1.56, 0.64, 1), fill 0.15s ease, filter 0.2s ease;
  opacity: 0;
  transform: scale(0);
  transform-box: fill-box;
  transform-origin: center center;
  animation: dotAppear 0.08s ease-out forwards;
  animation-delay: var(--delay, 0s);
  cursor: pointer;
}

@keyframes dotAppear {
  0% { opacity: 0; transform: scale(0); }
  100% { opacity: 1; transform: scale(1); }
}

/* Skeleton loader –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ */
.sparkline-skeleton {
  height: 60px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 8px;
  padding: 8px 16px;
}

.sparkline-skeleton-line {
  height: 2px;
  background: linear-gradient(90deg, var(--color-slate-200) 25%, var(--color-slate-100) 50%, var(--color-slate-200) 75%);
  background-size: 200% 100%;
  animation: shimmer 1.5s infinite;
  border-radius: 2px;
}

.sparkline-skeleton-dots {
  display: flex;
  justify-content: space-between;
}

.sparkline-skeleton-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: linear-gradient(90deg, var(--color-slate-200) 25%, var(--color-slate-100) 50%, var(--color-slate-200) 75%);
  background-size: 200% 100%;
  animation: shimmer 1.5s infinite;
}

@keyframes shimmer {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

@keyframes fadeInDot {
  0% { opacity: 0; transform: scale(0); }
  70% { opacity: 1; transform: scale(1.3); }
  100% { opacity: 1; transform: scale(1); }
}

.sparkline-goal {
  stroke: var(--color-slate-400);
  stroke-dasharray: 3, 3;
  stroke-width: 1;
}

.sparkline-dot:hover {
  r: 7;
  filter: drop-shadow(0 0 4px currentColor) brightness(1.1);
}

.sparkline-dot-ok {
  fill: #22c55e; /* –∑–µ–ª—ë–Ω—ã–π ‚Äî –≤ –Ω–æ—Ä–º–µ */
}

.sparkline-dot-warn {
  fill: #f59e0b; /* –∂—ë–ª—Ç—ã–π ‚Äî –Ω–µ–º–Ω–æ–≥–æ –ø—Ä–µ–≤—ã—à–µ–Ω–æ */
}

.sparkline-dot-over {
  fill: var(--color-red-500); /* –∫—Ä–∞—Å–Ω—ã–π ‚Äî —Å–∏–ª—å–Ω–æ –ø—Ä–µ–≤—ã—à–µ–Ω–æ */
}

.sparkline-dot-today {
  filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.15));
  animation: dotAppear 0.08s ease-out forwards, pulseDot 2s ease-in-out infinite;
  animation-delay: var(--delay, 0s), calc(var(--delay, 0s) + 0.1s);
  transform-box: fill-box;
  transform-origin: center center;
}

/* Weekend shading background */
.sparkline-weekend-bg {
  opacity: 1;
  pointer-events: none;
}

/* Goal achievement badge */
.sparkline-goal-badge {
  position: absolute;
  top: 4px;
  right: 8px;
  font-size: 10px;
  font-weight: 600;
  padding: 2px 6px;
  border-radius: 8px;
  background: var(--goal-badge-bg, rgba(34, 197, 94, 0.15));
  color: var(--goal-badge-color, #22c55e);
  display: flex;
  align-items: center;
  gap: 3px;
  z-index: 5;
}

.sparkline-goal-badge.goal-low {
  --goal-badge-bg: rgba(234, 179, 8, 0.15);
  --goal-badge-color: #ca8a04;
}

.sparkline-goal-badge.goal-critical {
  --goal-badge-bg: rgba(239, 68, 68, 0.15);
  --goal-badge-color: var(--color-red-500);
}

@keyframes pulseDot {
  0%, 100% { 
    transform: scale(1);
    filter: drop-shadow(0 0 0 rgba(34, 197, 94, 0));
  }
  50% { 
    transform: scale(1.2);
    filter: drop-shadow(0 0 6px rgba(34, 197, 94, 0.5));
  }
}

.sparkline-day-label {
  font-size: 9px;
  fill: var(--color-slate-400);
  font-weight: 500;
}

.sparkline-day-today {
  fill: #22c55e;
  font-weight: 600;
}

/* === 04. SPARKLINE POPUP ‚Äî –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ –ø—Ä–∏ —Ç–∞–ø–µ –Ω–∞ —Ç–æ—á–∫—É === */
/* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –≤ v2 */
.sparkline-popup {
  background: white;
  border-radius: 10px;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
  z-index: 9999;
  animation: sparklinePopupFadeIn 0.15s ease-out;
  will-change: opacity;
}

@keyframes sparklinePopupFadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* === 05. SPARKLINE POPUP V2 ‚Äî –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–π —Å metric-popup === */
.sparkline-popup.sparkline-popup-v2 {
  border-radius: 16px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.15), 0 0 0 1px rgba(0,0,0,0.05);
  overflow: visible;
}

/* –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ä—É—é —Å—Ç—Ä–µ–ª–∫—É ::after –¥–ª—è v2 (—É –Ω–µ–≥–æ —Å–≤–æ—è .sparkline-popup-arrow) */
.sparkline-popup.sparkline-popup-v2::after {
  display: none;
}

.sparkline-popup-v2 .sparkline-popup-stripe {
  height: 4px;
  border-radius: 16px 16px 0 0;
}

.sparkline-popup-v2 .sparkline-popup-content {
  padding: 12px 14px 14px;
  position: relative;
}

.sparkline-popup-v2 .sparkline-popup-swipe {
  width: 32px;
  height: 4px;
  background: var(--color-slate-200);
  border-radius: 2px;
  margin: 0 auto 8px;
}

.sparkline-popup-v2 .sparkline-popup-header-v2 {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  padding-right: 24px;
}

.sparkline-popup-v2 .sparkline-popup-date {
  font-size: 14px;
  font-weight: 700;
  color: #1e293b;
}

.sparkline-popup-v2 .sparkline-popup-pct {
  font-size: 15px;
  font-weight: 800;
}

.sparkline-popup-v2 .sparkline-popup-perfect-title {
  font-size: 14px;
  font-weight: 700;
  color: #b45309;
}

.sparkline-popup-v2 .sparkline-popup-progress {
  height: 6px;
  background: var(--color-slate-200);
  border-radius: 3px;
  overflow: hidden;
  margin-bottom: 10px;
}

.sparkline-popup-v2 .sparkline-popup-progress-fill {
  height: 100%;
  border-radius: 3px;
  transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.sparkline-popup-v2 .sparkline-popup-value-row {
  font-size: 15px;
  margin-bottom: 8px;
  display: flex;
  align-items: baseline;
  gap: 2px;
  flex-wrap: wrap;
}

.sparkline-popup-v2 .sparkline-popup-target {
  color: var(--color-slate-400);
  font-weight: 400;
  font-size: 13px;
}

.sparkline-popup-v2 .sparkline-popup-compare {
  font-size: 11px;
  padding: 2px 6px;
  border-radius: 4px;
  margin-left: 6px;
  background: var(--color-slate-100);
  color: var(--color-slate-500);
  white-space: nowrap;
}

.sparkline-popup-v2 .sparkline-popup-compare.up {
  background: #dcfce7;
  color: #166534;
}

.sparkline-popup-v2 .sparkline-popup-compare.down {
  background: #fee2e2;
  color: #991b1b;
}

.sparkline-popup-v2 .sparkline-popup-motivation-v2 {
  font-size: 12px;
  color: #b45309;
  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
  border: 1px solid #fcd34d;
  border-radius: 6px;
  padding: 6px 8px;
  margin-bottom: 8px;
  text-align: center;
}

.sparkline-popup-v2 .sparkline-popup-tags-v2 {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
  margin-bottom: 8px;
}

.sparkline-popup-v2 .sparkline-popup-tag-v2 {
  display: inline-flex;
  align-items: center;
  gap: 2px;
  font-size: 11px;
  font-weight: 500;
  padding: 3px 6px;
  border-radius: 4px;
  background: var(--color-slate-100);
  color: #475569;
}

.sparkline-popup-v2 .sparkline-popup-tag-v2.good {
  background: #dcfce7;
  color: var(--success-dark);
}

.sparkline-popup-v2 .sparkline-popup-tag-v2.bad {
  background: #fee2e2;
  color: #dc2626;
}

.sparkline-popup-v2 .sparkline-popup-tag-v2.perfect {
  background: linear-gradient(135deg, #fef3c7, #fde68a);
  color: #92400e;
  border: 1px solid #f59e0b;
}

.sparkline-popup-v2 .sparkline-popup-btn-v2 {
  width: 100%;
  padding: 8px;
  background: var(--color-slate-100);
  border: none;
  border-radius: 8px;
  font-size: 12px;
  font-weight: 500;
  color: #475569;
  cursor: pointer;
  transition: all 0.15s;
}

.sparkline-popup-v2 .sparkline-popup-btn-v2:hover {
  background: var(--color-slate-200);
}

.sparkline-popup-v2 .sparkline-popup-btn-v2.perfect {
  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
  color: #92400e;
  border: 1px solid #fcd34d;
}

.sparkline-popup-v2 .sparkline-popup-btn-v2.perfect:hover {
  background: linear-gradient(135deg, #fde68a 0%, #fcd34d 100%);
}

.sparkline-popup-v2 .sparkline-popup-close {
  position: absolute;
  top: 10px;
  right: 10px;
  background: rgba(0, 0, 0, 0.05);
  border: none;
  font-size: 12px;
  color: var(--color-slate-500);
  cursor: pointer;
  padding: 4px 6px;
  line-height: 1;
  border-radius: 6px;
  transition: all 0.15s;
}

.sparkline-popup-v2 .sparkline-popup-close:hover {
  background: rgba(0, 0, 0, 0.1);
  color: var(--color-slate-700);
}

.sparkline-popup-v2 .sparkline-popup-close.perfect {
  color: #92400e;
}

.sparkline-popup-v2 .sparkline-popup-arrow {
  position: absolute;
  top: -8px;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-left: 10px solid transparent;
  border-right: 10px solid transparent;
  border-bottom: 8px solid var(--color-white);
  filter: drop-shadow(0 -2px 2px rgba(0,0,0,0.1));
}

.sparkline-popup-v2 .sparkline-popup-arrow.left {
  left: 24px;
  transform: none;
}

.sparkline-popup-v2 .sparkline-popup-arrow.right {
  left: auto;
  right: 24px;
  transform: none;
}

.sparkline-popup-v2 .sparkline-popup-arrow.perfect {
  border-bottom-color: #fde68a;
}

/* –ó–æ–ª–æ—Ç–æ–π —Ñ–æ–Ω –¥–ª—è perfect popup */
.sparkline-popup-v2.sparkline-popup-perfect-v2 {
  background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
  border: 1px solid #fcd34d;
}

.sparkline-popup-v2.sparkline-popup-perfect-v2 .sparkline-popup-swipe {
  background: #fcd34d;
}

.sparkline-popup-v2.sparkline-popup-perfect-v2 .sparkline-popup-progress {
  background: #fef3c7;
}

/* === 05a. TDEE POPUP (—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –∑–∞—Ç—Ä–∞—Ç) === */
.tdee-popup {
  background: #fff;
}

.tdee-bar-container {
  margin-bottom: 12px;
}

.tdee-bar {
  display: flex;
  height: 8px;
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 4px;
}

.tdee-bar-bmr {
  background: linear-gradient(90deg, #94a3b8 0%, #64748b 100%);
  height: 100%;
}

.tdee-bar-activity {
  background: linear-gradient(90deg, #22c55e 0%, #16a34a 100%);
  height: 100%;
}

.tdee-bar-labels {
  display: flex;
  justify-content: space-between;
  font-size: 10px;
  color: #64748b;
}

.tdee-details {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.tdee-row {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 8px;
  background: #f8fafc;
  border-radius: 8px;
  font-size: 13px;
}

.tdee-row-main {
  background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
}

.tdee-row-total {
  background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
  border: 1px solid #bbf7d0;
  font-weight: 600;
}

.tdee-row-empty {
  background: #fef3c7;
  color: #92400e;
}

.tdee-row-icon {
  font-size: 16px;
  width: 24px;
  text-align: center;
  flex-shrink: 0;
}

.tdee-row-label {
  flex: 1;
  color: #475569;
}

.tdee-row-value {
  font-weight: 600;
  color: #1e293b;
  white-space: nowrap;
}

.tdee-positive {
  color: #16a34a !important;
}

.tdee-row-hint {
  font-size: 10px;
  color: #94a3b8;
  padding-left: 40px;
  margin-top: -4px;
}

.tdee-divider {
  height: 1px;
  background: #e2e8f0;
  margin: 4px 0;
}

/* –°—Ç—Ä–µ–ª–∫–∞-—É–∫–∞–∑–∞—Ç–µ–ª—å —Å–Ω–∏–∑—É –ø–æ–ø–∞–ø–∞ (–¥–ª—è legacy, –Ω–µ v2) */
.sparkline-popup::after {
  content: '';
  position: absolute;
  bottom: -6px;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-left: 6px solid transparent;
  border-right: 6px solid transparent;
  border-top: 6px solid white;
  filter: drop-shadow(0 1px 1px rgba(0, 0, 0, 0.1));
}

@keyframes popupFadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.sparkline-popup-header {
  font-size: 12px;
  font-weight: 600;
  color: #1e293b;
  margin-bottom: 6px;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.sparkline-popup-header .popup-pct {
  font-size: 11px;
  font-weight: 700;
  padding: 2px 6px;
  border-radius: 4px;
}
.sparkline-popup-header .popup-pct.good { background: #dcfce7; color: var(--success-dark); }
.sparkline-popup-header .popup-pct.warn { background: #fef3c7; color: #d97706; }
.sparkline-popup-header .popup-pct.bad { background: #fee2e2; color: #dc2626; }

/* –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî –∫–∞–ª–æ—Ä–∏–∏ */
.sparkline-popup-main {
  font-size: 14px;
  font-weight: 600;
  color: #1e293b;
  margin-bottom: 6px;
  letter-spacing: -0.3px;
}
.sparkline-popup-main small {
  font-size: 11px;
  font-weight: 400;
  color: var(--color-slate-400);
}

/* –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å */
.sparkline-popup-divider {
  height: 1px;
  background: var(--color-slate-100);
  margin: 6px 0;
}

/* –°–µ–∫—Ü–∏—è —Ç–µ–≥–æ–≤ ‚Äî –ë–ñ–£, —Å–æ–Ω, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ */
.sparkline-popup-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
  margin-bottom: 6px;
}

.sparkline-popup-tag {
  display: inline-flex;
  align-items: center;
  gap: 2px;
  font-size: 10px;
  font-weight: 500;
  padding: 2px 5px;
  border-radius: 4px;
  background: var(--color-slate-100);
  color: #475569;
}
.sparkline-popup-tag.good { background: #dcfce7; color: var(--success-dark); }
.sparkline-popup-tag.warn { background: #fef3c7; color: #d97706; }
.sparkline-popup-tag.bad { background: #fee2e2; color: #dc2626; }

/* –ó–æ–ª–æ—Ç–æ–π —Å—Ç–∏–ª—å –¥–ª—è –∏–¥–µ–∞–ª—å–Ω—ã—Ö –¥–Ω–µ–π */
.sparkline-popup-tags.perfect {
  margin-top: 8px;
}
.sparkline-popup-tag.perfect { 
  background: linear-gradient(135deg, #fef3c7, #fde68a); 
  color: #92400e; 
  border: 1px solid #f59e0b;
  font-weight: 500;
}

/* –°—Ç—Ä–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö (—É—Å—Ç–∞—Ä–µ–ª–æ, –Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏–º –¥–ª—è perfect popup) */
.sparkline-popup-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 11px;
  padding: 2px 0;
}

.sparkline-popup-label {
  color: var(--color-slate-500);
}

.sparkline-popup-value {
  font-weight: 600;
  color: #1e293b;
}

.sparkline-popup-value.good { color: #22c55e; }
.sparkline-popup-value.warn { color: #f59e0b; }
.sparkline-popup-value.bad { color: var(--color-red-500); }

.sparkline-popup-btn {
  margin-top: 6px;
  width: 100%;
  padding: 6px;
  background: var(--color-slate-100);
  border: none;
  border-radius: 6px;
  font-size: 11px;
  font-weight: 500;
  color: #475569;
  cursor: pointer;
  transition: background 0.15s;
}

.sparkline-popup-btn:hover {
  background: var(--color-slate-200);
}

/* Popup –¥–ª—è –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ –¥–Ω—è */
.sparkline-popup-perfect {
  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
  border-color: #f59e0b;
  text-align: center;
}

.sparkline-popup-header.perfect {
  color: #b45309;
  font-size: 13px;
  justify-content: center;
}

.sparkline-popup-motivation {
  font-size: 11px;
  color: #78350f;
  margin: 4px 0;
}

.sparkline-popup-subtitle {
  font-size: 10px;
  color: #92400e;
  opacity: 0.8;
}

.sparkline-popup-hint {
  font-size: 9px;
  color: var(--text-tertiary, #71717a);
  margin-top: 4px;
  text-align: center;
  font-style: italic;
}

.sparkline-popup-hint-v2 {
  font-size: 10px;
  color: var(--text-secondary, #6b7280);
  margin-top: 8px;
  padding: 6px 10px;
  background: var(--bg-secondary, #f3f4f6);
  border-radius: 6px;
  text-align: center;
}

.sparkline-popup-forecast {
  border: 1px dashed var(--border-color, #3f3f46);
}

/* Dark mode */
[data-theme="dark"] .sparkline-popup {
  background: #1e293b;
  border-color: var(--color-slate-700);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
}
[data-theme="dark"] .sparkline-popup-header { color: var(--color-slate-100); }
[data-theme="dark"] .sparkline-popup-main { color: var(--color-slate-100); }
[data-theme="dark"] .sparkline-popup-main small { color: var(--color-slate-500); }
[data-theme="dark"] .sparkline-popup-divider { background: var(--color-slate-700); }
[data-theme="dark"] .sparkline-popup-tag { background: var(--color-slate-700); color: var(--color-slate-400); }
[data-theme="dark"] .sparkline-popup-btn { background: var(--color-slate-700); color: var(--color-slate-400); }
[data-theme="dark"] .sparkline-popup-btn:hover { background: #475569; }

/* Dark mode: sparkline-popup-v2 */
[data-theme="dark"] .sparkline-popup-v2 {
  background: #1e293b;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
}

[data-theme="dark"] .sparkline-popup-v2 .sparkline-popup-swipe {
  background: #475569;
}

[data-theme="dark"] .sparkline-popup-v2 .sparkline-popup-date {
  color: var(--color-slate-100);
}

[data-theme="dark"] .sparkline-popup-v2 .sparkline-popup-progress {
  background: var(--color-slate-700);
}

[data-theme="dark"] .sparkline-popup-v2 .sparkline-popup-target {
  color: var(--color-slate-500);
}

[data-theme="dark"] .sparkline-popup-v2 .sparkline-popup-compare {
  background: var(--color-slate-700);
  color: var(--color-slate-400);
}

[data-theme="dark"] .sparkline-popup-v2 .sparkline-popup-compare.up {
  background: #14532d;
  color: #4ade80;
}

[data-theme="dark"] .sparkline-popup-v2 .sparkline-popup-compare.down {
  background: #450a0a;
  color: #f87171;
}

[data-theme="dark"] .sparkline-popup-v2 .sparkline-popup-tag-v2 {
  background: var(--color-slate-700);
  color: var(--color-slate-400);
}

[data-theme="dark"] .sparkline-popup-v2 .sparkline-popup-tag-v2.good {
  background: #14532d;
  color: #4ade80;
}

[data-theme="dark"] .sparkline-popup-v2 .sparkline-popup-tag-v2.bad {
  background: #450a0a;
  color: #f87171;
}

[data-theme="dark"] .sparkline-popup-v2 .sparkline-popup-tag-v2.perfect {
  background: linear-gradient(135deg, #451a03 0%, #78350f 100%);
  border-color: #92400e;
  color: #fbbf24;
}

[data-theme="dark"] .sparkline-popup-v2 .sparkline-popup-btn-v2 {
  background: var(--color-slate-700);
  color: var(--color-slate-400);
}

[data-theme="dark"] .sparkline-popup-v2 .sparkline-popup-btn-v2:hover {
  background: #475569;
}

[data-theme="dark"] .sparkline-popup-v2 .sparkline-popup-btn-v2.perfect {
  background: linear-gradient(135deg, #451a03 0%, #78350f 100%);
  border-color: #92400e;
  color: #fbbf24;
}

[data-theme="dark"] .sparkline-popup-v2 .sparkline-popup-close {
  background: rgba(255, 255, 255, 0.1);
  color: var(--color-slate-400);
}

[data-theme="dark"] .sparkline-popup-v2 .sparkline-popup-close:hover {
  background: rgba(255, 255, 255, 0.2);
  color: var(--color-slate-100);
}

[data-theme="dark"] .sparkline-popup-v2 .sparkline-popup-arrow {
  border-bottom-color: #1e293b;
}

[data-theme="dark"] .sparkline-popup-v2.sparkline-popup-perfect-v2 {
  background: linear-gradient(135deg, #451a03 0%, #78350f 100%);
  border-color: #92400e;
}

[data-theme="dark"] .sparkline-popup-v2.sparkline-popup-perfect-v2 .sparkline-popup-swipe {
  background: #92400e;
}

[data-theme="dark"] .sparkline-popup-v2.sparkline-popup-perfect-v2 .sparkline-popup-perfect-title {
  color: #fbbf24;
}

[data-theme="dark"] .sparkline-popup-v2.sparkline-popup-perfect-v2 .sparkline-popup-motivation-v2 {
  background: linear-gradient(135deg, #78350f 0%, #92400e 100%);
  border-color: #b45309;
  color: #fbbf24;
}

[data-theme="dark"] .sparkline-popup-v2.sparkline-popup-perfect-v2 .sparkline-popup-progress {
  background: #78350f;
}

[data-theme="dark"] .sparkline-popup-v2.sparkline-popup-perfect-v2 .sparkline-popup-arrow {
  border-bottom-color: #78350f;
}

/* === 06. HEATMAP ‚Äî –º–∏–Ω–∏ –ø–æ–ª–æ—Å–∫–∞ –ø–æ–¥ –≥—Ä–∞—Ñ–∏–∫–æ–º === */
.sparkline-heatmap {
  display: flex;
  gap: 2px;
  padding: 4px 16px 0;
  justify-content: space-between;
}

.sparkline-heatmap-day {
  flex: 1;
  height: 4px;
  border-radius: 2px;
  transition: transform 0.15s, opacity 0.15s;
}

.sparkline-heatmap-day:hover {
  transform: scaleY(1.5);
}

.sparkline-heatmap-day.level-0 { background: var(--color-slate-100); } /* –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö */
.sparkline-heatmap-day.level-1 { background: #bbf7d0; } /* <80% */
.sparkline-heatmap-day.level-2 { background: #4ade80; } /* 80-95% */
.sparkline-heatmap-day.level-3 { background: #22c55e; } /* 95-105% - –∏–¥–µ–∞–ª */
.sparkline-heatmap-day.level-4 { background: #fde047; } /* 105-115% */
.sparkline-heatmap-day.level-5 { background: #f97316; } /* 115-130% */
.sparkline-heatmap-day.level-6 { background: var(--color-red-500); } /* >130% */

/* === 07. MOOD-–ü–û–õ–û–°–ê ‚Äî –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–∞—è –ø–æ–ª–æ—Å–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è === */
.sparkline-mood-container {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 8px;
  padding: 12px 4px 4px; /* —É–º–µ–Ω—å—à–∏–ª–∏ –±–æ–∫–æ–≤—ã–µ –æ—Ç—Å—Ç—É–ø—ã */
  margin-top: 4px;
  margin-left: -4px;
  margin-right: -4px;
}

.sparkline-mood-bar {
  flex: 1;
  min-width: 0; /* –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ flex */
  height: 6px;
  border-radius: 3px;
  overflow: visible;
}

/* –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –±–∞—Ä –æ—Ü–µ–Ω–∫–∏ –¥–Ω—è ‚Äî CSS –≥—Ä–∞–¥–∏–µ–Ω—Ç –≤–º–µ—Å—Ç–æ SVG */
.sparkline-mood-bar-modern {
  height: 8px;
  border-radius: 4px; /* pill shape */
  box-shadow: 
    inset 0 1px 2px rgba(255, 255, 255, 0.3),
    0 1px 3px rgba(0, 0, 0, 0.1);
  position: relative;
}

/* –ì–ª—è–Ω—Ü–µ–≤—ã–π –±–ª–∏–∫ —Å–≤–µ—Ä—Ö—É */
.sparkline-mood-bar-modern::before {
  content: '';
  position: absolute;
  top: 1px;
  left: 4px;
  right: 4px;
  height: 3px;
  background: linear-gradient(to bottom, rgba(255,255,255,0.4), transparent);
  border-radius: 2px;
  pointer-events: none;
}

.sparkline-mood-label {
  font-size: 10px;
  color: var(--color-slate-500);
  white-space: nowrap;
}

/* –†—è–¥ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ —Å–Ω–∞ –ø–æ–¥ mood-bar */
.sparkline-sleep-row {
  position: relative;
  width: 100%;
  height: 14px;
  margin-top: 2px;
}

.sparkline-sleep-row .sparkline-sleep-indicator {
  position: absolute;
  transform: translateX(-50%);
  font-size: 9px;
  opacity: 0;
  animation: fadeInSleep 0.3s ease forwards;
  animation-delay: var(--delay, 0s);
}

@keyframes fadeInSleep {
  from { opacity: 0; transform: translateX(-50%) scale(0.5); }
  to { opacity: 1; transform: translateX(-50%) scale(1); }
}

/* –¶–≤–µ—Ç–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ —Å–Ω–∞ –ø–æ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ */
.sparkline-sleep-indicator.sleep-critical { 
  filter: grayscale(0) brightness(1); /* üò¥ <5—á ‚Äî –∫—Ä–∞—Å–Ω—ã–π –æ—Ç—Ç–µ–Ω–æ–∫ */
  text-shadow: 0 0 4px rgba(239, 68, 68, 0.5);
}
.sparkline-sleep-indicator.sleep-bad { 
  filter: hue-rotate(-15deg); /* üò¥ 5-6—á ‚Äî –æ—Ä–∞–Ω–∂–µ–≤—ã–π –æ—Ç—Ç–µ–Ω–æ–∫ */
  text-shadow: 0 0 4px rgba(249, 115, 22, 0.4);
}
.sparkline-sleep-indicator.sleep-low { 
  /* üò¥ 6-7—á ‚Äî –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π */
  opacity: 0.8;
}
.sparkline-sleep-indicator.sleep-good { 
  /* üí§ 7-8.5—á ‚Äî —Ö–æ—Ä–æ—à–æ */
  opacity: 1;
}
.sparkline-sleep-indicator.sleep-over { 
  filter: hue-rotate(40deg); /* üò™ 8.5+—á ‚Äî —Å–∏–Ω–∏–π –æ—Ç—Ç–µ–Ω–æ–∫ (–ø–µ—Ä–µ—Å—ã–ø) */
  text-shadow: 0 0 4px rgba(59, 130, 246, 0.4);
}

/* === 08. Slider Elements === */
.sparkline-slider-line {
  stroke: var(--color-blue-500);
  stroke-width: 1.5;
  stroke-dasharray: 4 2;
  opacity: 0.8;
  pointer-events: none;
}

.sparkline-slider-point {
  fill: var(--color-blue-500);
  stroke: white;
  stroke-width: 2;
  pointer-events: none;
  filter: drop-shadow(0 2px 4px rgba(59, 130, 246, 0.4));
}

/* === 09. TODAY LINE ‚Äî –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è –Ω–∞ —Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å === */
.sparkline-today-line {
  pointer-events: none;
  animation: sparkline-today-pulse 2s ease-in-out infinite;
}

.sparkline-today-label {
  pointer-events: none;
  animation: sparkline-today-bounce 2s ease-in-out infinite;
}

/* –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∞ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è */
.sparkline-forecast-arrow {
  animation: sparkline-forecast-bounce 1.5s ease-in-out infinite;
}

@keyframes sparkline-forecast-bounce {
  0%, 100% { 
    transform: translateY(0); 
    opacity: 0.9;
  }
  50% { 
    transform: translateY(3px); 
    opacity: 0.6;
  }
}

@keyframes sparkline-today-pulse {
  0%, 100% { opacity: 0.15; }
  50% { opacity: 0.25; }
}

@keyframes sparkline-today-bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(2px); }
}

/* === 10. BRUSH SELECTION ‚Äî –≤—ã–¥–µ–ª–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ === */
.sparkline-brush-overlay {
  pointer-events: none;
  animation: sparkline-brush-appear 0.15s ease-out;
}

@keyframes sparkline-brush-appear {
  from {
    opacity: 0;
    transform: scaleX(0.8);
  }
  to {
    opacity: 1;
    transform: scaleX(1);
  }
}

/* Brush Stats Badge */
.sparkline-brush-stats {
  position: absolute;
  top: 4px;
  right: 4px;
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 5px 10px;
  background: rgba(59, 130, 246, 0.15);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  border-radius: 8px;
  font-size: 11px;
  font-weight: 500;
  color: var(--color-blue-500);
  animation: sparkline-brush-stats-appear 0.2s ease-out;
  z-index: 5;
  cursor: pointer;
  transition: background-color 0.15s;
}

.sparkline-brush-stats:hover {
  background: rgba(59, 130, 246, 0.25);
}

.sparkline-brush-stats span {
  white-space: nowrap;
}

.sparkline-brush-stats .brush-days {
  opacity: 0.8;
}

.sparkline-brush-stats .brush-ratio {
  padding: 2px 5px;
  border-radius: 4px;
  color: white;
  font-size: 10px;
}

.sparkline-brush-stats .brush-close {
  margin-left: 2px;
  opacity: 0.6;
  transition: opacity 0.15s;
}

.sparkline-brush-stats:hover .brush-close {
  opacity: 1;
}

@keyframes sparkline-brush-stats-appear {
  from {
    opacity: 0;
    transform: translateY(-4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Zoom Indicator */
.sparkline-zoom-indicator {
  position: absolute;
  bottom: 4px;
  right: 4px;
  padding: 3px 6px;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 4px;
  font-size: 10px;
  color: white;
  cursor: pointer;
  opacity: 0.8;
  transition: opacity 0.15s;
  z-index: 5;
}

.sparkline-zoom-indicator:hover {
  opacity: 1;
}

/* Zoomed state ‚Äî overflow hidden */
.sparkline-container.sparkline-zoomed {
  overflow: hidden;
}

.sparkline-slider-tooltip {
  position: absolute;
  bottom: calc(100% + 6px);
  padding: 6px 10px;
  background: rgba(255, 255, 255, 0.92);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border-radius: 8px;
  box-shadow: 0 3px 12px rgba(0, 0, 0, 0.12), 0 0 0 1px rgba(255, 255, 255, 0.5);
  pointer-events: none;
  z-index: 10;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  animation: sparkline-tooltip-appear 0.12s ease-out;
  min-width: 80px;
}

@keyframes sparkline-tooltip-appear {
  from {
    opacity: 0;
    transform: translateX(-50%) translateY(3px);
  }
  to {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }
}

/* Header row: –¥–∞—Ç–∞ + badge –ø—Ä–æ—Ü–µ–Ω—Ç */
.sparkline-slider-tooltip-header {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  width: 100%;
}

.sparkline-slider-tooltip-date {
  font-size: 10px;
  font-weight: 600;
  color: #1e293b;
}

.sparkline-slider-tooltip-ratio {
  font-size: 9px;
  font-weight: 700;
  padding: 1px 5px;
  border-radius: 3px;
}

.sparkline-slider-tooltip-ratio.ratio-ok {
  background: #dcfce7;
  color: var(--success-dark);
}

.sparkline-slider-tooltip-ratio.ratio-warn {
  background: #fef3c7;
  color: #d97706;
}

.sparkline-slider-tooltip-ratio.ratio-over {
  background: #fee2e2;
  color: #dc2626;
}

/* Main row: –∫–∞–ª–æ—Ä–∏–∏ */
.sparkline-slider-tooltip-kcal {
  font-size: 11px;
  font-weight: 600;
  color: #1e293b;
  letter-spacing: -0.3px;
}
.sparkline-slider-tooltip-kcal small {
  font-size: 9px;
  font-weight: 400;
  color: var(--color-slate-400);
}

/* Tags row: –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ —Ç–µ–≥–∏ */
.sparkline-slider-tooltip-tags {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 3px;
}

.sparkline-slider-tooltip-tag {
  display: inline-flex;
  align-items: center;
  gap: 1px;
  font-size: 9px;
  font-weight: 500;
  padding: 1px 4px;
  border-radius: 3px;
  background: var(--color-slate-100);
  color: #475569;
}
.sparkline-slider-tooltip-tag.good { background: #dcfce7; color: var(--success-dark); }
.sparkline-slider-tooltip-tag.warn { background: #fef3c7; color: #d97706; }
.sparkline-slider-tooltip-tag.bad { background: #fee2e2; color: #dc2626; }

/* Weekly Rhythm ‚Äî –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ —Å–µ–ø–∞—Ä–∞—Ç–æ—Ä—ã –Ω–µ–¥–µ–ª—å */
.sparkline-week-separator {
  stroke: var(--color-slate-200);
  stroke-width: 1;
  stroke-dasharray: 2 2;
  opacity: 0.6;
}

/* Burn Glow ‚Äî —Å–≤–µ—á–µ–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ */
.sparkline-burn-glow {
  fill: #f97316;
  filter: blur(4px);
  pointer-events: none;
}

/* üò¥ Sleep Warning */
.sparkline-sleep-warning {
  font-size: 8px;
  opacity: 0.7;
  pointer-events: none;
}

/* === 11. SPARKLINE ANNOTATIONS ‚Äî –∏–∫–æ–Ω–∫–∏ —Å–æ–±—ã—Ç–∏–π –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ === */
.sparkline-annotation {
  font-size: 11px;
  text-anchor: middle;
  pointer-events: none;
  opacity: 0;
  animation: fadeInAnnotation 0.25s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
  animation-delay: 4.5s; /* –ø–æ—Å–ª–µ —Ä–∏—Å–æ–≤–∞–Ω–∏—è –ª–∏–Ω–∏–∏ 5s */
  dominant-baseline: auto; /* —Ä–µ–Ω–¥–µ—Ä–∏–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ */
}

@keyframes fadeInAnnotation {
  0% { opacity: 0; transform: translateY(4px) scale(0.8); }
  70% { opacity: 1; transform: translateY(-1px) scale(1.05); }
  100% { opacity: 1; transform: translateY(0) scale(1); }
}

.sparkline-annotation-training {
  font-size: 10px;
  fill: #8b5cf6; /* —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ */
  opacity: 0;
  animation: fadeInSimple 0.3s ease-out forwards;
  animation-delay: var(--delay, 0s);
}

@keyframes fadeInSimple {
  0% { opacity: 0; }
  100% { opacity: 1; }
}

/* –ü—É–Ω–∫—Ç–∏—Ä–Ω–∞—è –ª–∏–Ω–∏—è –æ—Ç —ç–º–æ–¥–∑–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∫ —Ç–æ—á–∫–µ ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Å —Ç–æ—á–∫–æ–π */
.sparkline-training-line {
  stroke: #a78bfa; /* —Å–≤–µ—Ç–ª–æ-—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π */
  stroke-width: 1;
  stroke-dasharray: 2 2;
  opacity: 0;
  animation: fadeInLine 0.3s ease-out forwards;
  animation-delay: var(--delay, 0s);
}

/* –ü—É–Ω–∫—Ç–∏—Ä–Ω–∞—è –ª–∏–Ω–∏—è –æ—Ç —Ç–æ—á–∫–∏ –∫ –¥–Ω—é ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Å —Ç–æ—á–∫–æ–π */
.sparkline-point-line {
  stroke: var(--color-slate-400); /* slate-400 ‚Äî —è—Ä—á–µ */
  stroke-width: 1;
  stroke-dasharray: 2 2;
  opacity: 0;
  animation: fadeInPointLine 0.3s ease-out forwards;
  animation-delay: var(--delay, 0s);
}

.weight-sparkline-point-line {
  stroke: #c084fc; /* purple-400 ‚Äî –¥–ª—è –≤–µ—Å–∞, —è—Ä—á–µ */
}

@keyframes fadeInPointLine {
  0% { opacity: 0; }
  100% { opacity: 0.5; }
}

@keyframes fadeInLine {
  0% { opacity: 0; }
  100% { opacity: 0.5; }
}

.sparkline-annotation-holiday {
  fill: #f59e0b; /* –æ—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤ */
}

/* –ü—Ä–æ–≥–Ω–æ–∑–Ω–∞—è –ª–∏–Ω–∏—è */
.sparkline-forecast-line {
  stroke: var(--color-slate-400);
  stroke-width: 1.5;
  animation: none;
}

.sparkline-forecast-dot {
  fill: var(--color-slate-400);
  opacity: 0.5;
}

/* –ó–æ–ª–æ—Ç–∞—è streak-–ª–∏–Ω–∏—è –º–µ–∂–¥—É üî• –¥–Ω—è–º–∏ */
.sparkline-streak-line {
  stroke: #f59e0b;
  stroke-width: 3;
  fill: none;
  filter: drop-shadow(0 0 4px rgba(245, 158, 11, 0.6));
  stroke-linecap: round;
  stroke-linejoin: round;
}

/* –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è streak-–ª–∏–Ω–∏—è ‚Äî —Ä–∏—Å—É–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å –æ—Å–Ω–æ–≤–Ω–æ–π */
.sparkline-streak-animated {
  animation: drawSparkline linear forwards;
  /* animationDelay –∏ animationDuration –∑–∞–¥–∞—é—Ç—Å—è inline */
}

/* –ü—Ä–æ–≥–Ω–æ–∑–Ω–∞—è –ª–∏–Ω–∏—è ‚Äî –º–∞—Å–∫–∞ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—É–Ω–∫—Ç–∏—Ä–∞ */
.sparkline-forecast-mask {
  animation: drawSparkline 0.6s linear forwards;
  animation-delay: 2.9s;
}

/* –ü—Ä–æ–≥–Ω–æ–∑–Ω–∞—è –ª–∏–Ω–∏—è –≤–µ—Å–∞ ‚Äî –º–∞—Å–∫–∞ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ */
.weight-sparkline-forecast-mask {
  animation: drawForecastLine 1.2s ease-out forwards;
  animation-delay: 2.5s; /* –ø–æ—Å–ª–µ –æ—Å–Ω–æ–≤–Ω–æ–π –ª–∏–Ω–∏–∏ –≤–µ—Å–∞ */
}

/* –ê–Ω–∏–º–∞—Ü–∏—è "—Ä–∏—Å–æ–≤–∞–Ω–∏—è" –ø—Ä–æ–≥–Ω–æ–∑–Ω–æ–π –ª–∏–Ω–∏–∏ ‚Äî –ø–ª–∞–≤–Ω–µ–µ */
@keyframes drawForecastLine {
  0% {
    stroke-dashoffset: 200;
    opacity: 0;
  }
  15% {
    opacity: 0.5;
  }
  100% {
    stroke-dashoffset: 0;
    opacity: 1;
  }
}

/* –¢–æ—á–∫–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞ ‚Äî –ø–æ—è–≤–ª—è—é—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å –ø—Ä–æ–≥–Ω–æ–∑–Ω–æ–π –ª–∏–Ω–∏–µ–π */
.sparkline-forecast-dot {
  animation: dotAppear 0.15s ease-out forwards;
  animation-delay: var(--delay, 3s);
}

/* –ü—Ä–æ–≥–Ω–æ–∑–Ω—ã–µ –¥–Ω–∏ ‚Äî —Ç–æ–Ω–∫–∏–π —à—Ä–∏—Ñ—Ç */
.sparkline-day-forecast {
  font-weight: 300;
  opacity: 0.5;
  font-style: italic;
}

/* === SPARKLINE FORECAST STYLES (—É–±—Ä–∞–Ω—ã inline styles) === */

/* –ü—Ä–æ–≥–Ω–æ–∑–Ω–∞—è —Ç–æ—á–∫–∞ –≤–µ—Å–∞ ‚Äî —Å–µ—Ä–∞—è —Å –ø—É–Ω–∫—Ç–∏—Ä–æ–º */
.weight-sparkline-dot-forecast {
  opacity: 0.6;
  stroke-dasharray: 2 2;
  stroke-width: 1.5;
}

/* –ü—Ä–æ–≥–Ω–æ–∑–Ω–∞—è –º–µ—Ç–∫–∞ –≤–µ—Å–∞ */
.weight-sparkline-label-forecast {
  opacity: 0.5;
  font-style: italic;
}

/* –ü—Ä–æ–≥–Ω–æ–∑–Ω–∞—è –ª–∏–Ω–∏—è –æ—Ç —Ç–æ—á–µ–∫ (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è) */
.sparkline-point-line-future {
  opacity: 0.4;
}

/* –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤–µ—Å–∞ –Ω–∞–¥ today line */
.weight-sparkline-change-text {
  font-size: 9px;
  font-weight: 700;
}

.weight-sparkline-change-arrow {
  font-size: 8px;
  font-weight: 600;
  fill: rgba(139, 92, 246, 0.9);
}

/* –ü–æ–¥—Å–∫–∞–∑–∫–∞ –æ —Ü–µ–ª–µ–≤–æ–º –≤–µ—Å–µ */
.weight-goal-hint {
  font-size: 10px;
  color: var(--color-slate-500);
  text-align: center;
  padding: 4px 8px;
  background: var(--color-slate-100);
  border-radius: 4px;
  margin-top: 4px;
}

.dark .weight-goal-hint {
  background: var(--color-slate-800);
  color: var(--color-slate-400);
}

/* –í—ã—Ö–æ–¥–Ω—ã–µ –∏ –ø—Ä–∞–∑–¥–Ω–∏–∫–∏ ‚Äî –∫—Ä–∞—Å–Ω—ã–π */
.sparkline-day-weekend {
  fill: var(--color-red-500);
}

/* –î–µ–ª—å—Ç–∞ (–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç –Ω–æ—Ä–º—ã) –ø–æ–¥ –∫–∞–∂–¥—ã–º –¥–Ω—ë–º ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Å —Ç–æ—á–∫–æ–π */
.sparkline-delta-label {
  font-size: 10px;
  font-weight: 700;
  opacity: 0;
  animation: fadeInSimple 0.3s ease-out forwards;
  animation-delay: var(--delay, 0s);
}

/* Min/Max –º–µ—Ç–∫–∏ (deprecated, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è delta) */
.sparkline-minmax-label {
  font-size: 9px;
  font-weight: 600;
  fill: var(--color-slate-500);
  opacity: 0;
  animation: fadeInAnnotation 0.3s ease forwards;
  animation-delay: 3.5s;
}

.sparkline-min-label {
  fill: var(--color-red-500);
}

.sparkline-max-label {
  fill: #22c55e;
}

/* –ó–æ–ª–æ—Ç—ã–µ –ø—É–ª—å—Å–∏—Ä—É—é—â–∏–µ —Ç–æ—á–∫–∏ –¥–ª—è –∏–¥–µ–∞–ª—å–Ω—ã—Ö –¥–Ω–µ–π */
.sparkline-dot-gold {
  fill: #fbbf24; /* –∑–æ–ª–æ—Ç–æ–π */
  stroke: #f59e0b;
  stroke-width: 1.5;
  opacity: 0;
  transform: scale(0);
  animation: dotAppear 0.15s ease-out forwards, pulseGold 2s ease-in-out infinite;
  animation-delay: var(--delay, 0s), calc(var(--delay, 0s) + 0.2s);
  filter: drop-shadow(0 0 4px rgba(251, 191, 36, 0.6));
  transform-box: fill-box;
  transform-origin: center center;
}

.sparkline-dot-gold-today {
  fill: #fbbf24;
  stroke: #f59e0b;
  stroke-width: 2;
  opacity: 0;
  transform: scale(0);
  animation: dotAppear 0.15s ease-out forwards, pulseGoldToday 1.5s ease-in-out infinite;
  animation-delay: var(--delay, 0s), calc(var(--delay, 0s) + 0.2s);
  filter: drop-shadow(0 0 6px rgba(251, 191, 36, 0.8));
  transform-box: fill-box;
  transform-origin: center center;
}

/* üîÑ Refeed day —Ç–æ—á–∫–∏ ‚Äî –æ—Ä–∞–Ω–∂–µ–≤—ã–µ —Å –ø—É–ª—å—Å–∞—Ü–∏–µ–π */
.sparkline-dot-refeed {
  fill: #f97316; /* orange-500 */
  stroke: #ea580c; /* orange-600 */
  stroke-width: 1.5;
  opacity: 0;
  transform: scale(0);
  animation: dotAppear 0.15s ease-out forwards, pulseRefeed 2s ease-in-out infinite;
  animation-delay: var(--delay, 0s), calc(var(--delay, 0s) + 0.2s);
  filter: drop-shadow(0 0 4px rgba(249, 115, 22, 0.6));
  transform-box: fill-box;
  transform-origin: center center;
}

.sparkline-dot-refeed-today {
  fill: #f97316;
  stroke: #ea580c;
  stroke-width: 2;
  opacity: 0;
  transform: scale(0);
  animation: dotAppear 0.15s ease-out forwards, pulseRefeedToday 1.5s ease-in-out infinite;
  animation-delay: var(--delay, 0s), calc(var(--delay, 0s) + 0.2s);
  filter: drop-shadow(0 0 6px rgba(249, 115, 22, 0.8));
  transform-box: fill-box;
  transform-origin: center center;
}

/* Refeed badge –Ω–∞–¥ —Ç–æ—á–∫–æ–π */
.sparkline-refeed-badge {
  opacity: 0;
  animation: fadeIn 0.3s ease-out forwards;
  animation-delay: var(--delay, 0s);
  pointer-events: none;
}

@keyframes pulseRefeed {
  0%, 100% { 
    transform: scale(1);
    filter: drop-shadow(0 0 4px rgba(249, 115, 22, 0.5));
  }
  50% { 
    transform: scale(1.15);
    filter: drop-shadow(0 0 8px rgba(249, 115, 22, 0.8));
  }
}

@keyframes pulseRefeedToday {
  0%, 100% { 
    transform: scale(1);
    filter: drop-shadow(0 0 6px rgba(249, 115, 22, 0.6));
  }
  50% { 
    transform: scale(1.25);
    filter: drop-shadow(0 0 12px rgba(249, 115, 22, 1));
  }
}

@keyframes popIn {
  0% { opacity: 0; transform: scale(0); }
  60% { opacity: 1; transform: scale(1.4); }
  80% { transform: scale(0.9); }
  100% { opacity: 1; transform: scale(1); }
}

@keyframes pulseGold {
  0%, 100% { 
    transform: scale(1);
    filter: drop-shadow(0 0 4px rgba(251, 191, 36, 0.5));
  }
  50% { 
    transform: scale(1.15);
    filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.8));
  }
}

@keyframes pulseGoldToday {
  0%, 100% { 
    transform: scale(1);
    filter: drop-shadow(0 0 6px rgba(251, 191, 36, 0.6));
  }
  50% { 
    transform: scale(1.25);
    filter: drop-shadow(0 0 12px rgba(251, 191, 36, 1));
  }
}

/* === 12. CORRELATION BLOCK ‚Äî —Å–≤—è–∑—å –∫–∞–ª–æ—Ä–∏–π –∏ –≤–µ—Å–∞ === */
.correlation-block {
  grid-column: 1 / -1;
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 14px;
  margin-top: 4px;
  background: linear-gradient(135deg, #f8fafc 0%, var(--color-slate-100) 100%);
  border: 1px solid var(--color-slate-200);
  border-radius: 10px;
  transition: all 0.3s ease;
}

.correlation-block.positive {
  background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
  border-color: #a7f3d0;
}

.correlation-block.warning {
  background: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);
  border-color: #fed7aa;
}

.correlation-block.mixed {
  background: linear-gradient(135deg, #fefce8 0%, #fef9c3 100%);
  border-color: #fde047;
}

.correlation-icon {
  font-size: 16px;
}

.correlation-text {
  font-size: 12px;
  font-weight: 500;
  color: var(--color-slate-700);
  line-height: 1.3;
}

/* –ö–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π –±–ª–æ–∫ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ */
.correlation-clickable {
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.correlation-clickable:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.correlation-clickable:active {
  transform: scale(0.98);
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –ø—É–ª—å—Å–∞—Ü–∏–∏ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö */
@keyframes correlationPulse {
  0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4); }
  50% { transform: scale(1.02); box-shadow: 0 0 0 8px rgba(59, 130, 246, 0); }
  100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
}

.correlation-block.pulse {
  animation: correlationPulse 0.6s ease-out;
}

/* === 13. Week Heatmap (compact) === */
.week-heatmap {
  grid-column: 1 / -1;
  background: #f8fafc;
  border: 1px solid var(--color-slate-200);
  border-radius: 10px;
  padding: 8px 12px;
  margin-top: 4px;
}

.week-heatmap-header {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 6px;
}

.week-heatmap-title {
  font-size: 12px;
  font-weight: 600;
  color: #1e293b;
}

.week-heatmap-streak {
  font-size: 11px;
  font-weight: 600;
  color: #f59e0b;
  background: #fef3c7;
  padding: 1px 5px;
  border-radius: 6px;
  animation: streakPulse 2s ease-in-out infinite;
}

@keyframes streakPulse {
  0%, 100% { 
    transform: scale(1);
    box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4);
  }
  50% { 
    transform: scale(1.05);
    box-shadow: 0 0 0 4px rgba(245, 158, 11, 0);
  }
}

.week-heatmap-stat {
  font-size: 11px;
  color: var(--color-slate-500);
  margin-left: auto;
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è grid + badge ‚Äî —Ç–µ–ø–µ—Ä—å –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, badge –≤ header */
.week-heatmap-content {
  display: flex;
  align-items: center;
  gap: 8px;
  width: 100%;
}

.week-heatmap-grid {
  display: flex;
  gap: 4px;
  flex-shrink: 0;
}

/* –°—Ç—Ä–æ–∫–∞ —Å grid + —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ "X/Y –≤ –Ω–æ—Ä–º–µ" */
.week-heatmap-row {
  display: flex;
  align-items: flex-end;
  justify-content: space-between;
  gap: 8px;
}

.week-heatmap-norm {
  font-size: 11px;
  color: var(--color-slate-500);
  cursor: pointer;
  padding: 2px 6px;
  border-radius: 6px;
  transition: background 0.15s ease, color 0.15s ease;
}

.week-heatmap-norm:hover {
  background: rgba(59, 130, 246, 0.1);
  color: var(--color-blue-600);
}

/* –°—Ä–µ–¥–Ω–∏–π –¥–µ—Ñ–∏—Ü–∏—Ç –≤ header - —Ü–≤–µ—Ç –ø–æ –±–ª–∏–∑–æ—Å—Ç–∏ –∫ —Ü–µ–ª–∏ */
.week-heatmap-stat {
  font-size: 11px;
  color: var(--color-slate-500);
  margin-left: auto;
}

.week-heatmap-stat.deficit-good {
  color: #16a34a;
  font-weight: 600;
}

.week-heatmap-stat.deficit-warn {
  color: #ca8a04;
  font-weight: 600;
}

.week-heatmap-stat.deficit-bad {
  color: #dc2626;
  font-weight: 600;
}

.week-heatmap-day {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  cursor: pointer;
  transition: transform 0.15s ease;
}

.week-heatmap-day:hover {
  transform: translateY(-1px);
}

.week-heatmap-day:active {
  transform: scale(0.95);
}

.week-heatmap-name {
  font-size: 9px;
  color: var(--color-slate-500);
  font-weight: 500;
}

/* –í—ã—Ö–æ–¥–Ω—ã–µ: –∫—Ä–∞—Å–Ω—ã–π —Ç–µ–∫—Å—Ç + —Ä–æ–∑–æ–≤–∞—è —Ä–∞–º–∫–∞ */
.week-heatmap-day.weekend .week-heatmap-name {
  color: #ef4444;
  font-weight: 600;
}

.week-heatmap-day.weekend .week-heatmap-cell {
  box-shadow: inset 0 0 0 1.5px rgba(251, 113, 133, 0.5);
}

.week-heatmap-day.today .week-heatmap-name {
  color: var(--color-blue-500);
  font-weight: 700;
}

.week-heatmap-cell {
  width: 28px;
  height: 28px;
  border-radius: 6px;
  background: var(--color-slate-200);
  transition: background 0.2s ease, transform 0.15s ease;
}

/* Hover —ç—Ñ—Ñ–µ–∫—Ç –Ω–∞ —è—á–µ–π–∫–µ */
.week-heatmap-day:not(.empty) .week-heatmap-cell:hover {
  transform: scale(1.08);
}

/* –°—Ç–∞—Ç—É—Å—ã ‚Äî fallback –µ—Å–ª–∏ –Ω–µ—Ç inline –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ */
.week-heatmap-day.low .week-heatmap-cell:not([style*="background"]) {
  background: #eab308; /* –∂—ë–ª—Ç—ã–π –¥–ª—è low */
}

.week-heatmap-day.green .week-heatmap-cell:not([style*="background"]) {
  background: #22c55e;
}

.week-heatmap-day.perfect .week-heatmap-cell:not([style*="background"]) {
  background: var(--color-emerald-500);
}

.week-heatmap-day.yellow .week-heatmap-cell:not([style*="background"]) {
  background: #eab308;
}

.week-heatmap-day.red .week-heatmap-cell:not([style*="background"]) {
  background: var(--color-red-500);
}

.week-heatmap-day.empty .week-heatmap-cell {
  background: var(--color-slate-200);
  opacity: 0.5;
}

/* In-progress (—Å–µ–≥–æ–¥–Ω—è –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö) ‚Äî –∂—ë–ª—Ç–∞—è —Ä–∞–º–∫–∞ —Å –ø—É–ª—å—Å–∞—Ü–∏–µ–π */
.week-heatmap-day.in-progress .week-heatmap-cell {
  background: linear-gradient(135deg, rgba(251, 191, 36, 0.15), rgba(251, 191, 36, 0.25));
  box-shadow: 0 0 0 2px #fbbf24;
  animation: inProgressPulse 1.5s ease-in-out infinite;
}

@keyframes inProgressPulse {
  0%, 100% { 
    box-shadow: 0 0 0 2px #fbbf24;
    opacity: 1;
  }
  50% { 
    box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.6);
    opacity: 0.8;
  }
}

/* Today ring —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π */
.week-heatmap-day.today .week-heatmap-cell {
  box-shadow: 0 0 0 2px var(--color-blue-500);
  animation: todayPulse 2s ease-in-out infinite;
}

@keyframes todayPulse {
  0%, 100% { box-shadow: 0 0 0 2px var(--color-blue-500); }
  50% { box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5); }
}

/* –ü–∞—Ç—Ç–µ—Ä–Ω-–∏–Ω—Å–∞–π—Ç */
.week-heatmap-pattern {
  margin-top: 8px;
  padding-top: 8px;
  border-top: 1px solid var(--color-slate-200);
  font-size: 11px;
  color: var(--color-slate-500);
  text-align: center;
}

/* –ë–ª–æ–∫ –¥–µ—Ñ–∏—Ü–∏—Ç–∞/–∂–∏—Ä–∞ –≤–Ω—É—Ç—Ä–∏ heatmap */
.week-heatmap-deficit {
  display: flex;
  align-items: center;
  justify-content: center;
  margin-top: 10px;
  padding: 10px 12px;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.2s ease;
}

/* ‚â§5% –æ—Ç —Ü–µ–ª–∏ ‚Äî –∑–µ–ª—ë–Ω—ã–π —Ñ–æ–Ω (–∏–¥–µ–∞–ª—å–Ω–æ) */
.week-heatmap-deficit.positive {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.08) 0%, rgba(16, 185, 129, 0.05) 100%);
  border: 1px solid rgba(34, 197, 94, 0.15);
}
.week-heatmap-deficit.positive:active {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.12) 0%, rgba(16, 185, 129, 0.08) 100%);
}

/* 6-15% –æ—Ç —Ü–µ–ª–∏ ‚Äî –∂—ë–ª—Ç—ã–π —Ñ–æ–Ω (–Ω–æ—Ä–º–∞–ª—å–Ω–æ) */
.week-heatmap-deficit.mixed {
  background: linear-gradient(135deg, rgba(234, 179, 8, 0.08) 0%, rgba(245, 158, 11, 0.05) 100%);
  border: 1px solid rgba(234, 179, 8, 0.15);
}
.week-heatmap-deficit.mixed:active {
  background: linear-gradient(135deg, rgba(234, 179, 8, 0.12) 0%, rgba(245, 158, 11, 0.08) 100%);
}

/* >15% –æ—Ç —Ü–µ–ª–∏ ‚Äî –∫—Ä–∞—Å–Ω—ã–π/–æ—Ä–∞–Ω–∂–µ–≤—ã–π —Ñ–æ–Ω (–º–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–∏–ª–∏—Å—å) */
.week-heatmap-deficit.warning {
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.08) 0%, rgba(220, 38, 38, 0.05) 100%);
  border: 1px solid rgba(239, 68, 68, 0.15);
}
.week-heatmap-deficit.warning:active {
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.12) 0%, rgba(220, 38, 38, 0.08) 100%);
}

.week-heatmap-deficit:active {
  transform: scale(0.98);
}

/* Empty state –¥–ª—è week heatmap */
.week-heatmap-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 16px 8px;
  text-align: center;
  font-size: 13px;
  color: var(--color-slate-500);
}

.week-heatmap-empty-hint {
  font-size: 11px;
  color: var(--color-slate-400);
  margin-top: 4px;
}

/* Hover –Ω–∞ –≤—Å—ë–º –±–ª–æ–∫–µ */
.week-heatmap:hover {
  border-color: #cbd5e1;
}

/* === 13.5 CALORIC DEBT CARD ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ –∫–∞–ª–æ—Ä–∏–π–Ω–æ–≥–æ –¥–æ–ª–≥–∞ === */
.caloric-debt-card {
  grid-column: 1 / -1;
  display: flex;
  flex-direction: column;
  gap: 8px;
  background: rgba(59, 130, 246, 0.08);
  border: 1px solid rgba(59, 130, 246, 0.2);
  border-radius: 12px;
  padding: 12px 14px;
  margin-top: 4px;
  transition: all 0.2s ease;
}

.caloric-debt-card:hover {
  border-color: var(--debt-color, rgba(59, 130, 246, 0.4));
}

/* Header */
.caloric-debt-header {
  display: flex;
  align-items: center;
  gap: 8px;
}

.caloric-debt-icon {
  font-size: 16px;
  line-height: 1;
}

.caloric-debt-title {
  font-size: 13px;
  font-weight: 600;
  color: var(--color-slate-700);
  flex: 1;
}

.caloric-debt-badge {
  font-size: 11px;
  font-weight: 700;
  color: #fff;
  padding: 3px 8px;
  border-radius: 10px;
  white-space: nowrap;
}

/* Days breakdown ‚Äî –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ª–µ–Ω—Ç–∞ */
.caloric-debt-days {
  display: flex;
  gap: 8px;
  overflow-x: auto;
  padding: 4px 0;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.caloric-debt-days::-webkit-scrollbar {
  display: none;
}

.caloric-debt-day {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  min-width: 52px;
  padding: 8px 10px;
  background: rgba(255, 255, 255, 0.7);
  border-radius: 10px;
  border: 1px solid rgba(0, 0, 0, 0.06);
  position: relative;
  transition: all 0.2s ease;
}

.caloric-debt-day.positive {
  background: rgba(34, 197, 94, 0.12);
  border-color: rgba(34, 197, 94, 0.25);
}

.caloric-debt-day.negative {
  background: rgba(239, 68, 68, 0.08);
  border-color: rgba(239, 68, 68, 0.2);
}

.caloric-debt-day.training {
  box-shadow: inset 0 0 0 2px rgba(245, 158, 11, 0.3);
}

.caloric-debt-day-num {
  font-size: 11px;
  font-weight: 600;
  color: var(--color-slate-500);
}

.caloric-debt-day-delta {
  font-size: 13px;
  font-weight: 700;
  line-height: 1.1;
}

.caloric-debt-day-train {
  position: absolute;
  top: -6px;
  right: -4px;
  font-size: 12px;
  background: #fff;
  border-radius: 50%;
  padding: 1px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.15);
}

/* Recommendation */
.caloric-debt-recommendation {
  display: flex;
  align-items: center;
  gap: 6px;
  background: rgba(255, 255, 255, 0.8);
  padding: 10px 12px;
  border-radius: 10px;
  border: 1px dashed rgba(0, 0, 0, 0.12);
}

.caloric-debt-rec-icon {
  font-size: 16px;
}

.caloric-debt-rec-text {
  font-size: 13px;
  font-weight: 500;
  color: var(--color-slate-700);
}

/* Warning */
.caloric-debt-warning {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 12px;
  font-weight: 500;
  color: #dc2626;
  padding: 6px 10px;
  background: rgba(239, 68, 68, 0.08);
  border-radius: 8px;
}

/* Explanation ‚Äî –ø–æ—è—Å–Ω–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è */
.caloric-debt-explanation {
  margin-top: 2px;
  padding: 8px 10px;
  background: rgba(59, 130, 246, 0.05);
  border-radius: 8px;
  border-left: 3px solid rgba(59, 130, 246, 0.3);
}

.caloric-debt-explanation-text {
  font-size: 12px;
  line-height: 1.4;
  color: var(--color-slate-600);
}

/* === 14. WEIGHT SPARKLINE ‚Äî –≥—Ä–∞—Ñ–∏–∫ –≤–µ—Å–∞ —Å —Ç—Ä–µ–Ω–¥–æ–º === */
.weight-sparkline-container {
  grid-column: 1 / -1;
  display: block;
  background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);
  border: 1px solid #e9d5ff;
  border-radius: 12px;
  padding: 12px 12px 8px;
  margin-top: 4px;
  overflow: hidden;
  transition: background 0.4s ease, border-color 0.4s ease;
}

/* –¶–≤–µ—Ç–æ–≤—ã–µ –∑–æ–Ω—ã —Ñ–æ–Ω–∞ –ø–æ —Ç—Ä–µ–Ω–¥—É */
.weight-sparkline-container.trend-down {
  background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
  border-color: #a7f3d0;
}

.weight-sparkline-container.trend-up {
  background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
  border-color: #fecaca;
}

.weight-sparkline-container.trend-same {
  background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);
  border-color: #e9d5ff;
}

/* Single point weight display (–∫–æ–≥–¥–∞ —Ç–æ–ª—å–∫–æ 1 —Ç–æ—á–∫–∞) */
.weight-single-point {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 20px 16px;
  text-align: center;
}

.weight-single-value {
  display: flex;
  align-items: baseline;
  gap: 4px;
}

.weight-single-number {
  font-size: 36px;
  font-weight: 700;
  color: #7c3aed;
  line-height: 1;
}

.weight-single-unit {
  font-size: 16px;
  font-weight: 500;
  color: #a78bfa;
}

.weight-single-hint {
  margin-top: 8px;
  font-size: 12px;
  color: #8b5cf6;
  opacity: 0.8;
}

.weight-sparkline-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.weight-sparkline-title {
  font-size: 13px;
  font-weight: 600;
  color: #6b21a8;
}

.weight-trend-badge {
  font-size: 12px;
  font-weight: 600;
  padding: 3px 8px;
  border-radius: 8px;
  transition: background 0.3s ease, color 0.3s ease;
}

.weight-trend-badge.down {
  background: #d1fae5;
  color: #059669;
}

.weight-trend-badge.up {
  background: #fee2e2;
  color: #dc2626;
}

.weight-trend-badge.same {
  background: #f3e8ff;
  color: #7c3aed;
}

.weight-sparkline-badges {
  display: flex;
  gap: 6px;
  align-items: center;
}

.weight-forecast-badge {
  font-size: 10px;
  font-weight: 500;
  padding: 2px 6px;
  border-radius: 6px;
  background: var(--color-slate-100);
  color: var(--color-slate-500);
}

.weight-forecast-badge.down {
  background: #dcfce7;
  color: #15803d;
}

.weight-forecast-badge.up {
  background: #fee2e2;
  color: #b91c1c;
}

/* === –ó–ê–î–ï–†–ñ–ö–ê –í–û–î–´ ‚Äî CYCLE INTEGRATION === */

/* –ë–µ–π–¥–∂ "—á–∏—Å—Ç—ã–π —Ç—Ä–µ–Ω–¥" */
.weight-clean-trend-badge {
  font-size: 10px;
  font-weight: 500;
  padding: 2px 6px;
  border-radius: 6px;
  background: #fce7f3;
  color: #be185d;
  cursor: help;
}

/* –†–æ–∑–æ–≤–∞—è –∑–æ–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∏ –≤–æ–¥—ã –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ */
.weight-retention-zone {
  opacity: 0;
  animation: fadeIn 0.5s ease 2s forwards;
}

/* –¢–æ—á–∫–∞ –≤ –∑–æ–Ω–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –≤–æ–¥—ã */
.weight-sparkline-dot-retention {
  filter: drop-shadow(0 0 3px rgba(236, 72, 153, 0.5));
}

/* –°–Ω–æ—Å–∫–∞ –æ –∑–∞–¥–µ—Ä–∂–∫–µ –≤–æ–¥—ã –ø–æ–¥ –≥—Ä–∞—Ñ–∏–∫–æ–º */
.weight-retention-note {
  display: flex;
  align-items: flex-start;
  gap: 6px;
  margin-top: 10px;
  padding: 8px 10px;
  background: linear-gradient(135deg, #fdf2f8 0%, #fce7f3 100%);
  border-radius: 8px;
  border-left: 3px solid #ec4899;
}

.weight-retention-note-icon {
  font-size: 14px;
  flex-shrink: 0;
}

.weight-retention-note-text {
  font-size: 11px;
  line-height: 1.4;
  color: #9d174d;
}

.weight-retention-note-text b {
  color: #be185d;
}

/* –ö–æ–Ω—Ç–µ–Ω—Ç —Å–Ω–æ—Å–∫–∏ (flex column) */
.weight-retention-note-content {
  display: flex;
  flex-direction: column;
  gap: 4px;
  flex: 1;
}

/* –ü—Ä–æ–≥–Ω–æ–∑ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ */
.weight-retention-forecast {
  font-size: 11px;
  color: #9d174d;
  font-weight: 500;
}

/* –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Å–∞–π—Ç */
.weight-retention-insight {
  font-size: 11px;
  color: #6b7280;
  font-style: italic;
}

/* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ü–∏–∫–ª–∞–º */
.weight-retention-stats {
  font-size: 10px;
  color: #9ca3af;
  margin-top: 2px;
  padding-top: 4px;
  border-top: 1px dashed rgba(236, 72, 153, 0.2);
}

.weight-retention-stats b {
  color: #be185d;
  font-weight: 600;
}

.weight-sparkline-svg {
  display: block;
  width: 100%;
  height: auto; /* –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ inline style */
  min-height: 100px;
  transition: opacity 0.3s ease;
}

.weight-sparkline-area {
  opacity: 0.2;
}

.weight-sparkline-line {
  fill: none;
  stroke-width: 3;
  stroke-linecap: round;
  stroke-linejoin: round;
  transition: stroke-width 0.2s ease;
}

/* Hover-—ç—Ñ—Ñ–µ–∫—Ç –¥–ª—è –≤–µ—Å–æ–≤–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞ */
.weight-sparkline-svg:hover .weight-sparkline-line {
  stroke-width: 4;
}

.weight-sparkline-svg.transitioning {
  opacity: 0.5;
}

/* –ê–Ω–∏–º–∞—Ü–∏—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è –ª–∏–Ω–∏–∏ –≤–µ—Å–∞ */
.weight-sparkline-line-animated {
  stroke-dasharray: 500;
  stroke-dashoffset: 500;
  animation: drawSparkline 3s linear forwards;
}

/* –¶–≤–µ—Ç –ª–∏–Ω–∏–∏ –ø–æ —Ç—Ä–µ–Ω–¥—É (fallback) */
.weight-sparkline-container.trend-down .weight-sparkline-line {
  stroke: var(--color-emerald-500);
}

.weight-sparkline-container.trend-up .weight-sparkline-line {
  stroke: var(--color-red-500);
}

.weight-sparkline-container.trend-same .weight-sparkline-line {
  stroke: #8b5cf6;
}

.weight-sparkline-dot {
  transition: r 0.2s cubic-bezier(0.34, 1.56, 0.64, 1), fill 0.15s ease, filter 0.2s ease;
  cursor: pointer;
  /* –¶–≤–µ—Ç –∑–∞–¥–∞—ë—Ç—Å—è inline —á–µ—Ä–µ–∑ style */
}

.weight-sparkline-dot:hover {
  r: 7;
  filter: drop-shadow(0 0 4px rgba(139, 92, 246, 0.6)) brightness(1.15);
}

.weight-sparkline-dot-today {
  stroke: white;
  stroke-width: 1.5;
  animation: dotAppear 0.08s ease-out forwards, pulseDotWeight 2s ease-in-out infinite;
  animation-delay: var(--delay, 0s), calc(var(--delay, 0s) + 0.1s);
  transform-box: fill-box;
  transform-origin: center center;
}

@keyframes pulseDotWeight {
  0%, 100% { 
    transform: scale(1);
    filter: drop-shadow(0 0 0 rgba(139, 92, 246, 0));
  }
  50% { 
    transform: scale(1.2);
    filter: drop-shadow(0 0 6px rgba(139, 92, 246, 0.5));
  }
}

.weight-sparkline-day-label {
  font-size: 9px;
  fill: var(--color-slate-400);
  font-weight: 400;
}

.weight-sparkline-weight-label {
  font-size: 10px;
  fill: var(--color-slate-500);
  font-weight: 500;
}

.weight-sparkline-day-today {
  fill: var(--color-slate-600);
  font-weight: 600;
}

/* –ö–Ω–æ–ø–∫–∏ –ø–µ—Ä–∏–æ–¥–∞ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –≤–µ—Å–∞ (–∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç–∏–ª–∏ kcal-period-pills) */
.weight-period-pills {
  background: rgba(139, 92, 246, 0.15);  /* –§–∏–æ–ª–µ—Ç–æ–≤—ã–π –≤–º–µ—Å—Ç–æ –∑–µ–ª—ë–Ω–æ–≥–æ */
  margin-left: auto;
}

.weight-period-pills .kcal-period-pill {
  color: #6d28d9;
}

.weight-period-pills .kcal-period-pill.active {
  color: #6d28d9;
}

/* –ü—Ä–æ–≥–Ω–æ–∑–Ω—ã–µ –º–µ—Ç–∫–∏ (–¥–∞—Ç—ã –∏ –≤–µ—Å–∞) */
.weight-sparkline-label-forecast {
  opacity: 0.5;
  font-style: italic;
}

/* –ü–æ–¥—Å–∫–∞–∑–∫–∞ –æ —Ü–µ–ª–µ–≤–æ–º –≤–µ—Å–µ */
.weight-goal-hint {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 12px;
  color: var(--color-slate-500);
  margin-top: 8px;
  padding: 8px 12px;
  background: rgba(234, 179, 8, 0.1);
  border-radius: 8px;
  border: 1px dashed rgba(234, 179, 8, 0.3);
}

.weight-goal-hint-link {
  background: none;
  border: none;
  color: #d97706;
  font-weight: 600;
  cursor: pointer;
  text-decoration: underline;
  padding: 0;
  font-size: inherit;
}

.weight-goal-hint-link:hover {
  color: #b45309;
}

/* –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è —Ü–µ–ª–µ–≤–æ–≥–æ –≤–µ—Å–∞ */
.weight-goal-line {
  stroke: #10b981;
  stroke-width: 1.5;
  stroke-opacity: 0.6;
}

.weight-goal-label {
  font-size: 9px;
  fill: #10b981;
  font-weight: 500;
  opacity: 0.8;
}

.weight-sparkline-label {
  font-size: 9px;
  fill: #a78bfa;
  font-weight: 500;
}

.weight-sparkline-label-today {
  fill: #7c3aed;
  font-weight: 600;
}

/* === 15. GOAL PROGRESS BAR (—Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–∞—Ç—É—Å-–±–∞—Ä) === */

/* –ö–∞—Ä—Ç–æ—á–∫–∞-–æ–±—ë—Ä—Ç–∫–∞ –¥–ª—è diary tab */
.goal-progress-card {
  margin: 0 0 12px 0;
  position: relative;
}

.goal-progress-bar {
  background: linear-gradient(135deg, #f8fafc 0%, var(--color-slate-100) 100%);
  border: 1px solid var(--color-slate-200);
  border-radius: 12px;
  padding: 12px 16px 36px 16px;
  position: relative;
  transition: box-shadow 0.3s ease, transform 0.1s ease;
}

/* ‚≠ê Pulse –Ω–∞ "–ò–¥–µ–∞–ª—å–Ω–æ" (ratio 0.9-1.1) */
.goal-progress-bar.pulse-perfect {
  animation: pulsePerfect 2s ease-in-out infinite;
  border-color: var(--color-emerald-500);
  box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4);
}

@keyframes pulsePerfect {
  0%, 100% {
    box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4);
    border-color: var(--color-emerald-500);
  }
  50% {
    box-shadow: 0 0 0 8px rgba(16, 185, 129, 0), 0 0 20px rgba(16, 185, 129, 0.3);
    border-color: #34d399;
  }
}

/* üîî Shake –Ω–∞ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ (ratio > 1.25) */
.goal-progress-bar.shake-excess {
  animation: shakeExcess 0.5s ease-in-out;
  border-color: var(--color-red-500);
  background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
}

@keyframes shakeExcess {
  0%, 100% { transform: translateX(0); }
  10%, 30%, 50%, 70%, 90% { transform: translateX(-3px); }
  20%, 40%, 60%, 80% { transform: translateX(3px); }
}

.goal-progress-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.goal-progress-title {
  font-size: 13px;
  font-weight: 600;
  color: var(--color-slate-700);
}

.goal-progress-stats {
  display: flex;
  align-items: baseline;
  gap: 2px;
}

.goal-eaten {
  font-size: 16px;
  font-weight: 700;
  color: #0ea5e9;
}

.goal-divider {
  font-size: 14px;
  color: var(--color-slate-400);
  margin: 0 2px;
}

.goal-target {
  font-size: 14px;
  font-weight: 500;
  color: var(--color-slate-500);
}

.goal-unit {
  font-size: 11px;
  color: var(--color-slate-400);
  margin-left: 4px;
}

.goal-progress-track {
  position: relative;
  display: flex;
  align-items: center;
  gap: 8px;
  height: 24px;
}

/* Wrapper –¥–ª—è toggle —Å–ª–µ–≤–∞ */
.goal-refeed-toggle-wrapper {
  flex-shrink: 0;
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–∞–º–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞ */
.goal-progress-track-inner {
  position: relative;
  flex: 1;
  height: 100%;
  border-radius: 12px;
}

/* –°–µ—Ä—ã–π —Ñ–æ–Ω —Ç–æ–ª—å–∫–æ –¥–æ –º–∞—Ä–∫–µ—Ä–∞ –ø—Ä–∏ –ø–µ—Ä–µ–±–æ—Ä–µ */
.goal-progress-track-inner::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 100%;
  background: var(--color-slate-200);
  border-radius: 12px;
  z-index: 0;
}

.goal-progress-fill {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  background: linear-gradient(90deg, #22c55e 0%, var(--success-dark) 100%);
  border-radius: 12px 0 0 12px;
  transition: width 1.2s cubic-bezier(0.16, 1, 0.3, 1);
  will-change: width;
  z-index: 1;
}

/* –û—Ç–∫–ª—é—á–∞–µ–º transition –ø—Ä–∏ —Å–±—Ä–æ—Å–µ –∫ 0 */
.goal-progress-fill.no-transition {
  transition: none !important;
}

@keyframes progressFillIn {
  from {
    transform: scaleX(0);
    opacity: 0.5;
  }
  to {
    transform: scaleX(1);
    opacity: 1;
  }
}

.goal-progress-fill.over {
  background: linear-gradient(90deg, #f97316 0%, var(--color-red-500) 100%);
}

/* –ö—Ä–∞—Å–Ω–∞—è —á–∞—Å—Ç—å ‚Äî –ø–µ—Ä–µ–±–æ—Ä –∫–∞–ª–æ—Ä–∏–π */
.goal-progress-over {
  position: absolute;
  top: 0;
  height: 100%;
  background: linear-gradient(90deg, var(--color-red-500) 0%, #dc2626 100%);
  border-radius: 0 12px 12px 0;
  z-index: 2;
}

.goal-marker {
  position: absolute;
  right: 0;
  top: 0;
  width: 3px;
  height: 100%;
  background: transparent;
  border-radius: 2px;
  z-index: 10;
  transition: left 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* –ú–∞—Ä–∫–µ—Ä –ø—Ä–∏ –ø–µ—Ä–µ–±–æ—Ä–µ ‚Äî —á—ë—Ä–Ω–∞—è –ª–∏–Ω–∏—è –Ω–∞ –≤—Å—é –≤—ã—Å–æ—Ç—É */
.goal-marker.over {
  right: auto;
  transform: translateX(-50%);
  background: #1f2937;
  box-shadow: 0 0 4px rgba(0,0,0,0.3);
}

/* === –ë–æ–Ω—É—Å–Ω–∞—è –∑–æ–Ω–∞ ‚Äî –∫–∞–ª–æ—Ä–∏–π–Ω—ã–π –¥–æ–ª–≥ (—à—Ç—Ä–∏—Ö–æ–≤–∫–∞) === */
.goal-bonus-zone {
  position: absolute;
  top: 0;
  height: 100%;
  background: repeating-linear-gradient(
    45deg,
    transparent,
    transparent 4px,
    rgba(16, 185, 129, 0.25) 4px,
    rgba(16, 185, 129, 0.25) 8px
  );
  border-radius: 0 12px 12px 0;
  z-index: 0;
  pointer-events: none;
  border-left: 1px dashed #10b981;
}

/* –ú–∞—Ä–∫–µ—Ä –±–∞–∑–æ–≤–æ–π –Ω–æ—Ä–º—ã (–±–µ–∑ –¥–æ–ª–≥–∞) ‚Äî –ø—É–Ω–∫—Ç–∏—Ä–Ω–∞—è –ª–∏–Ω–∏—è */
.goal-base-marker {
  position: absolute;
  top: 0;
  width: 2px;
  height: 100%;
  background: repeating-linear-gradient(
    to bottom,
    #059669,
    #059669 3px,
    transparent 3px,
    transparent 6px
  );
  z-index: 11;
  transform: translateX(-1px);
}

/* === –ú–∞—Ä–∫–µ—Ä —Ç–µ–∫—É—â–µ–≥–æ % –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è === */
.goal-current-marker {
  position: absolute;
  bottom: -22px;
  transform: translateX(-50%);
  z-index: 15;
  transition: left 1.2s cubic-bezier(0.16, 1, 0.3, 1);
  will-change: left;
}

.goal-current-marker.no-transition {
  transition: none !important;
}

.goal-current-pct {
  display: inline-block;
  background: var(--color-slate-700);
  color: #fff;
  font-size: 10px;
  font-weight: 600;
  padding: 2px 5px;
  border-radius: 4px;
  white-space: nowrap;
  position: relative;
}

/* –¢—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ —Å–≤–µ—Ä—Ö—É (—É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –±–∞—Ä) */
.goal-current-pct::after {
  content: '';
  position: absolute;
  top: -4px;
  left: 50%;
  transform: translateX(-50%);
  border-left: 4px solid transparent;
  border-right: 4px solid transparent;
  border-bottom: 4px solid var(--color-slate-700);
}

/* === –ú–µ—Ç–∫–∏ –∑–æ–Ω –ø–æ–¥ –ø–æ–ª–æ—Å–æ–π (80%, 100%) === */
.goal-zone-labels {
  position: relative;
  height: 14px;
  margin-top: 2px;
}

.goal-zone-label {
  position: absolute;
  transform: translateX(-50%);
  font-size: 9px;
  color: var(--color-slate-400);
  font-weight: 500;
}

.goal-zone-label-100 {
  color: var(--color-slate-500);
  font-weight: 600;
}

/* === –û—Å—Ç–∞—Ç–æ–∫ –∫–∞–ª–æ—Ä–∏–π –≤–Ω—É—Ç—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —á–∞—Å—Ç–∏ –±–∞—Ä–∞ (–∫–æ–≥–¥–∞ >80%) === */
.goal-remaining-inside {
  animation: pulseGlow 1.5s ease-in-out infinite;
}

@keyframes pulseGlow {
  0%, 100% {
    transform: translateY(-50%) scale(1);
    box-shadow: 0 1px 4px rgba(0,0,0,0.15);
  }
  50% {
    transform: translateY(-50%) scale(1.05);
    box-shadow: 0 2px 8px rgba(0,0,0,0.25), 0 0 12px rgba(255,255,255,0.5);
  }
}

.goal-progress-footer {
  margin-top: 8px;
  font-size: 14px;
  color: var(--color-slate-500);
  text-align: center;
}

.goal-remaining b {
  color: #22c55e;
  font-weight: 700;
  font-size: 16px;
}

/* üî• –ú–æ—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–∏ –∫ —Ü–µ–ª–∏ */
.goal-remaining.almost-there {
  color: #059669;
  font-weight: 600;
  animation: almostThere 1.5s ease-in-out infinite;
}

.goal-remaining.almost-there b {
  color: #059669;
  font-size: 18px;
}

.goal-remaining.getting-close {
  color: #0d9488;
  font-weight: 500;
}

.goal-remaining.getting-close b {
  color: #0d9488;
}

@keyframes almostThere {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.85; transform: scale(1.02); }
}

.goal-over b {
  color: var(--color-red-500);
  font-weight: 700;
  font-size: 16px;
}

/* === 16. MACRO + WEIGHT ROW (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–æ–ª–µ—Ü –∏ –≤–µ—Å–∞) === */
.macro-weight-row {
  display: flex;
  align-items: stretch;
  gap: 8px;
  margin-top: 8px;
  width: 100%;
  grid-column: 1 / -1;
}

/* === 17. MACRO RINGS (–ë–ñ–£ –≤ —Å—Ç–∏–ª–µ Apple Watch) === */
.macro-rings {
  display: flex;
  justify-content: center;
  align-items: flex-start;
  gap: 2px;
  padding: 6px 0;
  background: transparent;
  border: none;
  border-radius: 0;
  flex: 1;
  min-width: 0;
}

.macro-ring-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  flex: 1;
  min-width: 0;
  max-width: 70px;
}

.macro-ring {
  position: relative;
  width: 44px;
  height: 44px;
}

.macro-ring-svg {
  transform: rotate(-90deg);
  width: 100%;
  height: 100%;
}

.macro-ring-bg {
  fill: none;
  stroke: #e5e7eb;
  stroke-width: 3;
}

.macro-ring-fill {
  fill: none;
  stroke-width: 3;
  stroke-linecap: round;
  transition: stroke-dasharray 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  animation: ringFillIn 0.8s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

@keyframes ringFillIn {
  from {
    stroke-dasharray: 0 100;
    opacity: 0.5;
  }
  to {
    opacity: 1;
  }
}

/* –¶–≤–µ—Ç–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞–∫—Ä–æ—Å–∞ */
.macro-ring.protein .macro-ring-fill {
  stroke: var(--color-red-500);
}

.macro-ring.fat .macro-ring-fill {
  stroke: #f59e0b;
}

.macro-ring.carbs .macro-ring-fill {
  stroke: #22c55e;
}

.macro-ring-value {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 13px;
  font-weight: 700;
  color: var(--color-slate-700);
  text-align: center;
  white-space: nowrap;
  display: flex;
  align-items: center;
  justify-content: center;
}

.macro-ring-label {
  font-size: 11px;
  font-weight: 600;
  color: var(--color-slate-700);
  white-space: nowrap;
  display: flex;
  align-items: center;
  gap: 2px;
  line-height: 1;
}

.macro-ring-target {
  font-size: 10px;
  color: var(--color-slate-400);
}

.macro-ring-badges {
  display: flex;
  gap: 4px;
  justify-content: center;
  min-height: 16px;
}

.macro-ring-badge {
  font-size: 12px;
  line-height: 1;
  cursor: pointer;
  transition: transform 0.15s ease;
}

.macro-ring-badge:active {
  transform: scale(1.3);
}

/* === 18. MACRO BADGE POPUP === */
.macro-badge-popup {
  background: var(--color-white);
  border-radius: 14px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.18), 0 2px 8px rgba(0, 0, 0, 0.1);
  min-width: 200px;
  max-width: 240px;
  z-index: 1000;
  animation: popupFadeIn 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
  overflow: hidden;
  position: relative;
  touch-action: pan-y;
}

/* –¶–≤–µ—Ç–Ω–∞—è –ø–æ–ª–æ—Å–∞ —Å–≤–µ—Ä—Ö—É */
.macro-badge-popup-stripe {
  height: 4px;
  width: 100%;
}

/* –ö–æ–Ω—Ç–µ–Ω—Ç popup */
.macro-badge-popup-content {
  padding: 10px 14px 14px;
}

/* –°—Ç—Ä–µ–ª–∫–∞-—É–∫–∞–∑–∞—Ç–µ–ª—å */
.macro-badge-popup-arrow {
  position: absolute;
  top: -8px;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-left: 10px solid transparent;
  border-right: 10px solid transparent;
  border-bottom: 8px solid var(--color-white);
  filter: drop-shadow(0 -2px 2px rgba(0,0,0,0.1));
}

.macro-badge-popup-arrow.left {
  left: 24px;
  transform: none;
}

.macro-badge-popup-arrow.right {
  left: auto;
  right: 24px;
  transform: none;
}

@keyframes popupFadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.macro-badge-popup-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  padding-right: 24px;
}

.macro-badge-popup-title {
  font-size: 14px;
  font-weight: 700;
  color: #1e293b;
}

.macro-badge-popup-pct {
  font-size: 15px;
  font-weight: 800;
}

/* –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä */
.macro-badge-popup-progress {
  height: 6px;
  background: var(--color-slate-200);
  border-radius: 3px;
  overflow: hidden;
  margin-bottom: 10px;
}

.macro-badge-popup-progress-fill {
  height: 100%;
  border-radius: 3px;
  transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* üí´ –ê–Ω–∏–º–∞—Ü–∏—è count-up –¥–ª—è —á–∏—Å–µ–ª */
.macro-badge-popup-animated {
  animation: macroCountUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

.macro-badge-popup-animated-bar {
  animation: macroBarFill 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes macroCountUp {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes macroBarFill {
  from {
    width: 0 !important;
  }
}

/* üìä –ú–∏–Ω–∏-sparkline */
.macro-badge-popup-sparkline {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 8px;
  padding: 6px 8px;
  background: #f8fafc;
  border-radius: 6px;
}

.macro-badge-popup-spark-svg {
  width: 70px;
  height: 20px;
  flex-shrink: 0;
}

.macro-badge-popup-spark-label {
  font-size: 10px;
  color: var(--color-slate-400);
  white-space: nowrap;
}

.macro-badge-popup-spark-today {
  animation: sparkPulse 1.5s ease-in-out infinite;
}

@keyframes sparkPulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.6; }
}

/* ‚è∞ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ */
.macro-badge-popup-time-msg {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 12px;
  color: var(--color-slate-500);
  margin-bottom: 8px;
  padding: 4px 0;
}

/* üèÜ Streak –º–∞–∫—Ä–æ—Å–∞ */
.macro-badge-popup-streak {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 12px;
  color: #d97706;
  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
  border: 1px solid #fcd34d;
  border-radius: 6px;
  padding: 6px 8px;
  margin-bottom: 8px;
  animation: streakGlow 2s ease-in-out infinite;
}

.macro-badge-popup-streak-icon {
  font-size: 14px;
}

@keyframes streakGlow {
  0%, 100% { box-shadow: 0 0 0 0 rgba(251, 191, 36, 0); }
  50% { box-shadow: 0 0 8px 2px rgba(251, 191, 36, 0.3); }
}

.macro-badge-popup-value {
  font-size: 15px;
  margin-bottom: 10px;
  display: flex;
  align-items: baseline;
  gap: 2px;
  flex-wrap: wrap;
}

.macro-badge-popup-norm {
  color: var(--color-slate-400);
  font-weight: 400;
  font-size: 13px;
}

/* üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–æ –≤—á–µ—Ä–∞ */
.macro-badge-popup-compare {
  font-size: 11px;
  padding: 2px 6px;
  border-radius: 4px;
  margin-left: 6px;
  background: var(--color-slate-100);
  color: var(--color-slate-500);
  white-space: nowrap;
}

.macro-badge-popup-compare.up {
  background: #dcfce7;
  color: #166534;
}

.macro-badge-popup-compare.down {
  background: #fee2e2;
  color: #991b1b;
}

.macro-badge-popup-desc {
  display: flex;
  flex-direction: column;
  gap: 6px;
  border-top: 1px solid var(--color-slate-100);
  padding-top: 10px;
  margin-top: 2px;
}

.macro-badge-popup-item {
  display: flex;
  align-items: flex-start;
  gap: 8px;
  font-size: 12px;
  color: #475569;
  line-height: 1.4;
}

.macro-badge-popup-emoji {
  font-size: 14px;
  flex-shrink: 0;
}

/* –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞ */
.macro-badge-popup-rec {
  background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
  border-radius: 8px;
  padding: 8px 10px;
  margin-top: 10px;
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  color: #166534;
  border: 1px solid #bbf7d0;
}

.macro-badge-popup-rec-icon {
  font-size: 16px;
}

.macro-badge-popup-rec-text b {
  font-weight: 600;
}

.macro-badge-popup-close {
  position: absolute;
  top: 10px;
  right: 10px;
  background: rgba(0, 0, 0, 0.05);
  border: none;
  font-size: 12px;
  color: var(--color-slate-500);
  cursor: pointer;
  padding: 4px 6px;
  line-height: 1;
  border-radius: 6px;
  transition: all 0.15s;
}

.macro-badge-popup-close:hover {
  background: rgba(0, 0, 0, 0.1);
  color: var(--color-slate-700);
}

.macro-badge-popup-close:active {
  transform: scale(0.95);
}

/* Swipe indicator */
.macro-badge-popup-swipe {
  width: 32px;
  height: 4px;
  background: var(--color-slate-200);
  border-radius: 2px;
  margin: 0 auto 8px;
}

/* ====================================
   METRIC POPUP (–≤–æ–¥–∞, —à–∞–≥–∏, –∫–∞–ª–æ—Ä–∏–∏)
   ==================================== */

.metric-popup {
  background: var(--color-white);
  border-radius: 16px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.15), 0 0 0 1px rgba(0,0,0,0.05);
  animation: popupFadeIn 0.2s ease-out;
  overflow: visible;
  z-index: 9999;
}

.metric-popup-stripe {
  height: 4px;
  border-radius: 16px 16px 0 0;
}

.metric-popup-content {
  padding: 12px 14px 14px;
  position: relative;
}

.metric-popup-swipe {
  width: 32px;
  height: 4px;
  background: var(--color-slate-200);
  border-radius: 2px;
  margin: 0 auto 8px;
}

.metric-popup-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  padding-right: 24px;
}

.metric-popup-title {
  font-size: 14px;
  font-weight: 700;
  color: #1e293b;
}

.metric-popup-pct {
  font-size: 15px;
  font-weight: 800;
}

/* Sparkline */
.metric-popup-sparkline {
  position: relative;
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.metric-popup-spark-svg {
  flex: 1;
  height: 20px;
}

.metric-popup-spark-label {
  font-size: 10px;
  color: var(--color-slate-400);
  white-space: nowrap;
}

/* Progress bar */
.metric-popup-progress {
  height: 6px;
  background: var(--color-slate-200);
  border-radius: 3px;
  overflow: hidden;
  margin-bottom: 10px;
}

.metric-popup-progress-fill {
  height: 100%;
  border-radius: 3px;
  transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Value */
.metric-popup-value {
  font-size: 15px;
  margin-bottom: 8px;
  display: flex;
  align-items: baseline;
  gap: 2px;
  flex-wrap: wrap;
}

.metric-popup-goal {
  color: var(--color-slate-400);
  font-weight: 400;
  font-size: 13px;
}

.metric-popup-compare {
  font-size: 11px;
  padding: 2px 6px;
  border-radius: 4px;
  margin-left: 6px;
  background: var(--color-slate-100);
  color: var(--color-slate-500);
  white-space: nowrap;
}

.metric-popup-compare.up {
  background: #dcfce7;
  color: #166534;
}

.metric-popup-compare.down {
  background: #fee2e2;
  color: #991b1b;
}

/* Extra info */
.metric-popup-extra {
  font-size: 12px;
  color: var(--color-slate-500);
  margin-bottom: 8px;
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
}

.metric-popup-extra b {
  font-weight: 600;
  color: #1e293b;
}

/* Streak */
.metric-popup-streak {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 12px;
  color: #d97706;
  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
  border: 1px solid #fcd34d;
  border-radius: 6px;
  padding: 6px 8px;
  margin-bottom: 8px;
  animation: streakGlow 2s ease-in-out infinite;
}

/* Reminder */
.metric-popup-reminder {
  font-size: 12px;
  color: #ea580c;
  background: #fff7ed;
  border: 1px solid #fed7aa;
  border-radius: 6px;
  padding: 6px 8px;
  margin-top: 4px;
}

/* Close button */
.metric-popup-close {
  position: absolute;
  top: 10px;
  right: 10px;
  background: rgba(0, 0, 0, 0.05);
  border: none;
  font-size: 12px;
  color: var(--color-slate-500);
  cursor: pointer;
  padding: 4px 6px;
  line-height: 1;
  border-radius: 6px;
  transition: all 0.15s;
}

.metric-popup-close:hover {
  background: rgba(0, 0, 0, 0.1);
  color: var(--color-slate-700);
}

.metric-popup-close:active {
  transform: scale(0.95);
}

/* Arrow */
.metric-popup-arrow {
  position: absolute;
  top: -8px;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-left: 10px solid transparent;
  border-right: 10px solid transparent;
  border-bottom: 8px solid var(--color-white);
  filter: drop-shadow(0 -2px 2px rgba(0,0,0,0.1));
}

.metric-popup-arrow.left {
  left: 24px;
  transform: none;
}

.metric-popup-arrow.right {
  left: auto;
  right: 24px;
  transform: none;
}

.macro-ring-percent {
  font-size: 10px;
  font-weight: 600;
  color: var(--color-slate-500);
  background: rgba(100, 116, 139, 0.1);
  padding: 1px 4px;
  border-radius: 4px;
  margin-top: 2px;
}

/* –ü—É–ª—å—Å–∏—Ä—É—é—â–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π */
.macro-ring-pulse {
  animation: macroPulse 1.5s ease-in-out infinite;
}

@keyframes macroPulse {
  0%, 100% { 
    opacity: 1;
    transform: scale(1);
  }
  50% { 
    opacity: 0.7;
    transform: scale(1.05);
  }
}

/* === 19. MACRO TIP ‚Äî —É–º–Ω–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ –ë–ñ–£ === */
.macro-tip {
  grid-column: 1 / -1;
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  border-radius: 10px;
  font-size: 12px;
  margin-top: 4px;
  animation: fadeInUp 0.3s ease-out;
}

.macro-tip-icon {
  font-size: 14px;
  flex-shrink: 0;
}

.macro-tip-text {
  color: var(--color-slate-700);
  line-height: 1.3;
}

/* –¢–∏–ø: –±–µ–ª–æ–∫ */
.macro-tip-protein {
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.08) 0%, rgba(248, 113, 113, 0.12) 100%);
  border: 1px solid rgba(239, 68, 68, 0.2);
}

/* –¢–∏–ø: –∂–∏—Ä—ã */
.macro-tip-fat {
  background: linear-gradient(135deg, rgba(245, 158, 11, 0.08) 0%, rgba(251, 191, 36, 0.12) 100%);
  border: 1px solid rgba(245, 158, 11, 0.2);
}

/* –¢–∏–ø: —É–≥–ª–µ–≤–æ–¥—ã */
.macro-tip-carbs {
  background: linear-gradient(135deg, rgba(59, 130, 246, 0.08) 0%, rgba(96, 165, 250, 0.12) 100%);
  border: 1px solid rgba(59, 130, 246, 0.2);
}

/* –¢–∏–ø: —É—Å–ø–µ—Ö */
.macro-tip-success {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.08) 0%, rgba(74, 222, 128, 0.12) 100%);
  border: 1px solid rgba(34, 197, 94, 0.2);
}

/* –¢–∏–ø: –ø—É—Å—Ç–æ–π –¥–µ–Ω—å */
.macro-tip-empty {
  background: linear-gradient(135deg, rgba(100, 116, 139, 0.06) 0%, rgba(148, 163, 184, 0.1) 100%);
  border: 1px solid rgba(100, 116, 139, 0.15);
}

/* === 20. WEIGHT CARD MODERN (—Å—Ç–∏–ª—å –∫–∞–∫ —É goal progress bar) === */
.weight-card-modern {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 2px;
  padding: 6px 4px;
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.08) 0%, rgba(16, 185, 129, 0.12) 100%);
  border: 1px solid rgba(34, 197, 94, 0.2);
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.2s ease;
  width: 85px;
  min-width: 85px;
  max-width: 85px;
  flex-shrink: 0;
}

.weight-card-modern:hover {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.12) 0%, rgba(16, 185, 129, 0.18) 100%);
  border-color: rgba(34, 197, 94, 0.3);
}

.weight-card-modern:active {
  transform: scale(0.98);
}

.weight-card-modern.weight-card-empty {
  background: linear-gradient(135deg, rgba(251, 146, 60, 0.08) 0%, rgba(249, 115, 22, 0.12) 100%);
  border-color: rgba(251, 146, 60, 0.3);
  animation: pulse-weight 2s ease-in-out infinite;
}

.weight-card-left {
  display: flex;
  align-items: center;
}

.weight-card-label {
  font-size: 10px;
  font-weight: 600;
  color: var(--color-slate-500);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.weight-card-row {
  display: flex;
  flex-direction: row;
  align-items: baseline;
  gap: 2px;
}

.weight-card-value {
  display: flex;
  align-items: baseline;
  gap: 2px;
}

.weight-value-number {
  font-size: 18px;
  font-weight: 700;
  color: #166534;
}

.weight-card-empty .weight-value-number {
  color: #c2410c;
  font-size: 16px;
}

.weight-value-unit {
  font-size: 13px;
  font-weight: 600;
  color: var(--color-slate-500);
  margin-left: 2px;
}

.weight-card-bottom-row {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-top: 2px;
}

.weight-card-trend {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: 2px;
  font-size: 11px;
  font-weight: 600;
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç—Ä–µ–Ω–¥–∞ —Å DEV –∫–Ω–æ–ø–∫–æ–π */
.weight-trend-row {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: 6px;
  margin-top: 2px;
}

/* DEV: –ú–∏–Ω–∏-–∫–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –≤–µ—Å–∞ */
.dev-clear-weight-mini {
  width: 14px;
  height: 14px;
  min-width: 14px;
  padding: 0;
  border: none;
  border-radius: 50%;
  background: rgba(107, 114, 128, 0.2);
  color: var(--color-gray-500);
  font-size: 10px;
  line-height: 1;
  cursor: pointer;
  opacity: 0.5;
  transition: all 0.15s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.dev-clear-weight-mini:hover {
  opacity: 1;
  background: rgba(220, 38, 38, 0.2);
  color: #dc2626;
}

.weight-clear-btn-mini {
  width: 14px;
  height: 14px;
  padding: 0;
  border: none;
  border-radius: 50%;
  background: rgba(220, 38, 38, 0.15);
  color: #dc2626;
  font-size: 10px;
  line-height: 1;
  cursor: pointer;
  opacity: 0.5;
  transition: all 0.15s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.weight-clear-btn-mini:hover {
  opacity: 1;
  background: rgba(220, 38, 38, 0.25);
}

.trend-arrow {
  font-size: 10px;
}

.weight-card-trend.trend-down {
  color: var(--success-dark);
}

.weight-card-trend.trend-up {
  color: #dc2626;
}

.weight-card-trend.trend-same {
  color: var(--color-slate-500);
}

/* === 21. DEFICIT CARD === */
.deficit-card-modern {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 2px;
  padding: 6px 4px;
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.08) 0%, rgba(139, 92, 246, 0.12) 100%);
  border: 1px solid rgba(99, 102, 241, 0.2);
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.2s ease;
  width: 85px;
  min-width: 85px;
  max-width: 85px;
  flex-shrink: 0;
}

.deficit-card-modern:hover {
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.12) 0%, rgba(139, 92, 246, 0.18) 100%);
  border-color: rgba(99, 102, 241, 0.3);
}

.deficit-card-modern:active {
  transform: scale(0.98);
}

.deficit-value-number {
  font-size: 18px;
  font-weight: 700;
  color: #4f46e5;
}

.deficit-value-number.deficit-negative {
  color: var(--success-dark);
}

.deficit-value-number.deficit-positive {
  color: #f59e0b;
}

/* Deficit trend (—Ä–∞–∑–Ω–∏—Ü–∞ –æ—Ç –ø—Ä–æ—Ñ–∏–ª—è) */
.deficit-card-trend {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: 2px;
  font-size: 11px;
  font-weight: 600;
  margin-top: 2px;
}

.deficit-card-trend.trend-down {
  color: var(--success-dark);
}

.deficit-card-trend.trend-up {
  color: #f59e0b;
}

/* === 22. DEFICIT PICKER MODAL === */
.deficit-picker-modal {
  max-width: 280px;
}

.deficit-picker-hint {
  font-size: 12px;
  color: var(--color-slate-500);
  text-align: center;
  padding: 12px 16px 8px;
  line-height: 1.4;
}

.deficit-wheels {
  justify-content: center;
  padding-bottom: 16px;
}

/* === 23. HOUSEHOLD (–ë—ã—Ç–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å) PICKER === */
.activity-cards-row {
  display: flex;
  gap: 8px;
  margin-bottom: 8px;
}

/* –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –±—ã—Ç + –∫–Ω–æ–ø–∫–∞ */
.activity-right-col {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.household-activity-card {
  flex: 1;
  background: var(--color-white);
  border: 1px solid #e5e7eb;
  border-radius: 12px;
  padding: 12px 14px;
  cursor: pointer;
  transition: all 0.2s ease;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  display: flex;
  flex-direction: column;
}

.household-activity-card:hover {
  border-color: #22c55e;
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(34, 197, 94, 0.15);
}

.household-activity-card:active {
  transform: translateY(0);
}

.household-activity-header {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 6px;
}

.household-activity-icon {
  font-size: 16px;
}

.household-activity-title {
  font-size: 12px;
  font-weight: 600;
  color: #166534;
}

.household-activity-value {
  display: flex;
  align-items: center;
  gap: 4px;
  flex-wrap: wrap;
}

.household-value-number {
  font-size: 26px;
  font-weight: 700;
  color: var(--success-dark);
  line-height: 1;
}

.household-value-unit {
  font-size: 13px;
  color: #15803d;
  font-weight: 500;
}

.household-value-time {
  font-size: 12px;
  color: var(--color-indigo-500, #6366f1);
  font-weight: 600;
  margin-left: 4px;
}

.household-value-kcal {
  font-size: 12px;
  color: #22c55e;
  font-weight: 500;
  margin-top: 2px;
}

/* –°—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É - –æ—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ */
.household-stats-link {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 12px;
  color: var(--color-slate-400);
  font-weight: 400;
  margin-top: 2px;
}

.household-help-icon {
  width: 14px;
  height: 14px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: var(--color-slate-200);
  color: var(--color-slate-500);
  border-radius: 50%;
  font-size: 10px;
  font-weight: 600;
}

.household-activity-hint {
  font-size: 12px;
  color: var(--color-slate-400);
  margin-top: auto;
  padding-top: 8px;
}

/* –ö–Ω–æ–ø–∫–∞ "+ –î–æ–±–∞–≤–∏—Ç—å" –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ –±—ã—Ç–æ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ */
.household-add-btn {
  width: 100%;
  margin-top: 8px;
  padding: 10px 12px;
  border: 1px dashed #22c55e;
  background: rgba(34, 197, 94, 0.08);
  color: #16a34a;
  border-radius: 8px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.15s ease;
}

.household-add-btn:hover {
  border-color: #16a34a;
  background: rgba(34, 197, 94, 0.15);
}

.household-add-btn:active {
  transform: scale(0.98);
}

/* –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –≤ –ø—Ä–∞–≤–æ–π –∫–æ–ª–æ–Ω–∫–µ */
.add-training-btn {
  padding: 14px 12px;
  border: 1px dashed #f97316;
  background: rgba(249, 115, 22, 0.08);
  color: #ea580c;
  border-radius: 10px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.15s ease;
  white-space: nowrap;
}

.add-training-btn:hover {
  border-color: #ea580c;
  color: #c2410c;
  background: rgba(249, 115, 22, 0.15);
}

.add-training-btn:active {
  transform: scale(0.98);
}

.household-activity-card:active {
  transform: translateY(0);
}

.household-activity-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
}

.household-activity-icon {
  font-size: 18px;
}

.household-activity-title {
  font-size: 14px;
  font-weight: 600;
  color: #166534;
}

.household-activity-value {
  display: flex;
  align-items: baseline;
  gap: 4px;
}

.household-value-number {
  font-size: 28px;
  font-weight: 700;
  color: var(--success-dark);
}

.household-value-unit {
  font-size: 14px;
  color: #15803d;
  font-weight: 500;
}

.household-value-kcal {
  font-size: 12px;
  color: #22c55e;
  margin-left: 8px;
  font-weight: 500;
}

/* === 24. FORMULA CARD (–†–∞—Å—á—ë—Ç –∫–∞–ª–æ—Ä–∏–π) === */
.formula-card {
  flex: 1;
  background: var(--color-white);
  border: 1px solid #e5e7eb;
  border-radius: 12px;
  padding: 12px 16px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

.formula-card-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 10px;
}

.formula-card-icon {
  font-size: 16px;
}

.formula-card-title {
  font-size: 14px;
  font-weight: 600;
  color: #374151;
}

.formula-card-rows {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.formula-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 12px;
}

.formula-label {
  color: var(--color-gray-500);
}

.formula-value {
  font-weight: 600;
  color: #374151;
}

.formula-row.formula-total {
  margin-top: 6px;
  padding-top: 6px;
  border-top: 1px solid #e5e7eb;
}

.formula-row.formula-total .formula-label {
  font-weight: 600;
  color: #374151;
}

.formula-row.formula-total .formula-value {
  font-size: 16px;
  color: var(--success-dark);
  font-weight: 700;
}

.formula-row.formula-subtotal {
  margin-top: 4px;
  padding-top: 4px;
  border-top: 1px dashed #e5e7eb;
}

/* üî• NDTE ‚Äî —ç—Ñ—Ñ–µ–∫—Ç –≤—á–µ—Ä–∞—à–Ω–µ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ */
.formula-row.ndte-row {
  background: linear-gradient(90deg, rgba(16, 185, 129, 0.08), transparent);
  border-radius: 4px;
  padding: 2px 4px;
  margin: 2px 0;
}

.formula-row.ndte-row .formula-label {
  color: #10b981;
  font-weight: 500;
}

.formula-row.ndte-row .formula-value {
  color: #10b981;
  font-weight: 600;
}

.formula-row.formula-subtotal .formula-label {
  font-weight: 500;
  color: var(--color-gray-500);
}

.formula-row.formula-subtotal .formula-value {
  font-weight: 600;
  color: #374151;
}

.formula-row.deficit .formula-label {
  color: #dc2626;
}

.formula-row.deficit .formula-value {
  color: #dc2626;
  font-weight: 600;
}

.formula-row.surplus .formula-label {
  color: var(--success-dark);
}

.formula-row.surplus .formula-value {
  color: var(--success-dark);
  font-weight: 600;
}

.household-picker-modal {
  max-width: 300px;
}

.household-picker-hint {
  font-size: 13px;
  color: var(--color-slate-500);
  text-align: center;
  padding: 12px 16px 8px;
  line-height: 1.5;
}

.household-wheels {
  justify-content: center;
  padding-bottom: 16px;
  gap: 8px;
}

.household-wheel-unit {
  font-size: 20px;
  font-weight: 600;
  color: var(--success-dark);
  align-self: center;
  margin-left: 8px;
}

/* Zone Minutes Picker */
.zone-picker-modal {
  max-width: 260px;
}

.zone-picker-kcal-hint {
  text-align: center;
  font-size: 18px;
  font-weight: 600;
  color: #f97316;
  padding: 8px 0 4px;
}

.zone-wheels {
  justify-content: center;
  padding-bottom: 16px;
}

/* Zone Formula Popup */
.zone-formula-backdrop {
  position: fixed;
  inset: 0;
  z-index: 9999;
  background: rgba(0, 0, 0, 0.2);
  animation: fadeIn 0.15s ease;
}

.zone-formula-popup {
  background: var(--color-white);
  border-radius: 16px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
  padding: 16px;
  min-width: 200px;
  max-width: 280px;
  animation: zoneFormulaFadeIn 0.15s ease-out;
}

@keyframes zoneFormulaFadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.zone-formula-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--color-slate-100);
}

.zone-formula-badge {
  background: linear-gradient(135deg, #3b82f6, #2563eb);
  color: white;
  font-weight: 700;
  font-size: 12px;
  padding: 4px 8px;
  border-radius: 6px;
}

.zone-formula-name {
  font-weight: 600;
  font-size: 15px;
  color: var(--color-slate-700);
}

.zone-formula-values {
  display: flex;
  flex-direction: column;
  gap: 6px;
  margin-bottom: 12px;
}

.zone-formula-row {
  display: flex;
  justify-content: space-between;
  font-size: 13px;
}

.zone-formula-label {
  color: var(--color-slate-500);
}

.zone-formula-value {
  font-weight: 600;
  color: var(--color-slate-700);
}

.zone-formula-calc {
  background: var(--color-slate-50);
  border-radius: 10px;
  padding: 10px 12px;
  margin-bottom: 10px;
}

.zone-formula-expression {
  font-family: ui-monospace, 'SF Mono', Menlo, monospace;
  font-size: 12px;
  color: var(--color-slate-500);
  margin-bottom: 4px;
}

.zone-formula-result {
  font-size: 18px;
  font-weight: 700;
  color: #f97316;
}

.zone-formula-hint {
  font-size: 12px;
  color: var(--color-slate-400);
  text-align: center;
}

.zone-formula-edit-btn {
  width: 100%;
  padding: 10px;
  background: linear-gradient(135deg, #3b82f6, #2563eb);
  color: white;
  font-weight: 600;
  font-size: 14px;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.15s ease;
}

.zone-formula-edit-btn:active {
  transform: scale(0.98);
  opacity: 0.9;
}

.zone-formula-badge.household {
  background: linear-gradient(135deg, #22c55e, #16a34a);
}

/* –ö–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π badge –∫–∞–ª–æ—Ä–∏–π */
.compact-badge.clickable {
  cursor: pointer;
  transition: all 0.15s ease;
}

.compact-badge.clickable:active {
  transform: scale(0.95);
  opacity: 0.8;
}

/* –ü–æ–¥—Å–∫–∞–∑–∫–∞ "–Ω–∞–∂–º–∏ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è" */
.tap-hint {
  font-size: 11px;
  color: var(--color-slate-400);
  font-style: italic;
  margin-left: auto;
}

.household-detail.tap-hint {
  margin-left: auto;
}

/* Training Picker Modal */
.training-picker-modal {
  max-width: 340px;
  width: 95vw;
}

.training-type-section {
  padding: 12px 16px 8px;
}

.training-type-label {
  font-size: 13px;
  font-weight: 500;
  color: var(--color-slate-500);
  margin-bottom: 8px;
  display: block;
}

.training-type-buttons {
  display: flex;
  gap: 8px;
}

.training-type-btn {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  padding: 12px 8px;
  border: 2px solid var(--color-slate-200);
  border-radius: 12px;
  background: var(--color-white);
  cursor: pointer;
  transition: all 0.15s ease;
}

.training-type-btn:active {
  transform: scale(0.95);
}

.training-type-btn.active {
  border-color: #f97316;
  background: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);
}

.training-type-icon {
  font-size: 24px;
}

.training-type-text {
  font-size: 11px;
  font-weight: 500;
  color: var(--color-slate-500);
}

.training-type-btn.active .training-type-text {
  color: #ea580c;
  font-weight: 600;
}

.training-time-section {
  padding: 8px 16px 0;
}

.training-time-label {
  font-size: 13px;
  font-weight: 500;
  color: var(--color-slate-500);
  margin-bottom: 4px;
  display: block;
  text-align: center;
}

.training-time-wheels {
  justify-content: center;
  padding-bottom: 8px;
}

/* Compact train time display */
.compact-train-time {
  font-size: 12px;
  color: var(--color-slate-500);
  background: var(--color-slate-100);
  padding: 2px 6px;
  border-radius: 4px;
  margin-left: 4px;
}

/* Make compact-train-header clickable */
.compact-train-header {
  cursor: pointer;
  transition: background 0.15s;
}

.compact-train-header:active {
  background: #f8fafc;
}

/* Training Zones Section in Modal */
.training-zones-section {
  padding: 12px 8px 16px;
}

.training-zones-label {
  font-size: 14px;
  font-weight: 500;
  color: var(--color-slate-500);
  margin-bottom: 12px;
  text-align: center;
}

.training-zones-wheels {
  display: flex;
  justify-content: center;
  gap: 2px;
}

.training-zone-column {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 72px;
}

.training-zone-header {
  font-size: 12px;
  font-weight: 600;
  padding: 4px 8px;
  border-radius: 6px;
  margin-bottom: 4px;
}

.training-zone-header.zone-color-1 { background: #dbeafe; color: #2563eb; }
.training-zone-header.zone-color-2 { background: #dcfce7; color: var(--success-dark); }
.training-zone-header.zone-color-3 { background: #fef3c7; color: #d97706; }
.training-zone-header.zone-color-4 { background: #fee2e2; color: #dc2626; }

.training-zone-column .wheel-column {
  width: 70px;
}

.training-zone-column .wheel-viewport {
  height: 220px;
}

.training-zones-kcal {
  text-align: center;
  font-size: 16px;
  font-weight: 600;
  color: #f97316;
  padding: 8px 0 4px;
}

/* Training zones stats (time + kcal) */
.training-zones-stats {
  display: flex;
  justify-content: center;
  gap: 16px;
  padding: 12px 0 8px;
}

.training-zones-time {
  font-size: 16px;
  font-weight: 600;
  color: var(--color-blue-500);
}

.training-zones-stats .training-zones-kcal {
  padding: 0;
}

/* Training presets */
.training-presets-section {
  padding: 8px 16px 12px;
  border-top: 1px solid #e5e7eb;
}

.training-presets-label {
  font-size: 13px;
  font-weight: 500;
  color: var(--color-slate-500);
  margin-bottom: 8px;
  text-align: center;
}

.training-presets-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
}

.training-preset-btn {
  padding: 10px 12px;
  font-size: 13px;
  font-weight: 500;
  color: #374151;
  background: #f8fafc;
  border: 1px solid var(--color-slate-200);
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.15s;
  text-align: left;
}

.training-preset-btn:active {
  transform: scale(0.97);
  background: var(--color-slate-100);
}

/* Shake animation for validation */
@keyframes shake {
  0%, 100% { transform: translateX(0); }
  20%, 60% { transform: translateX(-8px); }
  40%, 80% { transform: translateX(8px); }
}

.training-zones-section.shake {
  animation: shake 0.5s ease-in-out;
}

/* === 25. Training Rating Section (Step 3) === */
.training-rating-section {
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.training-rating-row {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.training-rating-header {
  display: flex;
  align-items: center;
  gap: 8px;
}

.training-rating-emoji {
  font-size: 24px;
}

.training-rating-label {
  flex: 1;
  font-size: 14px;
  font-weight: 500;
  color: #374151;
}

.training-rating-value {
  font-size: 16px;
  font-weight: 600;
  min-width: 50px;
  text-align: right;
}

.training-rating-presets {
  display: flex;
  gap: 8px;
}

.training-rating-presets .mood-preset {
  flex: 1;
  font-size: 12px;
  padding: 8px 10px;
}

/* Training Comment Block */
.training-comment-wrapper {
  margin: 0 16px 16px;
  transition: all 0.3s ease;
}

.training-comment-prompt {
  display: flex;
  flex-direction: column;
  gap: 10px;
  padding: 12px 14px;
  border-radius: 14px;
  transition: all 0.3s ease;
}

.training-comment-prompt.neutral {
  background: rgba(156, 163, 175, 0.08);
  border: 1px solid rgba(156, 163, 175, 0.15);
}

.training-comment-prompt.positive {
  background: rgba(16, 185, 129, 0.08);
  border: 1px solid rgba(16, 185, 129, 0.15);
}

.training-comment-prompt.negative {
  background: rgba(239, 68, 68, 0.08);
  border: 1px solid rgba(239, 68, 68, 0.15);
}

.training-comment-prompt .training-comment-icon {
  font-size: 20px;
}

.training-comment-prompt .training-comment-text {
  font-size: 13px;
  font-weight: 500;
  color: var(--color-gray-500);
}

.training-comment-prompt.positive .training-comment-text {
  color: #059669;
}

.training-comment-prompt.negative .training-comment-text {
  color: #dc2626;
}

.training-comment-input {
  width: 100%;
  border: none;
  background: rgba(255, 255, 255, 0.8);
  border-radius: 8px;
  padding: 10px 12px;
  font-size: 14px;
  color: #1c1c1e;
  outline: none;
}

.training-comment-input::placeholder {
  color: var(--color-gray-400);
}

.training-comment-input:focus {
  background: var(--color-white);
  box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2);
}

/* Training Card Summary (duration + ratings) */
.training-card-summary {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid rgba(0, 0, 0, 0.06);
  flex-wrap: wrap;
}

/* Training Card Duration */
.training-card-duration {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
  border: 1px solid #bbf7d0;
  border-radius: 10px;
  font-size: 13px;
  font-weight: 600;
  color: #16a34a;
}

.training-card-duration-icon {
  font-size: 14px;
}

.training-card-duration-value {
  letter-spacing: 0.3px;
}

/* Training Card Rating Display */
.training-card-ratings {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  flex: 1;
}

.training-card-rating {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 12px;
  border-radius: 10px;
  font-size: 12px;
  transition: transform 0.15s ease;
}

.training-card-rating:hover {
  transform: translateY(-1px);
}

.training-card-rating.quality {
  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
  border: 1px solid #fcd34d;
}

.training-card-rating.feel {
  background: linear-gradient(135deg, #ede9fe 0%, #ddd6fe 100%);
  border: 1px solid #c4b5fd;
}

/* Physical (physical —Å–æ—Å—Ç–æ—è–Ω–∏–µ) - –æ—Ä–∞–Ω–∂–µ–≤—ã–π */
.training-card-rating.physical {
  background: linear-gradient(135deg, #ffedd5 0%, #fed7aa 100%);
  border: 1px solid #fdba74;
}

.training-card-rating.physical .training-card-rating-value {
  color: #ea580c;
}

/* Wellbeing (—Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ) - —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π */
.training-card-rating.wellbeing {
  background: linear-gradient(135deg, #ede9fe 0%, #ddd6fe 100%);
  border: 1px solid #c4b5fd;
}

.training-card-rating.wellbeing .training-card-rating-value {
  color: #7c3aed;
}

/* Mood (–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ) - –∑–µ–ª—ë–Ω—ã–π */
.training-card-rating.mood {
  background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
  border: 1px solid #86efac;
}

.training-card-rating.mood .training-card-rating-value {
  color: #16a34a;
}

/* Stress (—É—Å—Ç–∞–ª–æ—Å—Ç—å) - —Å–∏–Ω–∏–π */
.training-card-rating.stress {
  background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
  border: 1px solid #93c5fd;
}

.training-card-rating.stress .training-card-rating-value {
  color: #2563eb;
}

.training-card-rating-emoji {
  font-size: 18px;
}

.training-card-rating-text {
  display: flex;
  flex-direction: column;
  gap: 1px;
}

.training-card-rating-label {
  font-size: 10px;
  font-weight: 500;
  color: var(--color-gray-500);
  text-transform: uppercase;
  letter-spacing: 0.3px;
}

.training-card-rating-value {
  font-weight: 700;
  font-size: 13px;
}

.training-card-rating.quality .training-card-rating-value {
  color: #d97706;
}

.training-card-rating.feel .training-card-rating-value {
  color: #7c3aed;
}

.training-card-comment {
  margin-top: 10px;
  padding: 10px 12px;
  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
  border: 1px solid #e2e8f0;
  border-radius: 10px;
  font-size: 13px;
  color: var(--color-gray-600);
  font-style: italic;
  line-height: 1.4;
}

/* Clickable zone values */
.zone-clickable {
  cursor: pointer;
  transition: transform 0.1s;
}

.zone-clickable:active {
  transform: scale(0.95);
}

.zone-clickable:active .compact-zone-value {
  background: var(--color-slate-100);
  border-color: #cbd5e1;
}

.compact-zone-value {
  font-weight: 600;
  font-size: 14px;
  min-width: 36px;
  text-align: center;
  display: inline-block;
  background: var(--color-white);
  border-radius: 6px;
  padding: 4px 8px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.08);
  border: 1px solid var(--color-slate-200);
}

.weight-card-chevron {
  display: none;
}

/* –ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ –∫–æ–ª—ë—Å–∞ –≤ dropdown */
.weight-picker-wheels-inline .wheel-column {
  width: 50px;
}

.weight-picker-wheels-inline .wheel-viewport {
  height: 120px;
}

.weight-picker-wheels-inline .wheel-item {
  font-size: 18px;
}

.weight-picker-wheels-inline .wheel-item.selected {
  font-size: 20px;
}

.weight-picker-wheels-inline .wheel-highlight {
  height: 36px;
}

@keyframes pulse-weight {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}

/* === 26. WEIGHT PICKER MODAL === */
.weight-picker-modal {
  max-width: 320px;
}

/* Step indicator dots */
.picker-steps-indicator {
  display: flex;
  justify-content: center;
  gap: 8px;
  padding: 12px 0 8px;
  border-bottom: 1px solid #e5e7eb;
}

.picker-step-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #d1d5db;
  transition: background 0.2s ease;
}

.picker-step-dot.active {
  background: #6366f1;
}

/* DEV: Clear weight button */
.dev-clear-weight-btn {
  display: block;
  margin: 8px auto;
  padding: 6px 12px;
  font-size: 12px;
  color: var(--color-red-500);
  background: rgba(239, 68, 68, 0.1);
  border: 1px dashed var(--color-red-500);
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.15s ease;
}

.dev-clear-weight-btn:hover {
  background: rgba(239, 68, 68, 0.2);
}

.dev-clear-weight-btn:active {
  transform: scale(0.95);
}

/* Weight card bottom row: trend + mini clear button */
.weight-card-bottom-row {
  justify-content: center;
}

/* DEV: Mini clear weight button */
.dev-clear-weight-btn-mini {
  width: 16px;
  height: 16px;
  padding: 0;
  font-size: 12px;
  line-height: 14px;
  color: var(--color-gray-400);
  background: transparent;
  border: 1px solid #e5e7eb;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.15s ease;
  flex-shrink: 0;
  opacity: 0.6;
}

.dev-clear-weight-btn-mini:hover {
  color: var(--color-red-500);
  border-color: var(--color-red-500);
  background: rgba(239, 68, 68, 0.1);
  opacity: 1;
}

.dev-clear-weight-btn-mini:active {
  transform: scale(0.9);
}

.weight-picker-section {
  padding: 12px 16px;
  border-bottom: 1px solid #e5e7eb;
}

.weight-picker-section:last-child {
  border-bottom: none;
}

.weight-picker-section-label {
  font-size: 13px;
  font-weight: 600;
  color: var(--color-slate-500);
  margin-bottom: 8px;
  text-align: center;
}

.weight-wheels {
  justify-content: center;
  gap: 0;
}

.weight-picker-dot {
  font-size: 28px;
  font-weight: 600;
  color: #000;
  padding: 0 4px;
  align-self: center;
}

.weight-picker-unit {
  font-size: 20px;
  font-weight: 600;
  color: #000;
  align-self: center;
  margin-left: 4px;
}

/* Steps Goal Section */
.steps-goal-section {
  padding: 12px 16px;
}

.steps-goal-wheels {
  justify-content: center;
  gap: 8px;
}

.steps-goal-wheel-unit {
  font-size: 20px;
  font-weight: 600;
  color: #000;
  align-self: center;
  margin-left: 8px;
}

.steps-goal-input-row {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  margin-bottom: 8px;
}

.steps-goal-input {
  width: 100px;
  padding: 8px 12px;
  font-size: 18px;
  font-weight: 600;
  text-align: center;
  border: 2px solid #e5e7eb;
  border-radius: 8px;
  background: #f8fafc;
  color: var(--success-dark);
}

.steps-goal-input:focus {
  outline: none;
  border-color: var(--success-dark);
  background: var(--color-white);
}

.steps-goal-unit {
  font-size: 14px;
  color: var(--color-slate-500);
}

.steps-goal-presets {
  display: flex;
  justify-content: center;
  gap: 6px;
}

.steps-goal-preset {
  padding: 6px 12px;
  font-size: 12px;
  font-weight: 600;
  color: var(--color-slate-500);
  background: var(--color-slate-100);
  border: 1px solid var(--color-slate-200);
  border-radius: 16px;
  cursor: pointer;
  transition: all 0.15s ease;
}

.steps-goal-preset:active {
  transform: scale(0.95);
}

.steps-goal-preset.active {
  color: var(--color-white);
  background: var(--success-dark);
  border-color: var(--success-dark);
}

/* === 27. FAB (Floating Action Button) === */
.fab-add-meal {
  position: fixed;
  bottom: calc(90px + env(safe-area-inset-bottom, 0px)); /* –Ω–∞–¥ –Ω–∏–∂–Ω–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π + safe-area –¥–ª—è iPhone */
  right: 20px;
  width: 64px;
  height: 64px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--color-blue-500) 0%, #2563eb 100%);
  color: white;
  font-size: 36px;
  font-weight: 300;
  border: none;
  box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: transform 0.2s, box-shadow 0.2s;
  z-index: 100;
}

.fab-add-meal:hover {
  transform: scale(1.1);
  box-shadow: 0 6px 20px rgba(37, 99, 235, 0.5);
}

.fab-add-meal:active {
  transform: scale(0.95);
}

/* === 28. MACRO TOAST ‚Äî –ø–æ–¥—Å–∫–∞–∑–∫–∞ –ë–ñ–£ —Å–Ω–∏–∑—É === */
.macro-toast {
  position: fixed;
  bottom: calc(80px + env(safe-area-inset-bottom, 0px)); /* –Ω–∞–¥ –Ω–∏–∂–Ω–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π + safe-area */
  left: 50%;
  transform: translateX(-50%) translateY(100px);
  display: flex;
  flex-direction: column;
  align-items: stretch;
  gap: 4px;
  padding: 12px 16px;
  /* Gradient border + pastel background */
  border: 2px solid transparent;
  border-radius: 12px;
  background: 
    linear-gradient(var(--toast-bg, var(--color-white)), var(--toast-bg, var(--color-white))) padding-box,
    var(--toast-gradient, linear-gradient(135deg, #94a3b8 0%, #64748b 100%)) border-box;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
  z-index: 1000;
  opacity: 0;
  transition: transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.25s ease;
  width: 80%; /* 4/5 —à–∏—Ä–∏–Ω—ã —ç–∫—Ä–∞–Ω–∞ */
  max-width: 400px; /* –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –±–æ–ª—å—à–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö */
  cursor: pointer;
}

.macro-toast.visible {
  transform: translateX(-50%) translateY(0);
  opacity: 1;
}

.macro-toast-icon {
  font-size: 20px;
  flex-shrink: 0;
}

.macro-toast-text {
  font-size: 14px;
  font-weight: 500;
  color: var(--color-slate-700);
  line-height: 1.3;
}

.macro-toast-close {
  width: 24px;
  height: 24px;
  border: none;
  background: var(--color-slate-100);
  border-radius: 50%;
  font-size: 16px;
  color: var(--color-slate-500);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  margin-left: 4px;
}

.macro-toast-close:hover {
  background: var(--color-slate-200);
  color: var(--color-slate-700);
}

/* –¶–≤–µ—Ç–∞ –ø–æ —Ç–∏–ø—É */
.macro-toast-protein {
  border-left: 4px solid var(--color-red-500);
}

.macro-toast-fat {
  border-left: 4px solid #f59e0b;
}

.macro-toast-carbs {
  border-left: 4px solid var(--color-blue-500);
}

/* === Toast Gradient Borders + Pastel Backgrounds –ø–æ —Ç–∏–ø–∞–º === */
.macro-toast-warning {
  --toast-gradient: linear-gradient(135deg, #fca5a5 0%, #ef4444 100%);
  --toast-bg: #fef2f2; /* red-50 */
}

.macro-toast-success {
  --toast-gradient: linear-gradient(135deg, #6ee7b7 0%, #10b981 100%);
  --toast-bg: #ecfdf5; /* emerald-50 */
}

/* Fiber - –∑–µ–ª—ë–Ω—ã–π (–∫–ª–µ—Ç—á–∞—Ç–∫–∞) */
.macro-toast-fiber {
  --toast-gradient: linear-gradient(135deg, #6ee7b7 0%, #10b981 100%);
  --toast-bg: #ecfdf5; /* emerald-50 */
}

/* Tip - —Å–∏–Ω–∏–π (–ø–æ–¥—Å–∫–∞–∑–∫–∏) */
.macro-toast-tip {
  --toast-gradient: linear-gradient(135deg, #93c5fd 0%, #3b82f6 100%);
  --toast-bg: #eff6ff; /* blue-50 */
}

/* Achievement - –∑–æ–ª–æ—Ç–æ–π —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π */
.macro-toast-achievement {
  --toast-gradient: linear-gradient(135deg, #fde047 0%, #f59e0b 100%);
  --toast-bg: #fefce8; /* yellow-50 */
  animation: achievementPulse 0.5s ease-out;
}

/* Streak - –æ–≥–Ω–µ–Ω–Ω—ã–π */
.macro-toast-streak {
  --toast-gradient: linear-gradient(135deg, #fdba74 0%, #f97316 100%);
  --toast-bg: #fff7ed; /* orange-50 */
}

/* Emotional - —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π */
.macro-toast-emotional {
  --toast-gradient: linear-gradient(135deg, #c4b5fd 0%, #8b5cf6 100%);
  --toast-bg: #f5f3ff; /* violet-50 */
}

/* Hydration - –≥–æ–ª—É–±–æ–π */
.macro-toast-hydration {
  --toast-gradient: linear-gradient(135deg, #67e8f9 0%, #06b6d4 100%);
  --toast-bg: #ecfeff; /* cyan-50 */
}

/* Nutrition - –∑–µ–ª–µ–Ω–æ–≤–∞—Ç—ã–π */
.macro-toast-nutrition {
  --toast-gradient: linear-gradient(135deg, #86efac 0%, #22c55e 100%);
  --toast-bg: #f0fdf4; /* green-50 */
}

/* Lifestyle - –∏–Ω–¥–∏–≥–æ */
.macro-toast-lifestyle {
  --toast-gradient: linear-gradient(135deg, #a5b4fc 0%, #6366f1 100%);
  --toast-bg: #eef2ff; /* indigo-50 */
}

/* Dark mode ‚Äî –±–æ–ª–µ–µ —Ç—ë–º–Ω—ã–µ –ø–∞—Å—Ç–µ–ª—å–Ω—ã–µ –æ—Ç—Ç–µ–Ω–∫–∏ */
[data-theme="dark"] .macro-toast { --toast-bg: var(--bg-primary, #1f2937); }
[data-theme="dark"] .macro-toast-warning { --toast-bg: rgba(239, 68, 68, 0.15); }
[data-theme="dark"] .macro-toast-success { --toast-bg: rgba(16, 185, 129, 0.15); }
[data-theme="dark"] .macro-toast-fiber { --toast-bg: rgba(16, 185, 129, 0.15); }
[data-theme="dark"] .macro-toast-tip { --toast-bg: rgba(59, 130, 246, 0.15); }
[data-theme="dark"] .macro-toast-achievement { --toast-bg: rgba(245, 158, 11, 0.15); }
[data-theme="dark"] .macro-toast-streak { --toast-bg: rgba(249, 115, 22, 0.15); }
[data-theme="dark"] .macro-toast-emotional { --toast-bg: rgba(139, 92, 246, 0.15); }
[data-theme="dark"] .macro-toast-hydration { --toast-bg: rgba(6, 182, 212, 0.15); }
[data-theme="dark"] .macro-toast-nutrition { --toast-bg: rgba(34, 197, 94, 0.15); }
[data-theme="dark"] .macro-toast-lifestyle { --toast-bg: rgba(99, 102, 241, 0.15); }

@keyframes achievementPulse {
  0% { transform: translateX(-50%) scale(0.9); }
  50% { transform: translateX(-50%) scale(1.05); }
  100% { transform: translateX(-50%) scale(1); }
}

/* Progress bar –¥–ª—è auto-hide */
.macro-toast-progress {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 3px;
  background: currentColor;
  opacity: 0.3;
  border-radius: 0 0 12px 12px;
  animation: toast-progress 7.5s linear forwards;
}

@keyframes toast-progress {
  from { width: 100%; }
  to { width: 0%; }
}

.macro-toast-achievement .macro-toast-progress {
  animation-duration: 10s;
}

/* Rating buttons (üëç/üëé) */
.macro-toast-rating {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  padding: 8px 0;
  margin-top: 4px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.macro-toast-rating-label {
  font-size: 12px;
  opacity: 0.7;
}

.macro-toast-rating-btn {
  background: rgba(255, 255, 255, 0.15);
  border: none;
  border-radius: 8px;
  padding: 6px 14px;
  font-size: 18px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.macro-toast-rating-btn:hover {
  background: rgba(255, 255, 255, 0.25);
  transform: scale(1.1);
}

.macro-toast-rating-btn:active {
  transform: scale(0.95);
}

/* Snooze button (–æ—Ç–ª–æ–∂–∏—Ç—å —Å–æ–≤–µ—Ç) */
.macro-toast-snooze {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 8px 0;
  margin-top: 4px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.macro-toast-snooze-label {
  font-size: 11px;
  opacity: 0.7;
  margin-right: 4px;
}

.macro-toast-snooze-btn {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 16px;
  padding: 5px 12px;
  font-size: 12px;
  color: inherit;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  gap: 4px;
}

.macro-toast-snooze-btn:hover {
  background: rgba(255, 255, 255, 0.2);
  transform: scale(1.05);
}

.macro-toast-snooze-btn:active {
  transform: scale(0.95);
}

/* Micro-animations –ø–æ —Ç–∏–ø–∞–º —Å–æ–≤–µ—Ç–æ–≤ */
.macro-toast.anim-bounce {
  animation: adviceBounce 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes adviceBounce {
  0% { transform: translateX(-50%) scale(0.3) translateY(50px); opacity: 0; }
  50% { transform: translateX(-50%) scale(1.05) translateY(-5px); }
  100% { transform: translateX(-50%) scale(1) translateY(0); opacity: 1; }
}

.macro-toast.anim-shake {
  animation: adviceShake 0.5s ease-out;
}

@keyframes adviceShake {
  0%, 100% { transform: translateX(-50%) rotate(0); }
  10%, 30%, 50%, 70%, 90% { transform: translateX(-50%) rotate(-2deg); }
  20%, 40%, 60%, 80% { transform: translateX(-50%) rotate(2deg); }
}

.macro-toast.anim-fadeSlide {
  animation: adviceFadeSlide 0.3s ease-out;
}

@keyframes adviceFadeSlide {
  0% { transform: translateX(-50%) translateY(20px); opacity: 0; }
  100% { transform: translateX(-50%) translateY(0); opacity: 1; }
}

.macro-toast.anim-pulse {
  animation: advicePulse 0.4s ease-out;
}

@keyframes advicePulse {
  0% { transform: translateX(-50%) scale(0.8); opacity: 0; }
  50% { transform: translateX(-50%) scale(1.1); }
  100% { transform: translateX(-50%) scale(1); opacity: 1; }
}

.macro-toast.anim-glow {
  animation: adviceGlow 0.5s ease-out;
}

@keyframes adviceGlow {
  0% { transform: translateX(-50%) scale(0.9); box-shadow: 0 0 0 rgba(245, 158, 11, 0); }
  50% { box-shadow: 0 0 20px rgba(245, 158, 11, 0.5); }
  100% { transform: translateX(-50%) scale(1); box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15); }
}

/* Personal Best celebration */
.macro-toast.personal-best {
  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 50%, #fbbf24 100%);
  border-left: 4px solid #f59e0b;
}

.macro-toast.personal-best::before {
  content: '';
  position: absolute;
  top: -5px;
  right: -5px;
  width: 30px;
  height: 30px;
  background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23f59e0b'%3E%3Cpath d='M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z'/%3E%3C/svg%3E") center/contain no-repeat;
  animation: starSpin 1s ease-out;
}

@keyframes starSpin {
  0% { transform: rotate(-180deg) scale(0); opacity: 0; }
  50% { transform: rotate(0deg) scale(1.2); opacity: 1; }
  100% { transform: rotate(0deg) scale(1); opacity: 1; }
}

/* –ê–Ω–∏–º–∞—Ü–∏–∏ –∏–∫–æ–Ω–æ–∫ */
.macro-toast-achievement .macro-toast-icon {
  animation: fire-flicker 0.5s ease-in-out infinite alternate;
}

@keyframes fire-flicker {
  0% { transform: scale(1) rotate(-2deg); filter: brightness(1); }
  100% { transform: scale(1.05) rotate(2deg); filter: brightness(1.1); }
}

.macro-toast-warning .macro-toast-icon {
  animation: warning-pulse 1s ease-in-out infinite;
}

@keyframes warning-pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

.macro-toast-success .macro-toast-icon,
.macro-toast-fiber .macro-toast-icon {
  animation: success-bounce 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes success-bounce {
  0% { transform: scale(0); }
  50% { transform: scale(1.2); }
  100% { transform: scale(1); }
}

.macro-toast-tip .macro-toast-icon {
  animation: tip-wobble 0.5s ease-in-out;
}

@keyframes tip-wobble {
  0%, 100% { transform: rotate(0); }
  25% { transform: rotate(-10deg); }
  75% { transform: rotate(10deg); }
}

/* Swipe-to-dismiss */
.macro-toast {
  will-change: transform;
  touch-action: pan-x;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.32, 0.72, 0, 1);
}

/* === 29. EXPANDABLE ADVICE TOAST === */
.macro-toast.expanded {
  bottom: 90px;
  max-height: 400px;
  border-radius: 16px;
  flex-direction: column;
  align-items: stretch;
}

.macro-toast-main {
  display: flex;
  align-items: center;
  gap: 10px;
}

.macro-toast-main .macro-toast-text {
  flex: 1;
}

/* –î–µ—Ç–∞–ª–∏ —Å–æ–≤–µ—Ç–∞ –ø—Ä–∏ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–∏ */
.macro-toast-details {
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid rgba(255, 255, 255, 0.2);
  font-size: 13px;
  line-height: 1.5;
  color: rgba(255, 255, 255, 0.9);
  animation: slideDown 0.2s ease-out;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* –£–±—Ä–∞–Ω–∞ .macro-toast-badge ‚Äî —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ–º hint –≤–º–µ—Å—Ç–æ badge */

/* –ü–æ–¥—Å–∫–∞–∑–∫–∞ "–ï—â—ë X —Å–æ–≤–µ—Ç–æ–≤" –≤–Ω–∏–∑—É —Ç–æ—Å—Ç–∞ */
.macro-toast-hint {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 8px 16px;
  margin-top: 8px;
  background: rgba(255, 255, 255, 0.15);
  border-radius: 8px;
  font-size: 13px;
  color: rgba(255, 255, 255, 0.9);
  cursor: pointer;
  transition: all 0.2s ease;
}

.macro-toast-hint:hover {
  background: rgba(255, 255, 255, 0.25);
}

.macro-toast-hint:active {
  transform: scale(0.98);
}

.macro-toast-hint-arrow {
  font-size: 14px;
  animation: hintArrowPulse 1.5s infinite;
}

@keyframes hintArrowPulse {
  0%, 100% { transform: translateX(0); opacity: 0.7; }
  50% { transform: translateX(3px); opacity: 1; }
}

/* –ü–æ–¥—Å–∫–∞–∑–∫–∞ "–Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π" */
.macro-toast-tap-hint {
  display: block;
  width: 100%;
  margin-top: 8px;
  padding-top: 8px;
  border-top: 1px solid rgba(0, 0, 0, 0.08);
  font-size: 12px;
  font-style: italic;
  color: var(--color-slate-400, #94a3b8);
  text-align: center;
  animation: tapHintPulse 2s infinite;
}

@keyframes tapHintPulse {
  0%, 100% { opacity: 0.5; }
  50% { opacity: 0.8; }
}

.macro-toast-extras {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid rgba(255, 255, 255, 0.2);
  animation: slideDown 0.2s ease-out;
}

@keyframes slideDown {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}

.macro-toast-extra {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 12px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 10px;
  font-size: 13px;
}

.macro-toast-extra-warning { background: rgba(239, 68, 68, 0.2); }
.macro-toast-extra-achievement { background: rgba(234, 179, 8, 0.2); }
.macro-toast-extra-tip { background: rgba(59, 130, 246, 0.2); }
.macro-toast-extra-fiber { background: rgba(34, 197, 94, 0.2); }

/* Mobile: –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —à–∏—Ä–∏–Ω—É –∏ –≤—ã—Å–æ—Ç—É */
@media (max-width: 480px) {
  .macro-toast.expanded {
    max-height: 250px;
    overflow-y: auto;
    flex-direction: column;
    align-items: stretch;
  }
  
  .macro-toast-extras {
    max-height: 150px;
    overflow-y: auto;
  }
  
  .macro-toast-extra {
    font-size: 12px;
    padding: 6px 10px;
  }
}

/* === 30. PULL-TO-REFRESH (Modern Design) === */
.pull-indicator {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 6px;
  overflow: hidden;
  transition: height 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), 
              opacity 0.2s ease;
  margin: -12px -12px 8px -12px;
  padding-top: 12px;
  background: linear-gradient(
    180deg, 
    color-mix(in srgb, var(--acc) 8%, var(--bg)) 0%, 
    transparent 100%
  );
}

.pull-indicator.refreshing {
  height: 56px;
}

.pull-indicator.success {
  background: linear-gradient(
    180deg, 
    color-mix(in srgb, var(--success) 15%, var(--bg)) 0%, 
    transparent 100%
  );
}

.pull-spinner {
  position: relative;
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* SVG-based spinner for smooth animation */
.pull-spinner-ring {
  width: 28px;
  height: 28px;
  stroke: var(--acc);
  stroke-width: 3;
  fill: none;
  stroke-linecap: round;
  transform-origin: center;
  transition: stroke-dashoffset 0.15s ease-out;
}

.pull-spinner-ring.ready {
  stroke: var(--success);
}

.pull-spinner-ring.spinning {
  animation: pull-spin 0.8s cubic-bezier(0.4, 0, 0.2, 1) infinite;
}

@keyframes pull-spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* Fallback emoji spinner */
.pull-spinner-icon {
  font-size: 22px;
  color: var(--acc);
  transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1),
              color 0.2s ease;
}

.pull-spinner-icon.ready {
  color: var(--success);
  transform: scale(1.15);
}

.pull-spinner-icon.spinning {
  animation: pull-spin 0.8s cubic-bezier(0.4, 0, 0.2, 1) infinite;
}

.pull-spinner-icon.success {
  color: var(--success);
  animation: pull-success 0.4s ease-out forwards;
}

@keyframes pull-success {
  0% { transform: scale(1); }
  50% { transform: scale(1.3); }
  100% { transform: scale(1); }
}

.pull-text {
  font-size: 12px;
  color: var(--muted);
  font-weight: 500;
  transition: color 0.2s ease;
  letter-spacing: 0.02em;
}

.pull-text.ready {
  color: var(--success-dark);
  font-weight: 600;
}

.pull-text.syncing {
  color: var(--acc);
}

/* Ripple effect for threshold */
.pull-indicator::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  background: radial-gradient(
    circle,
    color-mix(in srgb, var(--success) 20%, transparent) 0%,
    transparent 70%
  );
  border-radius: 50%;
  transform: translate(-50%, -50%);
  opacity: 0;
  transition: width 0.3s ease, height 0.3s ease, opacity 0.3s ease;
}

.pull-indicator.ready::before {
  width: 120px;
  height: 120px;
  opacity: 1;
}
/* MODULE 02 ‚Äî Metrics & Graphs
 * Scope: metrics cards, sparkline, heatmap, sliders/brush, correlation/weight charts.
 */
