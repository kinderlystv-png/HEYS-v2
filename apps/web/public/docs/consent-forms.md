# Формы согласий

> Тексты для UI экрана согласий при регистрации  
> **Версия:** 1.2 (обновлено: 22 декабря 2025)

---

## Экран согласий (OnboardingConsent)

### Заголовок

```
Перед началом
```

### Подзаголовок

```
Нам нужно ваше согласие на несколько важных вещей
```

---

## Чекбокс 1: Пользовательское соглашение

### Краткий текст (в UI)

```
Принимаю Пользовательское соглашение
```

### При клике "Подробнее" — ключевые пункты

```
• Сервис для ведения дневника питания и получения рекомендаций
• Это НЕ медицинская услуга — при проблемах со здоровьем обращайтесь к врачу
• Куратор помогает с питанием и режимом, но не ставит диагнозы
• Вы можете отказаться от услуг в любой момент
```

---

## Чекбокс 2: Обработка персональных данных

### Краткий текст (в UI)

```
Согласен на обработку персональных данных
```

### При клике "Подробнее" — ключевые пункты

```
Мы будем обрабатывать:
• Ваше имя и телефон — для связи
• Возраст и пол — для расчёта норм

Ваши данные:
• Хранятся защищённо на серверах в России
• Не продаются третьим лицам
• Можно удалить в любой момент
```

---

## Чекбокс 3: Согласие на обработку данных о здоровье (СПЕЦИАЛЬНАЯ КАТЕГОРИЯ)

> ⚠️ **Требует ПЭП (простой электронной подписи)** согласно ч. 1 ст. 10 152-ФЗ

### Краткий текст (в UI)

```
Согласен на обработку данных о здоровье
```

### При клике "Подробнее" — ключевые пункты

```
К данным о здоровье относятся:
• Рост и вес, их динамика
• Данные о питании и пищевых привычках
• Данные о сне и активности
• Данные о менструальном цикле (при наличии)
• Данные о самочувствии и настроении

Эти данные нужны для:
• Персональной аналитики питания
• Рекомендаций от системы и куратора
• Отслеживания прогресса

Без этого согласия функционал приложения будет ограничен.
```

### Механизм ПЭП (подтверждение кодом)

После установки чекбокса показывается дополнительный шаг:

```
Для согласия на обработку данных о здоровье
необходимо подтверждение кодом.

Введите код из SMS:
[____]

[Отправить код повторно]
```

---

## Чекбокс 4 (опционально): Маркетинговые коммуникации

### Краткий текст (в UI)

```
Согласен получать полезные материалы и новости (можно отписаться)
```

---

## Дисклеймер «Не медицина» (всегда видимый)

### Текст под чекбоксами

```
⚠️ HEYS — это помощник в питании, а не врач. При проблемах со здоровьем обратитесь к специалисту.
```

---

## Кнопка подтверждения

### Текст кнопки

```
Продолжить
```

### Условие активации

- Чекбокс 1 отмечен ✓
- Чекбокс 2 отмечен ✓
- Чекбокс 3 отмечен ✓ И код подтверждён
- Чекбокс 4 — опционально

---

## Полный текст согласия на обработку ПДн (для лога)

```
СОГЛАСИЕ НА ОБРАБОТКУ ПЕРСОНАЛЬНЫХ ДАННЫХ

Я, пользователь сервиса HEYS, даю согласие ИП Поплавский Антон Сергеевич (ИНН 263517141102, ОГРНИП 320265100094118, адрес: 355041, г. Ставрополь, ул. Краснофлотская, д. 88/1, кв. 56) (далее — Оператор) на обработку моих персональных данных, включая:

1. Общие данные: имя, номер телефона, дата рождения, пол

Цели обработки:
- Создание и поддержание учётной записи
- Связь с пользователем
- Предоставление услуг сервиса HEYS

Оператор вправе:
- Собирать, записывать, систематизировать, хранить данные
- Передавать данные назначенному куратору

Срок действия: до отзыва согласия.

Я уведомлен(а) о праве отозвать согласие, направив запрос на privacy@heys.app.

Настоящее согласие дано путём проставления отметки в соответствующем поле при регистрации в сервисе HEYS.
```

---

## Полный текст согласия на обработку данных о здоровье (для лога)

```
СОГЛАСИЕ НА ОБРАБОТКУ СПЕЦИАЛЬНОЙ КАТЕГОРИИ ПЕРСОНАЛЬНЫХ ДАННЫХ
(данные о состоянии здоровья)

Я, пользователь сервиса HEYS, в соответствии с ч. 1 ст. 10 Федерального закона от 27.07.2006 № 152-ФЗ «О персональных данных», даю явное согласие ИП Поплавский Антон Сергеевич (ИНН 263517141102, ОГРНИП 320265100094118, адрес: 355041, г. Ставрополь, ул. Краснофлотская, д. 88/1, кв. 56) (далее — Оператор) на обработку моих персональных данных, относящихся к специальной категории — данных о состоянии здоровья:

1. Данные о здоровье:
   - Рост, вес и его динамика
   - Данные о питании и пищевых привычках
   - Данные о физической активности
   - Данные о сне
   - Данные о менструальном цикле (при наличии)
   - Данные о самочувствии и настроении

2. Цели обработки:
   - Персонализация рекомендаций по питанию
   - Аналитика данных о питании и здоровье
   - Работа куратора с моими данными (при выборе тарифа Pro/Pro+)
   - Улучшение сервиса на основе обезличенных данных

3. Действия с данными:
   - Сбор, запись, систематизация, накопление, хранение
   - Уточнение (обновление, изменение)
   - Извлечение, использование для аналитики и рекомендаций
   - Передача назначенному куратору (для тарифов с кураторским сопровождением)
   - Обезличивание для статистического анализа
   - Удаление и уничтожение по запросу субъекта

4. Срок обработки: до отзыва согласия или удаления аккаунта.

5. Порядок отзыва: направить запрос на privacy@heys.app. Обработка данных прекращается в течение 10 рабочих дней с момента получения запроса.

6. Форма согласия: настоящее согласие дано путём проставления отметки в соответствующем поле при регистрации в сервисе HEYS.

Я уведомлен(а), что отзыв согласия на обработку данных о здоровье приведёт к ограничению функционала приложения (аналитика, персональные рекомендации).
```

---

## Структура лога согласий (для Supabase)

```sql
CREATE TABLE consents (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  client_id UUID REFERENCES clients(id) NOT NULL,

  -- Тип согласия
  consent_type TEXT NOT NULL, -- 'user_agreement', 'personal_data', 'health_data', 'marketing'

  -- Версия документа
  document_version TEXT NOT NULL, -- '1.1'

  -- Статус
  granted BOOLEAN NOT NULL DEFAULT true,

  -- Способ подписи (для ПЭП)
  signature_method TEXT, -- 'checkbox', 'sms_code', 'one_time_code'

  -- Метаданные
  ip_address TEXT,
  user_agent TEXT,

  -- Время
  created_at TIMESTAMPTZ DEFAULT now(),
  revoked_at TIMESTAMPTZ
);

-- Индекс для поиска по клиенту
CREATE INDEX idx_consents_client ON consents(client_id);
```

---

## API для логирования

```javascript
// При регистрации
async function logConsents(clientId, consents, metadata) {
  const { ip, userAgent } = metadata;

  const records = consents.map((c) => ({
    client_id: clientId,
    consent_type: c.type,
    document_version: c.version,
    granted: c.granted,
    signature_method: c.signatureMethod || 'checkbox', // 'sms_code' для health_data
    ip_address: ip,
    user_agent: userAgent,
  }));

  await supabase.from('consents').insert(records);
}

// Пример вызова
logConsents(
  'client-uuid',
  [
    {
      type: 'user_agreement',
      version: '1.1',
      granted: true,
      signatureMethod: 'checkbox',
    },
    {
      type: 'personal_data',
      version: '1.1',
      granted: true,
      signatureMethod: 'checkbox',
    },
    {
      type: 'health_data',
      version: '1.1',
      granted: true,
      signatureMethod: 'sms_code',
    }, // ПЭП!
    {
      type: 'marketing',
      version: '1.1',
      granted: false,
      signatureMethod: 'checkbox',
    },
  ],
  { ip: '1.2.3.4', userAgent: 'Mozilla...' },
);
```

---

## Отзыв согласия

### Экран в настройках профиля

```
Управление согласиями

☑ Пользовательское соглашение (обязательно для использования)
☑ Обработка персональных данных (обязательно для использования)
☑ Данные о здоровье (обязательно для аналитики)
☐ Маркетинговые сообщения

[Отозвать все согласия и удалить аккаунт]
```

### При отзыве обязательных согласий

```
Внимание!

Отзыв согласия на обработку данных приведёт к удалению аккаунта и всех ваших данных.

Это действие нельзя отменить.

[Отмена] [Удалить аккаунт]
```
