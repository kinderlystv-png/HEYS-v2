{
	"version": "2.0.0",
	"tasks": [
		{
			"label": "Run All Tests",
			"type": "shell",
			"command": "pnpm run test:all",
			"group": "test",
			"presentation": {
				"panel": "dedicated",
				"reveal": "always"
			},
			"problemMatcher": []
		},
		{
			"label": "Start Frontend (Port 3001)",
			"type": "shell",
			"command": "pnpm",
			"args": [
				"--filter",
				"@heys/web",
				"run",
				"dev"
			],
			"group": "build",
			"options": {
				"env": {
					"PORT": "3001",
					"VITE_PORT": "3001",
					"API_PORT": "4001"
				}
			},
			"presentation": {
				"echo": true,
				"reveal": "always",
				"focus": false,
				"panel": "new",
				"showReuseMessage": true,
				"clear": false
			},
			"isBackground": true,
			"problemMatcher": {
				"pattern": {
					"regexp": "."
				},
				"background": {
					"activeOnStart": true,
					"beginsPattern": "\\[vite\\]",
					"endsPattern": "Local:.*http://localhost:3001"
				}
			}
		},
		{
			"label": "Start Landing (Port 3003)",
			"type": "shell",
			"command": "pnpm",
			"args": [
				"--filter",
				"@heys/landing",
				"run",
				"dev"
			],
			"group": "build",
			"options": {
				"env": {
					"PORT": "3003"
				}
			},
			"presentation": {
				"echo": true,
				"reveal": "always",
				"focus": false,
				"panel": "new",
				"showReuseMessage": true,
				"clear": false
			},
			"isBackground": true,
			"problemMatcher": {
				"pattern": {
					"regexp": "."
				},
				"background": {
					"activeOnStart": true,
					"beginsPattern": "ready",
					"endsPattern": "Local:.*http://localhost:3003"
				}
			}
		},
		{
			"label": "Start TG Mini (Port 3002)",
			"type": "shell",
			"command": "pnpm",
			"args": [
				"run",
				"dev:tg-mini"
			],
			"group": "build",
			"options": {
				"env": {
					"PORT": "3002",
					"VITE_PORT": "3002"
				}
			},
			"presentation": {
				"echo": true,
				"reveal": "always",
				"focus": false,
				"panel": "new",
				"showReuseMessage": true,
				"clear": false
			},
			"isBackground": true,
			"problemMatcher": {
				"pattern": {
					"regexp": "."
				},
				"background": {
					"activeOnStart": true,
					"beginsPattern": "\\[vite\\]",
					"endsPattern": "Local:.*http://localhost:3002"
				}
			}
		},
		{
			"label": "Start API Server (Port 4001)",
			"type": "shell",
			"command": "node",
			"args": [
				"packages/core/src/server.js"
			],
			"group": "build",
			"options": {
				"env": {
					"PORT": "4001",
					"API_PORT": "4001",
					"DATABASE_NAME": "projectB",
					"NODE_ENV": "development",
					"TELEGRAM_BOT_TOKEN": "${env:TELEGRAM_BOT_TOKEN}",
					"TELEGRAM_ALLOWED_USER_IDS": "1393964759",
					"API_ALLOWED_ORIGINS": "https://tressy-cotyledonoid-vergie.ngrok-free.dev"
				}
			},
			"presentation": {
				"echo": true,
				"reveal": "always",
				"focus": false,
				"panel": "new",
				"showReuseMessage": true,
				"clear": false
			},
			"isBackground": true
		},
		{
			"label": "Start Full Stack (Ports 3001 & 4001)",
			"dependsOrder": "parallel",
			"dependsOn": [
				"Start Frontend (Port 3001)",
				"Start API Server (Port 4001)"
			],
			"group": "build"
		},
		{
			"label": "Build for Production",
			"type": "shell",
			"command": "cross-env",
			"args": [
				"PORT=3001",
				"API_PORT=4001",
				"pnpm",
				"run",
				"build"
			],
			"group": "build",
			"presentation": {
				"echo": true,
				"reveal": "always",
				"focus": false,
				"panel": "shared",
				"showReuseMessage": true,
				"clear": false
			}
		},
		{
			"label": "Deploy SMS function without from",
			"type": "shell",
			"command": "cd /Users/poplavskijanton/HEYS-v2/yandex-cloud-functions/heys-api-sms && yc serverless function version create --function-name heys-api-sms --runtime nodejs18 --entrypoint index.handler --memory 128m --execution-timeout 10s --source-path . --environment \"SMS_API_KEY=78608003-ED53-BC7C-0C47-788283EBCC3F\""
		},
		{
			"label": "API Test",
			"type": "shell",
			"command": "echo 'ðŸ§ª HEYS API Test' && echo '1. Health:' && curl -s https://api.heyslab.ru/health && echo '' && echo '2. REST shared_products:' && curl -s 'https://api.heyslab.ru/rest/shared_products?limit=1' -H 'Origin: https://app.heyslab.ru' | head -c 200 && echo '' && echo '3. RPC get_shared_products:' && curl -s -X POST 'https://api.heyslab.ru/rpc?fn=get_shared_products' -H 'Content-Type: application/json' -H 'Origin: https://app.heyslab.ru' -d '{}' | head -c 200"
		}
	]
}