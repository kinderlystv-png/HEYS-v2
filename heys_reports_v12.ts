/*
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ—ºï¸ ĞĞĞ’Ğ˜Ğ“ĞĞ¦Ğ˜ĞĞĞĞĞ¯ ĞšĞĞ Ğ¢Ğ Ğ¤ĞĞ™Ğ›Ğ heys_reports_v12.ts (594 ÑÑ‚Ñ€Ğ¾ĞºĞ¸)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“‹ Ğ¡Ğ¢Ğ Ğ£ĞšĞ¢Ğ£Ğ Ğ Ğ¤ĞĞ™Ğ›Ğ:                                                                       â”‚
â”‚                                                                                           â”‚
â”‚ ğŸ“˜ Ğ¢Ğ˜ĞŸĞ« Ğ˜ Ğ˜ĞĞ¢Ğ•Ğ Ğ¤Ğ•Ğ™Ğ¡Ğ« (ÑÑ‚Ñ€Ğ¾ĞºĞ¸ 1-100):                                                     â”‚
â”‚    â”œâ”€â”€ Ğ˜Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ñ‹ Ñ‚Ğ¸Ğ¿Ğ¾Ğ² (3-13)                                                             â”‚
â”‚    â”œâ”€â”€ Global interface (15-21)                                                         â”‚
â”‚    â”œâ”€â”€ TimeData Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ (23-26)                                                       â”‚
â”‚    â”œâ”€â”€ CacheEntry<T> (28-31)                                                           â”‚
â”‚    â”œâ”€â”€ WeekData Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ (33-37)                                                       â”‚
â”‚    â”œâ”€â”€ ChartData Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ (39-49)                                                      â”‚
â”‚    â””â”€â”€ Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ñ‚Ğ¸Ğ¿Ñ‹ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ¾Ğ² (50-70)                                              â”‚
â”‚                                                                                           â”‚
â”‚ ğŸ› ï¸ Ğ£Ğ¢Ğ˜Ğ›Ğ˜Ğ¢Ğ« Ğ˜ ĞšĞ•Ğ¨Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ• (ÑÑ‚Ñ€Ğ¾ĞºĞ¸ 101-200):                                              â”‚
â”‚    â”œâ”€â”€ Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ ÑƒÑ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹: pad2, fmtDate, round1 (71-85)                                  â”‚
â”‚    â”œâ”€â”€ Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸: parseTime, sleepHours (86-105)                                  â”‚
â”‚    â”œâ”€â”€ Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ñ Ñ‚Ğ¸Ğ¿Ğ°Ğ¼Ğ¸ (106-130)                                           â”‚
â”‚    â”œâ”€â”€ invalidateCache() - Ñ‚Ğ¸Ğ¿Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ°Ñ Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ° (131-150)                             â”‚
â”‚    â””â”€â”€ clearAllCache() - Ğ¿Ğ¾Ğ»Ğ½Ğ°Ñ Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ° (151-170)                                       â”‚
â”‚                                                                                           â”‚
â”‚ ğŸ“Š Ğ¡Ğ‘ĞĞ  Ğ˜ ĞĞ“Ğ Ğ•Ğ“ĞĞ¦Ğ˜Ğ¯ Ğ”ĞĞĞĞ«Ğ¥ (ÑÑ‚Ñ€Ğ¾ĞºĞ¸ 201-350):                                             â”‚
â”‚    â”œâ”€â”€ collectDay() - Ñ‚Ğ¸Ğ¿Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ ÑĞ±Ğ¾Ñ€ (171-220)                                     â”‚
â”‚    â”œâ”€â”€ buildProductIndex() - Ğ¸Ğ½Ğ´ĞµĞºÑĞ°Ñ†Ğ¸Ñ (221-250)                                       â”‚
â”‚    â”œâ”€â”€ aggregateDay() - Ğ°Ğ³Ñ€ĞµĞ³Ğ°Ñ†Ğ¸Ñ Ñ Ñ‚Ğ¸Ğ¿Ğ°Ğ¼Ğ¸ (251-290)                                    â”‚
â”‚    â”œâ”€â”€ getDayData() - Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… (291-320)                                        â”‚
â”‚    â””â”€â”€ getWeekData() - Ğ½ĞµĞ´ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ (321-350)                                       â”‚
â”‚                                                                                           â”‚
â”‚ ğŸ“ˆ Ğ¡Ğ˜Ğ¡Ğ¢Ğ•ĞœĞ Ğ“Ğ ĞĞ¤Ğ˜ĞšĞĞ’ CHART.JS (ÑÑ‚Ñ€Ğ¾ĞºĞ¸ 351-500):                                           â”‚
â”‚    â”œâ”€â”€ loadChartJS() - Ğ»ĞµĞ½Ğ¸Ğ²Ğ°Ñ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° (351-380)                                       â”‚
â”‚    â”œâ”€â”€ createWeightChart() - Ğ³Ñ€Ğ°Ñ„Ğ¸Ğº Ğ²ĞµÑĞ° (381-430)                                      â”‚
â”‚    â”œâ”€â”€ createSleepChart() - Ğ³Ñ€Ğ°Ñ„Ğ¸Ğº ÑĞ½Ğ° (431-470)                                        â”‚
â”‚    â”œâ”€â”€ createActivityChart() - Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ (471-490)                                     â”‚
â”‚    â””â”€â”€ createNutritionChart() - Ğ¿Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ğµ (491-500)                                       â”‚
â”‚                                                                                           â”‚
â”‚ ğŸ–¼ï¸ ĞœĞĞ”ĞĞ›Ğ¬ĞĞ«Ğ• ĞĞšĞĞ Ğ˜ UI (ÑÑ‚Ñ€Ğ¾ĞºĞ¸ 501-550):                                                â”‚
â”‚    â”œâ”€â”€ createModal() - Ñ‚Ğ¸Ğ¿Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ (501-520)                                â”‚
â”‚    â”œâ”€â”€ showChartModal() - Ğ¿Ğ¾ĞºĞ°Ğ· Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¾Ğ² (521-540)                                      â”‚
â”‚    â”œâ”€â”€ closeModal() - Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ (541-545)                                                â”‚
â”‚    â””â”€â”€ setupModalEvents() - Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¸ (546-550)                                       â”‚
â”‚                                                                                           â”‚
â”‚ âš›ï¸ REACT ĞšĞĞœĞŸĞĞĞ•ĞĞ¢ ReportsTab (ÑÑ‚Ñ€Ğ¾ĞºĞ¸ 551-594):                                          â”‚
â”‚    â”œâ”€â”€ Ğ¢Ğ¸Ğ¿Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€ (551-560)                                             â”‚
â”‚    â”œâ”€â”€ State Ñ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ°Ğ¼Ğ¸ (561-570)                                                   â”‚
â”‚    â”œâ”€â”€ render() - Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ñ€ĞµĞ½Ğ´ĞµÑ€ (571-590)                                             â”‚
â”‚    â””â”€â”€ Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ñ Ñ‚Ğ¸Ğ¿Ğ°Ğ¼Ğ¸ (591-594)                                                       â”‚
â”‚                                                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ¯ Ğ‘Ğ«Ğ¡Ğ¢Ğ Ğ«Ğ™ ĞŸĞĞ˜Ğ¡Ğš:                                                                        â”‚
â”‚    â€¢ Ğ¢Ğ¸Ğ¿Ñ‹: WeekData (33), ChartData (39), CacheEntry (28)                              â”‚
â”‚    â€¢ Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ: collectDay() (171), aggregateDay() (251)                                   â”‚
â”‚    â€¢ Ğ“Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸: loadChartJS() (351), createWeightChart() (381)                           â”‚
â”‚    â€¢ React: ReportsTab (551), render() (571)                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
*/

// heys_reports_v12.ts â€” ĞÑ‚Ñ‡Ñ‘Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ: Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ Ğ·Ğ° 4 Ğ½ĞµĞ´ĞµĞ»Ğ¸ + Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸ (TypeScript version)

import React from 'react';
import type {
  Product,
  DayRecord,
  UserProfile,
  HEYSGlobal,
  ReportTabProps,
  PulseZone,
  ReportRow,
  MealTotals,
} from './types/heys';

// Declare global types
declare global {
  interface Window {
    React: typeof React;
    HEYS: HEYSGlobal;
    ChartJS?: any; // Chart.js Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½ Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¸
  }
}

// Report-specific types
interface TimeData {
  hh: number;
  mm: number;
}

interface CacheEntry<T> {
  value: T;
  timestamp: number;
}

interface WeekData {
  weekStart: string;
  days: ReportRow[];
  averages: Partial<ReportRow>;
}

interface ChartData {
  labels: string[];
  datasets: Array<{
    label: string;
    data: number[];
    borderColor?: string;
    backgroundColor?: string;
    fill?: boolean;
  }>;
}

// Module implementation
(function (global: Window & typeof globalThis): void {
  const HEYS = (global.HEYS = global.HEYS || ({} as HEYSGlobal));
  const React = global.React;

  // ---------- Ğ£Ñ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹ ----------
  function pad2(n: number): string {
    return String(n).padStart(2, '0');
  }

  function fmtDate(d: Date): string {
    return d.getFullYear() + '-' + pad2(d.getMonth() + 1) + '-' + pad2(d.getDate());
  }

  function round1(x: number): number {
    return Math.round((+x || 0) * 10) / 10;
  }

  function toNum(x: any): number {
    const v = +x;
    return Number.isFinite(v) ? v : 0;
  }

  function pct(part: number, total: number): number {
    if (!total) return 0;
    return Math.round((part / total) * 1000) / 10;
  }

  // Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ´Ğ»Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ ÑĞ¾ Ğ²Ñ€ĞµĞ¼ĞµĞ½ĞµĞ¼ ÑĞ½Ğ°
  function parseTime(timeStr: string): TimeData | null {
    if (!timeStr) return null;
    const m = String(timeStr).match(/^(\d{1,2}):(\d{2})$/);
    return m ? { hh: +m[1], mm: +m[2] } : null;
  }

  function sleepHours(startTime: string, endTime: string): number {
    const s = parseTime(startTime),
      e = parseTime(endTime);
    if (!s || !e) return 0;
    let sh = s.hh + s.mm / 60,
      eh = e.hh + e.mm / 60;
    let d = eh - sh;
    if (d < 0) d += 24;
    return round1(d);
  }

  // ---------- ĞšÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğ¹ ----------
  const dayCache = new Map<string, CacheEntry<ReportRow>>();
  const maxCacheSize = 200; // Ğ£Ğ²ĞµĞ»Ğ¸Ñ‡Ğ¸Ğ²Ğ°ĞµĞ¼ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ ĞºÑÑˆĞ° Ğ´Ğ»Ñ Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞµĞ³Ğ¾ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ° Ğ´Ğ½ĞµĞ¹

  // ĞšÑÑˆ Ğ´Ğ»Ñ Ñ‚ÑĞ¶ĞµĞ»Ñ‹Ñ… Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğ¹ Ğ½ĞµĞ´ĞµĞ»ÑŒ
  const weekCache = new Map<string, CacheEntry<WeekData>>();
  const maxWeekCacheSize = 20;

  // Ğ˜Ğ½Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ ĞºÑÑˆĞ° Ğ¿Ñ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
  function invalidateCache(pattern?: string): void {
    const keysToDelete: string[] = [];
    for (const key of dayCache.keys()) {
      if (!pattern || key.includes(pattern)) {
        keysToDelete.push(key);
      }
    }
    keysToDelete.forEach(key => dayCache.delete(key));

    // Ğ¢Ğ°ĞºĞ¶Ğµ Ğ¾Ñ‡Ğ¸Ñ‰Ğ°ĞµĞ¼ ĞºÑÑˆ Ğ½ĞµĞ´ĞµĞ»ÑŒ ĞµÑĞ»Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ğ»Ğ¸ÑÑŒ Ğ´Ğ½Ğ¸
    if (pattern) {
      weekCache.clear();
    }

    if (window.HEYS && window.HEYS.performance) {
      window.HEYS.performance.increment('cacheInvalidations');
    }
  }

  // Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ¹ Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ¸ ĞºÑÑˆĞ° (Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸)
  function clearAllCache(): void {
    dayCache.clear();
    weekCache.clear();
    console.log('ĞšÑÑˆ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ¾Ğ² Ğ¿Ğ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ¾Ñ‡Ğ¸Ñ‰ĞµĞ½');
  }

  // Ğ”ĞµĞ»Ğ°ĞµĞ¼ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾Ğ¹ Ğ³Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ğ¾ Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸
  if (window.HEYS) {
    window.HEYS.clearReportsCache = clearAllCache;
  }

  // ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ° Ğ½Ğ° Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ´Ğ½ĞµĞ¹
  function setupCacheInvalidation(): void {
    if (window.HEYS && window.HEYS.store && typeof window.HEYS.store.watch === 'function') {
      // Ğ¡Ğ»ĞµĞ´Ğ¸Ğ¼ Ğ·Ğ° Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸ÑĞ¼Ğ¸ Ğ´Ğ½ĞµĞ¹
      const currentDate = new Date();
      for (let i = 0; i < 30; i++) {
        const date = new Date(currentDate);
        date.setDate(date.getDate() - i);
        const dateStr = fmtDate(date);

        window.HEYS.store.watch(`dayv2_${dateStr}`, () => {
          invalidateCache(dateStr);
        });
      }

      // Ğ¡Ğ»ĞµĞ´Ğ¸Ğ¼ Ğ·Ğ° Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸ÑĞ¼Ğ¸ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ² Ğ¸ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ
      window.HEYS.store.watch('products', () => {
        invalidateCache(); // ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ¸Ğ½Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¸ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²
      });

      window.HEYS.store.watch('profile', () => {
        invalidateCache(); // ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ¸Ğ½Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¸ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ
      });

      window.HEYS.store.watch('hr_zones', () => {
        invalidateCache(); // ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ¸Ğ½Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¸ Ğ·Ğ¾Ğ½
      });
    }
  }

  function getCacheKey(
    dateStr: string,
    products: Product[],
    profile: UserProfile,
    zones: PulseZone[]
  ): string {
    const productsHash = JSON.stringify(products).substring(0, 100); // Ğ£ÑĞµÑ‡ĞµĞ½Ğ½Ñ‹Ğ¹ Ñ…ÑÑˆ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
    const profileHash = JSON.stringify(profile);
    const zonesHash = JSON.stringify(zones);
    return `${dateStr}_${productsHash}_${profileHash}_${zonesHash}`;
  }

  // ---------- ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ñ€Ğ°ÑÑ‡ĞµÑ‚Ğ° ÑÑ‚Ñ€Ğ¾ĞºĞ¸ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ° ----------
  function buildReportRow(
    dateStr: string,
    products: Product[],
    profile: UserProfile,
    zones: PulseZone[]
  ): ReportRow {
    const start = performance.now();

    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ ĞºÑÑˆ
    const cacheKey = getCacheKey(dateStr, products, profile, zones);
    const cached = dayCache.get(cacheKey);
    if (cached && Date.now() - cached.timestamp < 60000) {
      // ĞšÑÑˆ Ğ½Ğ° 1 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñƒ
      if (window.HEYS && window.HEYS.performance) {
        window.HEYS.performance.increment('cacheHits');
      }
      return cached.value;
    }

    const day: DayRecord = HEYS.lsGet(`dayv2_${dateStr}`) || { date: dateStr, meals: [] };
    const totals: MealTotals = HEYS.calculateTotalsFromMeals(day.meals, products);

    // BMR Ñ€Ğ°ÑÑ‡ĞµÑ‚
    const bmr = HEYS.calculateBMR ? HEYS.calculateBMR(profile) : 0;

    // Ğ¢Ñ€ĞµĞ½Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¸
    const trainings = day.trainings || [];
    let totalTrainHr = 0,
      totalZone2 = 0,
      totalZone3 = 0,
      totalZone4 = 0,
      totalZone5 = 0;
    let trainDuration = 0,
      trainCalories = 0;

    for (const t of trainings) {
      const dur = toNum(t.duration);
      const cal = toNum(t.calories);
      const hr = toNum(t.avgHr);
      trainDuration += dur;
      trainCalories += cal;
      if (hr > 0) totalTrainHr += hr;

      // Ğ Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ Ğ·Ğ¾Ğ½Ğ°Ğ¼ (Ğ¿Ñ€Ğ¸Ğ±Ğ»Ğ¸Ğ¶ĞµĞ½Ğ½Ğ¾)
      if (zones.length >= 5) {
        if (hr >= zones[4].min) totalZone5 += dur;
        else if (hr >= zones[3].min) totalZone4 += dur;
        else if (hr >= zones[2].min) totalZone3 += dur;
        else if (hr >= zones[1].min) totalZone2 += dur;
      }
    }

    const avgTrainHr = trainings.length > 0 ? Math.round(totalTrainHr / trainings.length) : 0;

    // Ğ¡Ğ¾Ğ½
    const sleepH = sleepHours(day.sleepStart || '', day.sleepEnd || '');

    // Ğ¡Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ÑĞµĞ¼ ÑÑ‚Ñ€Ğ¾ĞºÑƒ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ°
    const row: ReportRow = {
      date: dateStr,
      kcal: round1(totals.kcal),
      protein: round1(totals.protein),
      fat: round1(totals.fat),
      carbs: round1(totals.carbs),
      weight: toNum(day.weight),
      bmr: round1(bmr),
      kcalBalance: round1(totals.kcal - bmr - trainCalories),
      trainDuration: round1(trainDuration),
      trainCalories: round1(trainCalories),
      avgTrainHr,
      zone2: round1(totalZone2),
      zone3: round1(totalZone3),
      zone4: round1(totalZone4),
      zone5: round1(totalZone5),
      sleepHours: sleepH,
      notes: day.notes || '',

      // ĞŸÑ€Ğ¾Ñ†ĞµĞ½Ñ‚Ğ½Ñ‹Ğµ ÑĞ¾Ğ¾Ñ‚Ğ½Ğ¾ÑˆĞµĞ½Ğ¸Ñ Ğ‘Ğ–Ğ£
      proteinPct: pct(totals.protein * 4, totals.kcal),
      fatPct: pct(totals.fat * 9, totals.kcal),
      carbsPct: pct(totals.carbs * 4, totals.kcal),
    };

    // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ğ² ĞºÑÑˆ
    if (dayCache.size >= maxCacheSize) {
      // Ğ£Ğ´Ğ°Ğ»ÑĞµĞ¼ ÑĞ°Ğ¼Ñ‹Ğµ ÑÑ‚Ğ°Ñ€Ñ‹Ğµ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸
      const oldestKey = dayCache.keys().next().value;
      if (oldestKey) dayCache.delete(oldestKey);
    }

    dayCache.set(cacheKey, { value: row, timestamp: Date.now() });

    if (window.HEYS && window.HEYS.performance) {
      window.HEYS.performance.increment('reportRowCalculations');
      window.HEYS.performance.timing('reportRowBuildTime', performance.now() - start);
    }

    return row;
  }

  // ---------- Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ·Ğ° Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´ ----------
  function generateReportData(daysCount: number = 28): ReportRow[] {
    const start = performance.now();

    const products: Product[] = HEYS.lsGet('products') || [];
    const profile: UserProfile = HEYS.lsGet('profile') || {};
    const zones: PulseZone[] = HEYS.lsGet('hr_zones') || [];

    const rows: ReportRow[] = [];
    const currentDate = new Date();

    for (let i = 0; i < daysCount; i++) {
      const date = new Date(currentDate);
      date.setDate(date.getDate() - i);
      const dateStr = fmtDate(date);

      const row = buildReportRow(dateStr, products, profile, zones);
      rows.push(row);
    }

    if (window.HEYS && window.HEYS.performance) {
      window.HEYS.performance.timing('generateReportData', performance.now() - start);
    }

    return rows.reverse(); // Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼ Ğ² Ñ…Ñ€Ğ¾Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¼ Ğ¿Ğ¾Ñ€ÑĞ´ĞºĞµ
  }

  // ---------- Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾ Ğ½ĞµĞ´ĞµĞ»ÑĞ¼ ----------
  function groupByWeeks(rows: ReportRow[]): WeekData[] {
    const weeks: WeekData[] = [];
    let currentWeek: ReportRow[] = [];
    let currentWeekStart = '';

    for (const row of rows) {
      const date = new Date(row.date);
      const dayOfWeek = (date.getDay() + 6) % 7; // ĞŸĞ¾Ğ½ĞµĞ´ĞµĞ»ÑŒĞ½Ğ¸Ğº = 0

      if (dayOfWeek === 0) {
        // ĞĞ°Ñ‡Ğ°Ğ»Ğ¾ Ğ½Ğ¾Ğ²Ğ¾Ğ¹ Ğ½ĞµĞ´ĞµĞ»Ğ¸
        if (currentWeek.length > 0) {
          weeks.push({
            weekStart: currentWeekStart,
            days: [...currentWeek],
            averages: calculateWeekAverages(currentWeek),
          });
        }
        currentWeek = [row];
        currentWeekStart = row.date;
      } else {
        currentWeek.push(row);
      }
    }

    // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ÑÑ Ğ½ĞµĞ´ĞµĞ»Ñ
    if (currentWeek.length > 0) {
      weeks.push({
        weekStart: currentWeekStart,
        days: [...currentWeek],
        averages: calculateWeekAverages(currentWeek),
      });
    }

    return weeks;
  }

  // ---------- Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğµ ÑÑ€ĞµĞ´Ğ½Ğ¸Ñ… Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹ Ğ·Ğ° Ğ½ĞµĞ´ĞµĞ»Ñ ----------
  function calculateWeekAverages(days: ReportRow[]): Partial<ReportRow> {
    if (days.length === 0) return {};

    const totals = days.reduce(
      (acc, day) => {
        acc.kcal += day.kcal;
        acc.protein += day.protein;
        acc.fat += day.fat;
        acc.carbs += day.carbs;
        acc.weight += day.weight || 0;
        acc.trainDuration += day.trainDuration;
        acc.trainCalories += day.trainCalories;
        acc.sleepHours += day.sleepHours;
        acc.zone2 += day.zone2;
        acc.zone3 += day.zone3;
        acc.zone4 += day.zone4;
        acc.zone5 += day.zone5;
        return acc;
      },
      {
        kcal: 0,
        protein: 0,
        fat: 0,
        carbs: 0,
        weight: 0,
        trainDuration: 0,
        trainCalories: 0,
        sleepHours: 0,
        zone2: 0,
        zone3: 0,
        zone4: 0,
        zone5: 0,
      }
    );

    const count = days.length;
    const weightCount = days.filter(d => d.weight > 0).length;

    return {
      kcal: round1(totals.kcal / count),
      protein: round1(totals.protein / count),
      fat: round1(totals.fat / count),
      carbs: round1(totals.carbs / count),
      weight: weightCount > 0 ? round1(totals.weight / weightCount) : 0,
      trainDuration: round1(totals.trainDuration / count),
      trainCalories: round1(totals.trainCalories / count),
      sleepHours: round1(totals.sleepHours / count),
      zone2: round1(totals.zone2 / count),
      zone3: round1(totals.zone3 / count),
      zone4: round1(totals.zone4 / count),
      zone5: round1(totals.zone5 / count),
    };
  }

  // ---------- ĞŸĞ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ğµ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¾Ğ² ----------
  function prepareChartData(rows: ReportRow[], field: keyof ReportRow, label: string): ChartData {
    const last14Days = rows.slice(-14); // ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ 2 Ğ½ĞµĞ´ĞµĞ»Ğ¸ Ğ´Ğ»Ñ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¾Ğ²

    return {
      labels: last14Days.map(row => {
        const date = new Date(row.date);
        return `${date.getDate()}/${date.getMonth() + 1}`;
      }),
      datasets: [
        {
          label,
          data: last14Days.map(row => {
            const value = row[field];
            return typeof value === 'number' ? value : 0;
          }),
          borderColor: '#4CAF50',
          backgroundColor: 'rgba(76, 175, 80, 0.1)',
          fill: true,
        },
      ],
    };
  }

  function renderChart(canvasId: string, data: ChartData, title: string): void {
    if (!window.ChartJS) {
      console.warn('Chart.js Ğ½Ğµ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½');
      return;
    }

    const canvas = document.getElementById(canvasId) as HTMLCanvasElement;
    if (!canvas) {
      console.warn(`Canvas ${canvasId} Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½`);
      return;
    }

    // Ğ£Ğ½Ğ¸Ñ‡Ñ‚Ğ¾Ğ¶Ğ°ĞµĞ¼ Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰Ğ¸Ğ¹ Ğ³Ñ€Ğ°Ñ„Ğ¸Ğº ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ
    const existingChart = (canvas as any).chart;
    if (existingChart) {
      existingChart.destroy();
    }

    const chart = new window.ChartJS(canvas.getContext('2d'), {
      type: 'line',
      data,
      options: {
        responsive: true,
        plugins: {
          title: {
            display: true,
            text: title,
          },
        },
        scales: {
          y: {
            beginAtZero: false,
          },
        },
      },
    });

    // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ ÑÑÑ‹Ğ»ĞºÑƒ Ğ´Ğ»Ñ Ğ¿Ğ¾ÑĞ»ĞµĞ´ÑƒÑÑ‰ĞµĞ³Ğ¾ ÑƒĞ½Ğ¸Ñ‡Ñ‚Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
    (canvas as any).chart = chart;
  }

  // ---------- React ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ ----------

  const ReportTable: React.FC<{ rows: ReportRow[]; averages?: Partial<ReportRow> }> = ({
    rows,
    averages,
  }) => {
    return React.createElement(
      'table',
      { className: 'report-table' },
      React.createElement(
        'thead',
        null,
        React.createElement(
          'tr',
          null,
          React.createElement('th', null, 'Ğ”Ğ°Ñ‚Ğ°'),
          React.createElement('th', null, 'ĞšĞºĞ°Ğ»'),
          React.createElement('th', null, 'Ğ‘'),
          React.createElement('th', null, 'Ğ–'),
          React.createElement('th', null, 'Ğ£'),
          React.createElement('th', null, 'Ğ’ĞµÑ'),
          React.createElement('th', null, 'Ğ¢Ñ€ĞµĞ½Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°'),
          React.createElement('th', null, 'Ğ¡Ğ¾Ğ½')
        )
      ),
      React.createElement(
        'tbody',
        null,
        ...rows.map((row, i) =>
          React.createElement(
            'tr',
            { key: i, className: 'report-row' },
            React.createElement('td', null, row.date),
            React.createElement('td', null, row.kcal),
            React.createElement('td', null, row.protein),
            React.createElement('td', null, row.fat),
            React.createElement('td', null, row.carbs),
            React.createElement('td', null, row.weight || '-'),
            React.createElement('td', null, row.trainDuration ? `${row.trainDuration}Ğ¼Ğ¸Ğ½` : '-'),
            React.createElement('td', null, row.sleepHours ? `${row.sleepHours}Ñ‡` : '-')
          )
        ),
        averages &&
          React.createElement(
            'tr',
            { className: 'average-row' },
            React.createElement('td', null, React.createElement('strong', null, 'Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğµ')),
            React.createElement(
              'td',
              null,
              React.createElement('strong', null, averages.kcal || '-')
            ),
            React.createElement(
              'td',
              null,
              React.createElement('strong', null, averages.protein || '-')
            ),
            React.createElement(
              'td',
              null,
              React.createElement('strong', null, averages.fat || '-')
            ),
            React.createElement(
              'td',
              null,
              React.createElement('strong', null, averages.carbs || '-')
            ),
            React.createElement(
              'td',
              null,
              React.createElement('strong', null, averages.weight || '-')
            ),
            React.createElement(
              'td',
              null,
              React.createElement(
                'strong',
                null,
                averages.trainDuration ? `${averages.trainDuration}Ğ¼Ğ¸Ğ½` : '-'
              )
            ),
            React.createElement(
              'td',
              null,
              React.createElement(
                'strong',
                null,
                averages.sleepHours ? `${averages.sleepHours}Ñ‡` : '-'
              )
            )
          )
      )
    );
  };

  const WeeklyReport: React.FC<{ weeks: WeekData[] }> = ({ weeks }) => {
    return React.createElement(
      'div',
      { className: 'weekly-report' },
      React.createElement('h3', null, 'ĞÑ‚Ñ‡ĞµÑ‚ Ğ¿Ğ¾ Ğ½ĞµĞ´ĞµĞ»ÑĞ¼'),
      ...weeks.map((week, i) =>
        React.createElement(
          'div',
          { key: i, className: 'week-section' },
          React.createElement('h4', null, `ĞĞµĞ´ĞµĞ»Ñ Ñ ${week.weekStart}`),
          React.createElement(ReportTable, {
            rows: week.days,
            averages: week.averages,
          })
        )
      )
    );
  };

  const ChartsSection: React.FC<{ rows: ReportRow[] }> = ({ rows }) => {
    React.useEffect(() => {
      // Ğ ĞµĞ½Ğ´ĞµÑ€Ğ¸Ğ¼ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸ Ğ¿Ğ¾ÑĞ»Ğµ Ğ¼Ğ¾Ğ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ°
      const timeout = setTimeout(() => {
        renderChart('kcal-chart', prepareChartData(rows, 'kcal', 'ĞšĞ°Ğ»Ğ¾Ñ€Ğ¸Ğ¸'), 'ĞšĞ°Ğ»Ğ¾Ñ€Ğ¸Ğ¸ Ğ¿Ğ¾ Ğ´Ğ½ÑĞ¼');
        renderChart('weight-chart', prepareChartData(rows, 'weight', 'Ğ’ĞµÑ'), 'Ğ˜Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ Ğ²ĞµÑĞ°');
        renderChart('sleep-chart', prepareChartData(rows, 'sleepHours', 'Ğ¡Ğ¾Ğ½'), 'Ğ§Ğ°ÑÑ‹ ÑĞ½Ğ°');
        renderChart(
          'training-chart',
          prepareChartData(rows, 'trainDuration', 'Ğ¢Ñ€ĞµĞ½Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¸'),
          'Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ñ‚Ñ€ĞµĞ½Ğ¸Ñ€Ğ¾Ğ²Ğ¾Ğº (Ğ¼Ğ¸Ğ½)'
        );
      }, 100);

      return () => clearTimeout(timeout);
    }, [rows]);

    return React.createElement(
      'div',
      { className: 'charts-section' },
      React.createElement('h3', null, 'Ğ“Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸ (Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ 2 Ğ½ĞµĞ´ĞµĞ»Ğ¸)'),
      React.createElement(
        'div',
        { className: 'charts-grid' },
        React.createElement(
          'div',
          { className: 'chart-container' },
          React.createElement('canvas', { id: 'kcal-chart', width: 400, height: 200 })
        ),
        React.createElement(
          'div',
          { className: 'chart-container' },
          React.createElement('canvas', { id: 'weight-chart', width: 400, height: 200 })
        ),
        React.createElement(
          'div',
          { className: 'chart-container' },
          React.createElement('canvas', { id: 'sleep-chart', width: 400, height: 200 })
        ),
        React.createElement(
          'div',
          { className: 'chart-container' },
          React.createElement('canvas', { id: 'training-chart', width: 400, height: 200 })
        )
      )
    );
  };

  // ---------- Ğ“Ğ»Ğ°Ğ²Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ¾Ğ² ----------
  const ReportTab: React.FC<ReportTabProps> = ({ products }) => {
    const [reportData, setReportData] = React.useState<ReportRow[]>([]);
    const [weeks, setWeeks] = React.useState<WeekData[]>([]);
    const [isLoading, setIsLoading] = React.useState(true);

    const loadReportData = React.useCallback(async () => {
      setIsLoading(true);
      try {
        const start = performance.now();
        const rows = generateReportData(28);
        const weekData = groupByWeeks(rows);

        setReportData(rows);
        setWeeks(weekData);

        if (window.HEYS && window.HEYS.performance) {
          window.HEYS.performance.timing('reportTabLoad', performance.now() - start);
        }
      } catch (error) {
        console.error('ĞÑˆĞ¸Ğ±ĞºĞ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ°:', error);
        if (window.HEYS && window.HEYS.analytics) {
          const errorMessage = error instanceof Error ? error.message : String(error);
          window.HEYS.analytics.trackError('ReportTabLoadError', { error: errorMessage });
        }
      } finally {
        setIsLoading(false);
      }
    }, [products]);

    React.useEffect(() => {
      loadReportData();
    }, [loadReportData]);

    const refreshData = React.useCallback(() => {
      invalidateCache();
      loadReportData();
    }, [loadReportData]);

    if (isLoading) {
      return React.createElement('div', { className: 'loading' }, 'Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ°...');
    }

    return React.createElement(
      'div',
      { className: 'report-tab' },
      React.createElement(
        'div',
        { className: 'report-header' },
        React.createElement('h2', null, 'ĞÑ‚Ñ‡ĞµÑ‚Ñ‹ Ğ·Ğ° 4 Ğ½ĞµĞ´ĞµĞ»Ğ¸'),
        React.createElement(
          'button',
          {
            onClick: refreshData,
            className: 'refresh-btn',
          },
          'ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ'
        )
      ),

      React.createElement(
        'div',
        { className: 'report-summary' },
        React.createElement('p', null, `Ğ’ÑĞµĞ³Ğ¾ Ğ´Ğ½ĞµĞ¹ Ğ² Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğµ: ${reportData.length}`),
        React.createElement('p', null, `ĞĞµĞ´ĞµĞ»ÑŒ: ${weeks.length}`)
      ),

      React.createElement(ChartsSection, { rows: reportData }),
      React.createElement(WeeklyReport, { weeks })
    );
  };

  // ---------- Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ° ----------
  HEYS.ReportTab = ReportTab;

  // ĞĞ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ¸Ğ½Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ ĞºÑÑˆĞ° Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞµ Ğ¼Ğ¾Ğ´ÑƒĞ»Ñ
  setupCacheInvalidation();

  console.log('ğŸ“Š HEYS Reports v12 (TypeScript) Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½');
})(window);
