<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-widt    <div class="test-card">
        <h3>üìù –õ–æ–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</h3>
        <div id="console-log" class="log" style="max-height: 250px; min-height: 150px;"></div>
        <button class="test-button" onclick="copyConsoleLog()" style="background: #4299e1; font-size: 12px; padding: 5px 10px; margin-right: 5px;">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥</button>
        <button class="test-button" onclick="clearConsoleLog()" style="background: #a0aec0; font-size: 12px; padding: 5px 10px;">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
    </div>itial-scale=1.0">
    <title>HEYS - –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f8fafc;
        }
        
        .test-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .status {
            padding: 8px 12px;
            border-radius: 4px;
            font-weight: bold;
            margin: 5px 0;
        }
        
        .status.success {
            background: #c6f6d5;
            color: #22543d;
        }
        
        .status.error {
            background: #fed7d7;
            color: #9b2c2c;
        }
        
        .status.pending {
            background: #fef5e7;
            color: #744210;
        }
        
        .test-button {
            background: #4299e1;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        
        .test-button:hover {
            background: #3182ce;
        }
        
        .log {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            margin: 10px 0;
        }
        
        .back-button {
            background: #718096;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 0;
            text-decoration: none;
            display: inline-block;
        }
        
        .back-button:hover {
            background: #4a5568;
        }
    </style>
</head>
<body>
    <div style="margin-bottom: 20px;">
        <a href="../TESTS/index.html" class="back-button">‚Üê –ù–∞–∑–∞–¥ –∫ —Ü–µ–Ω—Ç—Ä—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</a>
    </div>
    
    <h1>üîç HEYS - –¢–µ—Å—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —É–º–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞</h1>
    <p>–ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π</p>
    
    <div class="test-card">
        <h3>üìö –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π</h3>
        <div id="modules-status" class="status pending">‚è≥ –ü—Ä–æ–≤–µ—Ä—è–µ–º...</div>
        <div id="modules-log" class="log"></div>
    </div>
    
    <div class="test-card">
        <h3>üóÑÔ∏è IndexedDB</h3>
        <div id="indexeddb-status" class="status pending">‚è≥ –¢–µ—Å—Ç–∏—Ä—É–µ–º...</div>
        <button class="test-button" onclick="testIndexedDB()">–¢–µ—Å—Ç IndexedDB</button>
        <div id="indexeddb-log" class="log"></div>
    </div>
    
    <div class="test-card">
        <h3>üë∑ Web Workers</h3>
        <div id="workers-status" class="status pending">‚è≥ –¢–µ—Å—Ç–∏—Ä—É–µ–º...</div>
        <button class="test-button" onclick="testWorkers()">–¢–µ—Å—Ç Workers</button>
        <div id="workers-log" class="log"></div>
    </div>
    
    <div class="test-card">
        <h3>üß† –£–º–Ω—ã–π –ø–æ–∏—Å–∫</h3>
        <div id="search-status" class="status pending">‚è≥ –¢–µ—Å—Ç–∏—Ä—É–µ–º...</div>
        <button class="test-button" onclick="testSmartSearch()">–¢–µ—Å—Ç —É–º–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞</button>
        <div id="search-log" class="log"></div>
    </div>
    
    <div class="test-card">
        <h3>ÔøΩ –õ–æ–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</h3>
        <div id="console-log" class="log" style="max-height: 250px; min-height: 150px;"></div>
        <button class="test-button" onclick="clearConsoleLog()" style="background: #a0aec0; font-size: 12px; padding: 5px 10px;">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
    </div>
    
    <div class="test-card">
        <h3>ÔøΩüìä –û–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</h3>
        <div id="overall-status" class="status pending">‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤...</div>
        <button class="test-button" onclick="runAllTests()" style="background: #48bb78;">üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã</button>
    </div>

    <!-- –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥—É–ª–∏ –∏–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–∏ -->
    <script src="../heys_storage_indexeddb_v1.js"></script>
    <script src="../heys_worker_manager_v1.js?v=4"></script>
    <script src="../heys_integration_layer_v1.js"></script>
    <!-- –ó–∞–≥—Ä—É–∂–∞–µ–º search integration –ü–û–°–õ–ï –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–æ–¥—É–ª–µ–π -->
    <script src="../modern-search-integration.js?v=2"></script>

    <script>
        function log(elementId, message) {
            const logElement = document.getElementById(elementId);
            const timestamp = new Date().toLocaleTimeString();
            logElement.innerHTML += `[${timestamp}] ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
        }
        
        function setStatus(elementId, status, message) {
            const statusElement = document.getElementById(elementId);
            statusElement.className = `status ${status}`;
            statusElement.textContent = message;
        }
        
        // –ü–µ—Ä–µ—Ö–≤–∞—Ç –∫–æ–Ω—Å–æ–ª–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª–æ–≥–æ–≤
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ —É–∂–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç
        let consoleInterceptionSetup = false;
        
        function setupConsoleInterception() {
            if (consoleInterceptionSetup) {
                console.log('[Debug] Console interception —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω');
                return;
            }
            
            consoleInterceptionSetup = true;
            console.log('[Debug] –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º console interception...');
            
            const consoleLogDiv = document.getElementById('console-log');
            const originalLog = console.log;
            const originalError = console.error;
            const originalWarn = console.warn;

            const addToConsoleLog = (level, args, color = '#e2e8f0') => {
                const timestamp = new Date().toLocaleTimeString();
                const message = args.map(arg => 
                    typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
                ).join(' ');
                
                const logEntry = document.createElement('div');
                logEntry.innerHTML = `<span style="color: #9ca3af;">[${timestamp}]</span> <span style="color: ${color};">[${level}]</span> ${message}`;
                consoleLogDiv.appendChild(logEntry);
                consoleLogDiv.scrollTop = consoleLogDiv.scrollHeight;
            };

            console.log = (...args) => {
                originalLog.apply(console, args);
                addToConsoleLog('LOG', args, '#60a5fa');
            };

            console.error = (...args) => {
                originalError.apply(console, args);
                addToConsoleLog('ERROR', args, '#ef4444');
            };

            console.warn = (...args) => {
                originalWarn.apply(console, args);
                addToConsoleLog('WARN', args, '#f59e0b');
            };
        }
        
        function clearConsoleLog() {
            document.getElementById('console-log').innerHTML = '';
        }
        
        function copyConsoleLog() {
            const logDiv = document.getElementById('console-log');
            const logText = logDiv.innerText || logDiv.textContent;
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(logText).then(() => {
                    addToConsoleLog('LOG', ['üìã –õ–æ–≥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞'], '#10b981');
                }).catch(err => {
                    addToConsoleLog('ERROR', ['–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:', err], '#ef4444');
                });
            } else {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = logText;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                addToConsoleLog('LOG', ['üìã –õ–æ–≥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ (fallback)'], '#10b981');
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –∫–æ–Ω—Å–æ–ª–∏
        setupConsoleInterception();
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π
        function checkModules() {
            console.log('üì¶ –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É –º–æ–¥—É–ª–µ–π...');
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
            console.log('window.HEYS:', typeof window.HEYS, window.HEYS);
            console.log('window.HEYS.integration:', typeof window.HEYS?.integration, window.HEYS?.integration);
            console.log('window.modernSearchIntegration:', typeof window.modernSearchIntegration, window.modernSearchIntegration);
            
            const modules = [
                { name: 'HEYS Core', check: () => typeof window.HEYS !== 'undefined' },
                { name: 'IndexedDB Storage', check: () => typeof window.HEYS?.indexedDB !== 'undefined' },
                { name: 'Web Workers', check: () => typeof window.HEYS?.workers !== 'undefined' },
                { name: 'Integration Layer', check: () => typeof window.HEYS?.integration !== 'undefined' },
                { 
                    name: 'Search Integration', 
                    check: () => {
                        const exists = typeof window.modernSearchIntegration !== 'undefined';
                        if (exists) {
                            const status = window.modernSearchIntegration;
                            console.log(`[Debug] Search Integration status:`, status);
                            return status.loaded === true;
                        }
                        console.log(`[Debug] window.modernSearchIntegration –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç`);
                        return false;
                    }
                }
            ];
            
            let allLoaded = true;
            modules.forEach(module => {
                const loaded = module.check();
                const status = loaded ? '‚úÖ' : '‚ùå';
                const message = loaded ? 'Module loaded and available' : 'Module not found or not loaded';
                
                console.log(`${status} ${module.name}: ${message}`);
                log('modules-log', `${module.name}: ${loaded ? '‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω' : '‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω'}`);
                if (!loaded) allLoaded = false;
            });
            
            if (allLoaded) {
                console.log('üéâ –í—Å–µ –º–æ–¥—É–ª–∏ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!');
                setStatus('modules-status', 'success', '‚úÖ –í—Å–µ –º–æ–¥—É–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
            } else {
                console.warn('‚ö†Ô∏è –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –º–æ–¥—É–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
                setStatus('modules-status', 'error', '‚ùå –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –º–æ–¥—É–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
            }
            
            return allLoaded;
        }
        
        // –¢–µ—Å—Ç IndexedDB
        async function testIndexedDB() {
            try {
                console.log('üóÑÔ∏è –ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç IndexedDB...');
                setStatus('indexeddb-status', 'pending', '‚è≥ –¢–µ—Å—Ç–∏—Ä—É–µ–º IndexedDB...');
                log('indexeddb-log', '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è IndexedDB...');
                
                if (!window.HEYS?.indexedDB) {
                    throw new Error('IndexedDB –º–æ–¥—É–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }
                console.log('‚úÖ IndexedDB –º–æ–¥—É–ª—å –Ω–∞–π–¥–µ–Ω');
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
                console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º IndexedDB...');
                await window.HEYS.indexedDB.init();
                log('indexeddb-log', '‚úÖ IndexedDB –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                console.log('‚úÖ IndexedDB –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                
                // –¢–µ—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                console.log('üíæ –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...');
                const testProducts = [{ id: 'test-1', name: '–¢–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç', calories: 100 }];
                await window.HEYS.indexedDB.saveProducts(testProducts);
                log('indexeddb-log', '‚úÖ –ü—Ä–æ–¥—É–∫—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
                console.log('‚úÖ –ü—Ä–æ–¥—É–∫—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
                
                // –¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞
                console.log('üîç –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–∏—Å–∫...');
                const results = await window.HEYS.indexedDB.searchProducts('—Ç–µ—Å—Ç', 10);
                log('indexeddb-log', `‚úÖ –ü–æ–∏—Å–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω: –Ω–∞–π–¥–µ–Ω–æ ${results.length} —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤`);
                console.log(`‚úÖ –ü–æ–∏—Å–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω: –Ω–∞–π–¥–µ–Ω–æ ${results.length} —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤`);
                
                setStatus('indexeddb-status', 'success', '‚úÖ IndexedDB —Ä–∞–±–æ—Ç–∞–µ—Ç');
                console.log('üéâ IndexedDB —Ç–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ');
                return true;
            } catch (error) {
                console.error('üí• –û—à–∏–±–∫–∞ –≤ IndexedDB —Ç–µ—Å—Ç–µ:', error);
                log('indexeddb-log', `‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
                setStatus('indexeddb-status', 'error', '‚ùå IndexedDB –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç');
                return false;
            }
        }
        
        // –¢–µ—Å—Ç Web Workers
        async function testWorkers() {
            try {
                console.log('üë∑ –ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç Web Workers...');
                setStatus('workers-status', 'pending', '‚è≥ –¢–µ—Å—Ç–∏—Ä—É–µ–º Workers...');
                log('workers-log', '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Workers...');
                
                if (!window.HEYS?.workers) {
                    throw new Error('Workers –º–æ–¥—É–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }
                console.log('‚úÖ Workers –º–æ–¥—É–ª—å –Ω–∞–π–¥–µ–Ω');
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
                console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Workers...');
                await window.HEYS.workers.init();
                log('workers-log', '‚úÖ Workers –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã');
                console.log('‚úÖ Workers –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã');
                
                // –¢–µ—Å—Ç –∑–∞–¥–∞—á–∏ —á–µ—Ä–µ–∑ Worker
                console.log('‚öôÔ∏è –¢–µ—Å—Ç–∏—Ä—É–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏...');
                const result = await window.HEYS.workers.execute('search', {
                    query: '—Ç–µ—Å—Ç',
                    products: [{ name: '–¢–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç', calories: 100 }],
                    limit: 5
                });
                log('workers-log', `‚úÖ –ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞: —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ ${result?.results?.length || result?.length || 0}`);
                console.log(`‚úÖ –ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞: —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ ${result?.results?.length || result?.length || 0}`);
                
                setStatus('workers-status', 'success', '‚úÖ Workers —Ä–∞–±–æ—Ç–∞—é—Ç');
                console.log('üéâ Workers —Ç–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ');
                return true;
            } catch (error) {
                console.error('üí• –û—à–∏–±–∫–∞ –≤ Workers —Ç–µ—Å—Ç–µ:', error);
                console.error('üí• Stack trace:', error.stack);
                console.error('üí• Error details:', JSON.stringify(error, Object.getOwnPropertyNames(error)));
                log('workers-log', `‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
                setStatus('workers-status', 'error', '‚ùå Workers –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç');
                return false;
            }
        }
        
        // –¢–µ—Å—Ç —É–º–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
        async function testSmartSearch() {
            try {
                console.log('üß† –ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç —É–º–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞...');
                setStatus('search-status', 'pending', '‚è≥ –¢–µ—Å—Ç–∏—Ä—É–µ–º —É–º–Ω—ã–π –ø–æ–∏—Å–∫...');
                log('search-log', '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–ª–æ—è...');
                
                if (!window.HEYS?.integration) {
                    throw new Error('Integration –º–æ–¥—É–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }
                console.log('‚úÖ Integration –º–æ–¥—É–ª—å –Ω–∞–π–¥–µ–Ω');
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
                console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Integration —Å–ª–æ–π...');
                await window.HEYS.integration.init();
                log('search-log', '‚úÖ Integration —Å–ª–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                console.log('‚úÖ Integration —Å–ª–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                
                // –¢–µ—Å—Ç —É–º–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
                console.log('üîç –¢–µ—Å—Ç–∏—Ä—É–µ–º —É–º–Ω—ã–π –ø–æ–∏—Å–∫...');
                const startTime = performance.now();
                const results = await window.HEYS.integration.smartSearch('—Ö–ª–µ–±', { limit: 10 });
                const duration = performance.now() - startTime;
                
                log('search-log', `‚úÖ –£–º–Ω—ã–π –ø–æ–∏—Å–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω –∑–∞ ${duration.toFixed(1)}ms`);
                log('search-log', `üìä –ò—Å—Ç–æ—á–Ω–∏–∫: ${results.source}, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: ${results.results?.length || 0}`);
                console.log(`‚úÖ –£–º–Ω—ã–π –ø–æ–∏—Å–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω –∑–∞ ${duration.toFixed(1)}ms`);
                console.log(`üìä –ò—Å—Ç–æ—á–Ω–∏–∫: ${results.source}, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: ${results.results?.length || 0}`);
                
                // –¢–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                console.log('üìà –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É...');
                const stats = window.HEYS.integration.getStats();
                log('search-log', `üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: ${JSON.stringify(stats, null, 2)}`);
                console.log('üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:', stats);
                
                setStatus('search-status', 'success', `‚úÖ –£–º–Ω—ã–π –ø–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç (${duration.toFixed(1)}ms)`);
                console.log('üéâ Smart Search —Ç–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ');
                return true;
            } catch (error) {
                console.error('üí• –û—à–∏–±–∫–∞ –≤ Smart Search —Ç–µ—Å—Ç–µ:', error);
                log('search-log', `‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
                setStatus('search-status', 'error', '‚ùå –£–º–Ω—ã–π –ø–æ–∏—Å–∫ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç');
                return false;
            }
        }
        
        // –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
        async function runAllTests() {
            console.log('üöÄ –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤...');
            log('search-log', 'üöÄ –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤...');
            
            try {
                const modulesOk = checkModules();
                if (!modulesOk) {
                    setStatus('overall-status', 'error', '‚ùå –ú–æ–¥—É–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
                    return;
                }
                
                console.log('üìö –ú–æ–¥—É–ª–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã, –∑–∞–ø—É—Å–∫–∞–µ–º IndexedDB —Ç–µ—Å—Ç...');
                const indexedDBOk = await testIndexedDB();
                console.log('üìä IndexedDB —Ä–µ–∑—É–ª—å—Ç–∞—Ç:', indexedDBOk);
                
                console.log('üë∑ –ó–∞–ø—É—Å–∫–∞–µ–º Workers —Ç–µ—Å—Ç...');
                const workersOk = await testWorkers();
                console.log('üìä Workers —Ä–µ–∑—É–ª—å—Ç–∞—Ç:', workersOk);
                
                console.log('üß† –ó–∞–ø—É—Å–∫–∞–µ–º Smart Search —Ç–µ—Å—Ç...');
                const searchOk = await testSmartSearch();
                console.log('üìä Smart Search —Ä–µ–∑—É–ª—å—Ç–∞—Ç:', searchOk);
                
                const allOk = indexedDBOk && workersOk && searchOk;
                console.log('üìã –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:', { indexedDBOk, workersOk, searchOk, allOk });
                
                if (allOk) {
                    setStatus('overall-status', 'success', 'üéâ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã! –£–º–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç!');
                } else {
                    setStatus('overall-status', 'error', '‚ùå –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Å—Ç—ã –Ω–µ –ø—Ä–æ—à–ª–∏');
                }
            } catch (error) {
                console.error('üí• –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Ç–µ—Å—Ç–æ–≤:', error);
                setStatus('overall-status', 'error', 'üí• –û—à–∏–±–∫–∞: ' + error.message);
            }
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', () => {
            // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –ª–æ–≥–∏
            console.log('üöÄ Starting HEYS Integration Tests...');
            console.log('Checking modern web technologies stack...');
            console.log('Technologies: IndexedDB, Web Workers, Integration Layer');
            
            setTimeout(() => {
                console.log('üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É –º–æ–¥—É–ª–µ–π...');
                checkModules();
            }, 500);
        });
    </script>
</body>
</html>
