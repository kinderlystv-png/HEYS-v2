<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HEYS - –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π</title>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            margin: 20px; 
            background: #f5f5f5; 
        }
        .container { 
            max-width: 800px; 
            margin: 0 auto; 
            background: white; 
            padding: 20px; 
            border-radius: 10px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
        }
        .test-item { 
            margin: 10px 0; 
            padding: 15px; 
            border-radius: 8px; 
            border-left: 4px solid #ddd; 
        }
        .test-item.success { 
            background: #d4edda; 
            border-left-color: #28a745; 
        }
        .test-item.failure { 
            background: #f8d7da; 
            border-left-color: #dc3545; 
        }
        .test-item.loading { 
            background: #fff3cd; 
            border-left-color: #ffc107; 
        }
        .summary { 
            font-size: 24px; 
            text-align: center; 
            margin: 20px 0; 
            padding: 20px; 
            border-radius: 10px; 
        }
        .summary.good { 
            background: #d4edda; 
            color: #155724; 
        }
        .summary.warning { 
            background: #fff3cd; 
            color: #856404; 
        }
        .summary.danger { 
            background: #f8d7da; 
            color: #721c24; 
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
        }
        button:hover {
            background: #0056b3;
        }
        .log { 
            background: #f8f9fa; 
            padding: 15px; 
            border-radius: 8px; 
            font-family: monospace; 
            white-space: pre-wrap; 
            max-height: 300px; 
            overflow-y: auto; 
            margin: 20px 0;
            border: 1px solid #e9ecef;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß HEYS - –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π</h1>
        <p>–ü—Ä–æ–≤–µ—Ä—è–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —ç–∫—Å–ø–æ—Ä—Ç–æ–≤</p>

        <button onclick="runQuickTest()">üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –±—ã—Å—Ç—Ä—É—é –ø—Ä–æ–≤–µ—Ä–∫—É</button>

        <div id="summary" class="summary" style="display: none;"></div>
        <div id="results"></div>
        <div id="log" class="log" style="display: none;"></div>
    </div>

    <!-- –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏ HEYS -->
    <script src="../heys_core_v12.js"></script>
    <script src="../heys_day_v12.js"></script>
    <script src="../heys_user_v12.js"></script>
    <script src="../heys_storage_supabase_v1.js"></script>
    <script src="../heys_storage_indexeddb_v1.js"></script>
    <script src="../heys_performance_monitor.js"></script>
    <script src="../heys_analytics_ui.js"></script>
    <script src="../heys_models_v1.js"></script>
    <script src="../heys_stats_v1.js"></script>
    <script src="../heys_smart_search_with_typos_v1.js"></script>
    <script src="../heys_advanced_error_tracker_v1.js"></script>
    <script src="../heys_worker_manager_v1.js"></script>
    <script src="../heys_integration_layer_v1.js"></script>
    <script src="../heys_service_worker_v1.js"></script>
    <script src="../modern-search-integration.js"></script>

    <script>
        const testResults = [];
        
        function log(message) {
            const logDiv = document.getElementById('log');
            logDiv.style.display = 'block';
            logDiv.textContent += new Date().toLocaleTimeString() + ': ' + message + '\n';
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log('[QuickTest]', message);
        }

        function addTestResult(name, success, message = '') {
            testResults.push({ name, success, message });
            
            const resultsDiv = document.getElementById('results');
            const testDiv = document.createElement('div');
            testDiv.className = `test-item ${success ? 'success' : 'failure'}`;
            testDiv.innerHTML = `
                <strong>${success ? '‚úÖ' : '‚ùå'} ${name}</strong>
                ${message ? `<br><small>${message}</small>` : ''}
            `;
            resultsDiv.appendChild(testDiv);
        }

        function updateSummary() {
            const passed = testResults.filter(t => t.success).length;
            const total = testResults.length;
            const percentage = Math.round((passed / total) * 100);
            
            const summaryDiv = document.getElementById('summary');
            summaryDiv.style.display = 'block';
            summaryDiv.textContent = `–†–µ–∑—É–ª—å—Ç–∞—Ç: ${passed}/${total} —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ (${percentage}%)`;
            
            if (percentage >= 90) {
                summaryDiv.className = 'summary good';
            } else if (percentage >= 70) {
                summaryDiv.className = 'summary warning';
            } else {
                summaryDiv.className = 'summary danger';
            }
        }

        async function runQuickTest() {
            document.getElementById('results').innerHTML = '';
            document.getElementById('log').textContent = '';
            testResults.length = 0;
            
            log('–ù–∞—á–∏–Ω–∞–µ–º –±—ã—Å—Ç—Ä—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π...');

            // –ñ–¥–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
            await new Promise(resolve => setTimeout(resolve, 1000));

            try {
                // –¢–µ—Å—Ç 1: Performance Monitor
                log('–¢–µ—Å—Ç–∏—Ä—É–µ–º Performance Monitor...');
                if (typeof HEYS.performance === 'object' && typeof HEYS.performance.trackUserInteraction === 'function') {
                    HEYS.performance.trackUserInteraction('test_event', { test: true });
                    addTestResult('Performance Monitor', true, 'HEYS.performance —ç–∫—Å–ø–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç');
                } else {
                    addTestResult('Performance Monitor', false, 'HEYS.performance –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–π');
                }

                // –¢–µ—Å—Ç 2: Analytics UI
                log('–¢–µ—Å—Ç–∏—Ä—É–µ–º Analytics UI...');
                if (typeof HEYS.AnalyticsUI === 'object') {
                    addTestResult('Analytics UI', true, 'HEYS.AnalyticsUI —ç–∫—Å–ø–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç');
                } else {
                    addTestResult('Analytics UI', false, 'HEYS.AnalyticsUI –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }

                // –¢–µ—Å—Ç 3: Models System
                log('–¢–µ—Å—Ç–∏—Ä—É–µ–º Models System...');
                if (typeof HEYS.validateProduct === 'function' && typeof HEYS.validateDay === 'function') {
                    const testProduct = { name: 'Test', kcal100: 100 };
                    const isValid = HEYS.validateProduct(testProduct);
                    addTestResult('Models System', true, `–í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞: ${isValid}`);
                } else {
                    addTestResult('Models System', false, '–§—É–Ω–∫—Ü–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
                }

                // –¢–µ—Å—Ç 4: Stats System
                log('–¢–µ—Å—Ç–∏—Ä—É–µ–º Stats System...');
                if (typeof HEYS.Stats === 'object' && HEYS.Stats.StatsTab) {
                    addTestResult('Stats System', true, 'HEYS.Stats —Å StatsTab —Ä–∞–±–æ—Ç–∞–µ—Ç');
                } else {
                    addTestResult('Stats System', false, 'HEYS.Stats –∏–ª–∏ StatsTab –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
                }

                // –¢–µ—Å—Ç 5: Smart Search
                log('–¢–µ—Å—Ç–∏—Ä—É–µ–º Smart Search...');
                if (typeof HEYS.SmartSearch === 'object' && typeof HEYS.SmartSearch.search === 'function') {
                    addTestResult('Smart Search', true, 'HEYS.SmartSearch —ç–∫—Å–ø–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç');
                } else {
                    addTestResult('Smart Search', false, 'HEYS.SmartSearch –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }

                // –¢–µ—Å—Ç 6: Advanced Error Tracker
                log('–¢–µ—Å—Ç–∏—Ä—É–µ–º Advanced Error Tracker...');
                if (typeof HEYS.errorTracker === 'object' && typeof HEYS.errorTracker.captureException === 'function') {
                    addTestResult('Advanced Error Tracker', true, 'HEYS.errorTracker —ç–∫—Å–ø–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç');
                } else {
                    addTestResult('Advanced Error Tracker', false, 'HEYS.errorTracker –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }

                // –¢–µ—Å—Ç 7: IndexedDB Storage
                log('–¢–µ—Å—Ç–∏—Ä—É–µ–º IndexedDB Storage...');
                if (typeof HEYS.indexedDB === 'object' && typeof HEYS.indexedDB.init === 'function') {
                    addTestResult('IndexedDB Storage', true, 'HEYS.indexedDB —ç–∫—Å–ø–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç');
                } else {
                    addTestResult('IndexedDB Storage', false, 'HEYS.indexedDB –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }

                // –¢–µ—Å—Ç 8: Worker Manager
                log('–¢–µ—Å—Ç–∏—Ä—É–µ–º Worker Manager...');
                if (typeof HEYS.WorkerManager === 'object' && typeof HEYS.WorkerManager.createWorker === 'function') {
                    addTestResult('Worker Manager', true, 'HEYS.WorkerManager —ç–∫—Å–ø–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç');
                } else {
                    addTestResult('Worker Manager', false, 'HEYS.WorkerManager –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }

                // –¢–µ—Å—Ç 9: Integration Layer
                log('–¢–µ—Å—Ç–∏—Ä—É–µ–º Integration Layer...');
                if (typeof HEYS.integration === 'object' && typeof HEYS.integration.init === 'function') {
                    addTestResult('Integration Layer', true, 'HEYS.integration —ç–∫—Å–ø–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç');
                } else {
                    addTestResult('Integration Layer', false, 'HEYS.integration –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }

                // –¢–µ—Å—Ç 10: Supabase Connection
                log('–¢–µ—Å—Ç–∏—Ä—É–µ–º Supabase Connection...');
                if (typeof HEYS.SupabaseConnection === 'object' && typeof HEYS.SupabaseConnection.connect === 'function') {
                    addTestResult('Supabase Connection', true, 'HEYS.SupabaseConnection —ç–∫—Å–ø–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç');
                } else {
                    addTestResult('Supabase Connection', false, 'HEYS.SupabaseConnection –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }

                // –¢–µ—Å—Ç 11: Service Worker
                log('–¢–µ—Å—Ç–∏—Ä—É–µ–º Service Worker...');
                if (typeof HEYS.serviceWorker === 'object' && typeof HEYS.serviceWorker.register === 'function') {
                    addTestResult('Service Worker', true, 'HEYS.serviceWorker —ç–∫—Å–ø–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç');
                } else {
                    addTestResult('Service Worker', false, 'HEYS.serviceWorker –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }

                // –¢–µ—Å—Ç 12: Modern Search Integration
                log('–¢–µ—Å—Ç–∏—Ä—É–µ–º Modern Search Integration...');
                if (typeof HEYS.ModernSearch === 'object' && typeof HEYS.ModernSearch.smartSearch === 'function') {
                    addTestResult('Modern Search Integration', true, 'HEYS.ModernSearch —ç–∫—Å–ø–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç');
                } else {
                    addTestResult('Modern Search Integration', false, 'HEYS.ModernSearch –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }

                log('–ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
                updateSummary();

            } catch (error) {
                log('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ç–µ—Å—Ç–æ–≤: ' + error.message);
                addTestResult('–û–±—â–∞—è –æ—à–∏–±–∫–∞', false, error.message);
                updateSummary();
            }
        }

        // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(() => {
            log('–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏...');
            runQuickTest();
        }, 2000);
    </script>
</body>
</html>
