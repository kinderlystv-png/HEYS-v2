/*
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üó∫Ô∏è –ù–ê–í–ò–ì–ê–¶–ò–û–ù–ù–ê–Ø –ö–ê–†–¢–ê –§–ê–ô–õ–ê heys_user_v12.js (295 —Å—Ç—Ä–æ–∫)                               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üìã –°–¢–†–£–ö–¢–£–†–ê –§–ê–ô–õ–ê:                                                                       ‚îÇ
‚îÇ                                                                                           ‚îÇ
‚îÇ ‚öõÔ∏è –ö–û–ú–ü–û–ù–ï–ù–¢ UserTabBase (—Å—Ç—Ä–æ–∫–∏ 1-150):                                                 ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ State —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: profile, zones (9-27)                                          ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ defaultZones - —Ä–∞—Å—á–µ—Ç HR –∑–æ–Ω (18-27)                                             ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ useEffect - –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å–º–µ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞ (29-50)                               ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ handleProfileSave() - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è (51-70)                                 ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ handleZoneSave() - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–æ–Ω (71-90)                                        ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ calculateBMI() - —Ä–∞—Å—á–µ—Ç –ò–ú–¢ (91-100)                                             ‚îÇ
‚îÇ    ‚îî‚îÄ‚îÄ calculateBMR() - –±–∞–∑–æ–≤—ã–π –º–µ—Ç–∞–±–æ–ª–∏–∑–º (101-120)                                    ‚îÇ
‚îÇ                                                                                           ‚îÇ
‚îÇ üé® RENDER –ú–ï–¢–û–î–´ (—Å—Ç—Ä–æ–∫–∏ 151-230):                                                       ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ renderProfileForm() - —Ñ–æ—Ä–º–∞ –ø—Ä–æ—Ñ–∏–ª—è (121-160)                                    ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ renderHRZones() - –ø—É–ª—å—Å–æ–≤—ã–µ –∑–æ–Ω—ã (161-190)                                       ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ renderStats() - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ BMI/BMR (191-210)                                     ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ renderNorms() - –Ω–æ—Ä–º—ã –ø–∏—Ç–∞–Ω–∏—è (211-220)                                          ‚îÇ
‚îÇ    ‚îî‚îÄ‚îÄ Main render() method (221-230)                                                    ‚îÇ
‚îÇ                                                                                           ‚îÇ
‚îÇ üîó –≠–ö–°–ü–û–†–¢ –ò –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø (—Å—Ç—Ä–æ–∫–∏ 231-259):                                             ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ HEYS.UserTab - –æ—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Å–ø–æ—Ä—Ç (231-240)                                        ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ HEYS.User - –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (241-250)                                    ‚îÇ
‚îÇ    ‚îî‚îÄ‚îÄ –£—Ç–∏–ª–∏—Ç—ã –ø—Ä–æ—Ñ–∏–ª—è (251-259)                                                        ‚îÇ
‚îÇ                                                                                           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üéØ –ë–´–°–¢–†–´–ô –ü–û–ò–°–ö:                                                                        ‚îÇ
‚îÇ    ‚Ä¢ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç: UserTabBase (—Å—Ç—Ä–æ–∫–∞ 8), main render (221)                              ‚îÇ
‚îÇ    ‚Ä¢ –ü—Ä–æ—Ñ–∏–ª—å: handleProfileSave() (51), renderProfileForm() (121)                      ‚îÇ
‚îÇ    ‚Ä¢ HR –∑–æ–Ω—ã: defaultZones (18), renderHRZones() (161)                                  ‚îÇ
‚îÇ    ‚Ä¢ –†–∞—Å—á–µ—Ç—ã: calculateBMI() (91), calculateBMR() (101)                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
*/

// heys_user_v12.js ‚Äî –≤–∫–ª–∞–¥–∫–∞ ¬´–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è¬ª
(function(global){
  const HEYS = global.HEYS = global.HEYS || {};
  const React = global.React;
  const { lsGet, lsSet, toNum, round1 } = HEYS.utils || {
    lsGet:(k,d)=>d, lsSet:()=>{}, toNum:(x)=>Number(x)||0, round1:(v)=>Math.round(v*10)/10
  };

  function UserTabBase(){
    const [profile, setProfile] = React.useState(() => {
      return lsGet('heys_profile', {
        firstName:'', lastName:'', gender:'–ú—É–∂—Å–∫–æ–π',
        weight:70, height:175, age:30,
        sleepHours:8, insulinWaveHours:3
      });
    });

    const defaultZones = React.useMemo(()=>{
      const maxHR = Math.max(0, 220 - toNum(profile.age||0));
      const z = (fromPct, toPct) => ({ hrFrom: Math.round(maxHR * fromPct), hrTo: Math.round(maxHR * toPct) });
      return [
        { name:'–ë—ã—Ç–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (—Ö–æ–¥—å–±–∞)', ...z(0.5,0.6), MET:2.5 },
        { name:'–£–º–µ—Ä–µ–Ω–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–º–µ–¥–ª–µ–Ω–Ω—ã–π –±–µ–≥)', ...z(0.6,0.75), MET:6 },
        { name:'–ê—ç—Ä–æ–±–Ω–∞—è (–∫–∞—Ä–¥–∏–æ)', ...z(0.75,0.85), MET:8 },
        { name:'–ê–Ω–∞—ç—Ä–æ–±–Ω–∞—è (–∞–∫—Ç–∏–≤–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞, –∫–æ–≥–¥–∞ —Ç—è–∂–µ–ª–æ)', ...z(0.85,0.95), MET:10 }
      ];
    }, [profile.age]);

    const [zones, setZones] = React.useState(lsGet('heys_hr_zones', defaultZones));

    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å–º–µ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞ (–∫–∞–∫ –≤ –¥–∞–Ω–Ω—ã—Ö –¥–Ω—è)
    React.useEffect(() => {
      let cancelled = false;
      const clientId = window.HEYS && window.HEYS.currentClientId;
      const cloud = window.HEYS && window.HEYS.cloud;
      
      const reloadData = () => {
        if (cancelled) return;
        console.log('[Profile] Reloading data after client change...');
        
        const newProfile = lsGet('heys_profile', {
          firstName:'', lastName:'', gender:'–ú—É–∂—Å–∫–æ–π',
          weight:70, height:175, age:30,
          sleepHours:8, insulinWaveHours:3
        });
        console.log('[Profile] Loaded profile:', newProfile);
        setProfile(newProfile);
        
        const newZones = lsGet('heys_hr_zones', defaultZones);
        console.log('[Profile] Loaded zones:', newZones);
        setZones(newZones);
      };
      
      if (clientId && cloud && typeof cloud.bootstrapClientSync === 'function') {
        if (typeof cloud.shouldSyncClient === 'function' ? cloud.shouldSyncClient(clientId, 4000) : true) {
          cloud.bootstrapClientSync(clientId).then(() => {
            setTimeout(reloadData, 150); // –ö–∞–∫ –≤ –¥–∞–Ω–Ω—ã—Ö –¥–Ω—è
          });
        } else {
          reloadData();
        }
      } else {
        reloadData();
      }
      
      return () => { cancelled = true; };
    }, [window.HEYS && window.HEYS.currentClientId]);

  React.useEffect(() => {
    console.log('[Profile] Saving profile:', profile);
    lsSet('heys_profile', profile);
  }, [profile]);
  React.useEffect(()=>{
    console.log('[Profile] Saving zones:', zones);
    lsSet('heys_hr_zones', zones);
  }, [zones]);

    const maxHR = Math.max(0, 220 - toNum(profile.age||0));
    const calPerMinPerMET = round1(toNum(profile.weight||0) * 0.0175); // –∫–∞–ª/–º–∏–Ω –Ω–∞ 1 MET

    function updateProfileField(key, value){ 
    const newProfile = { ...profile, [key]: value };
    setProfile(newProfile); 
    
    // Minimal logging for critical updates only
    if (key === 'height' || key === 'weight' || key === 'firstName' || key === 'lastName') {
      console.log(`[Profile] ${key} updated:`, value);
    }
  }
    function updateZone(i, patch){ setZones(zones.map((z, idx)=> idx===i ? { ...z, ...patch } : z)); }
    function resetZones(){ if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –ø—É–ª—å—Å–æ–≤—ã–µ –∑–æ–Ω—ã –∫ —à–∞–±–ª–æ–Ω—É?')) setZones(defaultZones); }

    return React.createElement('div', {className:'page page-user'},
      React.createElement('div', {className:'user-cards-grid'},
      React.createElement('div', {className:'card tone-blue'},
        React.createElement('div', {style:{fontWeight:'600', marginBottom:'6px'}}, '–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è'),
        React.createElement('div', {className:'field-list'},
            React.createElement('div', {className:'inline-field', style:{fontWeight:700,fontSize:'16px',background:'#f1f5f9',padding:'6px 10px',borderRadius:'8px'}}, React.createElement('label', {style:{fontWeight:700,minWidth:'180px'}}, '–¶–µ–ª–µ–≤–æ–π –¥–µ—Ñ–∏—Ü–∏—Ç (%)'), React.createElement('span', {className:'sep'}, '-'), React.createElement('input', {type:'number', step:'1', value:profile.deficitPctTarget||0, onChange:e=>updateProfileField('deficitPctTarget', Number(e.target.value)||0), style:{width:'70px',fontWeight:700,fontSize:'16px',textAlign:'center'}})),
          React.createElement('div', {className:'inline-field'}, React.createElement('label', null, '–ò–º—è'), React.createElement('span', {className:'sep'}, '-'), React.createElement('input', {value:profile.firstName, onChange:e=>updateProfileField('firstName', e.target.value)})),
          React.createElement('div', {className:'inline-field'}, React.createElement('label', null, '–§–∞–º–∏–ª–∏—è'), React.createElement('span', {className:'sep'}, '-'), React.createElement('input', {value:profile.lastName, onChange:e=>updateProfileField('lastName', e.target.value)})),
          React.createElement('div', {className:'inline-field'}, React.createElement('label', null, '–ü–æ–ª'), React.createElement('span', {className:'sep'}, '-'),
            React.createElement('select', {value:profile.gender, onChange:e=>updateProfileField('gender', e.target.value)},
              React.createElement('option', {value:'–ú—É–∂—Å–∫–æ–π'}, '–ú—É–∂—Å–∫–æ–π'),
              React.createElement('option', {value:'–ñ–µ–Ω—Å–∫–∏–π'}, '–ñ–µ–Ω—Å–∫–∏–π'),
              React.createElement('option', {value:'–î—Ä—É–≥–æ–µ'}, '–î—Ä—É–≥–æ–µ')
            )
          ),
          React.createElement('div', {className:'inline-field'}, React.createElement('label', null, '–ë–∞–∑–æ–≤—ã–π –≤–µ—Å —Ç–µ–ª–∞ (–∫–≥)'), React.createElement('span', {className:'sep'}, '-'), React.createElement('input', {type:'number', step:'0.1', value:profile.weight, onChange:e=>updateProfileField('weight', Number(e.target.value)||0)})),
          React.createElement('div', {className:'inline-field'}, React.createElement('label', null, '–†–æ—Å—Ç (—Å–º)'), React.createElement('span', {className:'sep'}, '-'), React.createElement('input', {type:'number', value:profile.height, onChange:e=>updateProfileField('height', Number(e.target.value)||0)})),
          React.createElement('div', {className:'inline-field'}, React.createElement('label', null, '–í–æ–∑—Ä–∞—Å—Ç (–ª–µ—Ç)'), React.createElement('span', {className:'sep'}, '-'), React.createElement('input', {type:'number', value:profile.age, onChange:e=>updateProfileField('age', Number(e.target.value)||0)})),
          React.createElement('div', {className:'inline-field'}, React.createElement('label', null, '–ù–æ—Ä–º–∞ —Å–Ω–∞ (—á–∞—Å–æ–≤)'), React.createElement('span', {className:'sep'}, '-'), React.createElement('input', {type:'number', step:'0.5', value:profile.sleepHours, onChange:e=>updateProfileField('sleepHours', Number(e.target.value)||0)})),
          React.createElement('div', {className:'inline-field'}, React.createElement('label', null, '–ò–Ω—Å—É–ª–∏–Ω–æ–≤–∞—è –≤–æ–ª–Ω–∞ (—á–∞—Å–æ–≤)'), React.createElement('span', {className:'sep'}, '-'), React.createElement('input', {type:'number', step:'0.5', value:profile.insulinWaveHours, onChange:e=>updateProfileField('insulinWaveHours', Number(e.target.value)||0)}))
        ),
        React.createElement('div', {className:'row', style:{marginTop:'10px', gap:'20px'}},
          React.createElement('div', {className:'pill'}, `–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—É–ª—å—Å: ${maxHR} —É–¥/–º–∏–Ω (220 - –≤–æ–∑—Ä–∞—Å—Ç)`),
          React.createElement('div', {className:'pill'}, `–ö–∞–ª/–º–∏–Ω –Ω–∞ 1 MET: ${calPerMinPerMET}`)
        ),
        React.createElement('div', {className:'muted', style:{marginTop:'6px'}}, '–í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.')
      ),

      React.createElement('div', {className:'card'},
        React.createElement('div', {className:'row', style:{justifyContent:'space-between'}},
          React.createElement('div', {className:'section-title'}, '–ü—É–ª—å—Å–æ–≤—ã–µ –∑–æ–Ω—ã'),
          React.createElement('div', {className:'row'}, React.createElement('button', {className:'btn', onClick:resetZones}, '–°–±—Ä–æ—Å–∏—Ç—å –∫ —à–∞–±–ª–æ–Ω—É'))
        ),
        React.createElement('div', {style:{overflowX:'auto'}},
          React.createElement('table', null,
            React.createElement('thead', null, React.createElement('tr', null,
              React.createElement('th', null, '–ü—É–ª—å—Å–æ–≤—ã–µ –∑–æ–Ω—ã'),
              React.createElement('th', null, '–ø—É–ª—å—Å –æ—Ç'),
              React.createElement('th', null, '–ø—É–ª—å—Å –¥–æ'),
              React.createElement('th', null, 'MET'),
              React.createElement('th', null, '–∫–∞–ª/–º–∏–Ω –¥–ª—è –Ω–∞—à–µ–≥–æ –≤–µ—Å–∞')
            )),
            React.createElement('tbody', null,
              zones.map((z, i)=>{
                const calPerMin = round1((toNum(z.MET||0) * calPerMinPerMET) - 1); // –ø–æ–ø—Ä–∞–≤–∫–∞ -1
                return React.createElement('tr', {key:i},
                  React.createElement('td', null, React.createElement('input', {value:z.name, onChange:e=>updateZone(i, {name:e.target.value})})),
                  React.createElement('td', null, React.createElement('input', {type:'number', value:z.hrFrom, onChange:e=>updateZone(i, {hrFrom:Number(e.target.value)||0})})),
                  React.createElement('td', null, React.createElement('input', {type:'number', value:z.hrTo, onChange:e=>updateZone(i, {hrTo:Number(e.target.value)||0})})),
                  React.createElement('td', null, React.createElement('input', {type:'number', step:'0.1', value:z.MET, onChange:e=>updateZone(i, {MET:Number(e.target.value)||0})})),
                  React.createElement('td', null, calPerMin)
                );
              })
            )
          )
        ),
        React.createElement('div', {className:'muted', style:{marginTop:'8px'}}, '–§–æ—Ä–º—É–ª—ã: –ú–∞–∫—Å –ø—É–ª—å—Å = 220 ‚àí –≤–æ–∑—Ä–∞—Å—Ç. –ö–∞–ª/–º–∏–Ω = MET √ó (–≤–µ—Å √ó 0.0175) ‚àí 1.')
      ),

      React.createElement(HEYS_NormsCard, null),
      
    )
    );
  }

  
  // === –ù–æ—Ä–º—ã (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –±–ª–æ–∫) ===
  function HEYS_NormsCard(){
    const U = HEYS.utils || {};
    const clamp = (v)=> Math.max(0, Math.min(100, (U.toNum?U.toNum(v):Number(v)||0)));
    const lsGet = U.lsGet || ((k,d)=>d);
    const lsSet = U.lsSet || (()=>{});
    const [norms, setNorms] = React.useState(() => {
      const val = lsGet('heys_norms', {
        carbsPct:0, proteinPct:0, badFatPct:0, superbadFatPct:0, simpleCarbPct:0, giPct:0, harmPct:0, fiberPct:0
      });
      return val;
    });
    // –ë–æ–ª—å—à–µ –Ω–µ –ø–æ–¥–≥—Ä—É–∂–∞–µ–º –Ω–æ—Ä–º—ã –∏–∑ –æ–±–ª–∞–∫–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–º–µ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞ (bootstrapClientSync –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ index.html)
    React.useEffect(() => {
      console.log('[Norms] Saving norms:', norms);
      lsSet('heys_norms', norms);
    }, [norms]);
    
    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–æ—Ä–º –ø—Ä–∏ —Å–º–µ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞ (–∫–∞–∫ –≤ –¥–∞–Ω–Ω—ã—Ö –¥–Ω—è)
    React.useEffect(() => {
      let cancelled = false;
      const clientId = window.HEYS && window.HEYS.currentClientId;
      const cloud = window.HEYS && window.HEYS.cloud;
      
      const reloadNorms = () => {
        if (cancelled) return;
        console.log('[Norms] Reloading norms after client change...');
        
        const newNorms = lsGet('heys_norms', {
          carbsPct:0, proteinPct:0, badFatPct:0, superbadFatPct:0, simpleCarbPct:0, giPct:0, harmPct:0, fiberPct:0
        });
        console.log('[Norms] Loaded norms:', newNorms);
        setNorms(newNorms);
      };
      
      if (clientId && cloud && typeof cloud.bootstrapClientSync === 'function') {
        if (typeof cloud.shouldSyncClient === 'function' ? cloud.shouldSyncClient(clientId, 4000) : true) {
          cloud.bootstrapClientSync(clientId).then(() => {
            setTimeout(reloadNorms, 150); // –ö–∞–∫ –≤ –¥–∞–Ω–Ω—ã—Ö –¥–Ω—è
          });
        } else {
          reloadNorms();
        }
      } else {
        reloadNorms();
      }
      
      return () => { cancelled = true; };
    }, [window.HEYS && window.HEYS.currentClientId]);

    const carb = clamp(norms.carbsPct);
    const prot = clamp(norms.proteinPct);
    const fatAuto = clamp(100 - carb - prot);

    const badF = clamp(norms.badFatPct);
    const superBadF = clamp(norms.superbadFatPct);
    const goodFAuto = clamp(100 - badF - superBadF);

    const simpleC = clamp(norms.simpleCarbPct);
    const complexCAuto = clamp(100 - simpleC);

    const update = (k, v)=> setNorms({...norms, [k]: clamp(v)});

    const overMacro = (carb + prot) > 100;
    const overFatSplit = (badF + superBadF) > 100;
    const overCarbSplit = simpleC > 100;

    return React.createElement('div', {className:'card', style:{marginTop:'10px'}},
      React.createElement('div', {className:'section-title'}, '–ù–æ—Ä–º—ã'),
      React.createElement('div', {className:'field-list'},
        React.createElement('div', {className:'inline-field'}, React.createElement('label', null, '–£–≥–ª–µ–≤–æ–¥—ã (%) ‚Äî –≤—Ä—É—á–Ω—É—é'), React.createElement('span', {className:'sep'}, '-'), React.createElement('input', {type:'number', min:0, max:100, step:'1', value:carb, onChange:e=>update('carbsPct', e.target.value)})),
        React.createElement('div', {className:'inline-field'}, React.createElement('label', null, '–ë–µ–ª–∫–∏ (%) ‚Äî –≤—Ä—É—á–Ω—É—é'), React.createElement('span', {className:'sep'}, '-'), React.createElement('input', {type:'number', min:0, max:100, step:'1', value:prot, onChange:e=>update('proteinPct', e.target.value)})),
        React.createElement('div', {className:'inline-field'}, React.createElement('label', null, '–ñ–∏—Ä—ã (%) ‚Äî –∞–≤—Ç–æ = 100 ‚àí –£ ‚àí –ë'), React.createElement('span', {className:'sep'}, '-'), React.createElement('input', {className:'readOnly', readOnly:true, value:fatAuto})),
        React.createElement('div', {className:'inline-field'}, React.createElement('label', null, '–í—Ä–µ–¥–Ω—ã–µ –∂–∏—Ä—ã (%) ‚Äî –≤—Ä—É—á–Ω—É—é'), React.createElement('span', {className:'sep'}, '-'), React.createElement('input', {type:'number', min:0, max:100, step:'1', value:badF, onChange:e=>update('badFatPct', e.target.value)})),
        React.createElement('div', {className:'inline-field'}, React.createElement('label', null, '–°—É–ø–µ—Ä–≤—Ä–µ–¥–Ω—ã–µ –∂–∏—Ä—ã (%) ‚Äî –≤—Ä—É—á–Ω—É—é'), React.createElement('span', {className:'sep'}, '-'), React.createElement('input', {type:'number', min:0, max:100, step:'1', value:superBadF, onChange:e=>update('superbadFatPct', e.target.value)})),
        React.createElement('div', {className:'inline-field'}, React.createElement('label', null, '–ü–æ–ª–µ–∑–Ω—ã–µ –∂–∏—Ä—ã (%) ‚Äî –∞–≤—Ç–æ = 100 ‚àí –≤—Ä–µ–¥–Ω—ã–µ ‚àí —Å—É–ø–µ—Ä–≤—Ä–µ–¥–Ω—ã–µ'), React.createElement('span', {className:'sep'}, '-'), React.createElement('input', {className:'readOnly', readOnly:true, value:goodFAuto})),
        React.createElement('div', {className:'inline-field'}, React.createElement('label', null, '–ü—Ä–æ—Å—Ç—ã–µ —É–≥–ª–µ–≤–æ–¥—ã (%) ‚Äî –≤—Ä—É—á–Ω—É—é'), React.createElement('span', {className:'sep'}, '-'), React.createElement('input', {type:'number', min:0, max:100, step:'1', value:simpleC, onChange:e=>update('simpleCarbPct', e.target.value)})),
        React.createElement('div', {className:'inline-field'}, React.createElement('label', null, '–°–ª–æ–∂–Ω—ã–µ —É–≥–ª–µ–≤–æ–¥—ã (%) ‚Äî –∞–≤—Ç–æ = 100 ‚àí –ø—Ä–æ—Å—Ç—ã–µ'), React.createElement('span', {className:'sep'}, '-'), React.createElement('input', {className:'readOnly', readOnly:true, value:complexCAuto})),
        React.createElement('div', {className:'inline-field'}, React.createElement('label', null, '–ì–ò (%) ‚Äî –≤—Ä—É—á–Ω—É—é'), React.createElement('span', {className:'sep'}, '-'), React.createElement('input', {type:'number', min:0, max:100, step:'1', value:clamp(norms.giPct), onChange:e=>update('giPct', e.target.value)})),
        React.createElement('div', {className:'inline-field'}, React.createElement('label', null, '–í—Ä–µ–¥–Ω–æ—Å—Ç—å (%) ‚Äî –≤—Ä—É—á–Ω—É—é'), React.createElement('span', {className:'sep'}, '-'), React.createElement('input', {type:'number', min:0, max:100, step:'1', value:clamp(norms.harmPct), onChange:e=>update('harmPct', e.target.value)})),
        React.createElement('div', {className:'inline-field'}, React.createElement('label', null, '–ö–ª–µ—Ç—á–∞—Ç–∫–∞ (%) ‚Äî –≤—Ä—É—á–Ω—É—é'), React.createElement('span', {className:'sep'}, '-'), React.createElement('input', {type:'number', min:0, max:100, step:'1', value:clamp(norms.fiberPct), onChange:e=>update('fiberPct', e.target.value)}))
      ),
      (overMacro || overFatSplit || overCarbSplit) ?
        React.createElement('div', {className:'muted', style:{marginTop:'6px', color:'#dc2626'}}, 
          (overMacro ? '–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –£% + –ë% –ø—Ä–µ–≤—ã—à–∞—é—Ç 100. –ñ–∏—Ä—ã –±—É–¥—É—Ç –æ–±–Ω—É–ª–µ–Ω—ã. ' : ''),
          (overFatSplit ? '–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –í—Ä–µ–¥–Ω—ã–µ% + –°—É–ø–µ—Ä–≤—Ä–µ–¥–Ω—ã–µ% > 100. –ü–æ–ª–µ–∑–Ω—ã–µ –±—É–¥—É—Ç –æ–±–Ω—É–ª–µ–Ω—ã. ' : ''),
          (overCarbSplit ? '–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –ü—Ä–æ—Å—Ç—ã–µ% > 100. –°–ª–æ–∂–Ω—ã–µ –±—É–¥—É—Ç –æ–±–Ω—É–ª–µ–Ω—ã.' : '')
        )
      : null,
      React.createElement('div', {className:'muted', style:{marginTop:'6px'}}, '–í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö, —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.')
    );
  }

  function UserTab(props){
    return React.createElement(UserTabBase, props);
  }

  HEYS.UserTab = UserTab;

})(window);
