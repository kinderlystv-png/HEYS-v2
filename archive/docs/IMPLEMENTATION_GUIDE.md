# üöÄ –ò–ù–°–¢–†–£–ö–¶–ò–Ø: –ö–∞–∫ –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∑–∞–¥–∞—á–µ–π –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

**–í–µ—Ç–∫–∞:** `feature/global-autosave-day-data`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–∞ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏  
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~1-2 —á–∞—Å–∞

---

## üìã –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (5 –º–∏–Ω—É—Ç)

### 1. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –≤–µ—Ç–∫—É

```bash
cd /Users/poplavskijanton/HEYS-v2
git checkout feature/global-autosave-day-data
```

### 2. –û—Ç–∫—Ä—ã—Ç—å –∑–∞–¥–∞—á—É

```bash
# –í —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –æ—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª:
# TASK_GLOBAL_AUTOSAVE_DAY_DATA.md
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
pnpm dev
```

---

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª                               | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                 | –î–µ–π—Å—Ç–≤–∏–µ         |
| ---------------------------------- | -------------------------- | ---------------- |
| `TASK_GLOBAL_AUTOSAVE_DAY_DATA.md` | –ü–æ–ª–Ω–æ–µ –¢–ó —Å —á–µ–∫-–ª–∏—Å—Ç–æ–º     | üìñ –ß–∏—Ç–∞—Ç—å        |
| `AUTOSAVE_FEATURE_SUMMARY.md`      | –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç –¥–Ω—è         | üìä –û–±–∑–æ—Ä–Ω–æ       |
| `BUG_ANALYSIS_TRAINING_ZONES.md`   | –ê–Ω–∞–ª–∏–∑ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ | üîç –ö–æ–Ω—Ç–µ–∫—Å—Ç      |
| `apps/web/heys_day_v12.js`         | –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π | ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å |
| `apps/web/heys_reports_v12.js`     | –§–∞–π–ª –æ—Ç—á–µ—Ç–æ–≤ (—É–∂–µ –∏–∑–º–µ–Ω–µ–Ω) | üìñ –°–ø—Ä–∞–≤–∫–∞       |

---

## üî® –ü–æ—à–∞–≥–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –§–∞–∑–∞ 1: –î–æ–±–∞–≤–∏—Ç—å `useEffect` (10 –º–∏–Ω—É—Ç)

**–§–∞–π–ª:** `apps/web/heys_day_v12.js`

**–ù–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫—É:**

```javascript
const [day, setDay] = React.useState(null);
const [prof, setProf] = React.useState(getProfile());
```

**–î–æ–±–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ –Ω–µ—ë:**

```javascript
// –≠—Ñ—Ñ–µ–∫—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–Ω—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π (debounce)
React.useEffect(() => {
  if (!day || !day.date) return; // –ù–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç

  const handler = setTimeout(() => {
    console.log(`[AUTOSAVE] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è ${day.date}`);
    lsSet('heys_dayv2_' + day.date, day);
  }, 500); // –ó–∞–¥–µ—Ä–∂–∫–∞ –≤ 500 –º—Å

  // –û—á–∏—Å—Ç–∫–∞ —Ç–∞–π–º–µ—Ä–∞ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∏–ª–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
  return () => clearTimeout(handler);
}, [day]); // –°–ª–µ–¥–∏–º –∑–∞ –õ–Æ–ë–´–ú–ò –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –≤ –æ–±—ä–µ–∫—Ç–µ 'day'
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:** –°–æ—Ö—Ä–∞–Ω–∏ —Ñ–∞–π–ª, app –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è (HMR).

---

### –§–∞–∑–∞ 2: –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏—Ä—É—é—â–∏–µ `lsSet()` (30 –º–∏–Ω—É—Ç)

**–§–∞–π–ª:** `apps/web/heys_day_v12.js`

**–ù–∞–π—Ç–∏ –∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏:**

#### 1Ô∏è‚É£ `updateTraining()`

–ù–∞–π—Ç–∏: `lsSet('heys_dayv2_'+newDay.date, newDay);`  
‚ùå **–£–¥–∞–ª–∏—Ç—å** —ç—Ç—É —Å—Ç—Ä–æ–∫—É

#### 2Ô∏è‚É£ `addMealProduct()`

–ù–∞–π—Ç–∏: `lsSet('heys_dayv2_'+newDay.date, newDay);`  
‚ùå **–£–¥–∞–ª–∏—Ç—å** —ç—Ç—É —Å—Ç—Ä–æ–∫—É

#### 3Ô∏è‚É£ `removeMealProduct()`

–ù–∞–π—Ç–∏: `lsSet('heys_dayv2_'+...)`  
‚ùå **–£–¥–∞–ª–∏—Ç—å** —ç—Ç—É —Å—Ç—Ä–æ–∫—É

#### 4Ô∏è‚É£ `updateMealProduct()`

–ù–∞–π—Ç–∏: `lsSet('heys_dayv2_'+...)`  
‚ùå **–£–¥–∞–ª–∏—Ç—å** —ç—Ç—É —Å—Ç—Ä–æ–∫—É

#### 5Ô∏è‚É£ `updateMealTime()`

–ù–∞–π—Ç–∏: `lsSet('heys_dayv2_'+...)`  
‚ùå **–£–¥–∞–ª–∏—Ç—å** —ç—Ç—É —Å—Ç—Ä–æ–∫—É

#### 6Ô∏è‚É£ `removeMeal()`

–ù–∞–π—Ç–∏: `lsSet('heys_dayv2_'+...)`  
‚ùå **–£–¥–∞–ª–∏—Ç—å** —ç—Ç—É —Å—Ç—Ä–æ–∫—É

#### 7Ô∏è‚É£ `addMeal()`

–ù–∞–π—Ç–∏: `lsSet('heys_dayv2_'+...)`  
‚ùå **–£–¥–∞–ª–∏—Ç—å** —ç—Ç—É —Å—Ç—Ä–æ–∫—É

**–ü–æ–¥—Å–∫–∞–∑–∫–∞:** –ò—Å–ø–æ–ª—å–∑—É–π `Ctrl+F` –¥–ª—è –ø–æ–∏—Å–∫–∞ `lsSet('heys_dayv2_`

---

### –§–∞–∑–∞ 3: –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (20 –º–∏–Ω—É—Ç)

#### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä—ã—Ç—å DevTools: `F12` ‚Üí Console
2. –í "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ –¥–Ω—è" –∏–∑–º–µ–Ω–∏—Ç—å "–®–∞–≥–∏" —Å 0 –Ω–∞ 2000
3. **–û–∂–∏–¥–∞–µ–º–æ:** –ß–µ—Ä–µ–∑ ~500–º—Å –≤ –∫–æ–Ω—Å–æ–ª–∏: `[AUTOSAVE] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è...`

#### –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é

1. –ò–∑–º–µ–Ω–∏—Ç—å "–ë—ã—Ç–æ–≤—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å" —Å 0 –Ω–∞ 120 –º–∏–Ω—É—Ç
2. –î–æ–∂–¥–∞—Ç—å—Å—è –ª–æ–≥–æ–≤ `[AUTOSAVE]`
3. –û—Ç–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É "–û—Ç—á–µ—Ç—ã"
4. –í—ã–±—Ä–∞—Ç—å —Ç–æ—Ç –∂–µ –¥–µ–Ω—å
5. **–û–∂–∏–¥–∞–µ–º–æ:** "–û–±—â–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã" —Å–æ–≤–ø–∞–¥–∞—é—Ç –≤ –æ–±–µ–∏—Ö –≤–∫–ª–∞–¥–∫–∞—Ö ‚úÖ

#### –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏

1. –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É (–∏–∑–º–µ–Ω–∏—Ç—å –º–∏–Ω—É—Ç—ã –≤ –∑–æ–Ω–∞—Ö)
2. –î–æ–∂–¥–∞—Ç—å—Å—è –ª–æ–≥–æ–≤ `[AUTOSAVE]`
3. –û—Ç–∫—Ä—ã—Ç—å "–û—Ç—á–µ—Ç—ã"
4. **–û–∂–∏–¥–∞–µ–º–æ:** –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –æ—Ç—Ä–∞–∂–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ ‚úÖ

#### –¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–µ –ø–æ–ª—è

1. –ò–∑–º–µ–Ω–∏—Ç—å "–í–µ—Å", "–°–æ–Ω", "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π"
2. –î–æ–∂–¥–∞—Ç—å—Å—è –ª–æ–≥–æ–≤ `[AUTOSAVE]`
3. **–û–∂–∏–¥–∞–µ–º–æ:** –í—Å–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª–æ—Å—å ‚úÖ

---

## üß™ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
pnpm run test

# –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
pnpm run test -- heys_day_v12.js
```

---

## üìù –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –∫–æ–º–º–∏—Ç

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
git status

# 2. –î–æ–±–∞–≤–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add apps/web/heys_day_v12.js

# 3. –°–æ–∑–¥–∞—Ç—å –∫–æ–º–º–∏—Ç
git commit -m "feat: implement global autosave for day data with debounce

- Add React.useEffect to automatically save day data
- Remove duplicate lsSet() calls from updateTraining, addMealProduct, etc.
- Implement 500ms debounce to prevent excessive saves
- Ensure data sync between 'Day Statistics' and 'Reports' tabs

Fixes: Synchronization issues between tabs (#XXX)"

# 4. –ó–∞–ø—É—à–∏—Ç—å –≤ –≤–µ—Ç–∫—É
git push origin feature/global-autosave-day-data
```

---

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–±–ª–µ–º–∞: –õ–æ–≥–∏ –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `lsSet` –¥–æ—Å—Ç—É–ø–µ–Ω: `window.HEYS.context`
2. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `day` –∏–∑–º–µ–Ω—è–µ—Ç—Å—è: –¥–æ–±–∞–≤–∏—Ç—å `console.log(day)` –ø–µ—Ä–µ–¥ `setDay()`

### –ü—Ä–æ–±–ª–µ–º–∞: –î–∞–Ω–Ω—ã–µ –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**

1. –û—Ç–∫—Ä—ã—Ç—å DevTools ‚Üí Application ‚Üí Local Storage
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–ª—é—á `heys_dayv2_YYYY-MM-DD` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤ –Ω–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON)

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:**

1. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `[day]` –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `day` ‚Äî —ç—Ç–æ —Å—Ç–µ–π—Ç React, –∞ –Ω–µ –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –Ω–∞ –∫–∞–∂–¥—ã–π —Ä–µ–Ω–¥–µ—Ä

---

## ‚úÖ –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ PR

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ª–∏–Ω—Ç–µ—Ä
pnpm run lint

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–∏–ø–∏–∑–∞—Ü–∏—é
pnpm run type-check

# 3. –£–±–µ–¥–∏—Ç—å—Å—è –Ω–µ—Ç console.error/warn
# (–∫—Ä–æ–º–µ [AUTOSAVE] –ª–æ–≥–æ–≤)

# 4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (—Å–º. –≤—ã—à–µ)

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤–µ—Ç–∫–∏
git log --oneline -5
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º PR:**

- ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (–∏–ª–∏ –Ω–µ—Ç –Ω–æ–≤—ã—Ö –æ—à–∏–±–æ–∫)
- ‚úÖ –ù–µ—Ç –ª–∏—à–Ω–∏—Ö –ª–æ–≥–æ–≤/–æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏
- ‚úÖ –î–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏
- ‚úÖ –ö–æ–º–º–∏—Ç —Å –ø–æ–Ω—è—Ç–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º

---

## üìû –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ç–∫—É:** `git branch` (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å
   `feature/global-autosave-day-data`)
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª—ã:** `git status` (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤
   `heys_day_v12.js`)
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:** `git log --oneline -3` (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞—à–∏ –∫–æ–º–º–∏—Ç—ã)
4. **–ü–µ—Ä–µ—Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä:** `Ctrl+C` ‚Üí `pnpm dev`

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –≤—Å–µ—Ö —ç—Ç–∏—Ö —à–∞–≥–æ–≤ –∑–∞–¥–∞—á–∞ –±—É–¥–µ—Ç **–∑–∞–≤–µ—Ä—à–µ–Ω–∞**:

‚úÖ –ì–ª–æ–±–∞–ª—å–Ω–æ–µ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ –î–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏  
‚úÖ –ö–æ–¥ —á–∏—Å—Ç –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω  
‚úÖ PR –≥–æ—Ç–æ–≤ –∫ –º–µ—Ä–¥–∂—É

**–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è:** ~1-2 —á–∞—Å–∞  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** üü° –°—Ä–µ–¥–Ω—è—è

–£–¥–∞—á–∏! üöÄ
