
> @heys/shared@13.0.0 test C:\! HEYS 2\packages\shared
> vitest run


[7m[1m[36m RUN [39m[22m[27m [36mv0.34.6[39m [90mC:/! HEYS 2/packages/shared[39m

 [32m✓[39m src/__tests__/legacy.test.ts [2m ([22m[2m12 tests[22m[2m)[22m[90m 10[2mms[22m[39m
 [32m✓[39m src/__tests__/monitoring.test.ts [2m ([22m[2m8 tests[22m[2m)[22m[90m 21[2mms[22m[39m
 [33m❯[39m src/__tests__/utils.test.ts [2m ([22m[2m0 test[22m[2m)[22m
 [32m✓[39m src/security/__tests__/security.test.ts [2m ([22m[2m34 tests[22m[2m)[22m[90m 54[2mms[22m[39m
 [33m❯[39m src/security/__tests__/pentest.test.ts [2m ([22m[2m18 tests[22m [2m|[22m [31m2 failed[39m[2m)[22m[90m 51[2mms[22m[39m
[90mstderr[2m | src/security/__tests__/pentest.test.ts[2m > [22m[2mPenetrationTestFramework[2m > [22m[2mshould run comprehensive penetration test[22m[39m
Scanner XSS Scanner failed: TypeError: alert is not a function
    at eval (http://localhost:3000/:2:1)
    at GlobalWindow.eval (<anonymous>)
    at HTMLScriptElement.#evaluateScript (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-script-element/HTMLScriptElement.js:456:20)
[31m   [33m❯[31m src/security/__tests__/pentest.test.ts[2m > [22mXSSScanner[2m > [22mshould detect XSS vulnerabilities[39m
[31m     → alert is not a function[39m
    at HTMLScriptElement.[connectedToDocument] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-script-element/HTMLScriptElement.js:329:45)
[31m   [33m❯[31m src/security/__tests__/pentest.test.ts[2m > [22mXSSScanner[2m > [22mshould identify malicious script tags[39m
[31m     → alert is not a function[39m
[90mstdout[2m | src/security/__tests__/pentest.test.ts[2m > [22m[2mPenetrationTestFramework[2m > [22m[2mshould run comprehensive penetration test[22m[39m
    at HTMLScriptElement.[connectedToNode] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:785:53)
Running XSS Scanner...
Running SQL Injection Scanner...
Running Input Validation Scanner...
Running Authentication Bypass Scanner...

[90mstdout[2m | src/security/__tests__/pentest.test.ts[2m > [22m[2mPenetrationTestFramework[2m > [22m[2mshould filter scanners by inclusion[22m[39m
Running XSS Scanner...
    at HTMLScriptElement.[connectedToNode] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-element/HTMLElement.js:812:46)

[90mstdout[2m | src/security/__tests__/pentest.test.ts[2m > [22m[2mPenetrationTestFramework[2m > [22m[2mshould filter scanners by exclusion[22m[39m
Running XSS Scanner...
Running Input Validation Scanner...
    at HTMLHtmlElement.[appendChild] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:404:45)
    at HTMLHtmlElement.[appendChild] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/element/Element.js:999:62)
    at HTMLHtmlElement.[insertBefore] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:505:45)
Running Authentication Bypass Scanner...

    at HTMLHtmlElement.[insertBefore] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/element/Element.js:1015:63)
[90mstdout[2m | src/security/__tests__/pentest.test.ts[2m > [22m[2mPenetrationTestFramework[2m > [22m[2mshould filter scanners by severity[22m[39m
Running SQL Injection Scanner...
Running Authentication Bypass Scanner...


[90mstdout[2m | src/security/__tests__/pentest.test.ts[2m > [22m[2mPenetrationTestFramework[2m > [22m[2mshould export report to JSON[22m[39m
Running XSS Scanner...
Running SQL Injection Scanner...
[90mstderr[2m | src/security/__tests__/pentest.test.ts[2m > [22m[2mPenetrationTestFramework[2m > [22m[2mshould filter scanners by inclusion[22m[39m
Scanner XSS Scanner failed: TypeError: alert is not a function
Running Input Validation Scanner...
Running Authentication Bypass Scanner...
    at eval (http://localhost:3000/:2:1)

    at GlobalWindow.eval (<anonymous>)
[90mstdout[2m | src/security/__tests__/pentest.test.ts[2m > [22m[2mPenetrationTestFramework[2m > [22m[2mshould generate HTML report[22m[39m
Running XSS Scanner...
    at HTMLScriptElement.#evaluateScript (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-script-element/HTMLScriptElement.js:456:20)
Running SQL Injection Scanner...
Running Input Validation Scanner...
Running Authentication Bypass Scanner...

    at HTMLScriptElement.[connectedToDocument] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-script-element/HTMLScriptElement.js:329:45)
[90mstdout[2m | src/security/__tests__/pentest.test.ts[2m > [22m[2mPenetrationTestFramework[2m > [22m[2mshould register custom scanners[22m[39m
Running XSS Scanner...
Running SQL Injection Scanner...
    at HTMLScriptElement.[connectedToNode] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:785:53)
Running Input Validation Scanner...
    at HTMLScriptElement.[connectedToNode] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-element/HTMLElement.js:812:46)
    at HTMLHtmlElement.[appendChild] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:404:45)
Running Authentication Bypass Scanner...
Running Custom XSS Scanner...

[90mstdout[2m | src/security/__tests__/pentest.test.ts[2m > [22m[2mdefaultPentestFramework[2m > [22m[2mshould run basic penetration test[22m[39m
Running XSS Scanner...
Running SQL Injection Scanner...
    at HTMLHtmlElement.[appendChild] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/element/Element.js:999:62)
Running Input Validation Scanner...
    at HTMLHtmlElement.[insertBefore] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:505:45)
Running Authentication Bypass Scanner...

    at HTMLHtmlElement.[insertBefore] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/element/Element.js:1015:63)

[90mstderr[2m | src/security/__tests__/pentest.test.ts[2m > [22m[2mPenetrationTestFramework[2m > [22m[2mshould filter scanners by exclusion[22m[39m
Scanner XSS Scanner failed: TypeError: alert is not a function
    at eval (http://localhost:3000/:2:1)
    at GlobalWindow.eval (<anonymous>)
    at HTMLScriptElement.#evaluateScript (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-script-element/HTMLScriptElement.js:456:20)
    at HTMLScriptElement.[connectedToDocument] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-script-element/HTMLScriptElement.js:329:45)
    at HTMLScriptElement.[connectedToNode] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:785:53)
    at HTMLScriptElement.[connectedToNode] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-element/HTMLElement.js:812:46)
    at HTMLHtmlElement.[appendChild] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:404:45)
    at HTMLHtmlElement.[appendChild] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/element/Element.js:999:62)
    at HTMLHtmlElement.[insertBefore] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:505:45)
    at HTMLHtmlElement.[insertBefore] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/element/Element.js:1015:63)

[90mstderr[2m | src/security/__tests__/pentest.test.ts[2m > [22m[2mPenetrationTestFramework[2m > [22m[2mshould export report to JSON[22m[39m
Scanner XSS Scanner failed: TypeError: alert is not a function
    at eval (http://localhost:3000/:2:1)
    at GlobalWindow.eval (<anonymous>)
    at HTMLScriptElement.#evaluateScript (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-script-element/HTMLScriptElement.js:456:20)
    at HTMLScriptElement.[connectedToDocument] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-script-element/HTMLScriptElement.js:329:45)
    at HTMLScriptElement.[connectedToNode] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:785:53)
    at HTMLScriptElement.[connectedToNode] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-element/HTMLElement.js:812:46)
    at HTMLHtmlElement.[appendChild] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:404:45)
    at HTMLHtmlElement.[appendChild] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/element/Element.js:999:62)
    at HTMLHtmlElement.[insertBefore] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:505:45)
    at HTMLHtmlElement.[insertBefore] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/element/Element.js:1015:63)

[90mstderr[2m | src/security/__tests__/pentest.test.ts[2m > [22m[2mPenetrationTestFramework[2m > [22m[2mshould generate HTML report[22m[39m
Scanner XSS Scanner failed: TypeError: alert is not a function
    at eval (http://localhost:3000/:2:1)
    at GlobalWindow.eval (<anonymous>)
    at HTMLScriptElement.#evaluateScript (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-script-element/HTMLScriptElement.js:456:20)
    at HTMLScriptElement.[connectedToDocument] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-script-element/HTMLScriptElement.js:329:45)
    at HTMLScriptElement.[connectedToNode] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:785:53)
    at HTMLScriptElement.[connectedToNode] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-element/HTMLElement.js:812:46)
    at HTMLHtmlElement.[appendChild] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:404:45)
    at HTMLHtmlElement.[appendChild] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/element/Element.js:999:62)
    at HTMLHtmlElement.[insertBefore] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:505:45)
    at HTMLHtmlElement.[insertBefore] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/element/Element.js:1015:63)

[90mstderr[2m | src/security/__tests__/pentest.test.ts[2m > [22m[2mPenetrationTestFramework[2m > [22m[2mshould register custom scanners[22m[39m
Scanner XSS Scanner failed: TypeError: alert is not a function
    at eval (http://localhost:3000/:2:1)
    at GlobalWindow.eval (<anonymous>)
    at HTMLScriptElement.#evaluateScript (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-script-element/HTMLScriptElement.js:456:20)
    at HTMLScriptElement.[connectedToDocument] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-script-element/HTMLScriptElement.js:329:45)
    at HTMLScriptElement.[connectedToNode] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:785:53)
    at HTMLScriptElement.[connectedToNode] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-element/HTMLElement.js:812:46)
    at HTMLHtmlElement.[appendChild] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:404:45)
    at HTMLHtmlElement.[appendChild] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/element/Element.js:999:62)
    at HTMLHtmlElement.[insertBefore] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:505:45)
    at HTMLHtmlElement.[insertBefore] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/element/Element.js:1015:63)
Scanner Custom XSS Scanner failed: TypeError: alert is not a function
    at eval (http://localhost:3000/:2:1)
    at GlobalWindow.eval (<anonymous>)
    at HTMLScriptElement.#evaluateScript (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-script-element/HTMLScriptElement.js:456:20)
    at HTMLScriptElement.[connectedToDocument] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-script-element/HTMLScriptElement.js:329:45)
    at HTMLScriptElement.[connectedToNode] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:785:53)
    at HTMLScriptElement.[connectedToNode] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-element/HTMLElement.js:812:46)
    at HTMLHtmlElement.[appendChild] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:404:45)
    at HTMLHtmlElement.[appendChild] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/element/Element.js:999:62)
    at HTMLHtmlElement.[insertBefore] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:505:45)
    at HTMLHtmlElement.[insertBefore] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/element/Element.js:1015:63)

[90mstderr[2m | src/security/__tests__/pentest.test.ts[2m > [22m[2mdefaultPentestFramework[2m > [22m[2mshould run basic penetration test[22m[39m
Scanner XSS Scanner failed: TypeError: alert is not a function
    at eval (http://localhost:3000/:2:1)
    at GlobalWindow.eval (<anonymous>)
    at HTMLScriptElement.#evaluateScript (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-script-element/HTMLScriptElement.js:456:20)
    at HTMLScriptElement.[connectedToDocument] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-script-element/HTMLScriptElement.js:329:45)

    at HTMLScriptElement.[connectedToNode] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:785:53)
    at HTMLScriptElement.[connectedToNode] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/html-element/HTMLElement.js:812:46)
    at HTMLHtmlElement.[appendChild] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:404:45)
    at HTMLHtmlElement.[appendChild] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/element/Element.js:999:62)
    at HTMLHtmlElement.[insertBefore] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/node/Node.js:505:45)
    at HTMLHtmlElement.[insertBefore] (file:///C:/!%20HEYS%202/node_modules/[4m.pnpm[24m/happy-dom@18.0.1/node_modules/[4mhappy-dom[24m/lib/nodes/element/Element.js:1015:63)

[31m⎯⎯⎯⎯⎯⎯[1m[7m Failed Suites 1 [27m[22m⎯⎯⎯⎯⎯⎯⎯[39m

[31m[1m[7m FAIL [27m[22m[39m src/__tests__/utils.test.ts [2m[ src/__tests__/utils.test.ts ][22m
[31m[1mTypeError[22m: Cannot read properties of undefined (reading 'OPEN')[39m
[36m [2m❯[22m RealtimeMonitor.connect src/monitoring/realtime.ts:[2m54:65[22m[39m
[2m Test Files [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m3 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m70 passed[39m[22m[90m (72)[39m
[2m   Start at [22m 20:46:33
[2m   Duration [22m 1.49s[2m (transform 424ms, setup 0ms, collect 624ms, tests 136ms, environment 3.12s, prepare 1.02s)[22m

    [90m 52| [39m   */
    [90m 53| [39m  connect(): void {
    [90m 54| [39m    if (!this.websocketUrl || this.ws?.readyState === WebSocket.OPEN) {
    [90m   | [39m                                                                [31m^[39m
    [90m 55| [39m      return;
    [90m 56| [39m    }
[90m [2m❯[22m new RealtimeMonitor src/monitoring/realtime.ts:[2m46:12[22m[39m
[90m [2m❯[22m src/monitoring/realtime.ts:[2m316:32[22m[39m
[90m [2m❯[22m src/monitoring/index.ts:[2m9:174[22m[39m

[31m[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯[22m[39m

[31m⎯⎯⎯⎯⎯⎯⎯[1m[7m Failed Tests 2 [27m[22m⎯⎯⎯⎯⎯⎯⎯[39m

[31m[1m[7m FAIL [27m[22m[39m src/security/__tests__/pentest.test.ts[2m > [22mXSSScanner[2m > [22mshould detect XSS vulnerabilities
[31m[1m[7m FAIL [27m[22m[39m src/security/__tests__/pentest.test.ts[2m > [22mXSSScanner[2m > [22mshould identify malicious script tags
[31m[1mTypeError[22m: alert is not a function[39m
[90m [2m❯[22m eval ../../../../:[2m2:1[22m[39m
[90m [2m❯[22m HTMLScriptElement.#evaluateScript ../../../!%20HEYS%202/node_modules/.pnpm/happy-dom@18.0.1/node_modules/happy-dom/lib/nodes/html-script-element/HTMLScriptElement.js:[2m456:20[22m[39m
[90m [2m❯[22m HTMLScriptElement.[connectedToDocument] ../../../!%20HEYS%202/node_modules/.pnpm/happy-dom@18.0.1/node_modules/happy-dom/lib/nodes/html-script-element/HTMLScriptElement.js:[2m329:45[22m[39m
[90m [2m❯[22m HTMLScriptElement.[connectedToNode] ../../../!%20HEYS%202/node_modules/.pnpm/happy-dom@18.0.1/node_modules/happy-dom/lib/nodes/node/Node.js:[2m785:53[22m[39m
[90m [2m❯[22m HTMLScriptElement.[connectedToNode] ../../../!%20HEYS%202/node_modules/.pnpm/happy-dom@18.0.1/node_modules/happy-dom/lib/nodes/html-element/HTMLElement.js:[2m812:46[22m[39m
[90m [2m❯[22m HTMLHtmlElement.[appendChild] ../../../!%20HEYS%202/node_modules/.pnpm/happy-dom@18.0.1/node_modules/happy-dom/lib/nodes/node/Node.js:[2m404:45[22m[39m
[90m [2m❯[22m HTMLHtmlElement.[appendChild] ../../../!%20HEYS%202/node_modules/.pnpm/happy-dom@18.0.1/node_modules/happy-dom/lib/nodes/element/Element.js:[2m999:62[22m[39m
[90m [2m❯[22m HTMLHtmlElement.[insertBefore] ../../../!%20HEYS%202/node_modules/.pnpm/happy-dom@18.0.1/node_modules/happy-dom/lib/nodes/node/Node.js:[2m505:45[22m[39m
[90m [2m❯[22m HTMLHtmlElement.[insertBefore] ../../../!%20HEYS%202/node_modules/.pnpm/happy-dom@18.0.1/node_modules/happy-dom/lib/nodes/element/Element.js:[2m1015:63[22m[39m

[31m[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯[22m[39m

 ELIFECYCLE  Test failed. See above for more details.
