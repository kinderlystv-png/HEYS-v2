import { jsx, jsxs, Fragment } from 'react/jsx-runtime';
import g, { useCallback, useMemo } from 'react';
import { defaultValidator, SecurityError, ValidationSchemas } from '@heys/shared';

var N=({variant:a="primary",size:o="md",loading:r=false,children:d,className:n="",disabled:i,...s})=>{let u="inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",l={primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border border-gray-300 bg-transparent hover:bg-gray-50 focus:ring-gray-500",ghost:"bg-transparent hover:bg-gray-100 focus:ring-gray-500"},t={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"},c=[u,l[a],t[o],n].filter(Boolean).join(" ");return jsx("button",{className:c,disabled:i||r,...s,children:r?jsxs(Fragment,{children:[jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",className:"opacity-25"}),jsx("path",{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",className:"opacity-75"})]}),"Loading..."]}):d})};var h=({value:a,onChange:o,type:r="text",placeholder:d,required:n=false,maxLength:i,sanitize:s=true,validateOnChange:u=true,className:l,"data-testid":t})=>{let c=useCallback(p=>{let m=p.target.value;if(u){let f="text";r==="email"?f="email":r==="password"&&(f="password");let C=defaultValidator.validateInput(m,f,{required:n,sanitize:s});if(!C.isValid&&n)return;m=C.sanitized||m;}o(m);},[o,r,n,i,s,u]);return jsx("input",{type:r,value:a,onChange:c,placeholder:d,maxLength:i,required:n,className:l,"data-testid":t})},b=({content:a,allowHtml:o=false,maxLength:r,className:d,"data-testid":n})=>{let i=useMemo(()=>defaultValidator.validateInput(a,"html",{sanitize:true}).sanitized||a,[a,r]);return o?jsx("div",{className:d,"data-testid":n,dangerouslySetInnerHTML:{__html:i}}):jsx("div",{className:d,"data-testid":n,children:i})},z=({onSubmit:a,children:o,validationSchema:r,className:d,"data-testid":n})=>{let i=useCallback(async s=>{s.preventDefault();let u=new FormData(s.currentTarget),l={};for(let[t,c]of u.entries())l[t]=c;if(r){let t=await defaultValidator.validateSchema(l,r,{sanitize:true,strictMode:true});if(!t.isValid)throw new SecurityError("Form validation failed",t.errors);Object.assign(l,t.sanitized||{});}await a(l);},[a,r]);return jsx("form",{onSubmit:i,className:d,"data-testid":n,children:o})},T=({user:a,onUpdate:o,editable:r=false,className:d})=>{let[n,i]=g.useState(false),[s,u]=g.useState(a),l=useCallback(async()=>{if(!o)return;let t=await defaultValidator.validateSchema(s,ValidationSchemas.user,{sanitize:true,strictMode:true});if(!t.isValid)throw new SecurityError("User profile validation failed",t.errors);await o(t.sanitized||s),i(false);},[s,o]);return !r||!n?jsxs("div",{className:d,"data-testid":"user-profile",children:[jsx("div",{"data-testid":"user-email",children:jsx(b,{content:a.email})}),jsx("div",{"data-testid":"user-username",children:jsx(b,{content:a.username})}),a.bio&&jsx("div",{"data-testid":"user-bio",children:jsx(b,{content:a.bio,maxLength:500})}),r&&jsx("button",{onClick:()=>i(true),"data-testid":"edit-profile-button",children:"Edit Profile"})]}):jsx("div",{className:d,"data-testid":"user-profile-edit",children:jsxs(z,{onSubmit:l,validationSchema:ValidationSchemas.user,"data-testid":"profile-form",children:[jsx(h,{value:s.email,onChange:t=>u(c=>({...c,email:t})),type:"email",placeholder:"Email",required:true,"data-testid":"email-input"}),jsx(h,{value:s.username,onChange:t=>u(c=>({...c,username:t})),type:"text",placeholder:"Username",required:true,maxLength:50,"data-testid":"username-input"}),jsx(h,{value:s.bio||"",onChange:t=>u(c=>({...c,bio:t})),type:"text",placeholder:"Bio",maxLength:500,"data-testid":"bio-input"}),jsx("button",{type:"submit","data-testid":"save-button",children:"Save"}),jsx("button",{type:"button",onClick:()=>i(false),"data-testid":"cancel-button",children:"Cancel"})]})})},V=({onSearch:a,placeholder:o="Search...",debounceMs:r=300,maxLength:d=100,className:n})=>{let[i,s]=g.useState(""),[u,l]=g.useState([]),[t,c]=g.useState(false);return g.useEffect(()=>{if(!i.trim()){l([]);return}let p=setTimeout(async()=>{c(true);try{let m=defaultValidator.validateInput(i,"text",{sanitize:!0,required:!0});if(m.isValid){let f=await a(m.sanitized||i);l(f);}}catch(m){console.error("Search error:",m),l([]);}finally{c(false);}},r);return ()=>clearTimeout(p)},[i,a,r,d]),jsxs("div",{className:n,"data-testid":"secure-search",children:[jsx(h,{value:i,onChange:s,type:"text",placeholder:o,maxLength:d,"data-testid":"search-input"}),t&&jsx("div",{"data-testid":"search-loading",children:"Loading..."}),jsx("div",{"data-testid":"search-results",children:u.map((p,m)=>jsx("div",{"data-testid":`search-result-${m}`,children:jsx(b,{content:p.title||p.name||String(p)})},p.id||m))})]})};

export { N as Button, b as SecureContent, z as SecureForm, h as SecureInput, V as SecureSearch, T as SecureUserProfile };
//# sourceMappingURL=out.js.map
//# sourceMappingURL=index.js.map