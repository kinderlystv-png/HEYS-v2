'use strict';

var jsxRuntime = require('react/jsx-runtime');
var shared = require('@heys/shared');
var g = require('react');

function _interopDefault (e) { return e && e.__esModule ? e : { default: e }; }

var g__default = /*#__PURE__*/_interopDefault(g);

var N=({variant:a="primary",size:o="md",loading:r=false,children:d,className:n="",disabled:i,...s})=>{let u="inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",l={primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border border-gray-300 bg-transparent hover:bg-gray-50 focus:ring-gray-500",ghost:"bg-transparent hover:bg-gray-100 focus:ring-gray-500"},t={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"},c=[u,l[a],t[o],n].filter(Boolean).join(" ");return jsxRuntime.jsx("button",{className:c,disabled:i||r,...s,children:r?jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[jsxRuntime.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntime.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",className:"opacity-25"}),jsxRuntime.jsx("path",{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",className:"opacity-75"})]}),"Loading..."]}):d})};var h=({value:a,onChange:o,type:r="text",placeholder:d,required:n=false,maxLength:i,sanitize:s=true,validateOnChange:u=true,className:l,"data-testid":t})=>{let c=g.useCallback(p=>{let m=p.target.value;if(u){let f="text";r==="email"?f="email":r==="password"&&(f="password");let C=shared.defaultValidator.validateInput(m,f,{required:n,sanitize:s});if(!C.isValid&&n)return;m=C.sanitized||m;}o(m);},[o,r,n,i,s,u]);return jsxRuntime.jsx("input",{type:r,value:a,onChange:c,placeholder:d,maxLength:i,required:n,className:l,"data-testid":t})},b=({content:a,allowHtml:o=false,maxLength:r,className:d,"data-testid":n})=>{let i=g.useMemo(()=>shared.defaultValidator.validateInput(a,"html",{sanitize:true}).sanitized||a,[a,r]);return o?jsxRuntime.jsx("div",{className:d,"data-testid":n,dangerouslySetInnerHTML:{__html:i}}):jsxRuntime.jsx("div",{className:d,"data-testid":n,children:i})},z=({onSubmit:a,children:o,validationSchema:r,className:d,"data-testid":n})=>{let i=g.useCallback(async s=>{s.preventDefault();let u=new FormData(s.currentTarget),l={};for(let[t,c]of u.entries())l[t]=c;if(r){let t=await shared.defaultValidator.validateSchema(l,r,{sanitize:true,strictMode:true});if(!t.isValid)throw new shared.SecurityError("Form validation failed",t.errors);Object.assign(l,t.sanitized||{});}await a(l);},[a,r]);return jsxRuntime.jsx("form",{onSubmit:i,className:d,"data-testid":n,children:o})},T=({user:a,onUpdate:o,editable:r=false,className:d})=>{let[n,i]=g__default.default.useState(false),[s,u]=g__default.default.useState(a),l=g.useCallback(async()=>{if(!o)return;let t=await shared.defaultValidator.validateSchema(s,shared.ValidationSchemas.user,{sanitize:true,strictMode:true});if(!t.isValid)throw new shared.SecurityError("User profile validation failed",t.errors);await o(t.sanitized||s),i(false);},[s,o]);return !r||!n?jsxRuntime.jsxs("div",{className:d,"data-testid":"user-profile",children:[jsxRuntime.jsx("div",{"data-testid":"user-email",children:jsxRuntime.jsx(b,{content:a.email})}),jsxRuntime.jsx("div",{"data-testid":"user-username",children:jsxRuntime.jsx(b,{content:a.username})}),a.bio&&jsxRuntime.jsx("div",{"data-testid":"user-bio",children:jsxRuntime.jsx(b,{content:a.bio,maxLength:500})}),r&&jsxRuntime.jsx("button",{onClick:()=>i(true),"data-testid":"edit-profile-button",children:"Edit Profile"})]}):jsxRuntime.jsx("div",{className:d,"data-testid":"user-profile-edit",children:jsxRuntime.jsxs(z,{onSubmit:l,validationSchema:shared.ValidationSchemas.user,"data-testid":"profile-form",children:[jsxRuntime.jsx(h,{value:s.email,onChange:t=>u(c=>({...c,email:t})),type:"email",placeholder:"Email",required:true,"data-testid":"email-input"}),jsxRuntime.jsx(h,{value:s.username,onChange:t=>u(c=>({...c,username:t})),type:"text",placeholder:"Username",required:true,maxLength:50,"data-testid":"username-input"}),jsxRuntime.jsx(h,{value:s.bio||"",onChange:t=>u(c=>({...c,bio:t})),type:"text",placeholder:"Bio",maxLength:500,"data-testid":"bio-input"}),jsxRuntime.jsx("button",{type:"submit","data-testid":"save-button",children:"Save"}),jsxRuntime.jsx("button",{type:"button",onClick:()=>i(false),"data-testid":"cancel-button",children:"Cancel"})]})})},V=({onSearch:a,placeholder:o="Search...",debounceMs:r=300,maxLength:d=100,className:n})=>{let[i,s]=g__default.default.useState(""),[u,l]=g__default.default.useState([]),[t,c]=g__default.default.useState(false);return g__default.default.useEffect(()=>{if(!i.trim()){l([]);return}let p=setTimeout(async()=>{c(true);try{let m=shared.defaultValidator.validateInput(i,"text",{sanitize:!0,required:!0});if(m.isValid){let f=await a(m.sanitized||i);l(f);}}catch(m){console.error("Search error:",m),l([]);}finally{c(false);}},r);return ()=>clearTimeout(p)},[i,a,r,d]),jsxRuntime.jsxs("div",{className:n,"data-testid":"secure-search",children:[jsxRuntime.jsx(h,{value:i,onChange:s,type:"text",placeholder:o,maxLength:d,"data-testid":"search-input"}),t&&jsxRuntime.jsx("div",{"data-testid":"search-loading",children:"Loading..."}),jsxRuntime.jsx("div",{"data-testid":"search-results",children:u.map((p,m)=>jsxRuntime.jsx("div",{"data-testid":`search-result-${m}`,children:jsxRuntime.jsx(b,{content:p.title||p.name||String(p)})},p.id||m))})]})};

exports.Button = N;
exports.SecureContent = b;
exports.SecureForm = z;
exports.SecureInput = h;
exports.SecureSearch = V;
exports.SecureUserProfile = T;
//# sourceMappingURL=out.js.map
//# sourceMappingURL=index.cjs.map