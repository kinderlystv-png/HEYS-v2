'use strict';

var jsxRuntime = require('react/jsx-runtime');
var shared = require('@heys/shared');
var ri = require('fs');
var ni = require('path');
var ne = require('react');

function _interopDefault (e) { return e && e.__esModule ? e : { default: e }; }

var ri__default = /*#__PURE__*/_interopDefault(ri);
var ni__default = /*#__PURE__*/_interopDefault(ni);
var ne__default = /*#__PURE__*/_interopDefault(ne);

var di=Object.create;var Bt=Object.defineProperty;var hi=Object.getOwnPropertyDescriptor;var mi=Object.getOwnPropertyNames;var gi=Object.getPrototypeOf,pi=Object.prototype.hasOwnProperty;var C=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var _=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var yi=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of mi(t))!pi.call(e,i)&&i!==r&&Bt(e,i,{get:()=>t[i],enumerable:!(n=hi(t,i))||n.enumerable});return e};var zt=(e,t,r)=>(r=e!=null?di(gi(e)):{},yi(Bt(r,"default",{value:e,enumerable:true}),e));var $e=_((Oc,qt)=>{var ie=e=>e&&typeof e.message=="string",ke=e=>{if(!e)return;let t=e.cause;if(typeof t=="function"){let r=e.cause();return ie(r)?r:void 0}else return ie(t)?t:void 0},Ft=(e,t)=>{if(!ie(e))return "";let r=e.stack||"";if(t.has(e))return r+`
causes have become circular...`;let n=ke(e);return n?(t.add(e),r+`
caused by: `+Ft(n,t)):r},wi=e=>Ft(e,new Set),Pt=(e,t,r)=>{if(!ie(e))return "";let n=r?"":e.message||"";if(t.has(e))return n+": ...";let i=ke(e);if(i){t.add(e);let o=typeof e.cause=="function";return n+(o?"":": ")+Pt(i,t,o)}else return n},vi=e=>Pt(e,new Set);qt.exports={isErrorLike:ie,getErrorCause:ke,stackWithCauses:wi,messageWithCauses:vi};});var Ce=_((Lc,Vt)=>{var Ei=Symbol("circular-ref-tag"),ce=Symbol("pino-raw-err-ref"),Mt=Object.create({},{type:{enumerable:true,writable:true,value:void 0},message:{enumerable:true,writable:true,value:void 0},stack:{enumerable:true,writable:true,value:void 0},aggregateErrors:{enumerable:true,writable:true,value:void 0},raw:{enumerable:false,get:function(){return this[ce]},set:function(e){this[ce]=e;}}});Object.defineProperty(Mt,ce,{writable:true,value:{}});Vt.exports={pinoErrProto:Mt,pinoErrorSymbols:{seen:Ei,rawSymbol:ce}};});var Gt=_((Rc,Kt)=>{Kt.exports=Ie;var{messageWithCauses:xi,stackWithCauses:_i,isErrorLike:Wt}=$e(),{pinoErrProto:Oi,pinoErrorSymbols:Li}=Ce(),{seen:Ne}=Li,{toString:Ri}=Object.prototype;function Ie(e){if(!Wt(e))return e;e[Ne]=void 0;let t=Object.create(Oi);t.type=Ri.call(e.constructor)==="[object Function]"?e.constructor.name:e.name,t.message=xi(e),t.stack=_i(e),Array.isArray(e.errors)&&(t.aggregateErrors=e.errors.map(r=>Ie(r)));for(let r in e)if(t[r]===void 0){let n=e[r];Wt(n)?r!=="cause"&&!Object.prototype.hasOwnProperty.call(n,Ne)&&(t[r]=Ie(n)):t[r]=n;}return delete e[Ne],t.raw=e,t}});var Ut=_((Ac,Ht)=>{Ht.exports=fe;var{isErrorLike:je}=$e(),{pinoErrProto:Ai,pinoErrorSymbols:Ti}=Ce(),{seen:ue}=Ti,{toString:ki}=Object.prototype;function fe(e){if(!je(e))return e;e[ue]=void 0;let t=Object.create(Ai);t.type=ki.call(e.constructor)==="[object Function]"?e.constructor.name:e.name,t.message=e.message,t.stack=e.stack,Array.isArray(e.errors)&&(t.aggregateErrors=e.errors.map(r=>fe(r))),je(e.cause)&&!Object.prototype.hasOwnProperty.call(e.cause,ue)&&(t.cause=fe(e.cause));for(let r in e)if(t[r]===void 0){let n=e[r];je(n)?Object.prototype.hasOwnProperty.call(n,ue)||(t[r]=fe(n)):t[r]=n;}return delete e[ue],t.raw=e,t}});var Qt=_((Tc,Yt)=>{Yt.exports={mapHttpRequest:$i,reqSerializer:Xt};var Be=Symbol("pino-raw-req-ref"),Jt=Object.create({},{id:{enumerable:true,writable:true,value:""},method:{enumerable:true,writable:true,value:""},url:{enumerable:true,writable:true,value:""},query:{enumerable:true,writable:true,value:""},params:{enumerable:true,writable:true,value:""},headers:{enumerable:true,writable:true,value:{}},remoteAddress:{enumerable:true,writable:true,value:""},remotePort:{enumerable:true,writable:true,value:""},raw:{enumerable:false,get:function(){return this[Be]},set:function(e){this[Be]=e;}}});Object.defineProperty(Jt,Be,{writable:true,value:{}});function Xt(e){let t=e.info||e.socket,r=Object.create(Jt);if(r.id=typeof e.id=="function"?e.id():e.id||(e.info?e.info.id:void 0),r.method=e.method,e.originalUrl)r.url=e.originalUrl;else {let n=e.path;r.url=typeof n=="string"?n:e.url?e.url.path||e.url:void 0;}return e.query&&(r.query=e.query),e.params&&(r.params=e.params),r.headers=e.headers,r.remoteAddress=t&&t.remoteAddress,r.remotePort=t&&t.remotePort,r.raw=e.raw||e,r}function $i(e){return {req:Xt(e)}}});var rr=_((kc,tr)=>{tr.exports={mapHttpResponse:Ci,resSerializer:er};var ze=Symbol("pino-raw-res-ref"),Zt=Object.create({},{statusCode:{enumerable:true,writable:true,value:0},headers:{enumerable:true,writable:true,value:""},raw:{enumerable:false,get:function(){return this[ze]},set:function(e){this[ze]=e;}}});Object.defineProperty(Zt,ze,{writable:true,value:{}});function er(e){let t=Object.create(Zt);return t.statusCode=e.headersSent?e.statusCode:null,t.headers=e.getHeaders?e.getHeaders():e._headers,t.raw=e,t}function Ci(e){return {res:er(e)}}});var Fe=_(($c,nr)=>{var De=Gt(),Ni=Ut(),de=Qt(),he=rr();nr.exports={err:De,errWithCause:Ni,mapHttpRequest:de.mapHttpRequest,mapHttpResponse:he.mapHttpResponse,req:de.reqSerializer,res:he.resSerializer,wrapErrorSerializer:function(t){return t===De?t:function(n){return t(De(n))}},wrapRequestSerializer:function(t){return t===de.reqSerializer?t:function(n){return t(de.reqSerializer(n))}},wrapResponseSerializer:function(t){return t===he.resSerializer?t:function(n){return t(he.resSerializer(n))}}};});var Pe=_((Cc,ir)=>{function Ii(e,t){return t}ir.exports=function(){let t=Error.prepareStackTrace;Error.prepareStackTrace=Ii;let r=new Error().stack;if(Error.prepareStackTrace=t,!Array.isArray(r))return;let n=r.slice(2),i=[];for(let o of n)o&&i.push(o.getFileName());return i};});var or=_((Nc,sr)=>{sr.exports=ji;function ji(e={}){let{ERR_PATHS_MUST_BE_STRINGS:t=()=>"fast-redact - Paths must be (non-empty) strings",ERR_INVALID_PATH:r=n=>`fast-redact \u2013 Invalid path (${n})`}=e;return function({paths:i}){i.forEach(o=>{if(typeof o!="string")throw Error(t());try{if(/ã€‡/.test(o))throw Error();let c=(o[0]==="["?"":".")+o.replace(/^\*/,"\u3007").replace(/\.\*/g,".\u3007").replace(/\[\*\]/g,"[\u3007]");if(/\n|\r|;/.test(c)||/\/\*/.test(c))throw Error();Function(`
            'use strict'
            const o = new Proxy({}, { get: () => o, set: () => { throw Error() } });
            const \u3007 = null;
            o${c}
            if ([o${c}].length !== 1) throw Error()`)();}catch{throw Error(r(o))}});}}});var me=_((Ic,lr)=>{lr.exports=/[^.[\]]+|\[((?:.)*?)\]/g;});var cr=_((jc,ar)=>{var Bi=me();ar.exports=zi;function zi({paths:e}){let t=[];var r=0;let n=e.reduce(function(i,o,c){var a=o.match(Bi).map(h=>h.replace(/'|"|`/g,""));let u=o[0]==="[";a=a.map(h=>h[0]==="["?h.substr(1,h.length-2):h);let d=a.indexOf("*");if(d>-1){let h=a.slice(0,d),l=h.join("."),g=a.slice(d+1,a.length),f=g.length>0;r++,t.push({before:h,beforeStr:l,after:g,nested:f});}else i[o]={path:a,val:void 0,precensored:false,circle:"",escPath:JSON.stringify(o),leadingBracket:u};return i},{});return {wildcards:t,wcLen:r,secret:n}}});var fr=_((Bc,ur)=>{var Di=me();ur.exports=Fi;function Fi({secret:e,serialize:t,wcLen:r,strict:n,isCensorFct:i,censorFctTakesPath:o},c){let a=Function("o",`
    if (typeof o !== 'object' || o == null) {
      ${Vi(n,t)}
    }
    const { censor, secret } = this
    const originalSecret = {}
    const secretKeys = Object.keys(secret)
    for (var i = 0; i < secretKeys.length; i++) {
      originalSecret[secretKeys[i]] = secret[secretKeys[i]]
    }

    ${Pi(e,i,o)}
    this.compileRestore()
    ${qi(r>0,i,o)}
    this.secret = originalSecret
    ${Mi(t)}
  `).bind(c);return a.state=c,t===false&&(a.restore=u=>c.restore(u)),a}function Pi(e,t,r){return Object.keys(e).map(n=>{let{escPath:i,leadingBracket:o,path:c}=e[n],a=o?1:0,u=o?"":".",d=[];for(var h;(h=Di.exec(n))!==null;){let[,s]=h,{index:y,input:p}=h;y>a&&d.push(p.substring(0,y-(s?0:1)));}var l=d.map(s=>`o${u}${s}`).join(" && ");l.length===0?l+=`o${u}${n} != null`:l+=` && o${u}${n} != null`;let g=`
      switch (true) {
        ${d.reverse().map(s=>`
          case o${u}${s} === censor:
            secret[${i}].circle = ${JSON.stringify(s)}
            break
        `).join(`
`)}
      }
    `,f=r?`val, ${JSON.stringify(c)}`:"val";return `
      if (${l}) {
        const val = o${u}${n}
        if (val === censor) {
          secret[${i}].precensored = true
        } else {
          secret[${i}].val = val
          o${u}${n} = ${t?`censor(${f})`:"censor"}
          ${g}
        }
      }
    `}).join(`
`)}function qi(e,t,r){return e===true?`
    {
      const { wildcards, wcLen, groupRedact, nestedRedact } = this
      for (var i = 0; i < wcLen; i++) {
        const { before, beforeStr, after, nested } = wildcards[i]
        if (nested === true) {
          secret[beforeStr] = secret[beforeStr] || []
          nestedRedact(secret[beforeStr], o, before, after, censor, ${t}, ${r})
        } else secret[beforeStr] = groupRedact(o, before, censor, ${t}, ${r})
      }
    }
  `:""}function Mi(e){return e===false?"return o":`
    var s = this.serialize(o)
    this.restore(o)
    return s
  `}function Vi(e,t){return e===true?"throw Error('fast-redact: primitives cannot be redacted')":t===false?"return o":"return this.serialize(o)"}});var Me=_((zc,mr)=>{mr.exports={groupRedact:Ki,groupRestore:Wi,nestedRedact:Hi,nestedRestore:Gi};function Wi({keys:e,values:t,target:r}){if(r==null||typeof r=="string")return;let n=e.length;for(var i=0;i<n;i++){let o=e[i];r[o]=t[i];}}function Ki(e,t,r,n,i){let o=dr(e,t);if(o==null||typeof o=="string")return {keys:null,values:null,target:o,flat:true};let c=Object.keys(o),a=c.length,u=t.length,d=i?[...t]:void 0,h=new Array(a);for(var l=0;l<a;l++){let g=c[l];h[l]=o[g],i?(d[u]=g,o[g]=r(o[g],d)):n?o[g]=r(o[g]):o[g]=r;}return {keys:c,values:h,target:o,flat:true}}function Gi(e){for(let t=0;t<e.length;t++){let{target:r,path:n,value:i}=e[t],o=r;for(let c=n.length-1;c>0;c--)o=o[n[c]];o[n[0]]=i;}}function Hi(e,t,r,n,i,o,c){let a=dr(t,r);if(a==null)return;let u=Object.keys(a),d=u.length;for(var h=0;h<d;h++){let l=u[h];Ui(e,a,l,r,n,i,o,c);}return e}function qe(e,t){return e!=null?"hasOwn"in Object?Object.hasOwn(e,t):Object.prototype.hasOwnProperty.call(e,t):false}function Ui(e,t,r,n,i,o,c,a){let u=i.length,d=u-1,h=r;var l=-1,g,f,s,p=null,w,b,S=false,v=0,x=0,O=Ji();if(s=g=t[r],typeof g=="object"){for(;g!=null&&++l<u&&(x+=1,r=i[l],!(r!=="*"&&!p&&!(typeof g=="object"&&r in g)));)if(!(r==="*"&&(p==="*"&&(S=true),p=r,l!==d))){if(p){let R=Object.keys(g);for(var L=0;L<R.length;L++){let E=R[L];if(b=g[E],w=r==="*",S)O=V(O,E,x),v=l,s=hr(b,v-1,r,n,i,o,c,a,h,g,f,s,w,E,l,d,O,e,t[h],x+1);else if(w||typeof b=="object"&&b!==null&&r in b){if(w?s=b:s=b[r],f=l!==d?s:c?a?o(s,[...n,h,...i]):o(s):o,w){let A=se(V(O,E,x),s,t[h]);e.push(A),g[E]=f;}else if(b[r]!==f)if(f===void 0&&o!==void 0||qe(b,r)&&f===s)O=V(O,E,x);else {O=V(O,E,x);let A=se(V(O,r,x+1),s,t[h]);e.push(A),b[r]=f;}}}p=null;}else {if(s=g[r],O=V(O,r,x),f=l!==d?s:c?a?o(s,[...n,h,...i]):o(s):o,!(qe(g,r)&&f===s||f===void 0&&o!==void 0)){let R=se(O,s,t[h]);e.push(R),g[r]=f;}g=g[r];}if(typeof g!="object")break}}}function dr(e,t){for(var r=-1,n=t.length,i=e;i!=null&&++r<n;)i=i[t[r]];return i}function hr(e,t,r,n,i,o,c,a,u,d,h,l,g,f,s,y,p,w,b,S){if(t===0&&(g||typeof e=="object"&&e!==null&&r in e)){if(g?l=e:l=e[r],h=s!==y?l:c?a?o(l,[...n,u,...i]):o(l):o,g){let v=se(p,l,b);w.push(v),d[f]=h;}else if(e[r]!==h){if(!(h===void 0&&o!==void 0||qe(e,r)&&h===l)){let v=se(V(p,r,S+1),l,b);w.push(v),e[r]=h;}}}for(let v in e)typeof e[v]=="object"&&(p=V(p,v,S),hr(e[v],t-1,r,n,i,o,c,a,u,d,h,l,g,f,s,y,p,w,b,S+1));}function Ji(){return {parent:null,key:null,children:[],depth:0}}function V(e,t,r){if(e.depth===r)return V(e.parent,t,r);var n={parent:e,key:t,depth:r,children:[]};return e.children.push(n),n}function se(e,t,r){let n=e,i=[];do i.push(n.key),n=n.parent;while(n.parent!=null);return {path:i,value:t,target:r}}});var pr=_((Dc,gr)=>{var{groupRestore:Xi,nestedRestore:Yi}=Me();gr.exports=Qi;function Qi(){return function(){if(this.restore){this.restore.state.secret=this.secret;return}let{secret:t,wcLen:r}=this,n=Object.keys(t),i=Zi(t,n),o=r>0,c=o?{secret:t,groupRestore:Xi,nestedRestore:Yi}:{secret:t};this.restore=Function("o",es(i,n,o)).bind(c),this.restore.state=c;}}function Zi(e,t){return t.map(r=>{let{circle:n,escPath:i,leadingBracket:o}=e[r],a=n?`o.${n} = secret[${i}].val`:`o${o?"":"."}${r} = secret[${i}].val`,u=`secret[${i}].val = undefined`;return `
      if (secret[${i}].val !== undefined) {
        try { ${a} } catch (e) {}
        ${u}
      }
    `}).join("")}function es(e,t,r){return `
    const secret = this.secret
    ${r===true?`
    const keys = Object.keys(secret)
    const len = keys.length
    for (var i = len - 1; i >= ${t.length}; i--) {
      const k = keys[i]
      const o = secret[k]
      if (o) {
        if (o.flat === true) this.groupRestore(o)
        else this.nestedRestore(o)
        secret[k] = null
      }
    }
  `:""}
    ${e}
    return o
  `}});var br=_((Fc,yr)=>{yr.exports=ts;function ts(e){let{secret:t,censor:r,compileRestore:n,serialize:i,groupRedact:o,nestedRedact:c,wildcards:a,wcLen:u}=e,d=[{secret:t,censor:r,compileRestore:n}];return i!==false&&d.push({serialize:i}),u>0&&d.push({groupRedact:o,nestedRedact:c,wildcards:a,wcLen:u}),Object.assign(...d)}});var vr=_((Pc,wr)=>{var Sr=or(),rs=cr(),ns=fr(),is=pr(),{groupRedact:ss,nestedRedact:os}=Me(),ls=br(),as=me(),cs=Sr(),Ve=e=>e;Ve.restore=Ve;var us="[REDACTED]";We.rx=as;We.validator=Sr;wr.exports=We;function We(e={}){let t=Array.from(new Set(e.paths||[])),r="serialize"in e&&(e.serialize===false||typeof e.serialize=="function")?e.serialize:JSON.stringify,n=e.remove;if(n===true&&r!==JSON.stringify)throw Error("fast-redact \u2013 remove option may only be set when serializer is JSON.stringify");let i=n===true?void 0:"censor"in e?e.censor:us,o=typeof i=="function",c=o&&i.length>1;if(t.length===0)return r||Ve;cs({paths:t,serialize:r,censor:i});let{wildcards:a,wcLen:u,secret:d}=rs({paths:t,censor:i}),h=is(),l="strict"in e?e.strict:true;return ns({secret:d,wcLen:u,serialize:r,strict:l,isCensorFct:o,censorFctTakesPath:c},ls({secret:d,censor:i,compileRestore:h,serialize:r,groupRedact:ss,nestedRedact:os,wildcards:a,wcLen:u}))}});var X=_((qc,Er)=>{var fs=Symbol("pino.setLevel"),ds=Symbol("pino.getLevel"),hs=Symbol("pino.levelVal"),ms=Symbol("pino.levelComp"),gs=Symbol("pino.useLevelLabels"),ps=Symbol("pino.useOnlyCustomLevels"),ys=Symbol("pino.mixin"),bs=Symbol("pino.lsCache"),Ss=Symbol("pino.chindings"),ws=Symbol("pino.asJson"),vs=Symbol("pino.write"),Es=Symbol("pino.redactFmt"),xs=Symbol("pino.time"),_s=Symbol("pino.timeSliceIndex"),Os=Symbol("pino.stream"),Ls=Symbol("pino.stringify"),Rs=Symbol("pino.stringifySafe"),As=Symbol("pino.stringifiers"),Ts=Symbol("pino.end"),ks=Symbol("pino.formatOpts"),$s=Symbol("pino.messageKey"),Cs=Symbol("pino.errorKey"),Ns=Symbol("pino.nestedKey"),Is=Symbol("pino.nestedKeyStr"),js=Symbol("pino.mixinMergeStrategy"),Bs=Symbol("pino.msgPrefix"),zs=Symbol("pino.wildcardFirst"),Ds=Symbol.for("pino.serializers"),Fs=Symbol.for("pino.formatters"),Ps=Symbol.for("pino.hooks"),qs=Symbol.for("pino.metadata");Er.exports={setLevelSym:fs,getLevelSym:ds,levelValSym:hs,levelCompSym:ms,useLevelLabelsSym:gs,mixinSym:ys,lsCacheSym:bs,chindingsSym:Ss,asJsonSym:ws,writeSym:vs,serializersSym:Ds,redactFmtSym:Es,timeSym:xs,timeSliceIndexSym:_s,streamSym:Os,stringifySym:Ls,stringifySafeSym:Rs,stringifiersSym:As,endSym:Ts,formatOptsSym:ks,messageKeySym:$s,errorKeySym:Cs,nestedKeySym:Ns,wildcardFirstSym:zs,needsMetadataGsym:qs,useOnlyCustomLevelsSym:ps,formattersSym:Fs,hooksSym:Ps,nestedKeyStrSym:Is,mixinMergeStrategySym:js,msgPrefixSym:Bs};});var He=_((Mc,Lr)=>{var Ge=vr(),{redactFmtSym:Ms,wildcardFirstSym:ge}=X(),{rx:Ke,validator:Vs}=Ge,xr=Vs({ERR_PATHS_MUST_BE_STRINGS:()=>"pino \u2013 redacted paths must be strings",ERR_INVALID_PATH:e=>`pino \u2013 redact paths array contains an invalid path (${e})`}),_r="[Redacted]",Or=false;function Ws(e,t){let{paths:r,censor:n}=Ks(e),i=r.reduce((a,u)=>{Ke.lastIndex=0;let d=Ke.exec(u),h=Ke.exec(u),l=d[1]!==void 0?d[1].replace(/^(?:"|'|`)(.*)(?:"|'|`)$/,"$1"):d[0];if(l==="*"&&(l=ge),h===null)return a[l]=null,a;if(a[l]===null)return a;let{index:g}=h,f=`${u.substr(g,u.length-1)}`;return a[l]=a[l]||[],l!==ge&&a[l].length===0&&a[l].push(...a[ge]||[]),l===ge&&Object.keys(a).forEach(function(s){a[s]&&a[s].push(f);}),a[l].push(f),a},{}),o={[Ms]:Ge({paths:r,censor:n,serialize:t,strict:Or})},c=(...a)=>t(typeof n=="function"?n(...a):n);return [...Object.keys(i),...Object.getOwnPropertySymbols(i)].reduce((a,u)=>{if(i[u]===null)a[u]=d=>c(d,[u]);else {let d=typeof n=="function"?(h,l)=>n(h,[u,...l]):n;a[u]=Ge({paths:i[u],censor:d,serialize:t,strict:Or});}return a},o)}function Ks(e){if(Array.isArray(e))return e={paths:e,censor:_r},xr(e),e;let{paths:t,censor:r=_r,remove:n}=e;if(Array.isArray(t)===false)throw Error("pino \u2013 redact must contain an array of strings");return n===true&&(r=void 0),xr({paths:t,censor:r}),{paths:t,censor:r}}Lr.exports=Ws;});var Ar=_((Vc,Rr)=>{var Gs=()=>"",Hs=()=>`,"time":${Date.now()}`,Us=()=>`,"time":${Math.round(Date.now()/1e3)}`,Js=()=>`,"time":"${new Date(Date.now()).toISOString()}"`;Rr.exports={nullTime:Gs,epochTime:Hs,unixTime:Us,isoTime:Js};});var kr=_((Wc,Tr)=>{function Xs(e){try{return JSON.stringify(e)}catch{return '"[Circular]"'}}Tr.exports=Ys;function Ys(e,t,r){var n=r&&r.stringify||Xs,i=1;if(typeof e=="object"&&e!==null){var o=t.length+i;if(o===1)return e;var c=new Array(o);c[0]=n(e);for(var a=1;a<o;a++)c[a]=n(t[a]);return c.join(" ")}if(typeof e!="string")return e;var u=t.length;if(u===0)return e;for(var d="",h=1-i,l=-1,g=e&&e.length||0,f=0;f<g;){if(e.charCodeAt(f)===37&&f+1<g){switch(l=l>-1?l:0,e.charCodeAt(f+1)){case 100:case 102:if(h>=u||t[h]==null)break;l<f&&(d+=e.slice(l,f)),d+=Number(t[h]),l=f+2,f++;break;case 105:if(h>=u||t[h]==null)break;l<f&&(d+=e.slice(l,f)),d+=Math.floor(Number(t[h])),l=f+2,f++;break;case 79:case 111:case 106:if(h>=u||t[h]===void 0)break;l<f&&(d+=e.slice(l,f));var s=typeof t[h];if(s==="string"){d+="'"+t[h]+"'",l=f+2,f++;break}if(s==="function"){d+=t[h].name||"<anonymous>",l=f+2,f++;break}d+=n(t[h]),l=f+2,f++;break;case 115:if(h>=u)break;l<f&&(d+=e.slice(l,f)),d+=String(t[h]),l=f+2,f++;break;case 37:l<f&&(d+=e.slice(l,f)),d+="%",l=f+2,f++,h--;break}++h;}++f;}return l===-1?e:(l<g&&(d+=e.slice(l)),d)}});var Je=_((Kc,Ue)=>{if(typeof SharedArrayBuffer<"u"&&typeof Atomics<"u"){let t=function(r){if((r>0&&r<1/0)===false)throw typeof r!="number"&&typeof r!="bigint"?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity");Atomics.wait(e,0,0,Number(r));},e=new Int32Array(new SharedArrayBuffer(4));Ue.exports=t;}else {let e=function(t){if((t>0&&t<1/0)===false)throw typeof t!="number"&&typeof t!="bigint"?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity");};Ue.exports=e;}});var Dr=_((Gc,zr)=>{var k=C("fs"),Qs=C("events"),Zs=C("util").inherits,$r=C("path"),Ye=Je(),eo=C("assert"),pe=100,ye=Buffer.allocUnsafe(0),to=16*1024,Cr="buffer",Nr="utf8",[ro,no]=(process.versions.node||"0.0").split(".").map(Number),io=ro>=22&&no>=7;function Ir(e,t){t._opening=true,t._writing=true,t._asyncDrainScheduled=false;function r(o,c){if(o){t._reopening=false,t._writing=false,t._opening=false,t.sync?process.nextTick(()=>{t.listenerCount("error")>0&&t.emit("error",o);}):t.emit("error",o);return}let a=t._reopening;t.fd=c,t.file=e,t._reopening=false,t._opening=false,t._writing=false,t.sync?process.nextTick(()=>t.emit("ready")):t.emit("ready"),!t.destroyed&&(!t._writing&&t._len>t.minLength||t._flushPending?t._actualWrite():a&&process.nextTick(()=>t.emit("drain")));}let n=t.append?"a":"w",i=t.mode;if(t.sync)try{t.mkdir&&k.mkdirSync($r.dirname(e),{recursive:!0});let o=k.openSync(e,n,i);r(null,o);}catch(o){throw r(o),o}else t.mkdir?k.mkdir($r.dirname(e),{recursive:true},o=>{if(o)return r(o);k.open(e,n,i,r);}):k.open(e,n,i,r);}function D(e){if(!(this instanceof D))return new D(e);let{fd:t,dest:r,minLength:n,maxLength:i,maxWrite:o,periodicFlush:c,sync:a,append:u=true,mkdir:d,retryEAGAIN:h,fsync:l,contentMode:g,mode:f}=e||{};t=t||r,this._len=0,this.fd=-1,this._bufs=[],this._lens=[],this._writing=false,this._ending=false,this._reopening=false,this._asyncDrainScheduled=false,this._flushPending=false,this._hwm=Math.max(n||0,16387),this.file=null,this.destroyed=false,this.minLength=n||0,this.maxLength=i||0,this.maxWrite=o||to,this._periodicFlush=c||0,this._periodicFlushTimer=void 0,this.sync=a||false,this.writable=true,this._fsync=l||false,this.append=u||false,this.mode=f,this.retryEAGAIN=h||(()=>true),this.mkdir=d||false;let s,y;if(g===Cr)this._writingBuf=ye,this.write=lo,this.flush=co,this.flushSync=fo,this._actualWrite=mo,s=()=>k.writeSync(this.fd,this._writingBuf),y=()=>k.write(this.fd,this._writingBuf,this.release);else if(g===void 0||g===Nr)this._writingBuf="",this.write=oo,this.flush=ao,this.flushSync=uo,this._actualWrite=ho,s=()=>k.writeSync(this.fd,this._writingBuf,"utf8"),y=()=>k.write(this.fd,this._writingBuf,"utf8",this.release);else throw new Error(`SonicBoom supports "${Nr}" and "${Cr}", but passed ${g}`);if(typeof t=="number")this.fd=t,process.nextTick(()=>this.emit("ready"));else if(typeof t=="string")Ir(t,this);else throw new Error("SonicBoom supports only file descriptors and files");if(this.minLength>=this.maxWrite)throw new Error(`minLength should be smaller than maxWrite (${this.maxWrite})`);this.release=(p,w)=>{if(p){if((p.code==="EAGAIN"||p.code==="EBUSY")&&this.retryEAGAIN(p,this._writingBuf.length,this._len-this._writingBuf.length))if(this.sync)try{Ye(pe),this.release(void 0,0);}catch(v){this.release(v);}else setTimeout(y,pe);else this._writing=false,this.emit("error",p);return}this.emit("write",w);let b=Xe(this._writingBuf,this._len,w);if(this._len=b.len,this._writingBuf=b.writingBuf,this._writingBuf.length){if(!this.sync){y();return}try{do{let v=s(),x=Xe(this._writingBuf,this._len,v);this._len=x.len,this._writingBuf=x.writingBuf;}while(this._writingBuf.length)}catch(v){this.release(v);return}}this._fsync&&k.fsyncSync(this.fd);let S=this._len;this._reopening?(this._writing=false,this._reopening=false,this.reopen()):S>this.minLength?this._actualWrite():this._ending?S>0?this._actualWrite():(this._writing=false,be(this)):(this._writing=false,this.sync?this._asyncDrainScheduled||(this._asyncDrainScheduled=true,process.nextTick(so,this)):this.emit("drain"));},this.on("newListener",function(p){p==="drain"&&(this._asyncDrainScheduled=false);}),this._periodicFlush!==0&&(this._periodicFlushTimer=setInterval(()=>this.flush(null),this._periodicFlush),this._periodicFlushTimer.unref());}function Xe(e,t,r){return typeof e=="string"&&Buffer.byteLength(e)!==r&&(r=Buffer.from(e).subarray(0,r).toString().length),t=Math.max(t-r,0),e=e.slice(r),{writingBuf:e,len:t}}function so(e){e.listenerCount("drain")>0&&(e._asyncDrainScheduled=false,e.emit("drain"));}Zs(D,Qs);function jr(e,t){return e.length===0?ye:e.length===1?e[0]:Buffer.concat(e,t)}function oo(e){if(this.destroyed)throw new Error("SonicBoom destroyed");let t=this._len+e.length,r=this._bufs;return this.maxLength&&t>this.maxLength?(this.emit("drop",e),this._len<this._hwm):(r.length===0||r[r.length-1].length+e.length>this.maxWrite?r.push(""+e):r[r.length-1]+=e,this._len=t,!this._writing&&this._len>=this.minLength&&this._actualWrite(),this._len<this._hwm)}function lo(e){if(this.destroyed)throw new Error("SonicBoom destroyed");let t=this._len+e.length,r=this._bufs,n=this._lens;return this.maxLength&&t>this.maxLength?(this.emit("drop",e),this._len<this._hwm):(r.length===0||n[n.length-1]+e.length>this.maxWrite?(r.push([e]),n.push(e.length)):(r[r.length-1].push(e),n[n.length-1]+=e.length),this._len=t,!this._writing&&this._len>=this.minLength&&this._actualWrite(),this._len<this._hwm)}function Br(e){this._flushPending=true;let t=()=>{if(this._fsync)this._flushPending=false,e();else try{k.fsync(this.fd,n=>{this._flushPending=!1,e(n);});}catch(n){e(n);}this.off("error",r);},r=n=>{this._flushPending=false,e(n),this.off("drain",t);};this.once("drain",t),this.once("error",r);}function ao(e){if(e!=null&&typeof e!="function")throw new Error("flush cb must be a function");if(this.destroyed){let t=new Error("SonicBoom destroyed");if(e){e(t);return}throw t}if(this.minLength<=0){e?.();return}e&&Br.call(this,e),!this._writing&&(this._bufs.length===0&&this._bufs.push(""),this._actualWrite());}function co(e){if(e!=null&&typeof e!="function")throw new Error("flush cb must be a function");if(this.destroyed){let t=new Error("SonicBoom destroyed");if(e){e(t);return}throw t}if(this.minLength<=0){e?.();return}e&&Br.call(this,e),!this._writing&&(this._bufs.length===0&&(this._bufs.push([]),this._lens.push(0)),this._actualWrite());}D.prototype.reopen=function(e){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this._opening){this.once("ready",()=>{this.reopen(e);});return}if(this._ending)return;if(!this.file)throw new Error("Unable to reopen a file descriptor, you must pass a file to SonicBoom");if(e&&(this.file=e),this._reopening=true,this._writing)return;let t=this.fd;this.once("ready",()=>{t!==this.fd&&k.close(t,r=>{if(r)return this.emit("error",r)});}),Ir(this.file,this);};D.prototype.end=function(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this._opening){this.once("ready",()=>{this.end();});return}this._ending||(this._ending=true,!this._writing&&(this._len>0&&this.fd>=0?this._actualWrite():be(this)));};function uo(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this.fd<0)throw new Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift(this._writingBuf),this._writingBuf="");let e="";for(;this._bufs.length||e;){e.length<=0&&(e=this._bufs[0]);try{let t=k.writeSync(this.fd,e,"utf8"),r=Xe(e,this._len,t);e=r.writingBuf,this._len=r.len,e.length<=0&&this._bufs.shift();}catch(t){if((t.code==="EAGAIN"||t.code==="EBUSY")&&!this.retryEAGAIN(t,e.length,this._len-e.length))throw t;Ye(pe);}}try{k.fsyncSync(this.fd);}catch{}}function fo(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this.fd<0)throw new Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift([this._writingBuf]),this._writingBuf=ye);let e=ye;for(;this._bufs.length||e.length;){e.length<=0&&(e=jr(this._bufs[0],this._lens[0]));try{let t=k.writeSync(this.fd,e);e=e.subarray(t),this._len=Math.max(this._len-t,0),e.length<=0&&(this._bufs.shift(),this._lens.shift());}catch(t){if((t.code==="EAGAIN"||t.code==="EBUSY")&&!this.retryEAGAIN(t,e.length,this._len-e.length))throw t;Ye(pe);}}}D.prototype.destroy=function(){this.destroyed||be(this);};function ho(){let e=this.release;if(this._writing=true,this._writingBuf=this._writingBuf||this._bufs.shift()||"",this.sync)try{let t=k.writeSync(this.fd,this._writingBuf,"utf8");e(null,t);}catch(t){e(t);}else k.write(this.fd,this._writingBuf,"utf8",e);}function mo(){let e=this.release;if(this._writing=true,this._writingBuf=this._writingBuf.length?this._writingBuf:jr(this._bufs.shift(),this._lens.shift()),this.sync)try{let t=k.writeSync(this.fd,this._writingBuf);e(null,t);}catch(t){e(t);}else io&&(this._writingBuf=Buffer.from(this._writingBuf)),k.write(this.fd,this._writingBuf,e);}function be(e){if(e.fd===-1){e.once("ready",be.bind(null,e));return}e._periodicFlushTimer!==void 0&&clearInterval(e._periodicFlushTimer),e.destroyed=true,e._bufs=[],e._lens=[],eo(typeof e.fd=="number",`sonic.fd must be a number, got ${typeof e.fd}`);try{k.fsync(e.fd,t);}catch{}function t(){e.fd!==1&&e.fd!==2?k.close(e.fd,r):r();}function r(n){if(n){e.emit("error",n);return}e._ending&&!e._writing&&e.emit("finish"),e.emit("close");}}D.SonicBoom=D;D.default=D;zr.exports=D;});var Qe=_((Hc,Vr)=>{var F={exit:[],beforeExit:[]},Fr={exit:yo,beforeExit:bo},Y;function go(){Y===void 0&&(Y=new FinalizationRegistry(So));}function po(e){F[e].length>0||process.on(e,Fr[e]);}function Pr(e){F[e].length>0||(process.removeListener(e,Fr[e]),F.exit.length===0&&F.beforeExit.length===0&&(Y=void 0));}function yo(){qr("exit");}function bo(){qr("beforeExit");}function qr(e){for(let t of F[e]){let r=t.deref(),n=t.fn;r!==void 0&&n(r,e);}F[e]=[];}function So(e){for(let t of ["exit","beforeExit"]){let r=F[t].indexOf(e);F[t].splice(r,r+1),Pr(t);}}function Mr(e,t,r){if(t===void 0)throw new Error("the object can't be undefined");po(e);let n=new WeakRef(t);n.fn=r,go(),Y.register(t,n),F[e].push(n);}function wo(e,t){Mr("exit",e,t);}function vo(e,t){Mr("beforeExit",e,t);}function Eo(e){if(Y!==void 0){Y.unregister(e);for(let t of ["exit","beforeExit"])F[t]=F[t].filter(r=>{let n=r.deref();return n&&n!==e}),Pr(t);}}Vr.exports={register:wo,registerBeforeExit:vo,unregister:Eo};});var Wr=_((Uc,xo)=>{xo.exports={name:"thread-stream",version:"3.1.0",description:"A streaming way to send data to a Node.js Worker Thread",main:"index.js",types:"index.d.ts",dependencies:{"real-require":"^0.2.0"},devDependencies:{"@types/node":"^20.1.0","@types/tap":"^15.0.0","@yao-pkg/pkg":"^5.11.5",desm:"^1.3.0",fastbench:"^1.0.1",husky:"^9.0.6","pino-elasticsearch":"^8.0.0","sonic-boom":"^4.0.1",standard:"^17.0.0",tap:"^16.2.0","ts-node":"^10.8.0",typescript:"^5.3.2","why-is-node-running":"^2.2.2"},scripts:{build:"tsc --noEmit",test:'standard && npm run build && npm run transpile && tap "test/**/*.test.*js" && tap --ts test/*.test.*ts',"test:ci":"standard && npm run transpile && npm run test:ci:js && npm run test:ci:ts","test:ci:js":'tap --no-check-coverage --timeout=120 --coverage-report=lcovonly "test/**/*.test.*js"',"test:ci:ts":'tap --ts --no-check-coverage --coverage-report=lcovonly "test/**/*.test.*ts"',"test:yarn":'npm run transpile && tap "test/**/*.test.js" --no-check-coverage',transpile:"sh ./test/ts/transpile.sh",prepare:"husky install"},standard:{ignore:["test/ts/**/*","test/syntax-error.mjs"]},repository:{type:"git",url:"git+https://github.com/mcollina/thread-stream.git"},keywords:["worker","thread","threads","stream"],author:"Matteo Collina <hello@matteocollina.com>",license:"MIT",bugs:{url:"https://github.com/mcollina/thread-stream/issues"},homepage:"https://github.com/mcollina/thread-stream#readme"};});var Gr=_((Jc,Kr)=>{function _o(e,t,r,n,i){let o=Date.now()+n,c=Atomics.load(e,t);if(c===r){i(null,"ok");return}let a=c,u=d=>{Date.now()>o?i(null,"timed-out"):setTimeout(()=>{a=c,c=Atomics.load(e,t),c===a?u(d>=1e3?1e3:d*2):c===r?i(null,"ok"):i(null,"not-equal");},d);};u(1);}function Oo(e,t,r,n,i){let o=Date.now()+n,c=Atomics.load(e,t);if(c!==r){i(null,"ok");return}let a=u=>{Date.now()>o?i(null,"timed-out"):setTimeout(()=>{c=Atomics.load(e,t),c!==r?i(null,"ok"):a(u>=1e3?1e3:u*2);},u);};a(1);}Kr.exports={wait:_o,waitDiff:Oo};});var Ur=_((Xc,Hr)=>{Hr.exports={WRITE_INDEX:4,READ_INDEX:8};});var Zr=_((Yc,Qr)=>{var{version:Lo}=Wr(),{EventEmitter:Ro}=C("events"),{Worker:Ao}=C("worker_threads"),{join:To}=C("path"),{pathToFileURL:ko}=C("url"),{wait:$o}=Gr(),{WRITE_INDEX:I,READ_INDEX:P}=Ur(),Co=C("buffer"),No=C("assert"),m=Symbol("kImpl"),Io=Co.constants.MAX_STRING_LENGTH,oe=class{constructor(t){this._value=t;}deref(){return this._value}},we=class{register(){}unregister(){}},jo=process.env.NODE_V8_COVERAGE?we:global.FinalizationRegistry||we,Bo=process.env.NODE_V8_COVERAGE?oe:global.WeakRef||oe,Jr=new jo(e=>{e.exited||e.terminate();});function zo(e,t){let{filename:r,workerData:n}=t,o=("__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{})["thread-stream-worker"]||To(__dirname,"lib","worker.js"),c=new Ao(o,{...t.workerOpts,trackUnmanagedFds:false,workerData:{filename:r.indexOf("file://")===0?r:ko(r).href,dataBuf:e[m].dataBuf,stateBuf:e[m].stateBuf,workerData:{$context:{threadStreamVersion:Lo},...n}}});return c.stream=new oe(e),c.on("message",Do),c.on("exit",Yr),Jr.register(e,c),c}function Xr(e){No(!e[m].sync),e[m].needDrain&&(e[m].needDrain=false,e.emit("drain"));}function Se(e){let t=Atomics.load(e[m].state,I),r=e[m].data.length-t;if(r>0){if(e[m].buf.length===0){e[m].flushing=false,e[m].ending?nt(e):e[m].needDrain&&process.nextTick(Xr,e);return}let n=e[m].buf.slice(0,r),i=Buffer.byteLength(n);i<=r?(e[m].buf=e[m].buf.slice(r),ve(e,n,Se.bind(null,e))):e.flush(()=>{if(!e.destroyed){for(Atomics.store(e[m].state,P,0),Atomics.store(e[m].state,I,0);i>e[m].data.length;)r=r/2,n=e[m].buf.slice(0,r),i=Buffer.byteLength(n);e[m].buf=e[m].buf.slice(r),ve(e,n,Se.bind(null,e));}});}else if(r===0){if(t===0&&e[m].buf.length===0)return;e.flush(()=>{Atomics.store(e[m].state,P,0),Atomics.store(e[m].state,I,0),Se(e);});}else q(e,new Error("overwritten"));}function Do(e){let t=this.stream.deref();if(t===void 0){this.exited=true,this.terminate();return}switch(e.code){case "READY":this.stream=new Bo(t),t.flush(()=>{t[m].ready=true,t.emit("ready");});break;case "ERROR":q(t,e.err);break;case "EVENT":Array.isArray(e.args)?t.emit(e.name,...e.args):t.emit(e.name,e.args);break;case "WARNING":process.emitWarning(e.err);break;default:q(t,new Error("this should not happen: "+e.code));}}function Yr(e){let t=this.stream.deref();t!==void 0&&(Jr.unregister(t),t.worker.exited=true,t.worker.off("exit",Yr),q(t,e!==0?new Error("the worker thread exited"):null));}var et=class extends Ro{constructor(t={}){if(super(),t.bufferSize<4)throw new Error("bufferSize must at least fit a 4-byte utf-8 char");this[m]={},this[m].stateBuf=new SharedArrayBuffer(128),this[m].state=new Int32Array(this[m].stateBuf),this[m].dataBuf=new SharedArrayBuffer(t.bufferSize||4*1024*1024),this[m].data=Buffer.from(this[m].dataBuf),this[m].sync=t.sync||false,this[m].ending=false,this[m].ended=false,this[m].needDrain=false,this[m].destroyed=false,this[m].flushing=false,this[m].ready=false,this[m].finished=false,this[m].errored=null,this[m].closed=false,this[m].buf="",this.worker=zo(this,t),this.on("message",(r,n)=>{this.worker.postMessage(r,n);});}write(t){if(this[m].destroyed)return tt(this,new Error("the worker has exited")),false;if(this[m].ending)return tt(this,new Error("the worker is ending")),false;if(this[m].flushing&&this[m].buf.length+t.length>=Io)try{Ze(this),this[m].flushing=!0;}catch(r){return q(this,r),false}if(this[m].buf+=t,this[m].sync)try{return Ze(this),!0}catch(r){return q(this,r),false}return this[m].flushing||(this[m].flushing=true,setImmediate(Se,this)),this[m].needDrain=this[m].data.length-this[m].buf.length-Atomics.load(this[m].state,I)<=0,!this[m].needDrain}end(){this[m].destroyed||(this[m].ending=true,nt(this));}flush(t){if(this[m].destroyed){typeof t=="function"&&process.nextTick(t,new Error("the worker has exited"));return}let r=Atomics.load(this[m].state,I);$o(this[m].state,P,r,1/0,(n,i)=>{if(n){q(this,n),process.nextTick(t,n);return}if(i==="not-equal"){this.flush(t);return}process.nextTick(t);});}flushSync(){this[m].destroyed||(Ze(this),rt(this));}unref(){this.worker.unref();}ref(){this.worker.ref();}get ready(){return this[m].ready}get destroyed(){return this[m].destroyed}get closed(){return this[m].closed}get writable(){return !this[m].destroyed&&!this[m].ending}get writableEnded(){return this[m].ending}get writableFinished(){return this[m].finished}get writableNeedDrain(){return this[m].needDrain}get writableObjectMode(){return  false}get writableErrored(){return this[m].errored}};function tt(e,t){setImmediate(()=>{e.emit("error",t);});}function q(e,t){e[m].destroyed||(e[m].destroyed=true,t&&(e[m].errored=t,tt(e,t)),e.worker.exited?setImmediate(()=>{e[m].closed=true,e.emit("close");}):e.worker.terminate().catch(()=>{}).then(()=>{e[m].closed=true,e.emit("close");}));}function ve(e,t,r){let n=Atomics.load(e[m].state,I),i=Buffer.byteLength(t);return e[m].data.write(t,n),Atomics.store(e[m].state,I,n+i),Atomics.notify(e[m].state,I),r(),true}function nt(e){if(!(e[m].ended||!e[m].ending||e[m].flushing)){e[m].ended=true;try{e.flushSync();let t=Atomics.load(e[m].state,P);Atomics.store(e[m].state,I,-1),Atomics.notify(e[m].state,I);let r=0;for(;t!==-1;){if(Atomics.wait(e[m].state,P,t,1e3),t=Atomics.load(e[m].state,P),t===-2){q(e,new Error("end() failed"));return}if(++r===10){q(e,new Error("end() took too long (10s)"));return}}process.nextTick(()=>{e[m].finished=!0,e.emit("finish");});}catch(t){q(e,t);}}}function Ze(e){let t=()=>{e[m].ending?nt(e):e[m].needDrain&&process.nextTick(Xr,e);};for(e[m].flushing=false;e[m].buf.length!==0;){let r=Atomics.load(e[m].state,I),n=e[m].data.length-r;if(n===0){rt(e),Atomics.store(e[m].state,P,0),Atomics.store(e[m].state,I,0);continue}else if(n<0)throw new Error("overwritten");let i=e[m].buf.slice(0,n),o=Buffer.byteLength(i);if(o<=n)e[m].buf=e[m].buf.slice(n),ve(e,i,t);else {for(rt(e),Atomics.store(e[m].state,P,0),Atomics.store(e[m].state,I,0);o>e[m].buf.length;)n=n/2,i=e[m].buf.slice(0,n),o=Buffer.byteLength(i);e[m].buf=e[m].buf.slice(n),ve(e,i,t);}}}function rt(e){if(e[m].flushing)throw new Error("unable to flush while flushing");let t=Atomics.load(e[m].state,I),r=0;for(;;){let n=Atomics.load(e[m].state,P);if(n===-2)throw Error("_flushSync failed");if(n!==t)Atomics.wait(e[m].state,P,n,1e3);else break;if(++r===10)throw new Error("_flushSync took too long (10s)")}}Qr.exports=et;});var ot=_((Qc,en)=>{var{createRequire:Fo}=C("module"),Po=Pe(),{join:it,isAbsolute:qo,sep:Mo}=C("path"),Vo=Je(),st=Qe(),Wo=Zr();function Ko(e){st.register(e,Ho),st.registerBeforeExit(e,Uo),e.on("close",function(){st.unregister(e);});}function Go(e,t,r,n){let i=new Wo({filename:e,workerData:t,workerOpts:r,sync:n});i.on("ready",o),i.on("close",function(){process.removeListener("exit",c);}),process.on("exit",c);function o(){process.removeListener("exit",c),i.unref(),r.autoEnd!==false&&Ko(i);}function c(){i.closed||(i.flushSync(),Vo(100),i.end());}return i}function Ho(e){e.ref(),e.flushSync(),e.end(),e.once("close",function(){e.unref();});}function Uo(e){e.flushSync();}function Jo(e){let{pipeline:t,targets:r,levels:n,dedupe:i,worker:o={},caller:c=Po(),sync:a=false}=e,u={...e.options},d=typeof c=="string"?[c]:c,h="__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{},l=e.target;if(l&&r)throw new Error("only one of target or targets can be specified");return r?(l=h["pino-worker"]||it(__dirname,"worker.js"),u.targets=r.filter(f=>f.target).map(f=>({...f,target:g(f.target)})),u.pipelines=r.filter(f=>f.pipeline).map(f=>f.pipeline.map(s=>({...s,level:f.level,target:g(s.target)})))):t&&(l=h["pino-worker"]||it(__dirname,"worker.js"),u.pipelines=[t.map(f=>({...f,target:g(f.target)}))]),n&&(u.levels=n),i&&(u.dedupe=i),u.pinoWillSendConfig=true,Go(g(l),u,o,a);function g(f){if(f=h[f]||f,qo(f)||f.indexOf("file://")===0)return f;if(f==="pino/file")return it(__dirname,"..","file.js");let s;for(let y of d)try{let p=y==="node:repl"?process.cwd()+Mo:y;s=Fo(p).resolve(f);break}catch{continue}if(!s)throw new Error(`unable to determine transport target for "${f}"`);return s}}en.exports=Jo;});var _e=_((Zc,dn)=>{var tn=kr(),{mapHttpRequest:Xo,mapHttpResponse:Yo}=Fe(),at=Dr(),rn=Qe(),{lsCacheSym:Qo,chindingsSym:on,writeSym:nn,serializersSym:ln,formatOptsSym:sn,endSym:Zo,stringifiersSym:an,stringifySym:cn,stringifySafeSym:ct,wildcardFirstSym:un,nestedKeySym:el,formattersSym:fn,messageKeySym:tl,errorKeySym:rl,nestedKeyStrSym:nl,msgPrefixSym:Ee}=X(),{isMainThread:il}=C("worker_threads"),sl=ot();function Q(){}function ol(e,t){if(!t)return r;return function(...i){t.call(this,i,r,e);};function r(n,...i){if(typeof n=="object"){let o=n;n!==null&&(n.method&&n.headers&&n.socket?n=Xo(n):typeof n.setHeader=="function"&&(n=Yo(n)));let c;o===null&&i.length===0?c=[null]:(o=i.shift(),c=i),typeof this[Ee]=="string"&&o!==void 0&&o!==null&&(o=this[Ee]+o),this[nn](n,tn(o,c,this[sn]),e);}else {let o=n===void 0?i.shift():n;typeof this[Ee]=="string"&&o!==void 0&&o!==null&&(o=this[Ee]+o),this[nn](null,tn(o,i,this[sn]),e);}}}function lt(e){let t="",r=0,n=false,i=255,o=e.length;if(o>100)return JSON.stringify(e);for(var c=0;c<o&&i>=32;c++)i=e.charCodeAt(c),(i===34||i===92)&&(t+=e.slice(r,c)+"\\",r=c,n=true);return n?t+=e.slice(r):t=e,i<32?JSON.stringify(e):'"'+t+'"'}function ll(e,t,r,n){let i=this[cn],o=this[ct],c=this[an],a=this[Zo],u=this[on],d=this[ln],h=this[fn],l=this[tl],g=this[rl],f=this[Qo][r]+n;f=f+u;let s;h.log&&(e=h.log(e));let y=c[un],p="";for(let b in e)if(s=e[b],Object.prototype.hasOwnProperty.call(e,b)&&s!==void 0){d[b]?s=d[b](s):b===g&&d.err&&(s=d.err(s));let S=c[b]||y;switch(typeof s){case "undefined":case "function":continue;case "number":Number.isFinite(s)===false&&(s=null);case "boolean":S&&(s=S(s));break;case "string":s=(S||lt)(s);break;default:s=(S||i)(s,o);}if(s===void 0)continue;let v=lt(b);p+=","+v+":"+s;}let w="";if(t!==void 0){s=d[l]?d[l](t):t;let b=c[l]||y;switch(typeof s){case "function":break;case "number":Number.isFinite(s)===false&&(s=null);case "boolean":b&&(s=b(s)),w=',"'+l+'":'+s;break;case "string":s=(b||lt)(s),w=',"'+l+'":'+s;break;default:s=(b||i)(s,o),w=',"'+l+'":'+s;}}return this[el]&&p?f+this[nl]+p.slice(1)+"}"+w+a:f+p+w+a}function al(e,t){let r,n=e[on],i=e[cn],o=e[ct],c=e[an],a=c[un],u=e[ln],d=e[fn].bindings;t=d(t);for(let h in t)if(r=t[h],(h!=="level"&&h!=="serializers"&&h!=="formatters"&&h!=="customLevels"&&t.hasOwnProperty(h)&&r!==void 0)===true){if(r=u[h]?u[h](r):r,r=(c[h]||a||i)(r,o),r===void 0)continue;n+=',"'+h+'":'+r;}return n}function cl(e){return e.write!==e.constructor.prototype.write}function xe(e){let t=new at(e);return t.on("error",r),!e.sync&&il&&(rn.register(t,ul),t.on("close",function(){rn.unregister(t);})),t;function r(n){if(n.code==="EPIPE"){t.write=Q,t.end=Q,t.flushSync=Q,t.destroy=Q;return}t.removeListener("error",r),t.emit("error",n);}}function ul(e,t){e.destroyed||(t==="beforeExit"?(e.flush(),e.on("drain",function(){e.end();})):e.flushSync());}function fl(e){return function(r,n,i={},o){if(typeof i=="string")o=xe({dest:i}),i={};else if(typeof o=="string"){if(i&&i.transport)throw Error("only one of option.transport or stream can be specified");o=xe({dest:o});}else if(i instanceof at||i.writable||i._writableState)o=i,i={};else if(i.transport){if(i.transport instanceof at||i.transport.writable||i.transport._writableState)throw Error("option.transport do not allow stream, please pass to option directly. e.g. pino(transport)");if(i.transport.targets&&i.transport.targets.length&&i.formatters&&typeof i.formatters.level=="function")throw Error("option.transport.targets do not allow custom level formatters");let u;i.customLevels&&(u=i.useOnlyCustomLevels?i.customLevels:Object.assign({},i.levels,i.customLevels)),o=sl({caller:n,...i.transport,levels:u});}if(i=Object.assign({},e,i),i.serializers=Object.assign({},e.serializers,i.serializers),i.formatters=Object.assign({},e.formatters,i.formatters),i.prettyPrint)throw new Error("prettyPrint option is no longer supported, see the pino-pretty package (https://github.com/pinojs/pino-pretty)");let{enabled:c,onChild:a}=i;return c===false&&(i.level="silent"),a||(i.onChild=Q),o||(cl(process.stdout)?o=process.stdout:o=xe({fd:process.stdout.fd||1})),{opts:i,stream:o}}}function dl(e,t){try{return JSON.stringify(e)}catch{try{return (t||this[ct])(e)}catch{return '"[unable to serialize, circular reference is too complex to analyze]"'}}}function hl(e,t,r){return {level:e,bindings:t,log:r}}function ml(e){let t=Number(e);return typeof e=="string"&&Number.isFinite(t)?t:e===void 0?1:e}dn.exports={noop:Q,buildSafeSonicBoom:xe,asChindings:al,asJson:ll,genLog:ol,createArgsNormalizer:fl,stringify:dl,buildFormatters:hl,normalizeDestFileDescriptor:ml};});var Oe=_((eu,hn)=>{var gl={trace:10,debug:20,info:30,warn:40,error:50,fatal:60},pl={ASC:"ASC",DESC:"DESC"};hn.exports={DEFAULT_LEVELS:gl,SORTING_ORDER:pl};});var dt=_((tu,yn)=>{var{lsCacheSym:yl,levelValSym:ut,useOnlyCustomLevelsSym:bl,streamSym:Sl,formattersSym:wl,hooksSym:vl,levelCompSym:mn}=X(),{noop:El,genLog:G}=_e(),{DEFAULT_LEVELS:M,SORTING_ORDER:gn}=Oe(),pn={fatal:e=>{let t=G(M.fatal,e);return function(...r){let n=this[Sl];if(t.call(this,...r),typeof n.flushSync=="function")try{n.flushSync();}catch{}}},error:e=>G(M.error,e),warn:e=>G(M.warn,e),info:e=>G(M.info,e),debug:e=>G(M.debug,e),trace:e=>G(M.trace,e)},ft=Object.keys(M).reduce((e,t)=>(e[M[t]]=t,e),{}),xl=Object.keys(ft).reduce((e,t)=>(e[t]='{"level":'+Number(t),e),{});function _l(e){let t=e[wl].level,{labels:r}=e.levels,n={};for(let i in r){let o=t(r[i],Number(i));n[i]=JSON.stringify(o).slice(0,-1);}return e[yl]=n,e}function Ol(e,t){if(t)return  false;switch(e){case "fatal":case "error":case "warn":case "info":case "debug":case "trace":return  true;default:return  false}}function Ll(e){let{labels:t,values:r}=this.levels;if(typeof e=="number"){if(t[e]===void 0)throw Error("unknown level value"+e);e=t[e];}if(r[e]===void 0)throw Error("unknown level "+e);let n=this[ut],i=this[ut]=r[e],o=this[bl],c=this[mn],a=this[vl].logMethod;for(let u in r){if(c(r[u],i)===false){this[u]=El;continue}this[u]=Ol(u,o)?pn[u](a):G(r[u],a);}this.emit("level-change",e,i,t[n],n,this);}function Rl(e){let{levels:t,levelVal:r}=this;return t&&t.labels?t.labels[r]:""}function Al(e){let{values:t}=this.levels,r=t[e];return r!==void 0&&this[mn](r,this[ut])}function Tl(e,t,r){return e===gn.DESC?t<=r:t>=r}function kl(e){return typeof e=="string"?Tl.bind(null,e):e}function $l(e=null,t=false){let r=e?Object.keys(e).reduce((o,c)=>(o[e[c]]=c,o),{}):null,n=Object.assign(Object.create(Object.prototype,{Infinity:{value:"silent"}}),t?null:ft,r),i=Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),t?null:M,e);return {labels:n,values:i}}function Cl(e,t,r){if(typeof e=="number"){if(![].concat(Object.keys(t||{}).map(o=>t[o]),r?[]:Object.keys(ft).map(o=>+o),1/0).includes(e))throw Error(`default level:${e} must be included in custom levels`);return}let n=Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),r?null:M,t);if(!(e in n))throw Error(`default level:${e} must be included in custom levels`)}function Nl(e,t){let{labels:r,values:n}=e;for(let i in t){if(i in n)throw Error("levels cannot be overridden");if(t[i]in r)throw Error("pre-existing level values cannot be used for new levels")}}function Il(e){if(typeof e!="function"&&!(typeof e=="string"&&Object.values(gn).includes(e)))throw new Error('Levels comparison should be one of "ASC", "DESC" or "function" type')}yn.exports={initialLsCache:xl,genLsCache:_l,levelMethods:pn,getLevel:Rl,setLevel:Ll,isLevelEnabled:Al,mappings:$l,assertNoLevelCollisions:Nl,assertDefaultLevelFound:Cl,genLevelComparison:kl,assertLevelComparison:Il};});var ht=_((ru,bn)=>{bn.exports={version:"9.9.4"};});var An=_((iu,Rn)=>{var{EventEmitter:jl}=C("events"),{lsCacheSym:Bl,levelValSym:zl,setLevelSym:gt,getLevelSym:Sn,chindingsSym:yt,parsedChindingsSym:Dl,mixinSym:Fl,asJsonSym:xn,writeSym:Pl,mixinMergeStrategySym:ql,timeSym:Ml,timeSliceIndexSym:Vl,streamSym:_n,serializersSym:H,formattersSym:mt,errorKeySym:Wl,messageKeySym:Kl,useOnlyCustomLevelsSym:Gl,needsMetadataGsym:Hl,redactFmtSym:Ul,stringifySym:Jl,formatOptsSym:Xl,stringifiersSym:Yl,msgPrefixSym:pt,hooksSym:Ql}=X(),{getLevel:Zl,setLevel:ea,isLevelEnabled:ta,mappings:ra,initialLsCache:na,genLsCache:ia,assertNoLevelCollisions:sa}=dt(),{asChindings:On,asJson:oa,buildFormatters:wn,stringify:vn}=_e(),{version:la}=ht(),aa=He(),ca=class{},Ln={constructor:ca,child:ua,bindings:fa,setBindings:da,flush:pa,isLevelEnabled:ta,version:la,get level(){return this[Sn]()},set level(e){this[gt](e);},get levelVal(){return this[zl]},set levelVal(e){throw Error("levelVal is read-only")},get msgPrefix(){return this[pt]},[Bl]:na,[Pl]:ma,[xn]:oa,[Sn]:Zl,[gt]:ea};Object.setPrototypeOf(Ln,jl.prototype);Rn.exports=function(){return Object.create(Ln)};var En=e=>e;function ua(e,t){if(!e)throw Error("missing bindings for child Pino");t=t||{};let r=this[H],n=this[mt],i=Object.create(this);if(t.hasOwnProperty("serializers")===true){i[H]=Object.create(null);for(let d in r)i[H][d]=r[d];let a=Object.getOwnPropertySymbols(r);for(var o=0;o<a.length;o++){let d=a[o];i[H][d]=r[d];}for(let d in t.serializers)i[H][d]=t.serializers[d];let u=Object.getOwnPropertySymbols(t.serializers);for(var c=0;c<u.length;c++){let d=u[c];i[H][d]=t.serializers[d];}}else i[H]=r;if(t.hasOwnProperty("formatters")){let{level:a,bindings:u,log:d}=t.formatters;i[mt]=wn(a||n.level,u||En,d||n.log);}else i[mt]=wn(n.level,En,n.log);if(t.hasOwnProperty("customLevels")===true&&(sa(this.levels,t.customLevels),i.levels=ra(t.customLevels,i[Gl]),ia(i)),typeof t.redact=="object"&&t.redact!==null||Array.isArray(t.redact)){i.redact=t.redact;let a=aa(i.redact,vn),u={stringify:a[Ul]};i[Jl]=vn,i[Yl]=a,i[Xl]=u;}if(typeof t.msgPrefix=="string"&&(i[pt]=(this[pt]||"")+t.msgPrefix),i[yt]=On(i,e),t.level!==void 0&&t.level!==this.level||t.hasOwnProperty("customLevels")){let a=t.level||this.level;i[gt](a);}return this.onChild(i),i}function fa(){let t=`{${this[yt].substr(1)}}`,r=JSON.parse(t);return delete r.pid,delete r.hostname,r}function da(e){let t=On(this,e);this[yt]=t,delete this[Dl];}function ha(e,t){return Object.assign(t,e)}function ma(e,t,r){let n=this[Ml](),i=this[Fl],o=this[Wl],c=this[Kl],a=this[ql]||ha,u,d=this[Ql].streamWrite;e==null?u={}:e instanceof Error?(u={[o]:e},t===void 0&&(t=e.message)):(u=e,t===void 0&&e[c]===void 0&&e[o]&&(t=e[o].message)),i&&(u=a(u,i(u,r,this)));let h=this[xn](u,t,r,n),l=this[_n];l[Hl]===true&&(l.lastLevel=r,l.lastObj=u,l.lastMsg=t,l.lastTime=n.slice(this[Vl]),l.lastLogger=this),l.write(d?d(h):h);}function ga(){}function pa(e){if(e!=null&&typeof e!="function")throw Error("callback must be a function");let t=this[_n];typeof t.flush=="function"?t.flush(e||ga):e&&e();}});var Cn=_((vt,$n)=>{var{hasOwnProperty:le}=Object.prototype,J=wt();J.configure=wt;J.stringify=J;J.default=J;vt.stringify=J;vt.configure=wt;$n.exports=J;var ya=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]/;function W(e){return e.length<5e3&&!ya.test(e)?`"${e}"`:JSON.stringify(e)}function bt(e,t){if(e.length>200||t)return e.sort(t);for(let r=1;r<e.length;r++){let n=e[r],i=r;for(;i!==0&&e[i-1]>n;)e[i]=e[i-1],i--;e[i]=n;}return e}var ba=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Object.getPrototypeOf(new Int8Array)),Symbol.toStringTag).get;function St(e){return ba.call(e)!==void 0&&e.length!==0}function Tn(e,t,r){e.length<r&&(r=e.length);let n=t===","?"":" ",i=`"0":${n}${e[0]}`;for(let o=1;o<r;o++)i+=`${t}"${o}":${n}${e[o]}`;return i}function Sa(e){if(le.call(e,"circularValue")){let t=e.circularValue;if(typeof t=="string")return `"${t}"`;if(t==null)return t;if(t===Error||t===TypeError)return {toString(){throw new TypeError("Converting circular structure to JSON")}};throw new TypeError('The "circularValue" argument must be of type string or the value null or undefined')}return '"[Circular]"'}function wa(e){let t;if(le.call(e,"deterministic")&&(t=e.deterministic,typeof t!="boolean"&&typeof t!="function"))throw new TypeError('The "deterministic" argument must be of type boolean or comparator function');return t===void 0?true:t}function va(e,t){let r;if(le.call(e,t)&&(r=e[t],typeof r!="boolean"))throw new TypeError(`The "${t}" argument must be of type boolean`);return r===void 0?true:r}function kn(e,t){let r;if(le.call(e,t)){if(r=e[t],typeof r!="number")throw new TypeError(`The "${t}" argument must be of type number`);if(!Number.isInteger(r))throw new TypeError(`The "${t}" argument must be an integer`);if(r<1)throw new RangeError(`The "${t}" argument must be >= 1`)}return r===void 0?1/0:r}function U(e){return e===1?"1 item":`${e} items`}function Ea(e){let t=new Set;for(let r of e)(typeof r=="string"||typeof r=="number")&&t.add(String(r));return t}function xa(e){if(le.call(e,"strict")){let t=e.strict;if(typeof t!="boolean")throw new TypeError('The "strict" argument must be of type boolean');if(t)return r=>{let n=`Object can not safely be stringified. Received type ${typeof r}`;throw typeof r!="function"&&(n+=` (${r.toString()})`),new Error(n)}}}function wt(e){e={...e};let t=xa(e);t&&(e.bigint===void 0&&(e.bigint=false),"circularValue"in e||(e.circularValue=Error));let r=Sa(e),n=va(e,"bigint"),i=wa(e),o=typeof i=="function"?i:void 0,c=kn(e,"maximumDepth"),a=kn(e,"maximumBreadth");function u(f,s,y,p,w,b){let S=s[f];switch(typeof S=="object"&&S!==null&&typeof S.toJSON=="function"&&(S=S.toJSON(f)),S=p.call(s,f,S),typeof S){case "string":return W(S);case "object":{if(S===null)return "null";if(y.indexOf(S)!==-1)return r;let v="",x=",",O=b;if(Array.isArray(S)){if(S.length===0)return "[]";if(c<y.length+1)return '"[Array]"';y.push(S),w!==""&&(b+=w,v+=`
${b}`,x=`,
${b}`);let $=Math.min(S.length,a),j=0;for(;j<$-1;j++){let K=u(String(j),S,y,p,w,b);v+=K!==void 0?K:"null",v+=x;}let B=u(String(j),S,y,p,w,b);if(v+=B!==void 0?B:"null",S.length-1>a){let K=S.length-a-1;v+=`${x}"... ${U(K)} not stringified"`;}return w!==""&&(v+=`
${O}`),y.pop(),`[${v}]`}let L=Object.keys(S),R=L.length;if(R===0)return "{}";if(c<y.length+1)return '"[Object]"';let E="",A="";w!==""&&(b+=w,x=`,
${b}`,E=" ");let N=Math.min(R,a);i&&!St(S)&&(L=bt(L,o)),y.push(S);for(let $=0;$<N;$++){let j=L[$],B=u(j,S,y,p,w,b);B!==void 0&&(v+=`${A}${W(j)}:${E}${B}`,A=x);}if(R>a){let $=R-a;v+=`${A}"...":${E}"${U($)} not stringified"`,A=x;}return w!==""&&A.length>1&&(v=`
${b}${v}
${O}`),y.pop(),`{${v}}`}case "number":return isFinite(S)?String(S):t?t(S):"null";case "boolean":return S===true?"true":"false";case "undefined":return;case "bigint":if(n)return String(S);default:return t?t(S):void 0}}function d(f,s,y,p,w,b){switch(typeof s=="object"&&s!==null&&typeof s.toJSON=="function"&&(s=s.toJSON(f)),typeof s){case "string":return W(s);case "object":{if(s===null)return "null";if(y.indexOf(s)!==-1)return r;let S=b,v="",x=",";if(Array.isArray(s)){if(s.length===0)return "[]";if(c<y.length+1)return '"[Array]"';y.push(s),w!==""&&(b+=w,v+=`
${b}`,x=`,
${b}`);let R=Math.min(s.length,a),E=0;for(;E<R-1;E++){let N=d(String(E),s[E],y,p,w,b);v+=N!==void 0?N:"null",v+=x;}let A=d(String(E),s[E],y,p,w,b);if(v+=A!==void 0?A:"null",s.length-1>a){let N=s.length-a-1;v+=`${x}"... ${U(N)} not stringified"`;}return w!==""&&(v+=`
${S}`),y.pop(),`[${v}]`}y.push(s);let O="";w!==""&&(b+=w,x=`,
${b}`,O=" ");let L="";for(let R of p){let E=d(R,s[R],y,p,w,b);E!==void 0&&(v+=`${L}${W(R)}:${O}${E}`,L=x);}return w!==""&&L.length>1&&(v=`
${b}${v}
${S}`),y.pop(),`{${v}}`}case "number":return isFinite(s)?String(s):t?t(s):"null";case "boolean":return s===true?"true":"false";case "undefined":return;case "bigint":if(n)return String(s);default:return t?t(s):void 0}}function h(f,s,y,p,w){switch(typeof s){case "string":return W(s);case "object":{if(s===null)return "null";if(typeof s.toJSON=="function"){if(s=s.toJSON(f),typeof s!="object")return h(f,s,y,p,w);if(s===null)return "null"}if(y.indexOf(s)!==-1)return r;let b=w;if(Array.isArray(s)){if(s.length===0)return "[]";if(c<y.length+1)return '"[Array]"';y.push(s),w+=p;let E=`
${w}`,A=`,
${w}`,N=Math.min(s.length,a),$=0;for(;$<N-1;$++){let B=h(String($),s[$],y,p,w);E+=B!==void 0?B:"null",E+=A;}let j=h(String($),s[$],y,p,w);if(E+=j!==void 0?j:"null",s.length-1>a){let B=s.length-a-1;E+=`${A}"... ${U(B)} not stringified"`;}return E+=`
${b}`,y.pop(),`[${E}]`}let S=Object.keys(s),v=S.length;if(v===0)return "{}";if(c<y.length+1)return '"[Object]"';w+=p;let x=`,
${w}`,O="",L="",R=Math.min(v,a);St(s)&&(O+=Tn(s,x,a),S=S.slice(s.length),R-=s.length,L=x),i&&(S=bt(S,o)),y.push(s);for(let E=0;E<R;E++){let A=S[E],N=h(A,s[A],y,p,w);N!==void 0&&(O+=`${L}${W(A)}: ${N}`,L=x);}if(v>a){let E=v-a;O+=`${L}"...": "${U(E)} not stringified"`,L=x;}return L!==""&&(O=`
${w}${O}
${b}`),y.pop(),`{${O}}`}case "number":return isFinite(s)?String(s):t?t(s):"null";case "boolean":return s===true?"true":"false";case "undefined":return;case "bigint":if(n)return String(s);default:return t?t(s):void 0}}function l(f,s,y){switch(typeof s){case "string":return W(s);case "object":{if(s===null)return "null";if(typeof s.toJSON=="function"){if(s=s.toJSON(f),typeof s!="object")return l(f,s,y);if(s===null)return "null"}if(y.indexOf(s)!==-1)return r;let p="",w=s.length!==void 0;if(w&&Array.isArray(s)){if(s.length===0)return "[]";if(c<y.length+1)return '"[Array]"';y.push(s);let O=Math.min(s.length,a),L=0;for(;L<O-1;L++){let E=l(String(L),s[L],y);p+=E!==void 0?E:"null",p+=",";}let R=l(String(L),s[L],y);if(p+=R!==void 0?R:"null",s.length-1>a){let E=s.length-a-1;p+=`,"... ${U(E)} not stringified"`;}return y.pop(),`[${p}]`}let b=Object.keys(s),S=b.length;if(S===0)return "{}";if(c<y.length+1)return '"[Object]"';let v="",x=Math.min(S,a);w&&St(s)&&(p+=Tn(s,",",a),b=b.slice(s.length),x-=s.length,v=","),i&&(b=bt(b,o)),y.push(s);for(let O=0;O<x;O++){let L=b[O],R=l(L,s[L],y);R!==void 0&&(p+=`${v}${W(L)}:${R}`,v=",");}if(S>a){let O=S-a;p+=`${v}"...":"${U(O)} not stringified"`;}return y.pop(),`{${p}}`}case "number":return isFinite(s)?String(s):t?t(s):"null";case "boolean":return s===true?"true":"false";case "undefined":return;case "bigint":if(n)return String(s);default:return t?t(s):void 0}}function g(f,s,y){if(arguments.length>1){let p="";if(typeof y=="number"?p=" ".repeat(Math.min(y,10)):typeof y=="string"&&(p=y.slice(0,10)),s!=null){if(typeof s=="function")return u("",{"":f},[],s,p,"");if(Array.isArray(s))return d("",f,[],Ea(s),p,"")}if(p.length!==0)return h("",f,[],p,"")}return l("",f,[])}return g}});var Bn=_((su,jn)=>{var Et=Symbol.for("pino.metadata"),{DEFAULT_LEVELS:In}=Oe(),_a=In.info;function Oa(e,t){e=e||[],t=t||{dedupe:false};let r=Object.create(In);r.silent=1/0,t.levels&&typeof t.levels=="object"&&Object.keys(t.levels).forEach(l=>{r[l]=t.levels[l];});let n={write:i,add:a,remove:u,emit:o,flushSync:c,end:d,minLevel:0,lastId:0,streams:[],clone:h,[Et]:true,streamLevels:r};return Array.isArray(e)?e.forEach(a,n):a.call(n,e),e=null,n;function i(l){let g,f=this.lastLevel,{streams:s}=this,y=0,p;for(let w=La(s.length,t.dedupe);Aa(w,s.length,t.dedupe);w=Ra(w,t.dedupe))if(g=s[w],g.level<=f){if(y!==0&&y!==g.level)break;if(p=g.stream,p[Et]){let{lastTime:b,lastMsg:S,lastObj:v,lastLogger:x}=this;p.lastLevel=f,p.lastTime=b,p.lastMsg=S,p.lastObj=v,p.lastLogger=x;}p.write(l),t.dedupe&&(y=g.level);}else if(!t.dedupe)break}function o(...l){for(let{stream:g}of this.streams)typeof g.emit=="function"&&g.emit(...l);}function c(){for(let{stream:l}of this.streams)typeof l.flushSync=="function"&&l.flushSync();}function a(l){if(!l)return n;let g=typeof l.write=="function"||l.stream,f=l.write?l:l.stream;if(!g)throw Error("stream object needs to implement either StreamEntry or DestinationStream interface");let{streams:s,streamLevels:y}=this,p;typeof l.levelVal=="number"?p=l.levelVal:typeof l.level=="string"?p=y[l.level]:typeof l.level=="number"?p=l.level:p=_a;let w={stream:f,level:p,levelVal:void 0,id:++n.lastId};return s.unshift(w),s.sort(Nn),this.minLevel=s[0].level,n}function u(l){let{streams:g}=this,f=g.findIndex(s=>s.id===l);return f>=0&&(g.splice(f,1),g.sort(Nn),this.minLevel=g.length>0?g[0].level:-1),n}function d(){for(let{stream:l}of this.streams)typeof l.flushSync=="function"&&l.flushSync(),l.end();}function h(l){let g=new Array(this.streams.length);for(let f=0;f<g.length;f++)g[f]={level:l,stream:this.streams[f].stream};return {write:i,add:a,remove:u,minLevel:l,streams:g,clone:h,emit:o,flushSync:c,[Et]:true}}}function Nn(e,t){return e.level-t.level}function La(e,t){return t?e-1:0}function Ra(e,t){return t?e-1:e+1}function Aa(e,t,r){return r?e>=0:e<t}jn.exports=Oa;});var Lt=_((ou,z)=>{var Ta=C("os"),Wn=Fe(),ka=Pe(),$a=He(),Kn=Ar(),Ca=An(),Gn=X(),{configure:Na}=Cn(),{assertDefaultLevelFound:Ia,mappings:Hn,genLsCache:ja,genLevelComparison:Ba,assertLevelComparison:za}=dt(),{DEFAULT_LEVELS:Un,SORTING_ORDER:Da}=Oe(),{createArgsNormalizer:Fa,asChindings:Pa,buildSafeSonicBoom:zn,buildFormatters:qa,stringify:xt,normalizeDestFileDescriptor:Dn,noop:Ma}=_e(),{version:Va}=ht(),{chindingsSym:Fn,redactFmtSym:Wa,serializersSym:Pn,timeSym:Ka,timeSliceIndexSym:Ga,streamSym:Ha,stringifySym:qn,stringifySafeSym:_t,stringifiersSym:Mn,setLevelSym:Ua,endSym:Ja,formatOptsSym:Xa,messageKeySym:Ya,errorKeySym:Qa,nestedKeySym:Za,mixinSym:ec,levelCompSym:tc,useOnlyCustomLevelsSym:rc,formattersSym:Vn,hooksSym:nc,nestedKeyStrSym:ic,mixinMergeStrategySym:sc,msgPrefixSym:oc}=Gn,{epochTime:Jn,nullTime:lc}=Kn,{pid:ac}=process,cc=Ta.hostname(),uc=Wn.err,fc={level:"info",levelComparison:Da.ASC,levels:Un,messageKey:"msg",errorKey:"err",nestedKey:null,enabled:true,base:{pid:ac,hostname:cc},serializers:Object.assign(Object.create(null),{err:uc}),formatters:Object.assign(Object.create(null),{bindings(e){return e},level(e,t){return {level:t}}}),hooks:{logMethod:void 0,streamWrite:void 0},timestamp:Jn,name:void 0,redact:null,customLevels:null,useOnlyCustomLevels:false,depthLimit:5,edgeLimit:100},dc=Fa(fc),hc=Object.assign(Object.create(null),Wn);function Ot(...e){let t={},{opts:r,stream:n}=dc(t,ka(),...e);r.level&&typeof r.level=="string"&&Un[r.level.toLowerCase()]!==void 0&&(r.level=r.level.toLowerCase());let{redact:i,crlf:o,serializers:c,timestamp:a,messageKey:u,errorKey:d,nestedKey:h,base:l,name:g,level:f,customLevels:s,levelComparison:y,mixin:p,mixinMergeStrategy:w,useOnlyCustomLevels:b,formatters:S,hooks:v,depthLimit:x,edgeLimit:O,onChild:L,msgPrefix:R}=r,E=Na({maximumDepth:x,maximumBreadth:O}),A=qa(S.level,S.bindings,S.log),N=xt.bind({[_t]:E}),$=i?$a(i,N):{},j=i?{stringify:$[Wa]}:{stringify:N},B="}"+(o?`\r
`:`
`),K=Pa.bind(null,{[Fn]:"",[Pn]:c,[Mn]:$,[qn]:xt,[_t]:E,[Vn]:A}),Ae="";l!==null&&(g===void 0?Ae=K(l):Ae=K(Object.assign({},l,{name:g})));let It=a instanceof Function?a:a?Jn:lc,ui=It().indexOf(":")+1;if(b&&!s)throw Error("customLevels is required if useOnlyCustomLevels is set true");if(p&&typeof p!="function")throw Error(`Unknown mixin type "${typeof p}" - expected "function"`);if(R&&typeof R!="string")throw Error(`Unknown msgPrefix type "${typeof R}" - expected "string"`);Ia(f,s,b);let jt=Hn(s,b);typeof n.emit=="function"&&n.emit("message",{code:"PINO_CONFIG",config:{levels:jt,messageKey:u,errorKey:d}}),za(y);let fi=Ba(y);return Object.assign(t,{levels:jt,[tc]:fi,[rc]:b,[Ha]:n,[Ka]:It,[Ga]:ui,[qn]:xt,[_t]:E,[Mn]:$,[Ja]:B,[Xa]:j,[Ya]:u,[Qa]:d,[Za]:h,[ic]:h?`,${JSON.stringify(h)}:{`:"",[Pn]:c,[ec]:p,[sc]:w,[Fn]:Ae,[Vn]:A,[nc]:v,silent:Ma,onChild:L,[oc]:R}),Object.setPrototypeOf(t,Ca()),ja(t),t[Ua](f),t}z.exports=Ot;z.exports.destination=(e=process.stdout.fd)=>typeof e=="object"?(e.dest=Dn(e.dest||process.stdout.fd),zn(e)):zn({dest:Dn(e),minLength:0});z.exports.transport=ot();z.exports.multistream=Bn();z.exports.levels=Hn();z.exports.stdSerializers=hc;z.exports.stdTimeFunctions=Object.assign({},Kn);z.exports.symbols=Gn;z.exports.version=Va;z.exports.default=Ot;z.exports.pino=Ot;});var bi=({variant:e="primary",size:t="md",loading:r=false,children:n,className:i="",disabled:o,...c})=>{let a="inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",u={primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border border-gray-300 bg-transparent hover:bg-gray-50 focus:ring-gray-500",ghost:"bg-transparent hover:bg-gray-100 focus:ring-gray-500"},d={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"},h=[a,u[e],d[t],i].filter(Boolean).join(" ");return jsxRuntime.jsx("button",{className:h,disabled:o||r,...c,children:r?jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[jsxRuntime.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntime.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",className:"opacity-25"}),jsxRuntime.jsx("path",{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",className:"opacity-75"})]}),"Loading..."]}):n})};var re=zt(Lt());var Z={fatal:{value:60,name:"fatal",color:"magenta",symbol:"\u{1F480}",description:"\u041A\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043A\u0430\u044F \u043E\u0448\u0438\u0431\u043A\u0430, \u043F\u0440\u0438\u0432\u043E\u0434\u044F\u0449\u0430\u044F \u043A \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0438\u044E \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F"},error:{value:50,name:"error",color:"red",symbol:"\u274C",description:"\u041E\u0448\u0438\u0431\u043A\u0430, \u0442\u0440\u0435\u0431\u0443\u044E\u0449\u0430\u044F \u043D\u0435\u043C\u0435\u0434\u043B\u0435\u043D\u043D\u043E\u0433\u043E \u0432\u043D\u0438\u043C\u0430\u043D\u0438\u044F"},warn:{value:40,name:"warn",color:"yellow",symbol:"\u26A0\uFE0F",description:"\u041F\u0440\u0435\u0434\u0443\u043F\u0440\u0435\u0436\u0434\u0435\u043D\u0438\u0435 \u043E \u043F\u043E\u0442\u0435\u043D\u0446\u0438\u0430\u043B\u044C\u043D\u043E\u0439 \u043F\u0440\u043E\u0431\u043B\u0435\u043C\u0435"},info:{value:30,name:"info",color:"green",symbol:"\u2139\uFE0F",description:"\u041E\u0431\u0449\u0430\u044F \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F \u043E \u0440\u0430\u0431\u043E\u0442\u0435 \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F"},http:{value:29,name:"http",color:"cyan",symbol:"\u{1F310}",description:"HTTP \u0437\u0430\u043F\u0440\u043E\u0441\u044B \u0438 \u043E\u0442\u0432\u0435\u0442\u044B"},debug:{value:20,name:"debug",color:"blue",symbol:"\u{1F50D}",description:"\u041E\u0442\u043B\u0430\u0434\u043E\u0447\u043D\u0430\u044F \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F \u0434\u043B\u044F \u0440\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u043A\u0438"},trace:{value:10,name:"trace",color:"gray",symbol:"\u{1F52C}",description:"\u0414\u0435\u0442\u0430\u043B\u044C\u043D\u0430\u044F \u0442\u0440\u0430\u0441\u0441\u0438\u0440\u043E\u0432\u043A\u0430 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"},silent:{value:1/0,name:"silent",color:"white",symbol:"\u{1F507}",description:"\u041E\u0442\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u0435 \u0432\u0441\u0435\u0445 \u043B\u043E\u0433\u043E\u0432"}},Yn={err:"error",warning:"warn",information:"info",verbose:"debug",silly:"trace",off:"silent"},Qn=Object.fromEntries(Object.entries(Z).map(([e,t])=>[e,t.color])),Tt=Object.fromEntries(Object.entries(Z).map(([e,t])=>[e,t.value])),Zn=Object.keys(Z),Rt={development:{defaultLevel:"debug",console:{enabled:true,level:"debug",colorize:true,timestamp:true,prettyPrint:true},file:{enabled:true,level:"info",rotation:false},performance:{logSlowOperations:true,threshold:100}},test:{defaultLevel:"error",console:{enabled:false,level:"silent"},file:{enabled:true,level:"error",path:"./logs/test"},performance:{logSlowOperations:false}},staging:{defaultLevel:"info",console:{enabled:true,level:"warn",colorize:false,format:"json"},file:{enabled:true,level:"info",rotation:true,maxSize:"50m",maxFiles:"7d"},performance:{logSlowOperations:true,threshold:500}},production:{defaultLevel:"warn",console:{enabled:true,level:"error",colorize:false,format:"json"},file:{enabled:true,level:"info",rotation:true,maxSize:"100m",maxFiles:"30d",compress:true},performance:{logSlowOperations:true,threshold:1e3},security:{sanitizeHeaders:true,maskPasswords:true,auditLevel:"warn"}}},At={fatal:(e,t)=>`\u{1F480} FATAL: ${e} ${JSON.stringify(t)}`,error:(e,t)=>`\u274C ERROR: ${e} ${t?JSON.stringify(t):""}`,warn:(e,t)=>`\u26A0\uFE0F  WARN: ${e} ${t?JSON.stringify(t):""}`,info:(e,t)=>`\u2139\uFE0F  INFO: ${e}`,http:(e,t)=>`\u{1F310} HTTP: ${e}`,debug:(e,t)=>`\u{1F50D} DEBUG: ${e} ${t?JSON.stringify(t):""}`,trace:(e,t)=>`\u{1F52C} TRACE: ${e} ${t?JSON.stringify(t):""}`},mc={isError:e=>["fatal","error"].includes(e),isWarning:e=>e==="warn",isInfo:e=>["info","http"].includes(e),isDebug:e=>["debug","trace"].includes(e),isCritical:e=>["fatal","error","warn"].includes(e),isProduction:e=>["fatal","error","warn","info"].includes(e)},gc={fatal:{maxSize:"10m",maxFiles:"90d",compress:true},error:{maxSize:"50m",maxFiles:"30d",compress:true},warn:{maxSize:"100m",maxFiles:"14d",compress:true},info:{maxSize:"200m",maxFiles:"7d",compress:false},http:{maxSize:"500m",maxFiles:"3d",compress:false},debug:{maxSize:"100m",maxFiles:"1d",compress:false},trace:{maxSize:"50m",maxFiles:"6h",compress:false}},Xn={level:"info",levels:Tt,colors:Qn,environment:process.env.NODE_ENV||"development",getEnvironmentConfig(){return Rt[this.environment]||Rt.development},isLevelEnabled(e,t=this.level){let r=Z[e]?.value||0,n=Z[t]?.value||30;return r>=n},getFormatter(e){return At[e]||At.info},normalizeLevel(e){let t=e.toLowerCase();return Yn[t]||t}};typeof module<"u"&&module.exports&&(module.exports={LOG_LEVELS:Z,LEVEL_ALIASES:Yn,LEVEL_COLORS:Qn,LEVEL_VALUES:Tt,LEVEL_METHODS:Zn,ENVIRONMENT_CONFIGS:Rt,LEVEL_FORMATTERS:At,LEVEL_PREDICATES:mc,ROTATION_CONFIG:gc,DEFAULT_CONFIG:Xn,default:Xn});var ei={level:process.env.LOG_LEVEL||"info",service:process.env.SERVICE_NAME||"heys-app",environment:process.env.NODE_ENV||"development",transports:{console:{enabled:process.env.LOG_CONSOLE!=="false",pretty:process.env.NODE_ENV!=="production",colorize:process.env.NODE_ENV!=="production"},file:{enabled:process.env.LOG_FILE==="true"||process.env.NODE_ENV==="production",path:process.env.LOG_PATH||"./logs",maxSize:process.env.LOG_MAX_SIZE||"10MB",maxFiles:parseInt(process.env.LOG_MAX_FILES||"5"),compress:process.env.LOG_COMPRESS==="true"},network:{enabled:process.env.LOG_NETWORK==="true",url:process.env.LOG_NETWORK_URL?process.env.LOG_NETWORK_URL:void 0,apiKey:process.env.LOG_API_KEY?process.env.LOG_API_KEY:void 0}},redact:["password","token","secret","authorization","cookie","session","apiKey","accessToken","refreshToken"],sampling:{enabled:process.env.LOG_SAMPLING==="true",rate:parseFloat(process.env.LOG_SAMPLING_RATE||"0.1")},performance:{enabled:process.env.LOG_PERFORMANCE==="true",threshold:parseInt(process.env.LOG_PERFORMANCE_THRESHOLD||"1000")}};function ti(e){let t={...ei,...e};return Object.values(kt).includes(t.level)||(t.level="info"),t.transports.file.enabled&&!t.transports.file.path&&(t.transports.file.path="./logs"),t.transports.network.enabled&&!t.transports.network.url&&(t.transports.network.enabled=false),t}var ee=zt(Lt());var $t=e=>e==="silent"?null:e==="http"?"info":e;function ii(e){let t=[];if(e.transports.console.enabled){let r=$t(e.level);r!==null&&(e.transports.console.pretty?t.push({level:r,stream:ee.default.transport({target:"pino-pretty",options:{colorize:e.transports.console.colorize,ignore:"pid,hostname",translateTime:"SYS:yyyy-mm-dd HH:MM:ss.l",messageFormat:`[${e.service}] {msg}`,sync:false}})}):t.push({level:r,stream:process.stdout}));}if(e.transports.file.enabled){pc(e.transports.file.path);let r=$t(e.level);r!==null&&t.push({level:r,stream:ee.default.destination({dest:ni__default.default.join(e.transports.file.path,`${e.service}.log`),sync:false,mkdir:true})}),t.push({level:"error",stream:ee.default.destination({dest:ni__default.default.join(e.transports.file.path,`${e.service}.error.log`),sync:false,mkdir:true})});}if(e.transports.network.enabled&&e.transports.network.url){let r=$t(e.level);r!==null&&t.push({level:r,stream:ee.default.transport({target:"@axiomhq/pino",options:{url:e.transports.network.url,apiKey:e.transports.network.apiKey,dataset:e.service}})});}return t}function pc(e){try{ri__default.default.existsSync(e)||ri__default.default.mkdirSync(e,{recursive:!0});}catch{}}function si(e){return {level:t=>({level:t}),bindings:t=>({service:e.service,environment:e.environment,version:process.env.npm_package_version||"1.0.0",...t}),log:t=>({...t,"@timestamp":new Date().toISOString(),"@version":"1"})}}function oi(){return {...ee.default.stdSerializers}}var kt=(u=>(u.TRACE="trace",u.DEBUG="debug",u.INFO="info",u.HTTP="http",u.WARN="warn",u.ERROR="error",u.FATAL="fatal",u.SILENT="silent",u))(kt||{});function yc(e={}){let t=ti(e),r=ii(t),n=si(t),i=oi(),o={level:t.level,base:{service:t.service,environment:t.environment,version:process.env.npm_package_version||"1.0.0"},timestamp:re.default.stdTimeFunctions.isoTime,formatters:n,serializers:i,redact:{paths:t.redact,censor:"[REDACTED]"}};return r.length>1?(0, re.default)(o,re.default.multistream(r)):r.length===1&&r[0]?(0, re.default)(o,r[0].stream):(0, re.default)(o)}var te=yc({service:"heys-system",level:process.env.LOG_LEVEL||"info"});var li={trace:(e,t)=>te.trace(t,e),debug:(e,t)=>te.debug(t,e),info:(e,t)=>te.info(t,e),warn:(e,t)=>te.warn(t,e),error:(e,t)=>te.error(t,e),fatal:(e,t)=>te.fatal(t,e)};var Sc={error(e,t){if(typeof window<"u"){let r=window.HEYS?.logger;if(r?.error){r.error(t??{},e);return}}try{li.error(e,t??{});}catch{typeof globalThis<"u"&&globalThis.console?.error&&globalThis.console.error(`[ui-security] ${e}`,t);}}},Le=({value:e,onChange:t,type:r="text",placeholder:n,required:i=false,maxLength:o,sanitize:c=true,validateOnChange:a=true,className:u,"data-testid":d})=>{let h=ne.useCallback(l=>{let g=l.target.value;if(a){let f="text";r==="email"?f="email":r==="password"&&(f="password");let s=shared.defaultValidator.validateInput(g,f,{required:i,sanitize:c});if(!s.isValid&&i)return;g=s.sanitized||g;}t(g);},[t,r,i,c,a]);return jsxRuntime.jsx("input",{type:r,value:e,onChange:h,placeholder:n,maxLength:o,required:i,className:u,"data-testid":d})},Re=({content:e,allowHtml:t=false,maxLength:r,className:n,"data-testid":i})=>{let o=ne.useMemo(()=>shared.defaultValidator.validateInput(e,"html",{sanitize:true}).sanitized||e,[e]);return t?jsxRuntime.jsx("div",{className:n,"data-testid":i,dangerouslySetInnerHTML:{__html:o}}):jsxRuntime.jsx("div",{className:n,"data-testid":i,children:o})},wc=({onSubmit:e,children:t,validationSchema:r,className:n,"data-testid":i})=>{let o=ne.useCallback(async c=>{c.preventDefault();let a=new FormData(c.currentTarget),u={};for(let[d,h]of a.entries())u[d]=h;if(r){let d=await shared.defaultValidator.validateSchema(u,r,{sanitize:true,strictMode:true});if(!d.isValid)throw new shared.SecurityError("Form validation failed",d.errors);d.sanitized&&typeof d.sanitized=="object"&&Object.assign(u,d.sanitized);}await e(u);},[e,r]);return jsxRuntime.jsx("form",{onSubmit:o,className:n,"data-testid":i,children:t})},wu=({user:e,onUpdate:t,editable:r=false,className:n})=>{let[i,o]=ne__default.default.useState(false),[c,a]=ne__default.default.useState(e),u=ne.useCallback(async()=>{if(!t)return;let d=await shared.defaultValidator.validateSchema(c,shared.ValidationSchemas.user,{sanitize:true,strictMode:true});if(!d.isValid)throw new shared.SecurityError("User profile validation failed",d.errors);await t(d.sanitized||c),o(false);},[c,t]);return !r||!i?jsxRuntime.jsxs("div",{className:n,"data-testid":"user-profile",children:[jsxRuntime.jsx("div",{"data-testid":"user-email",children:jsxRuntime.jsx(Re,{content:e.email})}),jsxRuntime.jsx("div",{"data-testid":"user-username",children:jsxRuntime.jsx(Re,{content:e.username})}),e.bio&&jsxRuntime.jsx("div",{"data-testid":"user-bio",children:jsxRuntime.jsx(Re,{content:e.bio,maxLength:500})}),r&&jsxRuntime.jsx("button",{onClick:()=>o(true),"data-testid":"edit-profile-button",children:"Edit Profile"})]}):jsxRuntime.jsx("div",{className:n,"data-testid":"user-profile-edit",children:jsxRuntime.jsxs(wc,{onSubmit:u,validationSchema:shared.ValidationSchemas.user,"data-testid":"profile-form",children:[jsxRuntime.jsx(Le,{value:c.email,onChange:d=>a(h=>({...h,email:d})),type:"email",placeholder:"Email",required:true,"data-testid":"email-input"}),jsxRuntime.jsx(Le,{value:c.username,onChange:d=>a(h=>({...h,username:d})),type:"text",placeholder:"Username",required:true,maxLength:50,"data-testid":"username-input"}),jsxRuntime.jsx(Le,{value:c.bio||"",onChange:d=>a(h=>({...h,bio:d})),type:"text",placeholder:"Bio",maxLength:500,"data-testid":"bio-input"}),jsxRuntime.jsx("button",{type:"submit","data-testid":"save-button",children:"Save"}),jsxRuntime.jsx("button",{type:"button",onClick:()=>o(false),"data-testid":"cancel-button",children:"Cancel"})]})})},vc=e=>typeof e.title=="string"?e.title:typeof e.name=="string"?e.name:typeof e.label=="string"?e.label:JSON.stringify(e),vu=({onSearch:e,placeholder:t="Search...",debounceMs:r=300,maxLength:n=100,className:i})=>{let[o,c]=ne__default.default.useState(""),[a,u]=ne__default.default.useState([]),[d,h]=ne__default.default.useState(false);return ne__default.default.useEffect(()=>{if(!o.trim()){u([]);return}let l=setTimeout(async()=>{h(true);try{let g=shared.defaultValidator.validateInput(o,"text",{sanitize:!0,required:!0});if(g.isValid){let f=g.sanitized||o,s=await e(f);u(s);}}catch(g){Sc.error("SecureSearch query failed",{error:g,query:o}),u([]);}finally{h(false);}},r);return ()=>clearTimeout(l)},[o,e,r]),jsxRuntime.jsxs("div",{className:i,"data-testid":"secure-search",children:[jsxRuntime.jsx(Le,{value:o,onChange:c,type:"text",placeholder:t,maxLength:n,"data-testid":"search-input"}),d&&jsxRuntime.jsx("div",{"data-testid":"search-loading",children:"Loading..."}),jsxRuntime.jsx("div",{"data-testid":"search-results",children:a.map((l,g)=>{let f=l,s=f.id??g,y=vc(f);return jsxRuntime.jsx("div",{"data-testid":`search-result-${g}`,children:jsxRuntime.jsx(Re,{content:y})},s)})})]})};

exports.Button = bi;
exports.SecureContent = Re;
exports.SecureForm = wc;
exports.SecureInput = Le;
exports.SecureSearch = vu;
exports.SecureUserProfile = wu;
//# sourceMappingURL=out.js.map
//# sourceMappingURL=index.cjs.map