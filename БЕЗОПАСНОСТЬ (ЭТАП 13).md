# üîí –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–´–ô –ü–õ–ê–ù –°–ü–†–ò–ù–¢–ê: –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ (–≠–¢–ê–ü 13)

## 1. –¶–ï–õ–ò –°–ü–†–ò–ù–¢–ê

1. **–í–Ω–µ–¥—Ä–∏—Ç—å –±–∞–∑–æ–≤—É—é JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é** –¥–ª—è 80% –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
2. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å RLS –ø–æ–ª–∏—Ç–∏–∫–∏** –≤ Supabase –¥–ª—è –¢–û–ü-5 —Ç–∞–±–ª–∏—Ü —Å PII –¥–∞–Ω–Ω—ã–º–∏
3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±–∞–∑–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
4. **–ü—Ä–æ–≤–µ—Å—Ç–∏ SAST –∞–Ω–∞–ª–∏–∑** –∏ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ (P0-P1)
5. **–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è Penetration Testing** (–∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ä–µ–¥–∞)

## 2. –ó–ê–î–ê–ß–ò –° –ü–†–ò–û–†–ò–¢–ò–ó–ê–¶–ò–ï–ô

### üî¥ –ö–†–ò–¢–ò–ß–ù–´–ï (–ù–ï–î–ï–õ–Ø 1)
- **–ê—É–¥–∏—Ç —Ç–µ–∫—É—â–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** (—Å–ª–æ–∂–Ω–æ—Å—Ç—å: 3) ‚Äî –≤—ã—è–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- **Basic JWT auth middleware** (—Å–ª–æ–∂–Ω–æ—Å—Ç—å: 3) ‚Äî JWT –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- **Input validation core** (—Å–ª–æ–∂–Ω–æ—Å—Ç—å: 3) ‚Äî –±–∞–∑–æ–≤–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –∏–Ω—ä–µ–∫—Ü–∏–π
- **RLS –¥–ª—è users/profiles —Ç–∞–±–ª–∏—Ü** (—Å–ª–æ–∂–Ω–æ—Å—Ç—å: 4) ‚Äî –±–∞–∑–æ–≤—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏

### üü† –í–ê–ñ–ù–´–ï (–ù–ï–î–ï–õ–Ø 1-2)
- **–ü—Ä–æ—Å—Ç–æ–π Rate limiting** (—Å–ª–æ–∂–Ω–æ—Å—Ç—å: 2) ‚Äî –±–∞–∑–æ–≤–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç DoS
- **–ë–∞–∑–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** (—Å–ª–æ–∂–Ω–æ—Å—Ç—å: 3) ‚Äî —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- **SAST –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ CI/CD** (—Å–ª–æ–∂–Ω–æ—Å—Ç—å: 3) ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è security-–ø—Ä–æ–≤–µ—Ä–æ–∫
- **XSS –∑–∞—â–∏—Ç–∞ —Å helmet.js** (—Å–ª–æ–∂–Ω–æ—Å—Ç—å: 2) ‚Äî –±–∞–∑–æ–≤—ã–µ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### üü° –ñ–ï–õ–ê–¢–ï–õ–¨–ù–´–ï (–ù–ï–î–ï–õ–Ø 2)
- **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ Penetration Testing** (—Å–ª–æ–∂–Ω–æ—Å—Ç—å: 3) ‚Äî –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ä–µ–¥–∞
- **Proof-of-concept —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** (—Å–ª–æ–∂–Ω–æ—Å—Ç—å: 3) ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –ø–æ–ª–µ–π
- **Security dashboard MVP** (—Å–ª–æ–∂–Ω–æ—Å—Ç—å: 2) ‚Äî –ø—Ä–æ—Å—Ç–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- –ê—É–¥–∏—Ç ‚Üí JWT auth ‚Üí Security logging
- –ê—É–¥–∏—Ç ‚Üí RLS –ø–æ–ª–∏—Ç–∏–∫–∏ ‚Üí Proof-of-concept —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- SAST –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ‚Üí Penetration Testing –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞

## 3. –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ô –ú–ê–†–®–†–£–¢

### üìÅ –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã (—Ñ–æ–∫—É—Å –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ-–Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ)
```
apps/web/src/
‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îú‚îÄ‚îÄ auth.ts            üÜï JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–ë–ê–ó–û–í–ê–Ø)
‚îÇ   ‚îî‚îÄ‚îÄ security.ts        üÜï XSS/CSRF –∑–∞—â–∏—Ç–∞ (helmet.js)
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ validator.ts       üÜï –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ security-logger.ts üÜï –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

supabase/migrations/
‚îî‚îÄ‚îÄ 20250905-basic-rls.sql üÜï RLS –ø–æ–ª–∏—Ç–∏–∫–∏ (–¢–û–õ–¨–ö–û –¢–û–ü-5 —Ç–∞–±–ª–∏—Ü)

.github/workflows/
‚îî‚îÄ‚îÄ security-scan.yml      üÜï SAST —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
```

### üì¶ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫
- `jsonwebtoken`, `helmet`, `express-validator`
- `@supabase/supabase-js` (—Ç–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è)
- `winston` (–¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è)
- `eslint-plugin-security` (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞)

## 4. –ö–û–ù–¢–†–û–õ–¨–ù–´–ï –¢–û–ß–ö–ò (–£–õ–£–ß–®–ï–ù–û)

### üìå –ö–¢1: –ê—É–¥–∏—Ç –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–î–µ–Ω—å 3)
- ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω –∞—É–¥–∏—Ç —Ç–µ–∫—É—â–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ü–µ–ª–∏ –∏ –º–µ—Ç—Ä–∏–∫–∏
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω —Å–ø–∏—Å–æ–∫ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

### üìå –ö–¢2: –ë–∞–∑–æ–≤–∞—è –∑–∞—â–∏—Ç–∞ API (–î–µ–Ω—å 7)
- ‚úÖ JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –¢–û–ü-10 API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- ‚úÖ Input validation –¥–ª—è –≤—Å–µ—Ö public POST/PUT API
- ‚úÖ –ë–∞–∑–æ–≤—ã–µ HTTP Security Headers (helmet.js)

### üìå –ö–¢3: Supabase Security (–î–µ–Ω—å 10)
- ‚úÖ RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è users/profiles —Ç–∞–±–ª–∏—Ü
- ‚úÖ –î–µ–º–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è 1-2 —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
- ‚úÖ –¢–µ—Å—Ç—ã –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º

### üìå –ö–¢4: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–î–µ–Ω—å 14)
- ‚úÖ SAST –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º P0-P1 —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –ë–∞–∑–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –±—É–¥—É—â–µ–≥–æ Penetration Testing

## 5. –†–ò–°–ö–ò –ò –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–´

### ‚ö†Ô∏è –£—Ç–æ—á–Ω–µ–Ω–Ω—ã–µ —Ä–∏—Å–∫–∏
- **JWT –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ** –º–æ–∂–µ—Ç –Ω–∞—Ä—É—à–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–µ—Å—Å–∏–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
  - _–ü–ª–∞–Ω –ë_: Dual-mode —Å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–º –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∏ backward compatibility
  
- **RLS –ø–æ–ª–∏—Ç–∏–∫–∏** –º–æ–≥—É—Ç —Å–ª–∏—à–∫–æ–º –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∏ —Å–ª–æ–º–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
  - _–ü–ª–∞–Ω –ë_: –ü–æ—ç—Ç–∞–ø–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –∏ –±—ã—Å—Ç—Ä—ã–º rollback
  
- **SAST —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –¥–ª—è –æ–¥–Ω–æ–≥–æ —Å–ø—Ä–∏–Ω—Ç–∞
  - _–ü–ª–∞–Ω –ë_: –§–æ–∫—É—Å —Ç–æ–ª—å–∫–æ –Ω–∞ P0-P1, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥

### üîÑ –°—Ç—Ä–∞—Ç–µ–≥–∏—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ** –¥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤ production
- **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ security changes** –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º security changelog
- **–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å rollback plan** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ security –∏–∑–º–µ–Ω–µ–Ω–∏—è
- **Incremental deployment** —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –º–µ—Ç—Ä–∏–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## 6. –ú–ï–¢–†–ò–ö–ò –£–°–ü–ï–•–ê

- **JWT –æ—Ö–≤–∞—Ç:** ‚â•80% –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- **RLS –ø–æ–∫—Ä—ã—Ç–∏–µ:** 100% –¥–ª—è –¢–û–ü-5 —Ç–∞–±–ª–∏—Ü —Å PII –¥–∞–Ω–Ω—ã–º–∏
- **SAST –º–µ—Ç—Ä–∏–∫–∏:** 0 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö (P0-P1) —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –ø–æ—Å–ª–µ —Å–ø—Ä–∏–Ω—Ç–∞
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:** 100% public POST/PUT endpoints
- **Security logging:** –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ 100% auth/user/admin –æ–ø–µ—Ä–∞—Ü–∏–π

## 7. –û–ë–£–ß–ï–ù–ò–ï –ò –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

- **–ö—Ä–∞—Ç–∫–∏–π security guide** –¥–ª—è –≤—Å–µ–π –∫–æ–º–∞–Ω–¥—ã (2-3 —Å—Ç—Ä–∞–Ω–∏—Ü—ã)
- **JWT cheatsheet** –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ API
- **RLS –ø—Ä–∏–º–µ—Ä—ã** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏
- **–ß–µ–∫-–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** –¥–ª—è code review

---

**–ò–¢–û–ì:** –ü–ª–∞–Ω —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω –Ω–∞ –¥–æ—Å—Ç–∏–∂–∏–º—ã—Ö, –≤—ã—Å–æ–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö —Å —è—Å–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ —É—Å–ø–µ—Ö–∞. –í–º–µ—Å—Ç–æ –ø–æ–ø—ã—Ç–∫–∏ —Ä–µ—à–∏—Ç—å –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å—Ä–∞–∑—É, —Å–ø—Ä–∏–Ω—Ç –∑–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç –ø—Ä–æ—á–Ω—ã–π —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ –∑–∞—â–∏—Ç—É –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏ API.