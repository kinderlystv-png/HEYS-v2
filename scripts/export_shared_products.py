# -*- coding: utf-8 -*-
import json
import sys

# Загружаем сырые данные
with open('/tmp/heys_shared_products_raw.json', 'r', encoding='utf-8') as f:
    products = json.load(f)

# Словарь с описаниями полей
field_descriptions = {
    "id": "Уникальный идентификатор продукта (UUID)",
    "name": "Название продукта",
    
    "simple100": "Простые углеводы (сахара) на 100г, граммы",
    "complex100": "Сложные углеводы на 100г, граммы",
    "protein100": "Белок на 100г, граммы",
    "badFat100": "Насыщенные (вредные) жиры на 100г, граммы",
    "goodFat100": "Ненасыщенные (полезные) жиры на 100г, граммы",
    "trans100": "Транс-жиры на 100г, граммы (самые вредные)",
    "fiber100": "Клетчатка на 100г, граммы",
    "gi": "Гликемический индекс (0-100). Низкий <55, средний 55-70, высокий >70",
    "harm": "Индекс вредности (0-10). 0=суперполезный, 10=супервредный. Формула учитывает транс-жиры, сахар, насыщенные жиры vs клетчатку, белок",
    "category": "Категория продукта (молочные, мясо, овощи и т.д.)",
    "portions": "Порции продукта в формате JSON [{name: '1 шт', grams: 50}]",
    
    "sodium100": "Натрий (соль) на 100г, миллиграммы. Норма <2000мг/день. Избыток вызывает гипертензию",
    "nova_group": "NOVA классификация переработки (1-4). 1=натуральный, 2=кулинарный ингредиент, 3=переработанный, 4=ультрапереработанный (вредно!)",
    
    "vitamin_a": "Витамин A, % от суточной нормы. Зрение, иммунитет",
    "vitamin_c": "Витамин C, % от суточной нормы. Иммунитет, антиоксидант",
    "vitamin_d": "Витамин D, % от суточной нормы. Кости, иммунитет",
    "vitamin_e": "Витамин E, % от суточной нормы. Антиоксидант",
    "vitamin_k": "Витамин K, % от суточной нормы. Свёртываемость крови",
    "vitamin_b1": "Витамин B1 (тиамин), % от суточной нормы. Энергетический метаболизм",
    "vitamin_b2": "Витамин B2 (рибофлавин), % от суточной нормы. Метаболизм",
    "vitamin_b3": "Витамин B3 (ниацин), % от суточной нормы. Энергия, нервная система",
    "vitamin_b6": "Витамин B6 (пиридоксин), % от суточной нормы. Белковый метаболизм",
    "vitamin_b9": "Витамин B9 (фолат), % от суточной нормы. Кроветворение, беременность",
    "vitamin_b12": "Витамин B12 (кобаламин), % от суточной нормы. Нервная система, кровь",
    
    "calcium": "Кальций, % от суточной нормы. Кости, зубы",
    "iron": "Железо, % от суточной нормы. Кровь, энергия",
    "magnesium": "Магний, % от суточной нормы. Мышцы, нервы, сон",
    "phosphorus": "Фосфор, % от суточной нормы. Кости, энергия",
    "potassium": "Калий, % от суточной нормы. Сердце, давление",
    "zinc": "Цинк, % от суточной нормы. Иммунитет, кожа",
    "selenium": "Селен, % от суточной нормы. Антиоксидант, щитовидка",
    "iodine": "Йод, % от суточной нормы. Щитовидная железа",
    
    "is_organic": "Органический продукт (true/false). Без пестицидов и ГМО",
    "is_whole_grain": "Цельнозерновой (true/false). Из цельного зерна, больше клетчатки",
    "is_fermented": "Ферментированный (true/false). Квашеный, содержит пробиотики",
    "is_raw": "Сырой/необработанный термически (true/false)"
}

# Формируем итоговую структуру
output = {
    "_meta": {
        "description": "Экспорт продуктов из общей базы HEYS для проверки и корректировки ИИ",
        "total_products": len(products),
        "export_date": "2026-01-18",
        "field_descriptions": field_descriptions
    },
    "products": products
}

# Сохраняем с форматированием
output_path = '/Users/poplavskijanton/HEYS-v2/heys_shared_products_export.json'
with open(output_path, 'w', encoding='utf-8') as f:
    json.dump(output, f, ensure_ascii=False, indent=2)

print(f"Exported {len(products)} products to {output_path}")
