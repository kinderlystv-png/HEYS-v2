# Mobile UX Improvement Plan (Option B)

**–¶–ï–õ–¨**: –°–æ–∑–¥–∞—Ç—å –∫—Ä—É—Ç—É—é —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—É—é –º–æ–±–∏–ª—å–Ω—É—é –≤–µ–±-–≤–µ—Ä—Å–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è HEYS v12,
—Å–æ—Ö—Ä–∞–Ω–∏–≤ –≤—Å—é —Ç–µ–∫—É—â—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∏ —É–ª—É—á—à–∏–≤ UX –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤.

## üéØ –ì–ª–∞–≤–Ω—ã–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã

1.  **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ù–ï –õ–û–ú–ê–¢–¨ —Ä–∞–±–æ—Ç–∞—é—â—É—é –ª–æ–≥–∏–∫—É (`window.HEYS.*`,
    localStorage, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å Supabase).
2.  **Mobile-First UX**: –°–≤–∞–π–ø—ã, Pull-to-Refresh, —É–¥–æ–±–Ω—ã–µ –∂–µ—Å—Ç—ã.
3.  **Touch-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –†–∞–∑–º–µ—Ä—ã —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –ø–∞–ª—å—Ü–µ–≤ (–º–∏–Ω–∏–º—É–º 44x44px).
4.  **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –ü–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤ (–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è
    –µ—Å–ª–∏ >50 —ç–ª–µ–º–µ–Ω—Ç–æ–≤).
5.  **Responsive**: –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã —ç–∫—Ä–∞–Ω–æ–≤ (–æ—Ç 320px –¥–æ desktop).
6.  **Zero new deps**: –ù–µ –ø–æ–¥–∫–ª—é—á–∞–µ–º –Ω–æ–≤—ã—Ö CDN/–±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ –Ω–µ —Ç—Ä–æ–≥–∞–µ–º –∫–æ–Ω—Ñ–∏–≥–∏
    —Å–±–æ—Ä–∫–∏, —á—Ç–æ–±—ã –∏—Å–∫–ª—é—á–∏—Ç—å —Å–∫—Ä—ã—Ç—ã–µ —Ä–∏—Å–∫–∏.

---

## ‚ö†Ô∏è –£–†–û–í–ï–ù–¨ –í–ú–ï–®–ê–¢–ï–õ–¨–°–¢–í–ê –ò –ü–†–ò–û–†–ò–¢–ï–¢–´

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–∑—ã (MUST HAVE)

- **Phase 1** ‚Äî Structural Refactoring (–≤—ã–Ω–æ—Å –∫–æ–¥–∞ –∏–∑ HTML)
  - **–†–∏—Å–∫**: –ù–∏–∑–∫–∏–π. –¢–æ–ª—å–∫–æ –ø–µ—Ä–µ–Ω–æ—Å, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏.
  - **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ß–∏—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö —É–ª—É—á—à–µ–Ω–∏–π.
  - **–ú–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å**: –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –±—ã—Å—Ç—Ä–µ–µ —É–≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –Ω–∞—á–Ω–∏ —Å—Ä–∞–∑—É —Å
    Phase 2.

- **Phase 2** ‚Äî Mobile UX Foundation (CSS —É–ª—É—á—à–µ–Ω–∏—è)
  - **–†–∏—Å–∫**: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π. –¢–æ–ª—å–∫–æ —Å—Ç–∏–ª–∏, –Ω–µ —Ç—Ä–æ–≥–∞–µ–º JS.
  - **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –£–¥–æ–±–Ω—ã–µ touch targets, –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –º–∞–ª–µ–Ω—å–∫–∏–µ —ç–∫—Ä–∞–Ω—ã.
  - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ú–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ü–ï–†–í–û–ô (–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç Phase 1), —Ç–∞–∫ –∫–∞–∫ CSS
    –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ.

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ñ–∞–∑—ã (NICE TO HAVE)

- **Phase 3** ‚Äî Navigation & Interaction (—Å–≤–∞–π–ø—ã, pull-to-refresh)
  - **–†–∏—Å–∫**: –°—Ä–µ–¥–Ω–∏–π. –í–æ–∑–º–æ–∂–Ω—ã –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å–æ —Å–∫—Ä–æ–ª–ª–æ–º.
  - **–£—Å–ª–æ–≤–∏–µ**: –î–µ–ª–∞—Ç—å –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –ø–æ—Å–ª–µ Phase 2 UX –≤—Å—ë –µ—â—ë –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
    —É–¥–æ–±–µ–Ω.
  - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ù–∞—á–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–æ —Å–≤–∞–π–ø–æ–≤ (–®–∞–≥ 3.1), Pull-to-Refresh
    –æ—Ç–ª–æ–∂–∏—Ç—å.

- **Phase 4** ‚Äî Performance & Polish (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏)
  - **–†–∏—Å–∫**: –°—Ä–µ–¥–Ω–∏–π-–í—ã—Å–æ–∫–∏–π (–ø—Ä–∏ –Ω–µ–∞–∫–∫—É—Ä–∞—Ç–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏).
  - **–£—Å–ª–æ–≤–∏–µ**: –î–µ–ª–∞—Ç—å –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –µ—Å—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –ª–∞–≥–∏ –∏–ª–∏ UX-–ø—Ä–æ–±–ª–µ–º—ã –ø–æ—Å–ª–µ
    –∑–∞–º–µ—Ä–æ–≤.
  - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ú–∞–∫—Å–∏–º—É–º ‚Äî ¬´Load More¬ª –∫–Ω–æ–ø–∫–∞. –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—é –∏ collapse
    –æ—Ç–ª–æ–∂–∏—Ç—å.

### üõë –¢–û–ß–ö–ê –ü–†–ò–ù–Ø–¢–ò–Ø –†–ï–®–ï–ù–ò–Ø

**–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è Phase 2** ‚Äî –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º
—Ç–µ–ª–µ—Ñ–æ–Ω–µ:

‚úÖ **–ï—Å–ª–∏ UX –∫–æ–º—Ñ–æ—Ä—Ç–Ω—ã–π** –∏ —ç–ª–µ–º–µ–Ω—Ç—ã —É–¥–æ–±–Ω–æ –Ω–∞–∂–∏–º–∞—Ç—å:

- Phase 3 –∏ 4 –º–æ–∂–Ω–æ **–æ—Ç–ª–æ–∂–∏—Ç—å** –∏–ª–∏ —Å–¥–µ–ª–∞—Ç—å —á–∞—Å—Ç–∏—á–Ω–æ.
- –°—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ –±–∞–≥—Ñ–∏–∫—Å–∞—Ö.

‚ö†Ô∏è **–ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã**:

- –¢—è–∂–µ–ª–æ –ø–æ–ø–∞—Å—Ç—å –ø–æ —ç–ª–µ–º–µ–Ω—Ç–∞–º ‚Üí –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å Phase 2 (—É–≤–µ–ª–∏—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä—ã –µ—â—ë).
- –ù–µ—É–¥–æ–±–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –≤–∫–ª–∞–¥–∫–∏ ‚Üí –≤–∑—è—Ç—å –∏–∑ Phase 3 —Ç–æ–ª—å–∫–æ —Å–≤–∞–π–ø—ã (–®–∞–≥ 3.1).
- –ó–∞–º–µ—Ç–Ω—ã –ª–∞–≥–∏ –Ω–∞ —Å–ø–∏—Å–∫–∞—Ö ‚Üí –≤–∑—è—Ç—å –∏–∑ Phase 4 —Ç–æ–ª—å–∫–æ ¬´Load More¬ª (–®–∞–≥ 4.1,
  –†–µ—à–µ–Ω–∏–µ A).

---

## üîç –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ê–£–î–ò–¢ (–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º)

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**:

- **Entry Point**: `index.html` (1170 —Å—Ç—Ä–æ–∫) —Å–æ–¥–µ—Ä–∂–∏—Ç inline-—Å–∫—Ä–∏–ø—Ç —Å –∫–æ—Ä–Ω–µ–≤—ã–º
  –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º `App`.
- **Business Logic**:
  - `heys_core_v12.js` (869 —Å—Ç—Ä–æ–∫) ‚Äî –ø–∞—Ä—Å–∏–Ω–≥ –ø—Ä–æ–¥—É–∫—Ç–æ–≤, –ø–æ–∏—Å–∫, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
    `Ration`.
  - `heys_day_v12.js` (1276 —Å—Ç—Ä–æ–∫) ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–Ω—è, –ø—Ä–∏—ë–º—ã –ø–∏—â–∏, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏,
    –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `DayTab`.
  - `heys_user_v12.js` (295 —Å—Ç—Ä–æ–∫) ‚Äî –ø—Ä–æ—Ñ–∏–ª—å, HR-–∑–æ–Ω—ã, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `UserTab`.
  - `heys_reports_v12.js` ‚Äî –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å –∑–∞ –ø–µ—Ä–∏–æ–¥.
  - `heys_storage_supabase_v1.js` (494 —Å—Ç—Ä–æ–∫–∏) ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å Supabase.
- **State Management**:
  - `window.HEYS.currentClientId` ‚Äî –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∏–µ–Ω—Ç (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ –≤—Å–µ—Ö
    –º–æ–¥—É–ª—è—Ö).
  - `window.HEYS.saveClientKey()` ‚Äî –æ–±—ë—Ä—Ç–∫–∞ –¥–ª—è –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ Supabase.
  - `window.HEYS.utils.lsGet/lsSet` ‚Äî localStorage —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º namespace –ø–æ
    –∫–ª–∏–µ–Ω—Ç—É.
  - `window.HEYS.cloud.*` ‚Äî –º–µ—Ç–æ–¥—ã –æ–±–ª–∞—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.

**Mobile-–∞–¥–∞–ø—Ç–∞—Ü–∏—è (—Ç–µ–∫—É—â–∞—è)**:

- **Viewport**:
  `<meta name="viewport" content="width=device-width, initial-scale=1.0">`
  (–±–∞–∑–æ–≤—ã–π).
- **CSS Media Queries**: –ï—Å—Ç—å 3 –±—Ä–µ–π–∫–ø–æ–∏–Ω—Ç–∞ (1400px, 1200px, 840px), –Ω–æ —Ñ–æ–∫—É—Å –Ω–∞
  desktop.
- **Touch Targets**: `.btn` –∏–º–µ–µ—Ç `padding: 6px 10px` ‚Äî –°–õ–ò–®–ö–û–ú –ú–ê–õ–û (–Ω—É–∂–Ω–æ
  –º–∏–Ω–∏–º—É–º 44px –≤—ã—Å–æ—Ç–∞).
- **Tabs**: `.tab` –∏–º–µ–µ—Ç `padding: 8px 14px` ‚Äî –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —Ç–∞–ø–∞.
- **–ù–µ—Ç –∂–µ—Å—Ç–æ–≤**: –°–≤–∞–π–ø—ã, Pull-to-Refresh –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç.

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**:

- **–°–ø–∏—Å–∫–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤**: –†–µ–Ω–¥–µ—Ä—è—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é (–Ω–µ—Ç –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏). –ü—Ä–∏ >100
  –ø—Ä–æ–¥—É–∫—Ç–∞—Ö –±—É–¥—É—Ç –ª–∞–≥–∏ –Ω–∞ —Å–ª–∞–±—ã—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–∞—Ö.
- **–¢–∞–±–ª–∏—Ü—ã –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏**: –ú–Ω–æ–≥–æ input-–ø–æ–ª–µ–π –≤ `heys_day_v12.js`, —Ä–µ–Ω–¥–µ—Ä
  —Ç—è–∂—ë–ª—ã–π.

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∏—Å–∫–∏**:

1. ‚ö†Ô∏è **–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –í—Å—è –ª–æ–≥–∏–∫–∞ –∑–∞–≤—è–∑–∞–Ω–∞ –Ω–∞ `window.HEYS.*`. –ü—Ä–∏
   —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ –ù–ï–õ–¨–ó–Ø –∏—Ö —Ç–µ—Ä—è—Ç—å.
2. ‚ö†Ô∏è **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**: `cloud.bootstrapClientSync()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ
   –∫–ª–∏–µ–Ω—Ç–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –ù—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —ç—Ç–∏ –≤—ã–∑–æ–≤—ã.
3. ‚ö†Ô∏è **localStorage**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –≤ `index.html`
   (`localStorage.getItem('heys_client_current')`). –ü—Ä–∏ –ø–µ—Ä–µ–Ω–æ—Å–µ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π
   —Ñ–∞–π–ª —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç.
4. ‚ö†Ô∏è **CSS –∫–ª–∞—Å—Å—ã**: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–ª–∞—Å—Å—ã –≤—Ä–æ–¥–µ `.card`,
   `.tone-violet`, `.day-layout`. –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∏–ª–µ–π –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ –ª–æ–º–∞–µ—Ç—Å—è
   –≤—ë—Ä—Å—Ç–∫–∞.

---

## ‚úÖ Phase 1: Structural Refactoring ‚Äî –ó–ê–í–ï–†–®–ï–ù–û

**–°—Ç–∞—Ç—É—Å**: ‚úÖ DONE (24.11.2025)

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ**:

- ‚úÖ –°–æ–∑–¥–∞–Ω `apps/web/heys_app_v12.js` —Å –≤—ã–Ω–µ—Å–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–æ–π
- ‚úÖ `index.html` –æ–±–Ω–æ–≤–ª—ë–Ω, –¥–æ–±–∞–≤–ª–µ–Ω `<script defer src="heys_app_v12.js?v=1">`
- ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã: –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, HMR —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
- ‚úÖ `window.HEYS.*` –æ–±—ä–µ–∫—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã**:

- `apps/web/heys_app_v12.js` (—Å–æ–∑–¥–∞–Ω)
- `apps/web/index.html` (inline script —É–¥–∞–ª—ë–Ω, –¥–æ–±–∞–≤–ª–µ–Ω –≤–Ω–µ—à–Ω–∏–π —Å–∫—Ä–∏–ø—Ç)

## ‚úÖ Phase 2: Mobile UX Foundation (CSS) ‚Äî –ó–ê–í–ï–†–®–ï–ù–û

**–°—Ç–∞—Ç—É—Å**: ‚úÖ DONE (24.11.2025)

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ**:

- ‚úÖ App-like Feel: `overscroll-behavior-y: none`,
  `-webkit-tap-highlight-color: transparent`
- ‚úÖ Touch Targets: `.btn`, `.tab`, `input` —É–≤–µ–ª–∏—á–µ–Ω—ã –¥–æ min-height 44px
- ‚úÖ Safe Areas: `env(safe-area-inset-*)` –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `.hdr`, `.tabs`, `.page`
- ‚úÖ Media Queries: –¥–æ–±–∞–≤–ª–µ–Ω—ã –±—Ä–µ–π–∫–ø–æ–∏–Ω—Ç—ã @media (max-width: 640px) –∏
  (max-width: 400px)
- ‚úÖ Active States: `:active` —Å—Ç–∏–ª–∏ –¥–ª—è –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- ‚úÖ Viewport: `viewport-fit=cover` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `index.html`
- ‚úÖ –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞: –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è —É–∑–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤
- ‚úÖ Build pipeline: –ø–æ—á–∏–Ω–µ–Ω (`build:deps` —Å–∫—Ä–∏–ø—Ç, —É–¥–∞–ª—ë–Ω expo/tsconfig.base)

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã**:

- `apps/web/styles/main.css` (–≤—Å–µ touch improvements)
- `apps/web/index.html` (viewport-fit=cover)
- `apps/web/package.json` (build:deps)
- `tsconfig.json` (—É–¥–∞–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ expo)

**–°–±–æ—Ä–∫–∞**: ‚úÖ `pnpm --filter @heys/web run build` ‚Äî PASS

---

## üéØ –¢–ï–ö–£–©–ò–ô –§–û–ö–£–°: Quick Wins & Testing

### üõë –¢–û–ß–ö–ê –ü–†–ò–ù–Ø–¢–ò–Ø –†–ï–®–ï–ù–ò–Ø (–°–ï–ô–ß–ê–°)

**Phase 1-2 –∑–∞–≤–µ—Ä—à–µ–Ω—ã. –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ ‚Äî –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –≤—ã—è–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ
–ø—Ä–æ–±–ª–µ–º—ã.**

**–ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π**:

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ** (1-2 —á–∞—Å–∞)
   - –û—Ç–∫—Ä—ã—Ç—å http://192.168.1.137:3001 –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ
   - –ü—Ä–æ–π—Ç–∏ –∫–ª—é—á–µ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:
     - [ ] –í—ã–±–æ—Ä –∫–ª–∏–µ–Ω—Ç–∞
     - [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ —Ä–∞—Ü–∏–æ–Ω
     - [ ] –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö –¥–Ω—è
     - [ ] –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏
     - [ ] –†–∞–±–æ—Ç–∞ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏
     - [ ] –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º (–≤–µ—Å, —à–∞–≥–∏, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏)
2. **–ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ–±–ª–µ–º** (30 –º–∏–Ω)
   - **–ù–∞–≤–∏–≥–∞—Ü–∏—è**: —É–¥–æ–±–Ω–æ –ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –≤–∫–ª–∞–¥–∫–∏ –æ–¥–Ω–æ–π —Ä—É–∫–æ–π?
   - **–¢–∞–±–ª–∏—Ü—ã**: –≤–ª–µ–∑–∞—é—Ç –ª–∏ 20+ –∫–æ–ª–æ–Ω–æ–∫ —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏?
   - **–§–æ—Ä–º—ã**: —É–¥–æ–±–Ω–æ –ª–∏ –¥–æ–±–∞–≤–ª—è—Ç—å –ø—Ä–æ–¥—É–∫—Ç—ã —á–µ—Ä–µ–∑ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ?
   - **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –µ—Å—Ç—å –ª–∏ –ª–∞–≥–∏ –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ —Å–ø–∏—Å–∫–∞ >50 –ø—Ä–æ–¥—É–∫—Ç–æ–≤?

3. **–ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è**
   - ‚úÖ –ï—Å–ª–∏ UX –∫–æ–º—Ñ–æ—Ä—Ç–Ω—ã–π ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –∫ PWA (Phase 5)
   - ‚ö†Ô∏è –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã –Ω–µ –≤–ª–µ–∑–∞—é—Ç ‚Üí Phase 3.3 (Tables ‚Üí Cards)
   - ‚ö†Ô∏è –ï—Å–ª–∏ –Ω–µ—É–¥–æ–±–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –≤–∫–ª–∞–¥–∫–∏ ‚Üí Phase 3.1 (Swipe Navigation)
   - ‚ö†Ô∏è –ï—Å–ª–∏ —Å–ø–∏—Å–∫–∏ –ª–∞–≥–∞—é—Ç ‚Üí Phase 4.1 (Load More button)

---

## üéØ Phase 3: Quick Wins (–≤—ã–±–æ—Ä–æ—á–Ω–æ, –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

**–°—Ç–∞—Ç—É—Å**: ‚è∏Ô∏è –ù–ï –ù–ê–ß–ê–¢–û (–∂–¥—ë–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

**–ü—Ä–∏–Ω—Ü–∏–ø**: –î–µ–ª–∞–µ–º –¢–û–õ–¨–ö–û —Ç–µ —à–∞–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ—à–∞—é—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –≤—ã—è–≤–ª–µ–Ω–Ω—ã–µ
–ø—Ä–æ–±–ª–µ–º—ã.

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

- **–ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã –Ω–µ –≤–ª–µ–∑–∞—é—Ç** ‚Üí –®–∞–≥ 3.3 (Tables ‚Üí Cards) ‚Äî **–ù–ê–ò–í–´–°–®–ò–ô
  –ü–†–ò–û–†–ò–¢–ï–¢**
- **–ï—Å–ª–∏ –Ω–µ—É–¥–æ–±–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –≤–∫–ª–∞–¥–∫–∏** ‚Üí –®–∞–≥ 3.1 (Swipe Navigation) ‚Äî
  —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è
- **–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ** ‚Üí –®–∞–≥ 3.2 (Pull-to-Refresh) ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ,
  –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫

### –®–∞–≥ 3.1: Swipe Navigation (–º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏) ‚Äî –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ —Ç–∞–ø –ø–æ –≤–µ—Ä—Ö–Ω–µ–º—É –º–µ–Ω—é ‚Äî –Ω–µ—É–¥–æ–±–Ω–æ
–Ω–∞ –±–æ–ª—å—à–∏—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–∞—Ö.

**–ì–¥–µ –¥–µ–ª–∞—Ç—å**: –í `apps/web/heys_app_v12.js`, –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ `App`.

**–õ–æ–≥–∏–∫–∞**:

1. –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ `onTouchStart`, `onTouchMove`, `onTouchEnd` –Ω–∞ –≥–ª–∞–≤–Ω—ã–π
   –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (`.wrap`).
2. –û–ø—Ä–µ–¥–µ–ª—è—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤–∞–π–ø–∞ (left/right).
3. –ï—Å–ª–∏ —Å–≤–∞–π–ø –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π >50px –∏ –±—ã—Å—Ç—Ä—ã–π ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –≤–∫–ª–∞–¥–∫—É:
   - **Swipe Left** (–≤–ª–µ–≤–æ): –°–ª–µ–¥—É—é—â–∞—è –≤–∫–ª–∞–¥–∫–∞ (ration ‚Üí day ‚Üí reports ‚Üí user ‚Üí
     analytics).
   - **Swipe Right** (–≤–ø—Ä–∞–≤–æ): –ü—Ä–µ–¥—ã–¥—É—â–∞—è –≤–∫–ª–∞–¥–∫–∞.
4. –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–≤–∞–π–ø—ã –≤–Ω—É—Ç—Ä–∏ input –ø–æ–ª–µ–π –∏ —Ç–∞–±–ª–∏—Ü (—á—Ç–æ–±—ã –Ω–µ –º–µ—à–∞—Ç—å –ø—Ä–æ–∫—Ä—É—Ç–∫–µ).

**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞** (–¥–æ–±–∞–≤–∏—Ç—å –≤ `App` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ—Å–ª–µ useState):

```javascript
// === SWIPE NAVIGATION ===
const [touchStart, setTouchStart] = React.useState(null);
const [touchEnd, setTouchEnd] = React.useState(null);

const minSwipeDistance = 50; // –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ —Å–≤–∞–π–ø–∞ –≤ px

const tabs = ['ration', 'day', 'reports', 'user', 'analytics'];
const currentTabIndex = tabs.indexOf(tab);

const onTouchStart = (e) => {
  setTouchEnd(null); // –°–±—Ä–æ—Å –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∫–æ–Ω—Ü–∞
  setTouchStart(e.targetTouches[0].clientX);
};

const onTouchMove = (e) => {
  setTouchEnd(e.targetTouches[0].clientX);
};

const onTouchEnd = () => {
  if (!touchStart || !touchEnd) return;

  const distance = touchStart - touchEnd;
  const isLeftSwipe = distance > minSwipeDistance;
  const isRightSwipe = distance < -minSwipeDistance;

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Å–≤–∞–π–ø –Ω–µ –≤–Ω—É—Ç—Ä–∏ input/textarea/select
  const activeElement = document.activeElement;
  const isInputActive = ['INPUT', 'TEXTAREA', 'SELECT'].includes(
    activeElement.tagName,
  );
  if (isInputActive) return;

  if (isLeftSwipe && currentTabIndex < tabs.length - 1) {
    // –°–≤–∞–π–ø –≤–ª–µ–≤–æ = —Å–ª–µ–¥—É—é—â–∞—è –≤–∫–ª–∞–¥–∫–∞
    setTab(tabs[currentTabIndex + 1]);
  }

  if (isRightSwipe && currentTabIndex > 0) {
    // –°–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ = –ø—Ä–µ–¥—ã–¥—É—â–∞—è –≤–∫–ª–∞–¥–∫–∞
    setTab(tabs[currentTabIndex - 1]);
  }
};
```

**–î–æ–±–∞–≤–∏—Ç—å –≤ JSX** (–≤ `return` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ `App`):

```javascript
React.createElement(
  'div',
  {
    className: 'wrap',
    onTouchStart: onTouchStart,
    onTouchMove: onTouchMove,
    onTouchEnd: onTouchEnd,
  },
  // ... –≤–µ—Å—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç ...
);
```

**–í–ê–ñ–ù–û**: –ù–µ –¥–æ–±–∞–≤–ª—è—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç—ã –≤–Ω—É—Ç—Ä–∏ —Ç–∞–±–ª–∏—Ü/input, –∏–Ω–∞—á–µ –±—É–¥–µ—Ç
–∫–æ–Ω—Ñ–ª–∏–∫—Ç —Å –Ω–∞—Ç–∏–≤–Ω—ã–º —Å–∫—Ä–æ–ª–ª–æ–º.

---

### –®–∞–≥ 3.2: Pull-to-Refresh (–ø–æ—Ç—è–Ω—É—Ç—å —á—Ç–æ–±—ã –æ–±–Ω–æ–≤–∏—Ç—å) ‚Äî –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û, –í–´–°–û–ö–ò–ô –†–ò–°–ö

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º.

‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï**:

1. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç —Å –±—Ä–∞—É–∑–µ—Ä–æ–º**: –ú–Ω–æ–≥–∏–µ –º–æ–±–∏–ª—å–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã (–æ—Å–æ–±–µ–Ω–Ω–æ Chrome –Ω–∞
   Android) –∏–º–µ—é—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π pull-to-refresh –¥–ª—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
   –ö–∞—Å—Ç–æ–º–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–∂–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å.

2. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç —Å–æ —Å–∫—Ä–æ–ª–ª–æ–º**: –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è –ø—Ä–æ–∫—Ä—É—Ç–∏—Ç—å –¥–ª–∏–Ω–Ω—É—é
   —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤–≤–µ—Ä—Ö, –∞ –º—ã –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º –∂–µ—Å—Ç ‚Äî —ç—Ç–æ —Ä–∞–∑–¥—Ä–∞–∂–∞–µ—Ç.

3. **–ù–µ–æ—á–µ–≤–∏–¥–Ω–∞—è UX-–ø–æ–ª—å–∑–∞**: –ï—Å–ª–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏
   —Å–º–µ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π pull-to-refresh –º–æ–∂–µ—Ç –±—ã—Ç—å
   –∏–∑–±—ã—Ç–æ—á–Ω—ã–º.

**–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø**:

- –°–Ω–∞—á–∞–ª–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¢–û–õ–¨–ö–û Swipe Navigation (–®–∞–≥ 3.1).
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö.
- Pull-to-Refresh –¥–æ–±–∞–≤–ª—è—Ç—å –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —è–≤–Ω–æ –ø—Ä–æ—Å—è—Ç —Ñ—É–Ω–∫—Ü–∏—é
  "–æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ".
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ü—Ä–æ—Å—Ç–∞—è –∫–Ω–æ–ø–∫–∞ "üîÑ –û–±–Ω–æ–≤–∏—Ç—å" –≤ header ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ –∏ –ø–æ–Ω—è—Ç–Ω–µ–µ.

**–ì–¥–µ –¥–µ–ª–∞—Ç—å** (–µ—Å–ª–∏ –≤—Å—ë-—Ç–∞–∫–∏ —Ä–µ—à–∏–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å): –í –æ–±—ë—Ä—Ç–∫–∞—Ö
`DayTabWithCloudSync` –∏ `RationTabWithCloudSync` –≤–Ω—É—Ç—Ä–∏ `heys_app_v12.js`.

**–õ–æ–≥–∏–∫–∞**:

1. –û–ø—Ä–µ–¥–µ–ª—è—Ç—å –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ç—è–Ω–µ—Ç —ç–∫—Ä–∞–Ω –≤–Ω–∏–∑ –≤ —Å–∞–º–æ–º –≤–µ—Ä—Ö—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
2. –ü—Ä–∏ –æ—Ç–ø—É—Å–∫–∞–Ω–∏–∏ (–µ—Å–ª–∏ –ø–æ—Ç—è–Ω—É–ª >80px) ‚Äî –∑–∞–ø—É—Å–∫–∞—Ç—å
   `cloud.bootstrapClientSync(clientId)`.
3. –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä (—Å–ø–∏–Ω–Ω–µ—Ä –∏–ª–∏ —Ç–µ–∫—Å—Ç "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ...").

**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞** (–¥–æ–±–∞–≤–∏—Ç—å –≤ `DayTabWithCloudSync`):

```javascript
function DayTabWithCloudSync(props) {
  const { clientId, products } = props;
  const [loading, setLoading] = React.useState(true);

  // === PULL-TO-REFRESH ===
  const [isPulling, setIsPulling] = React.useState(false);
  const [pullDistance, setPullDistance] = React.useState(0);
  const [isRefreshing, setIsRefreshing] = React.useState(false);

  const pullThreshold = 80; // px –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
  let pullStartY = 0;

  const handlePullStart = (e) => {
    // –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å–∫—Ä–æ–ª–ª –≤ —Å–∞–º–æ–º –≤–µ—Ä—Ö—É
    if (window.scrollY === 0) {
      pullStartY = e.touches[0].clientY;
      setIsPulling(true);
    }
  };

  const handlePullMove = (e) => {
    if (!isPulling) return;

    const currentY = e.touches[0].clientY;
    const distance = Math.max(0, currentY - pullStartY);
    setPullDistance(distance);

    // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π overscroll –µ—Å–ª–∏ —Ç—è–Ω–µ–º –≤–Ω–∏–∑
    if (distance > 0 && window.scrollY === 0) {
      e.preventDefault();
    }
  };

  const handlePullEnd = () => {
    setIsPulling(false);

    if (pullDistance > pullThreshold && !isRefreshing) {
      // –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
      setIsRefreshing(true);
      const cloud = window.HEYS && window.HEYS.cloud;

      if (
        clientId &&
        cloud &&
        typeof cloud.bootstrapClientSync === 'function'
      ) {
        cloud
          .bootstrapClientSync(clientId)
          .then(() => {
            setIsRefreshing(false);
            setLoading(false);
          })
          .catch(() => {
            setIsRefreshing(false);
            setLoading(false);
          });
      } else {
        setIsRefreshing(false);
      }
    }

    setPullDistance(0);
  };

  // –û—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞...
  React.useEffect(() => {
    // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ ...
  }, [clientId]);

  // Render —Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º pull-to-refresh
  return React.createElement(
    'div',
    {
      onTouchStart: handlePullStart,
      onTouchMove: handlePullMove,
      onTouchEnd: handlePullEnd,
      style: { position: 'relative' },
    },
    // –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä refresh
    isPulling || isRefreshing
      ? React.createElement(
          'div',
          {
            style: {
              position: 'absolute',
              top: 0,
              left: '50%',
              transform: `translateX(-50%) translateY(${Math.min(pullDistance, 60)}px)`,
              padding: '8px 16px',
              background: 'var(--acc)',
              color: 'white',
              borderRadius: '20px',
              fontSize: '13px',
              fontWeight: 600,
              zIndex: 1000,
              transition: isRefreshing ? 'none' : 'transform 0.2s',
            },
          },
          isRefreshing
            ? '‚è≥ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ...'
            : pullDistance > pullThreshold
              ? '‚Üì –û—Ç–ø—É—Å—Ç–∏—Ç–µ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è'
              : '‚Üì –ü–æ—Ç—è–Ω–∏—Ç–µ –≤–Ω–∏–∑',
        )
      : null,

    // –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥)
    loading
      ? React.createElement(
          'div',
          { className: 'muted', style: { padding: 24 } },
          '–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞...',
        )
      : !window.HEYS || !window.HEYS.DayTab
        ? React.createElement(
            'div',
            { className: 'muted', style: { padding: 24 } },
            '‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞...',
          )
        : React.createElement(window.HEYS.DayTab, { products }),
  );
}
```

**–í–ê–ñ–ù–û**: –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ç—É –∂–µ –ª–æ–≥–∏–∫—É –∫ `RationTabWithCloudSync` –∏
`UserTabWithCloudSync`.

---

### –®–∞–≥ 3.3: Tables ‚Üí Cards (—Å–∞–º–∞—è –∫—Ä–∏—Ç–∏—á–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞) ‚Äî –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø

**–ü—Ä–æ–±–ª–µ–º–∞**: –¢–∞–±–ª–∏—Ü—ã –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏ —Å 20+ –∫–æ–ª–æ–Ω–∫–∞–º–∏ –Ω–µ –≤–ª–µ–∑–∞—é—Ç –Ω–∞ —ç–∫—Ä–∞–Ω —Ç–µ–ª–µ—Ñ–æ–Ω–∞
(320-640px).

**–¶–µ–ª—å**: –ù–∞ —É–∑–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ –≤–º–µ—Å—Ç–æ —Ç–∞–±–ª–∏—Ü.

**–ì–¥–µ –¥–µ–ª–∞—Ç—å**: `apps/web/heys_day_v12.js` (–∫–æ–º–ø–æ–Ω–µ–Ω—Ç `DayTab`, —Å–µ–∫—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∞
—Ç–∞–±–ª–∏—Ü –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏).

**–õ–æ–≥–∏–∫–∞**:

1. –û–ø—Ä–µ–¥–µ–ª—è—Ç—å —à–∏—Ä–∏–Ω—É —ç–∫—Ä–∞–Ω–∞: `window.innerWidth < 640`
2. –ï—Å–ª–∏ —É–∑–∫–∏–π —ç–∫—Ä–∞–Ω ‚Üí —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å `.meal-card` –≤–º–µ—Å—Ç–æ `<table>`
3. –ï—Å–ª–∏ —à–∏—Ä–æ–∫–∏–π —ç–∫—Ä–∞–Ω ‚Üí —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É –∫–∞–∫ —Å–µ–π—á–∞—Å

**–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–∞—Ä—Ç–æ—á–∫–∏**:

```javascript
// –í–º–µ—Å—Ç–æ <table> —Ä–µ–Ω–¥–µ—Ä–∏–º –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏—ë–º–∞ –ø–∏—â–∏
React.createElement(
  'div',
  { className: 'meal-cards' },
  meals.map((meal) =>
    React.createElement(
      'div',
      {
        className: 'card meal-card',
        key: meal.id,
      },
      // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–∏—ë–º–∞ –ø–∏—â–∏
      React.createElement(
        'h4',
        {
          style: { marginBottom: '12px', fontSize: '16px' },
        },
        meal.name,
      ), // –ó–∞–≤—Ç—Ä–∞–∫, –û–±–µ–¥, –£–∂–∏–Ω

      // –ò—Ç–æ–≥–∏ –ø–æ –º–∞–∫—Ä–æ—Å–∞–º
      React.createElement(
        'div',
        {
          className: 'meal-summary',
          style: { marginBottom: '16px', display: 'flex', gap: '12px' },
        },
        React.createElement('div', {}, `üî• ${meal.totalKcal} –∫–∫–∞–ª`),
        React.createElement('div', {}, `üçö ${meal.totalCarbs}–≥ –£`),
        React.createElement('div', {}, `ü•© ${meal.totalProtein}–≥ –ë`),
        React.createElement('div', {}, `ü•ë ${meal.totalFat}–≥ –ñ`),
      ),

      // –°–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ –ø—Ä–∏—ë–º–µ
      React.createElement(
        'div',
        { className: 'meal-products' },
        meal.products.map((product, idx) =>
          React.createElement(
            'div',
            {
              className: 'product-row',
              key: idx,
              style: {
                padding: '8px 0',
                borderTop: idx > 0 ? '1px solid var(--border)' : 'none',
              },
            },
            React.createElement(
              'div',
              {
                style: { fontWeight: 500, marginBottom: '4px' },
              },
              product.name,
            ),
            React.createElement(
              'div',
              {
                style: { fontSize: '13px', color: 'var(--muted)' },
              },
              `${product.grams}–≥`,
            ),
          ),
        ),
      ),

      // –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
      React.createElement(
        'div',
        {
          style: { marginTop: '12px', display: 'flex', gap: '8px' },
        },
        React.createElement(
          'button',
          {
            className: 'btn btn-sm',
            onClick: () => handleEditMeal(meal.id),
          },
          '–ò–∑–º–µ–Ω–∏—Ç—å',
        ),
        React.createElement(
          'button',
          {
            className: 'btn btn-sm',
            onClick: () => handleAddProduct(meal.id),
          },
          '+ –ü—Ä–æ–¥—É–∫—Ç',
        ),
      ),
    ),
  ),
);
```

**CSS –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫** (–¥–æ–±–∞–≤–∏—Ç—å –≤ `main.css`):

```css
@media (max-width: 640px) {
  .meal-cards {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .meal-card {
    padding: 16px;
  }

  .meal-summary {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    font-size: 14px;
    font-weight: 600;
  }

  .product-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
}
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ (–ø—Ä–æ—â–µ)**: –ï—Å–ª–∏ –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ–¥–µ–ª–∫–∞ —Å–ª–æ–∂–Ω–∞, –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —Å–∫—Ä—ã—Ç—å
–ª–∏—à–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏ —á–µ—Ä–µ–∑ CSS:

```css
@media (max-width: 640px) {
  /* –°–∫—Ä—ã–≤–∞–µ–º –∫–æ–ª–æ–Ω–∫–∏ "–Ω–∞ 100–≥", –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –∏—Ç–æ–≥–æ–≤—ã–µ */
  .meal-table th:nth-child(n + 3):nth-child(-n + 11),
  .meal-table td:nth-child(n + 3):nth-child(-n + 11) {
    display: none;
  }
}
```

---

## ‚ö° Phase 4: Performance & Polish ‚Äî –ü–û–õ–ù–û–°–¢–¨–Æ –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û

**–¶–µ–ª—å**: –û–±–µ—Å–ø–µ—á–∏—Ç—å –ø–ª–∞–≤–Ω—É—é —Ä–∞–±–æ—Ç—É –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –∏ –±–æ–ª—å—à–∏–µ —Å–ø–∏—Å–∫–∏.

‚ö†Ô∏è **–£–°–õ–û–í–ò–ï –í–´–ü–û–õ–ù–ï–ù–ò–Ø**: –≠—Ç–∞ —Ñ–∞–∑–∞ –¥–µ–ª–∞–µ—Ç—Å—è –¢–û–õ–¨–ö–û –µ—Å–ª–∏:

1. –ü–æ—Å–ª–µ Phase 1-2 (–∏–ª–∏ Phase 3) –∑–∞–º–µ—á–µ–Ω—ã —Ä–µ–∞–ª—å–Ω—ã–µ –ª–∞–≥–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö.
2. –ï—Å—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∂–∞–ª–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –º–µ–¥–ª–µ–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É.
3. –ò–∑–º–µ—Ä–µ–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (–≤—Ä–µ–º—è —Ä–µ–Ω–¥–µ—Ä–∞ >500ms, FPS <30).

**–ë–ï–ó –∏–∑–º–µ—Ä–µ–Ω–∏–π –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º ‚Äî –ù–ï –î–ï–õ–ê–¢–¨. –≠—Ç–æ –æ–≤–µ—Ä–∫–∏–ª.**

### üö´ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ü–†–ê–í–ò–õ–û –î–õ–Ø PHASE 4

**–ù–ï –¢–†–û–ì–ê–¢–¨**:

- ‚ùå –§–æ—Ä–º—É–ª—ã –∏ —Ä–∞—Å—á—ë—Ç—ã (TDEE, BMR, –º–∞–∫—Ä–æ–Ω—É—Ç—Ä–∏–µ–Ω—Ç—ã, –¥–µ—Ñ–∏—Ü–∏—Ç)
- ‚ùå –°—Ç—Ä—É–∫—Ç—É—Ä—É –æ–±—ä–µ–∫—Ç–æ–≤ –≤ localStorage (—Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –¥–Ω—è, –ø—Ä–æ–¥—É–∫—Ç–æ–≤)
- ‚ùå –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ (`computeDerived`, `calculateDayStats`,
  etc.)
- ‚ùå –õ–æ–≥–∏–∫—É —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å Supabase

**–ú–û–ñ–ù–û**:

- ‚úÖ –î–æ–±–∞–≤–ª—è—Ç—å UI-–æ–±—ë—Ä—Ç–∫–∏ (–∫–Ω–æ–ø–∫–∏ "–ü–æ–∫–∞–∑–∞—Ç—å –µ—â—ë", skeleton screens)
- ‚úÖ –°–∫—Ä—ã–≤–∞—Ç—å –∫–æ–ª–æ–Ω–∫–∏ —á–µ—Ä–µ–∑ CSS `@media`
- ‚úÖ –î–æ–±–∞–≤–ª—è—Ç—å –¥–µ–±–∞—É–Ω—Å –¥–ª—è –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (–Ω–æ –Ω–µ –º–µ–Ω—è—Ç—å —Å–∞–º—É –ª–æ–≥–∏–∫—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è)

### –®–∞–≥ 4.1: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–ø–∏—Å–∫–æ–≤ ‚Äî –¢–û–õ–¨–ö–û –ü–†–ò –†–ï–ê–õ–¨–ù–´–• –õ–ê–ì–ê–•

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–∏ >100 –ø—Ä–æ–¥—É–∫—Ç–∞—Ö –∏–ª–∏ –ø—Ä–∏—ë–º–∞—Ö –ø–∏—â–∏ —Ä–µ–Ω–¥–µ—Ä —Ç–æ—Ä–º–æ–∑–∏—Ç –Ω–∞ —Å—Ç–∞—Ä—ã—Ö
—Ç–µ–ª–µ—Ñ–æ–Ω–∞—Ö.

**–ì–¥–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å**:

1. `heys_core_v12.js` ‚Äî —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ –≤–∫–ª–∞–¥–∫–µ "–†–∞—Ü–∏–æ–Ω".
2. `heys_day_v12.js` ‚Äî —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏ (—Å—Ç—Ä–æ–∫–∏ ~970-1100).

**–†–µ—à–µ–Ω–∏–µ A (–ø—Ä–æ—Å—Ç–æ–µ)**: "Load More" –∫–Ω–æ–ø–∫–∞

- –†–µ–Ω–¥–µ—Ä–∏—Ç—å —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 50 —ç–ª–µ–º–µ–Ω—Ç–æ–≤.
- –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "–ü–æ–∫–∞–∑–∞—Ç—å –µ—â—ë 50".
- **–ü–ª—é—Å—ã**: –õ–µ–≥–∫–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å, –Ω–µ –ª–æ–º–∞–µ—Ç –ª–æ–≥–∏–∫—É.
- **–ú–∏–Ω—É—Å—ã**: –ù–µ "–Ω–∞—Å—Ç–æ—è—â–∞—è" –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è, –Ω–æ –¥–ª—è –Ω—É—Ç—Ä–∏—Ü–∏–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ B (–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ)**: React-–æ–∫–Ω–æ (virtual scrolling)

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `react-window` –∏–ª–∏ —Å–∞–º–æ–ø–∏—Å–Ω—É—é –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—é.
- –†–µ–Ω–¥–µ—Ä–∏—Ç—å —Ç–æ–ª—å–∫–æ –≤–∏–¥–∏–º—ã–µ —Å—Ç—Ä–æ–∫–∏ + buffer (10 —Å–≤–µ—Ä—Ö—É/—Å–Ω–∏–∑—É).
- **–ü–ª—é—Å—ã**: –°—É–ø–µ—Ä-–ø–ª–∞–≤–Ω–æ –¥–∞–∂–µ —Å 1000+ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏.
- **–ú–∏–Ω—É—Å—ã**: –°–ª–æ–∂–Ω–µ–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å, –Ω—É–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å input –ø–æ–ª—è.

**–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø**: –ù–∞—á–∞—Ç—å —Å **–†–µ—à–µ–Ω–∏—è A**. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∂–∞–ª—É—é—Ç—Å—è –Ω–∞ –ª–∞–≥–∏ ‚Äî
–ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –†–µ—à–µ–Ω–∏–µ B.

**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –¥–ª—è –†–µ—à–µ–Ω–∏—è A** (–¥–æ–±–∞–≤–∏—Ç—å –≤ `heys_core_v12.js`):

```javascript
// –í–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ Ration
function Ration({ products, setProducts }) {
  const [displayLimit, setDisplayLimit] = React.useState(50);

  const visibleProducts = products.slice(0, displayLimit);
  const hasMore = products.length > displayLimit;

  return React.createElement(
    'div',
    { className: 'page' },
    // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ —Ä–µ–Ω–¥–µ—Ä–∞ —Å–ø–∏—Å–∫–∞ ...

    // –°–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (—Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ displayLimit)
    visibleProducts.map((product) => {
      // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ä–µ–Ω–¥–µ—Ä –ø—Ä–æ–¥—É–∫—Ç–∞ ...
    }),

    // –ö–Ω–æ–ø–∫–∞ "–ü–æ–∫–∞–∑–∞—Ç—å –µ—â—ë"
    hasMore
      ? React.createElement(
          'button',
          {
            className: 'btn',
            style: { marginTop: 16, width: '100%' },
            onClick: () => setDisplayLimit((prev) => prev + 50),
          },
          `–ü–æ–∫–∞–∑–∞—Ç—å –µ—â—ë (${products.length - displayLimit} –æ—Å—Ç–∞–ª–æ—Å—å)`,
        )
      : null,
  );
}
```

### –®–∞–≥ 4.2: –î–µ–±–∞—É–Ω—Å –¥–ª—è input –ø–æ–ª–µ–π (—ç–∫–æ–Ω–æ–º–∏–º —Ä–µ—Å—É—Ä—Å—ã)

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–∏ –≤–≤–æ–¥–µ –≤ input (`onChange`) –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `setDay()` –∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä
–≤—Å–µ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ ‚Äî —ç—Ç–æ —Ç—è–∂–µ–ª–æ.

**–ì–¥–µ**: `heys_day_v12.js`, —Å—Ç—Ä–æ–∫–∏ ~880-920 (input –ø–æ–ª—è –¥–ª—è –≤–µ—Å–∞, —à–∞–≥–æ–≤,
—Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫).

**–†–µ—à–µ–Ω–∏–µ**: –î–µ–±–∞—É–Ω—Å –Ω–∞ 300ms –¥–ª—è –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è.

**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞**:

```javascript
// –í –Ω–∞—á–∞–ª–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ DayTab (–ø–æ—Å–ª–µ useState)
const saveTimerRef = React.useRef(null);

const debouncedSetDay = React.useCallback(
  (newDay) => {
    // –õ–æ–∫–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ)
    setDay(newDay);

    // –û—Ç–ª–æ–∂–µ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage
    if (saveTimerRef.current) clearTimeout(saveTimerRef.current);

    saveTimerRef.current = setTimeout(() => {
      lsSet('heys_dayv2_' + dateKey, newDay);
      // –¢—Ä–∏–≥–≥–µ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å –æ–±–ª–∞–∫–æ–º (–µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ)
      if (window.HEYS.saveClientKey) {
        window.HEYS.saveClientKey('heys_dayv2_' + dateKey, newDay);
      }
    }, 300);
  },
  [dateKey],
);

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å debouncedSetDay –≤–º–µ—Å—Ç–æ setDay –≤ onChange
```

### –®–∞–≥ 4.3: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü (—É–º–µ–Ω—å—à–∏—Ç—å DOM –Ω–∞–≥—Ä—É–∑–∫—É)

**–ü—Ä–æ–±–ª–µ–º–∞**: –í `heys_day_v12.js` —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏ —Ä–µ–Ω–¥–µ—Ä—è—Ç –º–Ω–æ–≥–æ input
–ø–æ–ª–µ–π (–ø–æ ~20 –∫–æ–ª–æ–Ω–æ–∫ –Ω–∞ —Å—Ç—Ä–æ–∫—É).

**–†–µ—à–µ–Ω–∏–µ**:

1. **–°–∫—Ä—ã—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏** –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö (—á–µ—Ä–µ–∑ CSS `@media`).
2. **Collapse/Expand**: –°–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –ø—Ä–∏—ë–º–∞ –ø–∏—â–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —Ä–∞—Å–∫—Ä—ã–≤–∞—Ç—å
   –ø–æ —Ç–∞–ø—É.

**–ü—Ä–∏–º–µ—Ä CSS** (–¥–æ–±–∞–≤–∏—Ç—å –≤ `main.css`):

```css
@media (max-width: 640px) {
  /* –°–∫—Ä—ã–≤–∞–µ–º –∫–æ–ª–æ–Ω–∫–∏ "–Ω–∞ 100–≥" –Ω–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö */
  .meal-table th:nth-child(n + 3):nth-child(-n + 11),
  .meal-table td:nth-child(n + 3):nth-child(-n + 11) {
    display: none;
  }

  /* –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ: –ü—Ä–æ–¥—É–∫—Ç, –ì—Ä–∞–º–º—ã, –ò—Ç–æ–≥–æ –ö–∫–∞–ª, –ò—Ç–æ–≥–æ –£, –ò—Ç–æ–≥–æ –ë, –ò—Ç–æ–≥–æ –ñ */
  .meal-table th:nth-child(1),
  .meal-table th:nth-child(2),
  .meal-table th:nth-child(13),
  .meal-table th:nth-child(14),
  .meal-table th:nth-child(17),
  .meal-table th:nth-child(18),
  .meal-table td:nth-child(1),
  .meal-table td:nth-child(2),
  .meal-table td:nth-child(13),
  .meal-table td:nth-child(14),
  .meal-table td:nth-child(17),
  .meal-table td:nth-child(18) {
    display: table-cell;
  }
}
```

### –®–∞–≥ 4.4: –î–æ–±–∞–≤–∏—Ç—å Skeleton Screens (–≤–º–µ—Å—Ç–æ "–ó–∞–≥—Ä—É–∑–∫–∞...")

**–ü—Ä–æ–±–ª–µ–º–∞**: –ë–µ–ª—ã–π —ç–∫—Ä–∞–Ω —Å —Ç–µ–∫—Å—Ç–æ–º "–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞..." –≤—ã–≥–ª—è–¥–∏—Ç –Ω–µ
—Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ**: –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ placeholder'—ã (skeleton) –≤–æ –≤—Ä–µ–º—è
–∑–∞–≥—Ä—É–∑–∫–∏.

**–ü—Ä–∏–º–µ—Ä CSS**:

```css
@keyframes skeleton-loading {
  0% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

.skeleton {
  background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s infinite;
  border-radius: 8px;
}

.skeleton-card {
  height: 120px;
  margin-bottom: 12px;
}

.skeleton-text {
  height: 16px;
  margin-bottom: 8px;
}

.skeleton-button {
  height: 44px;
  width: 100%;
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å** –≤ `DayTabWithCloudSync`:

```javascript
if (loading) {
  return React.createElement(
    'div',
    { className: 'page' },
    React.createElement('div', { className: 'skeleton skeleton-card' }),
    React.createElement('div', { className: 'skeleton skeleton-card' }),
    React.createElement('div', {
      className: 'skeleton skeleton-text',
      style: { width: '60%' },
    }),
    React.createElement('div', { className: 'skeleton skeleton-button' }),
  );
}
```

---

## üÜï Phase 5: PWA Setup (–±—ã—Å—Ç—Ä–∞—è –ø–æ–±–µ–¥–∞) ‚Äî –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø

**–°—Ç–∞—Ç—É—Å**: ‚è∏Ô∏è –ù–ï –ù–ê–ß–ê–¢–û

**–¶–µ–ª—å**: –ü—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ "—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º–æ–µ" –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –∏–∫–æ–Ω–∫–æ–π –Ω–∞
home screen.

**–í—Ä–µ–º—è**: ~1 —á–∞—Å

**–®–∞–≥–∏**:

1. **–°–æ–∑–¥–∞—Ç—å `apps/web/manifest.json`**:

```json
{
  "name": "HEYS Nutrition Tracker",
  "short_name": "HEYS",
  "description": "–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É—á—ë—Ç–∞ –ø–∏—Ç–∞–Ω–∏—è –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#ffffff",
  "theme_color": "#6A5ACD",
  "orientation": "portrait",
  "icons": [
    {
      "src": "/icon-192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "/icon-512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ]
}
```

2. **–û–±–Ω–æ–≤–∏—Ç—å `apps/web/index.html`** (–¥–æ–±–∞–≤–∏—Ç—å –≤ `<head>`):

```html
<link rel="manifest" href="/manifest.json" />
<meta name="theme-color" content="#6A5ACD" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="default" />
<meta name="apple-mobile-web-app-title" content="HEYS" />
<link rel="apple-touch-icon" href="/icon-192.png" />
```

3. **–°–æ–∑–¥–∞—Ç—å –∏–∫–æ–Ω–∫–∏** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ª–æ–≥–æ—Ç–∏–ø –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç—É—é –∏–∫–æ–Ω–∫—É
   - –†–∞–∑–º–µ—Å—Ç–∏—Ç—å –≤ `apps/web/public/`: `icon-192.png`, `icon-512.png`

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

- ‚úÖ –ö–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –¥–æ–º–∞—à–Ω–∏–π —ç–∫—Ä–∞–Ω" –≤ –º–æ–±–∏–ª—å–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö
- ‚úÖ –ó–∞–ø—É—Å–∫ –±–µ–∑ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞
- ‚úÖ –û—â—É—â–µ–Ω–∏–µ –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## üìã –ß–µ–∫–ª–∏—Å—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ

- [x] Phase 1: Structural Refactoring ‚Äî DONE
- [x] Phase 2: Mobile UX Foundation (CSS) ‚Äî DONE
- [x] Build pipeline ‚Äî FIXED
- [x] Dev server ‚Äî RUNNING (http://localhost:3001)

### üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞)

1. [ ] **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ (http://192.168.1.137:3001)
2. [ ] **–ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è** –≤—ã—è–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º
3. [ ] **–ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è** –æ Phase 3 —à–∞–≥–∞—Ö
4. [ ] **PWA Setup** (–µ—Å–ª–∏ UX —É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç)

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏

1. ‚úÖ **`window.HEYS.*` –¥–æ—Å—Ç—É–ø–µ–Ω** ‚Äî –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ
2. ‚úÖ **localStorage —Ä–∞–±–æ—Ç–∞–µ—Ç** ‚Äî –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ
3. ‚úÖ **Supabase sync** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç (`'online'`)
4. ‚úÖ **Build —É—Å–ø–µ—à–µ–Ω** ‚Äî –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ
5. ‚è∏Ô∏è **Mobile UX** ‚Äî —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

---

## üöÄ –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π (Optimized for AI Agent)

> **Note for User**: Copy the relevant prompt below and paste it into the AI
> chat to execute the task.

### –ü—Ä–æ–º–ø—Ç 1: Mobile UX Testing (Manual)

**Role**: QA Lead **Goal**: –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ç–∫—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ
—Ä—É—á–Ω–æ–º—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π Phase 2.

**Instructions for AI Agent**:

1. –ù–µ –ø—ã—Ç–∞–π—Å—è –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ (—É —Ç–µ–±—è –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫
   —Ç–µ–ª–µ—Ñ–æ–Ω—É).
2. –í—ã–≤–µ–¥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç –¥–µ–π—Å—Ç–≤–∏–π.
3. –í—ã–≤–µ–¥–∏ —à–∞–±–ª–æ–Ω —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
4. –ü–æ–ø—Ä–æ—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –≤ –æ—Ç–≤–µ—Ç.

**Checklist to generate for User**:

1. **Setup**: –û—Ç–∫—Ä—ã—Ç—å `http://192.168.x.x:3001` (–∏–ª–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π IP) –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ.
2. **Visual Check**:
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å "—á–µ–ª–∫—É" (Notch) ‚Äî –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–µ—Ç –ª–∏ –æ–Ω–∞ –∑–∞–≥–æ–ª–æ–≤–æ–∫/—Ç–∞–±—ã?
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä –∫–Ω–æ–ø–æ–∫ ‚Äî —É–¥–æ–±–Ω–æ –ª–∏ –Ω–∞–∂–∏–º–∞—Ç—å?
3. **Functional Check**:
   - –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç –≤ —Ä–∞—Ü–∏–æ–Ω.
   - –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –≤–∫–ª–∞–¥–∫–∏ (Ration -> Day -> Reports).
   - –û—Ç–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª–∫—É –≤—ã–±–æ—Ä–∞ –∫–ª–∏–µ–Ω—Ç–∞.
4. **Critical Layout Check (Tab "Day")**:
   - –í–ª–µ–∑–∞–µ—Ç –ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –ø—Ä–∏–µ–º–æ–≤ –ø–∏—â–∏ –≤ —ç–∫—Ä–∞–Ω?
   - –í–∏–¥–Ω—ã –ª–∏ –∏—Ç–æ–≥–æ–≤—ã–µ —Ü–∏—Ñ—Ä—ã (–ö–∫–∞–ª/–ë–ñ–£)?
   - –ù–µ—Ç –ª–∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Å–∫—Ä–æ–ª–ª–∞ –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã (—Ç–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞
     —Å–∫—Ä–æ–ª–ª–∏—Ç—å—Å—è, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)?

**Output Template (Markdown)**:

```markdown
| Area               | Status (OK/Fail) | Issues / Notes |
| ------------------ | ---------------- | -------------- |
| Safe Areas (Notch) |                  |                |
| Touch Targets      |                  |                |
| Table Visibility   |                  |                |
| Tab Switching      |                  |                |
```

**Decision Logic (tell this to user)**:

- –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ –≤–ª–µ–∑–∞–µ—Ç -> –ú—ã –∑–∞–ø—É—Å—Ç–∏–º –ü—Ä–æ–º–ø—Ç 2.
- –ï—Å–ª–∏ –Ω–µ—É–¥–æ–±–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å —Ç–∞–±—ã -> –ú—ã –∑–∞–ø—É—Å—Ç–∏–º –ü—Ä–æ–º–ø—Ç 3.
- –ï—Å–ª–∏ –≤—Å–µ –û–ö -> –ú—ã –∑–∞–ø—É—Å—Ç–∏–º –ü—Ä–æ–º–ø—Ç 4.

---

### –ü—Ä–æ–º–ø—Ç 2: Fix Table Overflow (CSS-First Approach)

**Role**: Frontend Developer (CSS Specialist) **Goal**: –°–¥–µ–ª–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏—ë–º–æ–≤
–ø–∏—â–∏ —á–∏—Ç–∞–µ–º—ã–º–∏ –Ω–∞ —ç–∫—Ä–∞–Ω–∞—Ö 320‚Äì400px –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è JS. **Risk Level**: üü¢ –ù–∏–∑–∫–∏–π
(—Ç–æ–ª—å–∫–æ CSS)

**Inputs**:

- –§–∞–π–ª –¥–ª—è –ø—Ä–∞–≤–æ–∫: `apps/web/styles/main.css`.
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã –æ–ø–∏—Å–∞–Ω–∞ –≤ `heys_day_v12.js` (–∫–æ–ª–æ–Ω–∫–∏: –ù–∞–∑–≤–∞–Ω–∏–µ, –ì—Ä–∞–º–º—ã,
  –∑–Ω–∞—á–µ–Ω–∏—è "–Ω–∞ 100–≥", –∏—Ç–æ–≥–æ–≤—ã–µ –º–∞–∫—Ä–æ—Å—ã).

**Constraints**:

- ‚ùå –ù–µ –∏–∑–º–µ–Ω—è–µ–º `heys_day_v12.js`, JSX –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É.
- ‚ùå –ù–µ —Å–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –∏ –∏—Ç–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.
- ‚úÖ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ `@media (max-width: 640px)`.

**Steps**:

1. **–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ**: –æ—Ç–∫—Ä—ã—Ç—å `apps/web/heys_day_v12.js`, –Ω–∞–π—Ç–∏ —Ä–µ–Ω–¥–µ—Ä —Ç–∞–±–ª–∏—Ü—ã
   (–ø–æ–∏—Å–∫ –ø–æ `<table` –∏–ª–∏ `createElement('table')`), –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å CSS-–∫–ª–∞—Å—Å—ã
   (–Ω–∞–ø—Ä–∏–º–µ—Ä, `.day-layout table` –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ `table`).
2. –í `apps/web/styles/main.css` –Ω–∞–π—Ç–∏ –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –±–ª–æ–∫
   `@media (max-width: 640px)`.
3. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è —Ç–∞–±–ª–∏—Ü:
   ```css
   /* Mobile: hide per-100g columns in meal tables */
   @media (max-width: 640px) {
     table th:nth-child(n + 3):nth-child(-n + 11),
     table td:nth-child(n + 3):nth-child(-n + 11) {
       display: none;
     }
     table {
       font-size: 13px;
     }
     table th,
     table td {
       padding: 6px 4px;
     }
   }
   ```
4. –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –∏–º–µ–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –∫–ª–∞—Å—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, `.meal-table`), –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
   –µ–≥–æ –≤–º–µ—Å—Ç–æ `table`.
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–∞ desktop (>640px) —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å.

**Verification Commands**:

```bash
pnpm --filter @heys/web run build  # –î–æ–ª–∂–Ω–æ –ø—Ä–æ–π—Ç–∏ –±–µ–∑ –æ—à–∏–±–æ–∫
pnpm --filter @heys/web run dev    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω–æ
```

**Visual Check** (DevTools):

- Responsive Mode ‚Üí iPhone 12 (390px)
- –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–î–µ–Ω—å"
- –£–±–µ–¥–∏—Ç—å—Å—è: —Ç–∞–±–ª–∏—Ü–∞ –≤–∏–¥–Ω–∞ –±–µ–∑ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Å–∫—Ä–æ–ª–ª–∞, –≤–∏–¥–Ω—ã –∫–æ–ª–æ–Ω–∫–∏ "–ü—Ä–æ–¥—É–∫—Ç",
  "–ì—Ä–∞–º–º—ã", "–ò—Ç–æ–≥–æ".

**Fail-safe**:

- –ï—Å–ª–∏ –ø–æ—Å–ª–µ CSS-—Ñ–∏–∫—Å–∞ —Ç–∞–±–ª–∏—Ü–∞ –≤—Å—ë –µ—â—ë –Ω–µ—á–∏—Ç–∞–±–µ–ª—å–Ω–∞, –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É –≤
  –æ—Ç—á—ë—Ç–µ –∏ –ø–æ–ø—Ä–æ—Å–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–µ—Ä–µ—Ö–æ–¥ –∫ JS-—Ä–µ—à–µ–Ω–∏—é (Phase 3.3,
  "Cards").

---

### –ü—Ä–æ–º–ø—Ç 3: Implement Swipe Navigation

**Role**: React Developer **Goal**: –î–æ–±–∞–≤–∏—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ —Å–≤–∞–π–ø—ã –º–µ–∂–¥—É
–≤–∫–ª–∞–¥–∫–∞–º–∏, –Ω–µ –ª–æ–º–∞—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª –∏ —Ä–∞–±–æ—Ç—É –∏–Ω–ø—É—Ç–æ–≤. **Risk Level**: üü°
–°—Ä–µ–¥–Ω–∏–π (–æ–±—Ä–∞–±–æ—Ç–∫–∞ touch-—Å–æ–±—ã—Ç–∏–π)

**Inputs**:

- –§–∞–π–ª: `apps/web/heys_app_v12.js`
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç: `App` (—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, —É–ø—Ä–∞–≤–ª—è—é—â–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º `tab`).

**Constraints**:

- ‚ùå –ù–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º `window.HEYS.*` –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É —Ç–∞–±–æ–≤.
- ‚ùå –ù–µ –≤–µ—à–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç—ã —Ç–∞–±–ª–∏—Ü/–∏–Ω–ø—É—Ç–æ–≤.
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –Ω–∞—Ç–∏–≤–Ω—ã–µ `onTouch*`, –±–µ–∑ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫.

**Steps**:

1. –í `App` –¥–æ–±–∞–≤–∏—Ç—å `useRef` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (—á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ª–∏—à–Ω–∏—Ö
   —Ä–µ-—Ä–µ–Ω–¥–µ—Ä–æ–≤ –ø—Ä–∏ —Å–≤–∞–π–ø–µ):
   ```javascript
   const touchStart = React.useRef(null);
   const touchEnd = React.useRef(null);
   const minSwipeDistance = 50;
   ```
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `.current`):

   ```javascript
   const onTouchStart = (e) => {
     touchEnd.current = null;
     touchStart.current = {
       x: e.targetTouches[0].clientX,
       y: e.targetTouches[0].clientY,
     };
   };

   const onTouchMove = (e) => {
     touchEnd.current = {
       x: e.targetTouches[0].clientX,
       y: e.targetTouches[0].clientY,
     };
   };

   const onTouchEnd = () => {
     if (!touchStart.current || !touchEnd.current) return;

     const diffX = touchStart.current.x - touchEnd.current.x;
     const diffY = touchStart.current.y - touchEnd.current.y;

     // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ—Å—Ç—å (X > Y)
     if (Math.abs(diffX) < Math.abs(diffY)) return;

     // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–∏—Å—Ç–∞–Ω—Ü–∏—é
     if (Math.abs(diffX) < minSwipeDistance) return;

     // 3. –ü—Ä–æ–≤–µ—Ä–∫–∞: –Ω–µ –≤–Ω—É—Ç—Ä–∏ –∏–Ω–ø—É—Ç–∞ –∏–ª–∏ —Ç–∞–±–ª–∏—Ü—ã
     const active = document.activeElement;
     if (active && ['INPUT', 'TEXTAREA', 'SELECT'].includes(active.tagName))
       return;

     // 4. –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
     const tabs = ['ration', 'day', 'reports', 'user', 'analytics'];
     const currentIndex = tabs.indexOf(tab);

     if (diffX > 0 && currentIndex < tabs.length - 1) {
       setTab(tabs[currentIndex + 1]); // –°–≤–∞–π–ø –≤–ª–µ–≤–æ -> –í–ø–µ—Ä–µ–¥
     }

     if (diffX < 0 && currentIndex > 0) {
       setTab(tabs[currentIndex - 1]); // –°–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ -> –ù–∞–∑–∞–¥
     }
   };
   ```

3. –ü—Ä–∏–≤—è–∑–∞—Ç—å –∫ `.wrap`:
   ```javascript
   React.createElement(
     'div',
     {
       className: 'wrap',
       onTouchStart: onTouchStart,
       onTouchMove: onTouchMove,
       onTouchEnd: onTouchEnd,
     } /* ... */,
   );
   ```

**Verification**:

- –¢–µ—Å—Ç –≤ –º–æ–±–∏–ª—å–Ω–æ–π —ç–º—É–ª—è—Ü–∏–∏ Chrome: —Å–≤–∞–π–ø—ã –ø–æ –ø—É—Å—Ç–æ–π –æ–±–ª–∞—Å—Ç–∏ –º–µ–Ω—è—é—Ç –≤–∫–ª–∞–¥–∫–∏.
- –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –¥–ª–∏–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –≤–Ω–∏–∑/–≤–≤–µ—Ä—Ö –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç —Å–º–µ–Ω—É –≤–∫–ª–∞–¥–∫–∏.
- –í–≤–æ–¥ –≤ –ø–æ–ª—è—Ö –æ—Å—Ç–∞—ë—Ç—Å—è –±–µ—Å–ø—Ä–µ–ø—è—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º.

**Fail-safe**:

- –ï—Å–ª–∏ –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è, —É–º–µ–Ω—å—à–∏—Ç—å
  —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, `minSwipeDistance = 70`) –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —Ç–µ—Å—Ç.

---

### –ü—Ä–æ–º–ø—Ç 4: Enable PWA (Progressive Web App)

**Role**: Web Configuration Specialist **Goal**: –°–¥–µ–ª–∞—Ç—å HEYS —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—ã–º
–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º (Add to Home Screen) –±–µ–∑ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è Service Worker. **Risk Level**:
üü¢ –ù–∏–∑–∫–∏–π (–∫–æ–Ω—Ñ–∏–≥–∏)

**Inputs**:

- –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `apps/web/public/manifest.json` (–µ—Å–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `public` –Ω–µ—Ç ‚Äî
  —Å–æ–∑–¥–∞—Ç—å).
- –û–±–Ω–æ–≤–∏—Ç—å `<head>` –≤ `apps/web/index.html`.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∏–∫–æ–Ω–∫–∏ –∏–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–≥–ª—É—à–∫–∏.

**Constraints**:

- ‚ùå –ù–µ –ø–æ–¥–∫–ª—é—á–∞–µ–º Service Worker –∏ –Ω–µ –º–µ–Ω—è–µ–º build-–∫–æ–Ω—Ñ–∏–≥.
- ‚úÖ –í—Å–µ –ø—É—Ç–∏ –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫–æ—Ä–Ω–µ–≤—ã–º–∏ (`/icon-192.png`).
- ‚úÖ –¶–≤–µ—Ç–∞ –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å–æ —Å—Ç–∏–ª–∏—Å—Ç–∏–∫–æ–π (`theme_color = #6A5ACD`).

**Steps**:

1. **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤
   `apps/web/public/manifest.json` (Vite –∫–æ–ø–∏—Ä—É–µ—Ç `public/` –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–∏
   —Å–±–æ—Ä–∫–µ).
2. –°–æ–∑–¥–∞—Ç—å `apps/web/public/manifest.json`:
   ```json
   {
     "name": "HEYS Nutrition Tracker",
     "short_name": "HEYS",
     "description": "–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É—á—ë—Ç–∞ –ø–∏—Ç–∞–Ω–∏—è –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫",
     "start_url": "/",
     "scope": "/",
     "display": "standalone",
     "background_color": "#ffffff",
     "theme_color": "#6A5ACD",
     "orientation": "portrait",
     "icons": [
       {
         "src": "/icon-192.png",
         "sizes": "192x192",
         "type": "image/png",
         "purpose": "any maskable"
       },
       {
         "src": "/icon-512.png",
         "sizes": "512x512",
         "type": "image/png",
         "purpose": "any maskable"
       }
     ]
   }
   ```
3. –°–æ–∑–¥–∞—Ç—å placeholder –∏–∫–æ–Ω–∫–∏ (–µ—Å–ª–∏ –Ω–µ—Ç –≥–æ—Ç–æ–≤—ã—Ö): –≤ `apps/web/public/` –ø–æ–ª–æ–∂–∏—Ç—å
   `icon-192.png` –∏ `icon-512.png` (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—é–±–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 192x192
   –∏ 512x512).
4. –û–±–Ω–æ–≤–∏—Ç—å `apps/web/index.html` –≤ `<head>` (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã!):
   ```html
   <link rel="manifest" href="/manifest.json" />
   <meta name="theme-color" content="#6A5ACD" />
   <meta name="apple-mobile-web-app-capable" content="yes" />
   <meta name="apple-mobile-web-app-status-bar-style" content="default" />
   <meta name="apple-mobile-web-app-title" content="HEYS" />
   <link rel="apple-touch-icon" href="/icon-192.png" />
   ```

**Verification Commands**:

```bash
pnpm --filter @heys/web run build  # –î–æ–ª–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å—Å—è
ls apps/web/dist/manifest.json     # –§–∞–π–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ dist
ls apps/web/dist/icon-*.png        # –ò–∫–æ–Ω–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ dist
```

**Browser Check** (DevTools):

- Application ‚Üí Manifest ‚Üí "No errors", –∏–∫–æ–Ω–∫–∏ –≤–∏–¥–Ω—ã
- Lighthouse ‚Üí PWA audit ‚Üí "Installable" = ‚úÖ

**Fail-safe**:

- –ï—Å–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å `start_url` –∏ `scope`; –ø—Ä–∏
  –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∑–∞ —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∏–∫–æ–Ω–∫–∞–º–∏.

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- **Apple HIG Touch Targets**: –º–∏–Ω–∏–º—É–º 44x44pt –¥–ª—è iOS.
- **Material Design Touch Targets**: –º–∏–Ω–∏–º—É–º 48x48dp –¥–ª—è Android.
- **Safe Area Insets**: –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ iPhone —Å –≤—ã—Ä–µ–∑–æ–º.
- **Touch-action CSS**: —É–±–∏—Ä–∞–µ—Ç 300ms –∑–∞–¥–µ—Ä–∂–∫—É —Ç–∞–ø–∞.

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

1. **iOS Safari**: iPhone SE (320px), iPhone 14 (390px), iPhone 14 Pro Max
   (430px).
2. **Android Chrome**: Samsung Galaxy S10 (360px), Pixel 7 (412px).
3. **Landscape —Ä–µ–∂–∏–º**: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –ø–æ–≤–æ—Ä–æ—Ç–µ.

### Rollback –ø–ª–∞–Ω (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–µ—Ç—Å—è)

1. –û—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ Git: `git checkout HEAD -- apps/web/`.
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è.
3. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞.
4. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —Ñ–∞–∑—É –∑–∞–Ω–æ–≤–æ.
