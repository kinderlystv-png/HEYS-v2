@echo off
REM ğŸš€ BATCH Ğ¡ĞšĞ Ğ˜ĞŸĞ¢ Ğ”Ğ›Ğ¯ Ğ—ĞĞŸĞ£Ğ¡ĞšĞ Ğ¡Ğ˜Ğ¡Ğ¢Ğ•ĞœĞ« ĞĞšĞ¢Ğ£ĞĞ›Ğ˜Ğ—ĞĞ¦Ğ˜Ğ˜ Ğ”ĞĞšĞ£ĞœĞ•ĞĞ¢ĞĞ¦Ğ˜Ğ˜ HEYS

echo.
echo ========================================
echo ğŸ”„ Ğ¡Ğ˜Ğ¡Ğ¢Ğ•ĞœĞ ĞĞšĞ¢Ğ£ĞĞ›Ğ˜Ğ—ĞĞ¦Ğ˜Ğ˜ Ğ”ĞĞšĞ£ĞœĞ•ĞĞ¢ĞĞ¦Ğ˜Ğ˜ HEYS
echo ========================================
echo.

REM ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ñ Node.js
node --version >nul 2>&1
if errorlevel 1 (
    echo âŒ Node.js Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½! Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğµ Node.js Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½Ğ¸Ñ.
    pause
    exit /b 1
)

REM ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´ Ğ² Ñ€Ğ°Ğ±Ğ¾Ñ‡ÑƒÑ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ
cd /d "%~dp0"

REM ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ñ Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ñ… Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹
if not exist "docs\actualization-runner.js" (
    echo âŒ ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ñ„Ğ°Ğ¹Ğ» ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½!
    echo ğŸ“‚ ĞĞ¶Ğ¸Ğ´Ğ°ĞµÑ‚ÑÑ: docs\actualization-runner.js
    pause
    exit /b 1
)

if not exist "docs\dependencies.yaml" (
    echo âŒ Ğ¤Ğ°Ğ¹Ğ» Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½!
    echo ğŸ“‚ ĞĞ¶Ğ¸Ğ´Ğ°ĞµÑ‚ÑÑ: docs\dependencies.yaml
    pause
    exit /b 1
)

REM Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹ ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ¾
if not exist "node_modules\js-yaml" (
    echo ğŸ“¦ Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹...
    npm install js-yaml
    if errorlevel 1 (
        echo âŒ ĞÑˆĞ¸Ğ±ĞºĞ° ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹!
        pause
        exit /b 1
    )
)

echo ğŸ” ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹...
echo   âœ… Node.js Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½
echo   âœ… ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ñ‹
echo   âœ… Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ñ‹
echo.

REM ĞœĞµĞ½Ñ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ° Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ° Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°
echo Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ñ€ĞµĞ¶Ğ¸Ğ¼ Ğ°ĞºÑ‚ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸:
echo.
echo [1] ğŸ”„ ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ°ĞºÑ‚ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ (Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ)
echo [2] ğŸ—ºï¸ Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğµ ĞºĞ°Ñ€Ñ‚Ñ‹
echo [3] ğŸ“ Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ
echo [4] ğŸ§ª Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ
echo [5] ğŸ“Š ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ
echo [6] ğŸ”’ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ backup
echo [0] âŒ ĞÑ‚Ğ¼ĞµĞ½Ğ°
echo.

set /p choice="Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ½Ğ¾Ğ¼ĞµÑ€ [0-6]: "

if "%choice%"=="1" goto full_actualization
if "%choice%"=="2" goto nav_maps_only
if "%choice%"=="3" goto docs_only
if "%choice%"=="4" goto validation_only
if "%choice%"=="5" goto open_dashboard
if "%choice%"=="6" goto create_backup
if "%choice%"=="0" goto cancel
goto invalid_choice

:full_actualization
echo.
echo ğŸš€ Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ¹ Ğ°ĞºÑ‚ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸...
echo âš ï¸ Ğ­Ñ‚Ğ¾ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ·Ğ°Ğ½ÑÑ‚ÑŒ Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¾ Ğ¼Ğ¸Ğ½ÑƒÑ‚.
echo.
pause
node docs\actualization-runner.js
goto end

:nav_maps_only
echo.
echo ğŸ—ºï¸ ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ñ… ĞºĞ°Ñ€Ñ‚...
node docs\actualization-runner.js --no-docs
goto end

:docs_only
echo.
echo ğŸ“ ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ğ¸...
node docs\actualization-runner.js --no-nav-maps
goto end

:validation_only
echo.
echo ğŸ§ª Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹...
node -e "
const ActualizationSystem = require('./docs/actualization-runner.js');
const system = new ActualizationSystem();
system.phase4_Validate().then(() => {
    console.log('âœ… Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ°');
}).catch(err => {
    console.error('âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸:', err.message);
});
"
goto end

:open_dashboard
echo.
echo ğŸ“Š ĞÑ‚ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ...
if exist "docs\ui\actualization-dashboard.html" (
    start "" "docs\ui\actualization-dashboard.html"
    echo âœ… ĞŸĞ°Ğ½ĞµĞ»ÑŒ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ğ° Ğ² Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğµ
) else (
    echo âŒ ĞŸĞ°Ğ½ĞµĞ»ÑŒ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ°!
    echo ğŸ“‚ ĞĞ¶Ğ¸Ğ´Ğ°ĞµÑ‚ÑÑ: docs\ui\actualization-dashboard.html
)
goto end

:create_backup
echo.
echo ğŸ”’ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ backup ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²...
node -e "
const DocsBackupSystem = require('./docs/automation/backup-system.js');
const backup = new DocsBackupSystem();
backup.autoBackupCriticalFiles('manual_backup').then(results => {
    console.log('âœ… Backup ÑĞ¾Ğ·Ğ´Ğ°Ğ½ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾');
    for (let result of results) {
        if (result.success) {
            console.log('  âœ…', result.file);
        } else {
            console.log('  âŒ', result.file, ':', result.error);
        }
    }
}).catch(err => {
    console.error('âŒ ĞÑˆĞ¸Ğ±ĞºĞ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ backup:', err.message);
});
"
goto end

:invalid_choice
echo.
echo âŒ ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€! ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ĞµÑ‰Ğµ Ñ€Ğ°Ğ·.
echo.
goto menu

:cancel
echo.
echo âŒ ĞĞ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¾Ñ‚Ğ¼ĞµĞ½ĞµĞ½Ğ°.
goto end

:end
echo.
echo ========================================
echo ğŸ ĞĞŸĞ•Ğ ĞĞ¦Ğ˜Ğ¯ Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ
echo ========================================
echo.

REM ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ ĞºÑ€Ğ°Ñ‚ĞºÑƒÑ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ
if exist "docs\DOCS_ACTUALIZATION_SYSTEM.md" (
    echo ğŸ“Š Ğ¢ĞµĞºÑƒÑ‰Ğ°Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°:
    findstr /c:"Ğ¤Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¾:" "docs\DOCS_ACTUALIZATION_SYSTEM.md" 2>nul
    findstr /c:"ĞĞºÑ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ğ¸:" "docs\DOCS_ACTUALIZATION_SYSTEM.md" 2>nul
    findstr /c:"ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¾:" "docs\DOCS_ACTUALIZATION_SYSTEM.md" 2>nul
    echo.
)

echo ğŸ’¡ ĞŸĞ¾Ğ»ĞµĞ·Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹:
echo   ğŸ“Š ĞŸĞ°Ğ½ĞµĞ»ÑŒ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ: start docs\ui\actualization-dashboard.html
echo   ğŸ”’ Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº backup'Ğ¾Ğ²: node -e "const b=require('./docs/automation/backup-system.js'); new b().listBackups().then(console.log)"
echo   ğŸ” ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹: node -e "const d=require('./docs/automation/dependency-resolver.js'); new d().detectCircularDependencies().then(console.log)"
echo.

pause
