# Telegram Mini App Setup (HEYS v2)

> –≠—Ç–æ—Ç —Ñ–∞–π–ª –æ–ø–∏—Å—ã–≤–∞–µ—Ç **–ª–æ–∫–∞–ª—å–Ω—ã–π dev-–∑–∞–ø—É—Å–∫** mini-app –∏ backend –¥–ª—è Telegram WebApp **–±–µ–∑ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏**.

## 1. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è

- Node.js ‚â• 18
- pnpm ‚â• 8
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
cd /Users/poplavskijanton/HEYS-v2
pnpm install
```

- –°–æ–∑–¥–∞–Ω Telegram-–±–æ—Ç —á–µ—Ä–µ–∑ `@BotFather` (—Å–º. –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Telegram Bots API).

## 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 2.1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è backend

–°–æ–∑–¥–∞–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ù–ï –∫–æ–º–º–∏—Ç—å—Ç–µ –µ–≥–æ –≤ git):

```bash
cd /Users/poplavskijanton/HEYS-v2
cp .env .env.local 2>/dev/null || touch .env.local
```

–û—Ç–∫—Ä–æ–π—Ç–µ `.env.local` –∏ –∑–∞–¥–∞–π—Ç–µ –Ω—É–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:

```dotenv
# API server
API_PORT=4001
DATABASE_NAME=projectB
NODE_ENV=development

# Base URL –¥–ª—è Vite-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
VITE_API_URL=http://localhost:4001

# Supabase (–≤–∫–ª—é—á–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —Ç—è–Ω—É—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–æ–≤)
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_KEY=your-service-role-key

# Telegram Bot configuration
# –ù–∞—Å—Ç–æ—è—â–∏–π —Ç–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ, –ù–ï –¥–æ–±–∞–≤–ª—è–π—Ç–µ –µ–≥–æ –≤ –∫–æ–º–º–∏—Ç—ã
TELEGRAM_BOT_TOKEN=__REPLACE_WITH_LOCAL_TOKEN__

# –†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ Telegram user IDs (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
# –ü—Ä–∏–º–µ—Ä: TELEGRAM_ALLOWED_USER_IDS=123456789,987654321
TELEGRAM_ALLOWED_USER_IDS=

# –ú–∞–ø–ø–∏–Ω–≥ Telegram ‚Üí Supabase curator (—Ñ–æ—Ä–º–∞—Ç: telegramId=supabaseUserId)
# –ü—Ä–∏–º–µ—Ä: TELEGRAM_CURATOR_MAP=123456789=00000000-0000-4000-8000-aaaaaaaaaaaa
TELEGRAM_CURATOR_MAP=
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `.env.local` –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è git (–≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≤ `.gitignore` –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞):

```gitignore
.env.local
```

> –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –¥–ª—è "–ø—Ä–∏–º–µ—Ä–æ–≤" –º–æ–∂–Ω–æ –¥–µ—Ä–∂–∞—Ç—å `.env.example` **–±–µ–∑ —Ç–æ–∫–µ–Ω–æ–≤**, –∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞–¥–∞–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤ `.env.local`. –î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø–æ–ª–Ω–∏—Ç–µ `SUPABASE_URL`, `SUPABASE_SERVICE_KEY` –∏ `TELEGRAM_CURATOR_MAP` (–∫–∞–∂–¥—ã–π Telegram ID, –∫–æ—Ç–æ—Ä–æ–º—É —Ä–∞–∑—Ä–µ—à—ë–Ω –¥–æ—Å—Ç—É–ø, –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω —Å Supabase `auth.users.id`).

### 2.2. Telegram WebApp –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ —É `@BotFather` –∑–∞–¥–∞–π—Ç–µ:

- **WebApp URL** ‚Äì URL –≤–∞—à–µ–π –º–∏–Ω–∏-–∞–ø–∫–∏ (–≤ dev-—Ä–µ–∂–∏–º–µ –æ–±—ã—á–Ω–æ `https://<ngrok-–∞–¥—Ä–µ—Å>` –∏–ª–∏ –¥—Ä—É–≥–æ–π –ø—É–±–ª–∏—á–Ω—ã–π —Ç—É–Ω–Ω–µ–ª—å, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π –ø–æ—Ä—Ç).
- **Allowed domains** ‚Äì –¥–æ–º–µ–Ω, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –¥–æ—Å—Ç—É–ø–µ–Ω frontend (–¥–æ–º–µ–Ω –ø—Ä–æ–∫—Å–∏/—Ç—É–Ω–Ω–µ–ª—è).

–õ–æ–∫–∞–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ `http://localhost:3002` / `http://localhost:3003` –Ω—É–∂–Ω–æ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—Ç—å –Ω–∞—Ä—É–∂—É —á–µ—Ä–µ–∑ ngrok –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏, —Ç.–∫. Telegram –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –≤–∞—à–µ–º—É frontend.

## 3. –ó–∞–ø—É—Å–∫ backend

Backend HEYS API –∂–∏–≤—ë—Ç –≤ `packages/core` –∏ –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è –Ω–∞ `API_PORT` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `4001`).

### –í–∞—Ä–∏–∞–Ω—Ç 1: —á–µ—Ä–µ–∑ VS Code task (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–í VS Code –µ—Å—Ç—å task:

- `Start API Server (Port 4001)`

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –µ–≥–æ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å VS Code (Terminal ‚Üí Run Task‚Ä¶). Backend —Å—Ç–∞—Ä—Ç—É–µ—Ç –Ω–∞ `http://localhost:4001`.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –≤—Ä—É—á–Ω—É—é –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞

```bash
cd /Users/poplavskijanton/HEYS-v2
API_PORT=4001 DATABASE_NAME=projectB node packages/core/src/server.js
```

–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–µ—Ä–∞:

```bash
curl http://localhost:4001/health
```

–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç ‚Äì JSON —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `OK`.

## 4. –ó–∞–ø—É—Å–∫ Telegram mini-app (frontend)

–ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è Telegram –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `apps/tg-mini`.

### 4.1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ `.env.local` –¥–ª—è mini-app

```bash
cd /Users/poplavskijanton/HEYS-v2/apps/tg-mini
cp .env.telegram .env.local 2>/dev/null || touch .env.local
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `.env.local` —É–∫–∞–∑–∞–Ω—ã:

```dotenv
# URL backend API
VITE_API_URL=http://localhost:4001

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –º–æ–∫–∏
VITE_USE_CLIENT_MOCKS=false
```

### 4.2. –ó–∞–ø—É—Å–∫ dev-—Å–µ—Ä–≤–µ—Ä–∞ mini-app

**–í–∞—Ä–∏–∞–Ω—Ç 1: —á–µ—Ä–µ–∑ VS Code task (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

–ó–∞–ø—É—Å—Ç–∏—Ç–µ task `Start TG Mini (Port 3002)` —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å VS Code (Terminal ‚Üí Run Task‚Ä¶).

**–í–∞—Ä–∏–∞–Ω—Ç 2: –≤—Ä—É—á–Ω—É—é –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞**

```bash
cd /Users/poplavskijanton/HEYS-v2
pnpm run dev:tg-mini
```

–ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é:

```bash
cd /Users/poplavskijanton/HEYS-v2
pnpm --filter @heys/tg-mini run dev
```

–ü–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞ dev-—Å–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:3002`.

### 4.3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ngrok –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∏–∑ Telegram

–î–ª—è Telegram WebApp –Ω—É–∂–µ–Ω –≤–Ω–µ—à–Ω–∏–π HTTPS URL. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ngrok:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
brew install ngrok

# –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–ø–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –Ω–∞ https://dashboard.ngrok.com/get-started/your-authtoken)
ngrok config add-authtoken YOUR_NGROK_TOKEN

# –ó–∞–ø—É—Å–∫ —Ç—É–Ω–Ω–µ–ª—è
ngrok http 3002
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π URL (–Ω–∞–ø—Ä–∏–º–µ—Ä, `https://abc123.ngrok-free.dev`).

**–í–∞–∂–Ω–æ:** –î–æ–±–∞–≤—å—Ç–µ ngrok-–¥–æ–º–µ–Ω –≤ `apps/tg-mini/vite.config.ts`:

```ts
server: {
  port: 3002,
  host: true,
  strictPort: false,
  allowedHosts: ['your-ngrok-domain.ngrok-free.dev'], // –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω
},
```

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ mini-app –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥–∞.

## 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

1. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ backend –æ—Ç–≤–µ—á–∞–µ—Ç:

   ```bash
   curl http://localhost:4001/health
   ```

2. –û—Ç–∫—Ä—ã—Ç—å mini-app –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–æ `http://localhost:3002` –∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
   - –Ω–µ—Ç –ª–∏ CORS –æ—à–∏–±–æ–∫ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö –∫ `http://localhost:4001`;
  - –æ—Ç–≤–µ—Ç—ã API –∏–º–µ—é—Ç —Å—Ç–∞—Ç—É—Å HTTP 200;
  - `GET /api/curator/clients` –∏ `GET /api/curator/client/:clientId/day/:dayKey` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –¥–∞–Ω–Ω—ã–µ Supabase (–µ—Å–ª–∏ –∑–∞–¥–∞–Ω—ã `SUPABASE_*`).

3. –û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞ –≤ Telegram –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å WebApp-–∫–Ω–æ–ø–∫—É (–∫–æ—Ç–æ—Ä—É—é –≤—ã –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ —á–µ—Ä–µ–∑ `@BotFather` –∏–ª–∏ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫–∏ –≤ —Å–∞–º–æ–º –±–æ—Ç–µ). –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å mini-app –¥–æ–ª–∂–µ–Ω –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –∏ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –≤–∞—à–µ–º—É backend.

## 6. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–ù–∏–∫–æ–≥–¥–∞** –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è `TELEGRAM_BOT_TOKEN` –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.
- –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –∫–æ–≥–¥–∞-–ª–∏–±–æ –ø–æ–ø–∞–ª –≤:
  - git-–∏—Å—Ç–æ—Ä–∏—é,
  - —Ç–µ—Ä–º–∏–Ω–∞–ª, –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤ –ª–æ–≥–∏,
  - –ø–µ—Ä–µ–ø–∏—Å–∫—É, —Å–∫—Ä–∏–Ω—à–æ—Ç—ã,

  ‚Äî –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `/revoke` —É `@BotFather` –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω.

- –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω-—Å—Ä–µ–¥—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã CI/CD –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.
- –í production **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –∑–∞–ø–æ–ª–Ω–∏—Ç–µ `TELEGRAM_ALLOWED_USER_IDS` (–º–∏–Ω–∏–º—É–º –æ–¥–∏–Ω ID –∫—É—Ä–∞—Ç–æ—Ä–∞). –ü—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ dev.
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `API_ALLOWED_ORIGINS`, —á—Ç–æ–±—ã backend –ø—Ä–∏–Ω–∏–º–∞–ª –∑–∞–ø—Ä–æ—Å—ã —Ç–æ–ª—å–∫–æ —Å –Ω—É–∂–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `https://curator.heysapp.com`).

## 7. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞ –≤ BotFather

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ ngrok:

1. –û—Ç–∫—Ä–æ–π—Ç–µ `@BotFather` –≤ Telegram
2. –ù–∞–ø–∏—à–∏—Ç–µ `/mybots` ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
3. **Bot Settings** ‚Üí **Menu Button** ‚Üí **Edit Menu Button URL**
4. –í—Å—Ç–∞–≤—å—Ç–µ ngrok URL: `https://your-domain.ngrok-free.dev`
5. **Configure Menu Button** ‚Üí –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ü–∞–Ω–µ–ª—å –∫—É—Ä–∞—Ç–æ—Ä–∞")

–¢–µ–ø–µ—Ä—å –≤ —á–∞—Ç–µ —Å –±–æ—Ç–æ–º –ø–æ—è–≤–∏—Ç—Å—è –∫–Ω–æ–ø–∫–∞ –º–µ–Ω—é, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–∫—Ä–æ–µ—Ç mini-app.

## 8. –ö—Ä–∞—Ç–∫–∞—è –ø–∞–º—è—Ç–∫–∞ –∫–æ–º–∞–Ω–¥

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
cd /Users/poplavskijanton/HEYS-v2
pnpm install

# –ó–∞–ø—É—Å—Ç–∏—Ç—å backend (—á–µ—Ä–µ–∑ VS Code task "Start API Server (Port 4001)")
# –õ–∏–±–æ –≤—Ä—É—á–Ω—É—é:
API_PORT=4001 DATABASE_NAME=projectB node packages/core/src/server.js

# –ó–∞–ø—É—Å—Ç–∏—Ç—å Telegram mini-app (—á–µ—Ä–µ–∑ VS Code task "Start TG Mini (Port 3002)")
# –õ–∏–±–æ –≤—Ä—É—á–Ω—É—é:
pnpm run dev:tg-mini

# –ó–∞–ø—É—Å—Ç–∏—Ç—å ngrok
ngrok http 3002
```

## 9. –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å (15 –Ω–æ—è–±—Ä—è 2025)

‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç:**
- Backend API –Ω–∞ `localhost:4001`
- Mini-app frontend –Ω–∞ `localhost:3002`
- Telegram WebApp –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (initData –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è)
- Ngrok —Ç—É–Ω–Ω–µ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∏–∑ Telegram
- CORS –∏ whitelist Telegram ID (—á–µ—Ä–µ–∑ `TELEGRAM_ALLOWED_USER_IDS`)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ HMAC-–ø–æ–¥–ø–∏—Å–∏ initData –Ω–∞ backend
- Supabase-–ø—É—Ç—å: —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ–¥–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `supabaseCuratorService`

üöÄ **–ù–æ–≤–æ–µ:**
- –ü—Ä–æ–¥–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π (—Å–º. `TELEGRAM_MINI_APP_PRODUCTION.md`) –≤–∫–ª—é—á–∞–µ—Ç Supabase-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ Telegram curator map
- `API_ALLOWED_ORIGINS` –∏ `TELEGRAM_CURATOR_MAP` –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É—é—Ç—Å—è –∏–∑ `.env`
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã `router.supabase.test.ts` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –±–µ–∑ –ø–æ–¥–Ω—è—Ç–æ–≥–æ Supabase

üß™ **–í –æ—á–µ—Ä–µ–¥–∏:**
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ E2E-—Ç–µ—Å—Ç—ã Telegram mini-app –Ω–∞ staging-–¥–æ–º–µ

–≠—Ç–æ–≥–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ —à–∞–≥–æ–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å Telegram mini-app –ª–æ–∫–∞–ª—å–Ω–æ, –Ω–µ —Ö—Ä–∞–Ω—è —Å–µ–∫—Ä–µ—Ç—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∏ –Ω–µ –ø–æ–ª–∞–≥–∞—è—Å—å –Ω–∞ –ø–∞–º—è—Ç—å.

## 10. –ü—Ä–æ–¥–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π (Step 6)

–î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –±–æ–µ–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ—Å—å —á–µ–∫-–ª–∏—Å—Ç–∞:

1. –°–æ–±–µ—Ä–∏—Ç–µ backend: `pnpm --filter @heys/core run build` ‚Üí `node packages/core/src/server.js` —Å production `.env`.
2. –°–æ–±–µ—Ä–∏—Ç–µ mini-app: `pnpm --filter @heys/tg-mini run build` –∏ –∑–∞–¥–µ–ø–ª–æ–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `apps/tg-mini/dist/` –Ω–∞ —Å—Ç–∞—Ç–∏–∫—É.
3. –û–±–Ω–æ–≤–∏—Ç–µ `server.allowedHosts` –≤ `apps/tg-mini/vite.config.ts` –Ω–∞ production-–¥–æ–º–µ–Ω.
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ BotFather (Menu Button URL + Allowed Domains) –Ω–∞ —Ç–æ—Ç –∂–µ –¥–æ–º–µ–Ω.
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–¥–æ—Ä–æ–≤—å–µ `/health` –∏ —É—Å–ø–µ—à–Ω—É—é –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é Telegram ID.

üìÑ –ü–æ–¥—Ä–æ–±–Ω—ã–π –ø–ª–µ–π–±—É–∫ –æ–ø–∏—Å–∞–Ω –≤ —Ñ–∞–π–ª–µ `TELEGRAM_MINI_APP_PRODUCTION.md`.
